<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>MySQL - Zhang&#39;s Blog的博客</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Zhang&#39;s Blog" /><meta name="description" content="Step01.管理数据库 创建数据库 1 create database 数据库名; 数据库名命名规范 数字 字母 下划线 但不能以数字开头 不能使用mysql关键字命名数据库 1 2 db_mrbbs db_MRBBS 创" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.67.1 with theme even" />


<link rel="canonical" href="http://localhost:1313/post/mysql/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="MySQL" />
<meta property="og:description" content="Step01.管理数据库 创建数据库 1 create database 数据库名; 数据库名命名规范 数字 字母 下划线 但不能以数字开头 不能使用mysql关键字命名数据库 1 2 db_mrbbs db_MRBBS 创" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/mysql/" />
<meta property="article:published_time" content="2020-08-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-08-01T00:00:00+00:00" />
<meta itemprop="name" content="MySQL">
<meta itemprop="description" content="Step01.管理数据库 创建数据库 1 create database 数据库名; 数据库名命名规范 数字 字母 下划线 但不能以数字开头 不能使用mysql关键字命名数据库 1 2 db_mrbbs db_MRBBS 创">
<meta itemprop="datePublished" content="2020-08-01T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2020-08-01T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="12397">



<meta itemprop="keywords" content="DataBase," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MySQL"/>
<meta name="twitter:description" content="Step01.管理数据库 创建数据库 1 create database 数据库名; 数据库名命名规范 数字 字母 下划线 但不能以数字开头 不能使用mysql关键字命名数据库 1 2 db_mrbbs db_MRBBS 创"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Zhang&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/home/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">MyBlog</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Zhang&#39;s Blog</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/home/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">MyBlog</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">MySQL</h1>

      <div class="post-meta">
        <span class="post-time"> 2020-08-01 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#step01管理数据库">Step01.管理数据库</a>
      <ul>
        <li><a href="#创建数据库">创建数据库</a></li>
        <li><a href="#查看数据库">查看数据库</a></li>
        <li><a href="#选择数据库">选择数据库</a></li>
        <li><a href="#修改数据库">修改数据库</a></li>
        <li><a href="#删除数据库">删除数据库</a></li>
        <li><a href="#查看mysql支持的全部存储引擎">查看mysql支持的全部存储引擎</a></li>
        <li><a href="#查看默认的存储引擎">查看默认的存储引擎</a></li>
      </ul>
    </li>
    <li><a href="#step02表结构管理">Step02.表结构管理</a>
      <ul>
        <li><a href="#创建数据表">创建数据表</a></li>
        <li><a href="#复制数据表">复制数据表</a>
          <ul>
            <li><a href="#复制结构">复制结构</a></li>
            <li><a href="#复制结构和内容">复制结构和内容</a></li>
          </ul>
        </li>
        <li><a href="#查看数据库下的所有数据表">查看数据库下的所有数据表</a></li>
        <li><a href="#查看创建数据表时的定义语句">查看创建数据表时的定义语句</a></li>
        <li><a href="#显示数据表结构">显示数据表结构</a>
          <ul>
            <li><a href="#desc或describee">desc或describee</a></li>
            <li><a href="#columns">columns</a></li>
          </ul>
        </li>
        <li><a href="#设置表的存储引擎--enginexxx">设置表的存储引擎 ( engine=xxx)</a></li>
        <li><a href="#设置创建表的默认字符集">设置创建表的默认字符集</a></li>
        <li><a href="#以一个表的结构为模版创建一个表但不复制数据">以一个表的结构为模版,创建一个表,但不复制数据</a></li>
        <li><a href="#更改表名">更改表名</a></li>
        <li><a href="#更改多个表名">更改多个表名</a></li>
        <li><a href="#更改表的某个字段名称或者数据类型">更改表的某个字段(名称或者数据类型)</a></li>
        <li><a href="#更改字段数据类型">更改字段数据类型</a></li>
        <li><a href="#为数据表添加字段">为数据表添加字段</a>
          <ul>
            <li><a href="#单个字段">单个字段</a></li>
            <li><a href="#多个字段">多个字段</a></li>
          </ul>
        </li>
        <li><a href="#删除表的某个字段">删除表的某个字段</a></li>
        <li><a href="#更改表字段的排列顺序">更改表字段的排列顺序</a>
          <ul>
            <li><a href="#将a字段放到b字段后面">将A字段放到B字段后面</a></li>
            <li><a href="#将字段c放到表的第一位">将字段C放到表的第一位</a></li>
          </ul>
        </li>
        <li><a href="#删除数据表">删除数据表</a></li>
        <li><a href="#表的约束">表的约束</a>
          <ul>
            <li><a href="#主键约束">主键约束</a></li>
            <li><a href="#非空约束">非空约束</a></li>
            <li><a href="#唯一约束">唯一约束</a></li>
            <li><a href="#默认约束">默认约束</a></li>
            <li><a href="#四种约束-为字段添加约束和删除约束对比">四种约束-为字段添加约束和删除约束对比</a></li>
          </ul>
        </li>
        <li><a href="#为表字段设置自动增加">为表字段设置自动增加</a>
          <ul>
            <li><a href="#删除字段的自动增长">删除字段的自动增长</a></li>
            <li><a href="#重新为id添加自动增长">重新为id添加自动增长</a></li>
            <li><a href="#错误---duplicate-entry-0-for-key-primary-mysql的小问题">错误: - Duplicate entry &lsquo;0&rsquo; for key &lsquo;PRIMARY&rsquo;—— mysql的小问题</a></li>
            <li><a href="#修改表的默认自增值">修改表的默认自增值</a></li>
          </ul>
        </li>
        <li><a href="#索引">索引</a>
          <ul>
            <li><a href="#分类">分类</a></li>
            <li><a href="#创建表时创建索引">创建表时创建索引</a></li>
            <li><a href="#使用create语句创建索引">使用create语句创建索引</a></li>
            <li><a href="#使用alter语句创建索引">使用alter语句创建索引</a></li>
            <li><a href="#删除索引">删除索引</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step03表数据的更新操作">Step03.表数据的更新操作</a>
      <ul>
        <li><a href="#在mysql中支持将查询的结果插入到指定的数据表中">在MySQL中，支持将查询的结果插入到指定的数据表中</a></li>
        <li><a href="#临时表">临时表</a></li>
        <li><a href="#主键冲突">主键冲突</a>
          <ul>
            <li><a href="#方法一更新数据">方法一,更新数据</a></li>
            <li><a href="#方法二删除重复的主键数据">方法二,删除重复的主键数据</a></li>
            <li><a href="#方法三使用replace语句删除的同时进行替换">方法三,使用replace语句,删除的同时进行替换</a></li>
          </ul>
        </li>
        <li><a href="#查询">查询</a>
          <ul>
            <li><a href="#字段过滤查询">字段过滤查询</a></li>
            <li><a href="#值过滤查询">值过滤查询</a></li>
          </ul>
        </li>
        <li><a href="#更新数据">更新数据</a></li>
        <li><a href="#删除数据">删除数据</a>
          <ul>
            <li><a href="#delete">delete</a></li>
            <li><a href="#truncate">truncate</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step04表记录的检索查询">Step04.表记录的检索查询</a>
      <ul>
        <li><a href="#where">where</a>
          <ul>
            <li><a href="#not-in">(not) in</a></li>
            <li><a href="#根据数值范围查询某字段">根据数值范围查询某字段</a></li>
            <li><a href="#根据字段是否有空值查询">根据字段是否有空值查询</a></li>
            <li><a href="#去重查询">去重查询</a></li>
            <li><a href="#模糊查询">模糊查询</a></li>
            <li><a href="#and">and</a></li>
            <li><a href="#or">or</a></li>
          </ul>
        </li>
        <li><a href="#高级查询">高级查询</a>
          <ul>
            <li><a href="#聚合函数">聚合函数</a></li>
            <li><a href="#排序">排序</a></li>
            <li><a href="#分组">分组</a></li>
            <li><a href="#限制查询数量">限制查询数量</a></li>
            <li><a href="#应用排序后限制查询数量再更新数据">应用:排序后限制查询数量再更新数据</a></li>
          </ul>
        </li>
        <li><a href="#连接查询">连接查询</a>
          <ul>
            <li><a href="#内连接查询">内连接查询</a></li>
            <li><a href="#外连接查询">外连接查询</a></li>
            <li><a href="#全连接">全连接</a></li>
            <li><a href="#自连接查询">自连接查询</a></li>
            <li><a href="#子连接查询">子连接查询</a></li>
          </ul>
        </li>
        <li><a href="#给数据表取别名">给数据表取别名</a></li>
        <li><a href="#正则表达式">正则表达式</a></li>
        <li><a href="#外键">外键</a>
          <ul>
            <li><a href="#修改表时创建外键">修改表时创建外键</a></li>
            <li><a href="#删除外键">删除外键</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step05视图">Step05.视图</a>
      <ul>
        <li><a href="#创建视图">创建视图</a></li>
        <li><a href="#视图数据会同步于它的模版表">视图数据会同步于它的模版表</a></li>
        <li><a href="#视图的增删改查等操作都和数据表基本一样因为视图就是个表来着">视图的增删改查等操作都和数据表基本一样,因为视图就是个表来着</a>
          <ul>
            <li><a href="#查看视图">查看视图</a></li>
            <li><a href="#更新视图数据">更新视图数据</a></li>
            <li><a href="#修改视图结构">修改视图结构</a></li>
            <li><a href="#删除视图">删除视图</a></li>
          </ul>
        </li>
        <li><a href="#多表创建视图">多表创建视图</a></li>
      </ul>
    </li>
    <li><a href="#step06存储过程与触发器">Step06.存储过程与触发器</a>
      <ul>
        <li><a href="#函数">函数</a>
          <ul>
            <li><a href="#系统函数">系统函数</a></li>
            <li><a href="#自定义函数">自定义函数</a></li>
          </ul>
        </li>
        <li><a href="#存储过程">存储过程</a>
          <ul>
            <li><a href="#创建">创建</a></li>
            <li><a href="#调用">调用</a></li>
          </ul>
        </li>
        <li><a href="#变量">变量</a>
          <ul>
            <li><a href="#系统变量">系统变量</a></li>
            <li><a href="#会话变量">会话变量</a></li>
            <li><a href="#局部变量">局部变量</a></li>
          </ul>
        </li>
        <li><a href="#流程控制">流程控制</a>
          <ul>
            <li><a href="#普通">普通</a></li>
            <li><a href="#if-then">if-then</a></li>
            <li><a href="#case">case</a></li>
          </ul>
        </li>
        <li><a href="#循环语句">循环语句</a>
          <ul>
            <li><a href="#loop">loop</a></li>
            <li><a href="#repeat">repeat</a></li>
            <li><a href="#while">while</a></li>
            <li><a href="#leave和iterate">leave和iterate</a></li>
          </ul>
        </li>
        <li><a href="#游标">游标</a></li>
        <li><a href="#触发器">触发器</a>
          <ul>
            <li><a href="#查看所有的触发器">查看所有的触发器</a></li>
            <li><a href="#查看创建触发器的语句">查看创建触发器的语句</a></li>
            <li><a href="#删除触发器">删除触发器</a></li>
          </ul>
        </li>
        <li><a href="#事件">事件</a></li>
        <li><a href="#预处理">预处理</a>
          <ul>
            <li><a href="#查看事件调度器是否开启">查看事件调度器是否开启</a></li>
            <li><a href="#预处理的语句是字符串">预处理的语句是字符串</a></li>
            <li><a href="#预处理的语句是变量">预处理的语句是变量</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step07事务和锁">Step07.事务和锁</a>
      <ul>
        <li><a href="#事务">事务</a>
          <ul>
            <li><a href="#开启一个事务">开启一个事务</a></li>
            <li><a href="#回滚事务">回滚事务</a></li>
            <li><a href="#保存点">保存点</a></li>
          </ul>
        </li>
        <li><a href="#锁">锁</a>
          <ul>
            <li><a href="#只读方式锁定数据表">只读方式锁定数据表</a></li>
            <li><a href="#写方式锁定数据表">写方式锁定数据表</a></li>
            <li><a href="#查询语句加锁">查询语句加锁</a></li>
          </ul>
        </li>
        <li><a href="#写锁">写锁</a></li>
      </ul>
    </li>
    <li><a href="#step08用户与权限">Step08.用户与权限</a>
      <ul>
        <li><a href="#查询mysql数据库下的user表">查询mysql数据库下的user表</a></li>
        <li><a href="#创建用户">创建用户</a></li>
        <li><a href="#给用户设置密码">给用户设置密码</a></li>
        <li><a href="#删除用户">删除用户</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="step01管理数据库">Step01.管理数据库</h1>
<h2 id="创建数据库">创建数据库</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">database</span> <span class="err">数据库名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>数据库名命名规范</p>
<blockquote>
<p>数字 字母 下划线 但不能以数字开头</p>
<p>不能使用mysql关键字命名数据库</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">db_mrbbs</span>
<span class="n">db_MRBBS</span>
</code></pre></td></tr></table>
</div>
</div></blockquote>
</li>
<li>
<p>创建一个指定字符集的数据库</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">database</span> <span class="err">数据库名</span> <span class="k">character</span> <span class="kt">set</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在mysql中,不允许数据库重名</p>
<blockquote>
<p>如果创建一个已存在名称的数据库,会报错</p>
</blockquote>
</li>
<li>
<p>为了避免这种错误,在创建数据库时可以加上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">database</span> <span class="k">if</span> <span class="k">not</span> <span class="k">exists</span> <span class="err">数据库名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h2 id="查看数据库">查看数据库</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="k">databases</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">Information_schema：主要存储了系统中的一些数据库对象信息，比如用户表信息、列信息、权限信息、字符集信息和分区信息等。
mysql：MySQL 的核心数据库，主要负责存储数据库用户、用户访问权限等, MySQL 自己需要使用的控制和管理信息。常用的比如在 mysql 数据库的 user 表中修改 root 用户密码。
performance_schema：主要用于收集数据库服务器性能参数。
sakila：MySQL 提供的样例数据库，该数据库共有 <span class="m">16</span> 张表，这些数据表都是比较常见的，在设计数据库时，可以参照这些样例数据表来快速完成所需的数据表。
sys: 主要提供了一些视图，数据都来自于 performation_schema，主要是让开发者和使用者更方便地查看性能问题。
world : MySQL 自动创建的数据库，该数据库中只包括 <span class="m">3</span> 张数据表，分别保存城市，国家和国家使用的语言等内容。
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>查看指定数据库</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="k">create</span> <span class="k">database</span> <span class="err">数据库名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h2 id="选择数据库">选择数据库</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">use</span> <span class="err">数据库名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="修改数据库">修改数据库</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">database</span> <span class="err">数据库名</span> <span class="k">default</span> <span class="k">character</span> <span class="kt">set</span> <span class="n">gbk</span> <span class="k">default</span> <span class="k">collate</span> <span class="n">gbk_chinese_ci</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="删除数据库">删除数据库</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">drop</span> <span class="k">database</span> <span class="err">数据库名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="查看mysql支持的全部存储引擎">查看mysql支持的全部存储引擎</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="n">engines</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">可以用“<span class="p">;</span>”结束，也可以用“<span class="se">\g</span>” 或者“<span class="se">\G</span>”结束。
“<span class="p">;</span>” 或者“<span class="se">\g</span>”的作用是相同的，而“<span class="se">\G</span>”可以让查到的结果旋转90度变成纵向。
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="查看默认的存储引擎">查看默认的存储引擎</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="n">variables</span><span class="p">:</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>还可以模糊查询</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="n">variables</span> <span class="k">like</span> <span class="s2">&#34;%storage_engine%&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step02表结构管理">Step02.表结构管理</h1>
<h2 id="创建数据表">创建数据表</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">table</span> <span class="err">数据表名</span><span class="p">(</span>
	<span class="err">字段名</span><span class="mi">1</span> <span class="err">数据类型</span><span class="p">[</span><span class="err">完整的约束条件</span><span class="p">],</span>
  <span class="err">字段名</span><span class="mi">2</span> <span class="err">数据类型</span><span class="p">[</span><span class="err">完整的约束条件</span><span class="p">],</span>
  <span class="err">字段名</span><span class="mi">3</span> <span class="err">数据类型</span><span class="p">[</span><span class="err">完整的约束条件</span><span class="p">],</span>
  <span class="p">...</span>
<span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>在创建数据表之前,应该使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">use</span> <span class="err">数据库名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>选中某个数据库</p>
</li>
<li>
<p>然后才能直接创建表</p>
</li>
<li>
<p>否则会报错</p>
</li>
<li>
<p>不过可以直接</p>
<blockquote>
<p>create table 数据库名.数据表名</p>
<p>就可以在任何数据库下访问其它数据库中的表</p>
</blockquote>
</li>
</ul>
<h2 id="复制数据表">复制数据表</h2>
<h3 id="复制结构">复制结构</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">table</span> <span class="err">新表名</span> <span class="k">like</span> <span class="err">旧表名</span><span class="p">;</span> 
</code></pre></td></tr></table>
</div>
</div><h3 id="复制结构和内容">复制结构和内容</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">table</span> <span class="err">新表名</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">旧表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="查看数据库下的所有数据表">查看数据库下的所有数据表</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="kp">tables</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="查看创建数据表时的定义语句">查看创建数据表时的定义语句</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="k">create</span> <span class="k">table</span> <span class="err">数据表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="显示数据表结构">显示数据表结构</h2>
<h3 id="desc或describee">desc或describee</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">desc</span> <span class="err">数据表名</span><span class="p">;</span>
<span class="k">describe</span> <span class="err">数据表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="columns">columns</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="k">column</span> <span class="k">from</span> <span class="err">数据表名</span><span class="p">;</span> <span class="c1"># 前提是使用了某个数据库
</span><span class="c1"></span><span class="k">show</span> <span class="k">column</span> <span class="k">from</span> <span class="err">数据库名</span><span class="p">.</span><span class="err">数据表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="设置表的存储引擎--enginexxx">设置表的存储引擎 ( engine=xxx)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">age</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">MyISAM</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">创建数据表时，如果省略了default charset属性，那么该表将沿用数据库字符集的值，
即my.ini文件中指定的default-character-set变量的值。
如果需要修改，可以通过default charset属性设置表的字符集。设置表的字符集的语法格式如下
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="设置创建表的默认字符集">设置创建表的默认字符集</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s3</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">age</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">MyISAM</span> <span class="k">default</span> <span class="kp">charset</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="以一个表的结构为模版创建一个表但不复制数据">以一个表的结构为模版,创建一个表,但不复制数据</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">table</span>  <span class="k">if</span> <span class="k">not</span> <span class="k">exists</span> <span class="n">s4</span> <span class="k">like</span> <span class="n">s1</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="更改表名">更改表名</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">旧表名</span> <span class="k">rename</span> <span class="k">to</span> <span class="err">新表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="更改多个表名">更改多个表名</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">rename</span> <span class="k">table</span> <span class="err">旧表名</span><span class="mi">1</span> <span class="k">to</span> <span class="err">新表名</span><span class="mi">1</span><span class="p">,</span><span class="err">旧表名</span><span class="mi">2</span> <span class="k">to</span> <span class="err">新表名</span><span class="mi">2</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="更改表的某个字段名称或者数据类型">更改表的某个字段(名称或者数据类型)</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="k">change</span> <span class="err">旧字段名</span> <span class="err">新字段名</span> <span class="err">新字段类型</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p><strong>注:新字段数据类型不能为空</strong></p>
<p>这种方法既可以修改字段名,又可以修改字段数据类型</p>
</blockquote>
<hr>
<h2 id="更改字段数据类型">更改字段数据类型</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">数据表名</span> <span class="n">modify</span> <span class="err">字段</span> <span class="err">新数据类型</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="为数据表添加字段">为数据表添加字段</h2>
<h3 id="单个字段">单个字段</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="k">add</span> <span class="err">新字段名</span> <span class="err">新字段数据类型</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="多个字段">多个字段</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="k">add</span> <span class="p">(</span><span class="err">新字段</span><span class="mi">1</span> <span class="err">新字段</span><span class="mi">1</span><span class="err">的数据类型</span><span class="p">,</span><span class="err">新字段</span><span class="mi">2</span> <span class="err">新字段</span><span class="mi">2</span><span class="err">的数据类型</span><span class="p">,</span><span class="err">新字段</span><span class="mi">3</span> <span class="err">新字段</span><span class="mi">3</span><span class="err">的数据类型</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="删除表的某个字段">删除表的某个字段</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="k">drop</span> <span class="err">字段名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="更改表字段的排列顺序">更改表字段的排列顺序</h2>
<h3 id="将a字段放到b字段后面">将A字段放到B字段后面</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">数据表名</span> <span class="n">modify</span> <span class="err">字段</span><span class="n">A</span> <span class="err">字段</span><span class="n">A的数据类型</span> <span class="n">after</span> <span class="err">字段</span><span class="n">B</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="将字段c放到表的第一位">将字段C放到表的第一位</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">数据表名</span> <span class="n">modify</span> <span class="err">字段</span><span class="n">A</span> <span class="err">字段</span><span class="n">A的数据类型</span> <span class="n">first</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="删除数据表">删除数据表</h2>
<ul>
<li>Delete可以加参数的选择性删除</li>
<li>例如删掉某一行或某几行</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">delete</span> <span class="k">from</span> <span class="err">表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>truncate只能删除表中全部数据,相当于清空表</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">truncate</span> <span class="k">table</span> <span class="err">表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>上面二者只能删除表数据,drop可以将表结构和表数据统统删掉</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">drop</span> <span class="k">table</span> <span class="err">表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="表的约束">表的约束</h2>
<h3 id="主键约束">主键约束</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">通过主键可以快速查找表中的某条信息
它可以唯一标识表中的记录，就好比身份证可以用来标识人的身份一样。
每个数据表中最多只能有一个主键约束，定义为PRIMARY    KEY的字段不能有重复值且不能为NULL值。
</code></pre></td></tr></table>
</div>
</div><h4 id="单字段主键">单字段主键</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="err">单字段主键指的是由一个字段构成的主键。语法如下：</span>
<span class="err">字段名</span> <span class="err">数据类型</span>  <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="err">，</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s2</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">name</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">grade</span><span class="o">`</span> <span class="kt">float</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="多字段主键">多字段主键</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">多字段主键指的是由多个字段组合而成的主键。语法如下：
PRIMARY KEY <span class="o">(</span>字段名1,……<span class="o">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">password</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">stu_id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">stu_id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="为当前数据表添加主键">为当前数据表添加主键</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">ALTER</span> <span class="k">TABLE</span>  <span class="err">表名</span>  <span class="k">ADD</span> <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="err">字段名</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="删除表的主键">删除表的主键</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="k">drop</span> <span class="k">primary</span> <span class="k">key</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="主键冲突解决方案">主键冲突解决方案</h4>
<h5 id="主键冲突进行更新操作">主键冲突进行更新操作</h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">insert</span> <span class="k">into</span> <span class="o">+</span> <span class="err">表名</span> <span class="o">+</span> <span class="p">[(</span><span class="err">字段列表：包含主键</span><span class="p">)]</span> <span class="o">+</span> <span class="k">values</span> <span class="p">(</span><span class="err">值列表</span><span class="p">)</span> <span class="k">on</span> <span class="n">duplicate</span> <span class="k">key</span> <span class="k">update</span> <span class="err">字段</span> <span class="o">=</span> <span class="err">新值</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>就是说,如果你插入的这条数据, 主键冲突,则插入失败，但是你可以指定，和你要插入的这条数据冲突的那条数据，对它的字段值进行更新</li>
</ul>
<h5 id="主键冲突的替换"><strong>主键冲突的替换</strong></h5>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">replace</span> <span class="k">insert</span> <span class="k">into</span> <span class="o">+</span> <span class="err">表名</span> <span class="o">+</span> <span class="p">[(</span><span class="err">字段列表：包含主键</span><span class="p">)]</span> <span class="o">+</span> <span class="k">values</span> <span class="p">(</span><span class="err">值列表</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="非空约束">非空约束</h3>
<blockquote>
<p>字段名 数据类型 NOT NULL</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">CREATE TABLE <span class="sb">`</span>s1<span class="sb">`</span> <span class="o">(</span>
  <span class="sb">`</span>id<span class="sb">`</span> int NOT NULL,
  <span class="sb">`</span>username<span class="sb">`</span> varchar<span class="o">(</span>20<span class="o">)</span> NOT NULL
<span class="o">)</span> <span class="nv">ENGINE</span><span class="o">=</span>InnoDB DEFAULT <span class="nv">CHARSET</span><span class="o">=</span>gbk<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="为现有表添加非空约束">为现有表添加非空约束</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">ALTER</span>  <span class="k">TABLE</span>  <span class="err">表名</span>   <span class="n">MODIFY</span>  <span class="err">字段名</span> <span class="err">数据类型</span>  <span class="k">NOT</span> <span class="no">NULL</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="删除表中某个字段的非空约束">删除表中某个字段的非空约束</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">ALTER</span>  <span class="k">TABLE</span>  <span class="err">表名</span>   <span class="n">MODIFY</span>  <span class="err">字段名</span> <span class="err">数据类型</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="唯一约束">唯一约束</h3>
<blockquote>
<p>唯一约束用于保证数据表中字段的唯一性，即表中字段的值不能重复出现。</p>
</blockquote>
<blockquote>
<p>语法格式如下所示</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="err">字段名</span> <span class="err">数据类型</span> <span class="k">UNIQUE</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">table</span> <span class="nf">s1</span><span class="p">(</span>
    <span class="o">-&gt;</span> <span class="n">id</span> <span class="kt">int</span> <span class="k">unique</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="n">username</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>唯一约束的完整语法：“UNIQUE KEY <code>id</code> (<code>id</code>)”</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-sql" data-lang="sql"><span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="err">索引名</span> <span class="p">(</span><span class="err">字段列表</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></blockquote>
<ul>
<li>创建唯一约束的同时也会创建一个该约束对应的唯一索引</li>
<li>索引名可以自己指定，也可以省略</li>
<li>省略时，MySQL自动使用字段名作为索引名</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="为当前表字段添加唯一约束">为当前表字段添加唯一约束</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">ALTER</span>  <span class="k">TABLE</span>  <span class="err">表名</span>   <span class="k">ADD</span>  <span class="k">UNIQUE</span><span class="p">(</span><span class="err">字段名</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="删除表字段的唯一约束">删除表字段的唯一约束</h4>
<ul>
<li>
<p>因为在声明字段的唯一约束时,是会有索引设置的,所以通过索引删除字段的唯一约束</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">数据表名</span> <span class="k">drop</span> <span class="k">index</span> <span class="err">唯一约束索引名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h3 id="默认约束">默认约束</h3>
<ul>
<li>BLOB、TEXT数据类型不支持默认约束</li>
</ul>
<h4 id="创建表时为字段添加默认约束">创建表时为字段添加默认约束</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">grade</span><span class="o">`</span> <span class="kt">float</span> <span class="k">DEFAULT</span> <span class="s1">&#39;0&#39;</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="删除表中某字段的默认约束">删除表中某字段的默认约束</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">ALTER</span> <span class="k">TABLE</span>  <span class="err">表名</span>  <span class="n">MODIFY</span> <span class="err">字段</span> <span class="err">数据类型</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>这条命令会同时删除该字段的<code>默认约束</code>和<code>非空约束</code></li>
</ul>
<hr>
<h4 id="为当前表的某字段添加默认约束">为当前表的某字段添加默认约束</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">ALTER</span> <span class="k">TABLE</span>  <span class="err">表名</span>  <span class="n">MODIFY</span> <span class="err">字段</span> <span class="err">数据类型</span>  <span class="k">DEFAULT</span>  <span class="err">默认值</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="四种约束-为字段添加约束和删除约束对比">四种约束-为字段添加约束和删除约束对比</h3>
<table>
<thead>
<tr>
<th align="center"></th>
<th align="center">添加</th>
<th align="center">删除</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">主键约束</td>
<td align="center">alter table 表名 add primary key(字段名);</td>
<td align="center">alter table 数据表名 drop primary key;</td>
</tr>
<tr>
<td align="center">非空约束</td>
<td align="center">alter table 表名 modify 字段名 字段数据类型 not null;</td>
<td align="center">alter table 表名 modify 字段名 字段数据类型;</td>
</tr>
<tr>
<td align="center">唯一约束</td>
<td align="center">alter table 表名 add unique(字段名);</td>
<td align="center">alter table 表名 drop index 唯一约束索引名;</td>
</tr>
<tr>
<td align="center">默认约束</td>
<td align="center">alter table 表名 modify 字段名 字段数据类型 default 默认值;</td>
<td align="center">alter table modify 字段名 字段类型;</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="为表字段设置自动增加">为表字段设置自动增加</h2>
<ul>
<li>
<p>语法格式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="err">字段名</span> <span class="err">数据类型</span> <span class="kp">AUTO_INCREMENT</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="kp">AUTO_INCREMENT</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">password</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">一个表中只能有一个自动增长字段；
该字段的数据类型是整数类型；
该字段必须定义为主键或唯一约束，如UNIQUE KEY、PRIMARY KEY；
若为自动增长字段插入NULL、0、DEFAULT或在插入时省略该字段，该字段就会使用自动增长值；
若插入的是一个具体值，则不会使用自动增长值。
</code></pre></td></tr></table>
</div>
</div><h3 id="删除字段的自动增长">删除字段的自动增长</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="n">modify</span> <span class="err">字段名</span> <span class="err">字段数据类型</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li><code>alter table 表名 modify 字段名 字段数据类型</code> =&gt; 会删掉字段的<code>非空约束</code>和<code>默认约束</code>以及<code>自动增长</code></li>
</ul>
<h3 id="重新为id添加自动增长">重新为id添加自动增长</h3>
<blockquote>
<p>重新为id添加自动增长，自动增长删除并重新添加后，自动增长的初始值会自动设为该列现有的最大值加1</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="err">表名</span> <span class="n">MODIFY</span> <span class="err">字段</span>  <span class="err">数据类型</span>  <span class="kp">AUTO_INCREMENT</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="错误---duplicate-entry-0-for-key-primary-mysql的小问题">错误: - Duplicate entry &lsquo;0&rsquo; for key &lsquo;PRIMARY&rsquo;—— mysql的小问题</h3>
<blockquote>
<p>原因：我估计可能是数据表中<a href="https://so.csdn.net/so/search?q=%E4%B8%BB%E9%94%AE&amp;spm=1001.2101.3001.7020">主键</a>这一栏已经有一个为“0”了，一般出现这种问题是以int类型的字段在输入时没有输如数据，而int类型默认值为“0”，而你之前第一条数据已经默认主键如：id为默认的“0”了，于是就报错说Duplicate entry &lsquo;0&rsquo; for key &lsquo;PRIMARY&rsquo;。</p>
</blockquote>
<ul>
<li>解决方案：</li>
</ul>
<blockquote>
<p>要么每次给主键赋值，且同时要注意重复输入数据的情况。</p>
</blockquote>
<blockquote>
<p>要么就是将主键设置为auto_increment(自增长)，但有一点要注意的是需要将第一条主键如：id=0的那一条数据删除，因为auto_increment的字段需要从1开始。</p>
</blockquote>
<h3 id="修改表的默认自增值">修改表的默认自增值</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="kp">auto_increment</span> <span class="o">=</span> <span class="err">数值</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>当然,这个值只有在插入数据时,自增字段对应的值为null之类时,才会被使用,否则还是1-1递增</li>
</ul>
<hr>
<h2 id="索引">索引</h2>
<h3 id="分类">分类</h3>
<blockquote>
<ul>
<li>普通索引：不应用任何限制条件的索引，可以在任何数据类型中创建。</li>
<li>唯一性索引：使用UNIQUE参数可以设置唯一索引。创建该索引时，索引的值必须唯一。</li>
<li>单列索引：只对应一个字段的索引。</li>
<li>多列索引：在表的多个字段上创建一个索引。</li>
<li>全文索引：使用FULLTEXT参数可以设置索引为全文索引。全文索引只能创建在CHAR、VARCHAR或者TEXT类型的字段上。</li>
<li>空间索引：使用SPATIAL参数可以设置索引为空间索引。空间索引只能建立在空间数据类型上。</li>
</ul>
</blockquote>
<h3 id="创建表时创建索引">创建表时创建索引</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="err">表名（字段名</span> <span class="err">数据类型</span><span class="p">[</span><span class="err">完整性约束条件</span><span class="p">],</span>
                     <span class="err">字段名</span> <span class="err">数据类型</span><span class="p">[</span><span class="err">完整性约束条件</span><span class="p">],</span>
                     <span class="err">．．．．．．</span>
　　　　　　 <span class="err">字段名</span> <span class="err">数据类型</span>
　　　　　<span class="err">［</span><span class="k">UNIQUE</span><span class="o">|</span><span class="k">FULLTEXT</span><span class="o">|</span><span class="k">SPATIAL</span><span class="err">］</span> <span class="k">INDEX</span><span class="o">|</span><span class="k">KEY</span>
                    <span class="p">[</span><span class="err">索引名</span><span class="p">]</span> <span class="p">(</span><span class="err">字段名</span> <span class="p">[(</span><span class="err">长度</span><span class="p">)]</span>  <span class="p">[</span><span class="k">ASC</span><span class="o">|</span><span class="k">DESC</span><span class="p">]));</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<ul>
<li>UNIQUE：可选参数，表示唯一索引</li>
<li>FULLTEXT：可选参数，表示全文索引</li>
<li>SPATIAL：可选参数，表示空间索引</li>
<li>INDEX和KEY：用来表示字段的索引，二者选一即可</li>
<li>索引名：可选参数，表示创建的索引的名称</li>
<li>字段名：指定索引对应字段的名称</li>
<li>长度：可选参数，用于表示索引的长度</li>
<li>ASC和DESC：可选参数，ASC表示升序，DESC表示降序</li>
</ul>
</blockquote>
<h4 id="创建普通索引">创建普通索引</h4>
<ul>
<li>为字段id创建一个名为id的普通索引</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">index</span> <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>index等同于key</li>
</ul>
<hr>
<h4 id="创建唯一性索引">创建唯一性索引</h4>
<ul>
<li>为字段id创建唯一性索引</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s2</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">UNIQUE</span> <span class="k">KEY</span> <span class="o">`</span><span class="n">unique_index</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="创建全文索引">创建全文索引</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">FULLTEXT</span> <span class="k">KEY</span> <span class="o">`</span><span class="n">fulltext_index</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">username</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h4 id="创建单列索引---同普通索引">创建单列索引 - 同普通索引</h4>
<h4 id="创建多列索引---字段参数写多个字段就好">创建多列索引 - 字段参数写多个字段就好</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">KEY</span> <span class="o">`</span><span class="n">multi</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">id</span><span class="o">`</span><span class="p">,</span><span class="o">`</span><span class="n">username</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>在创建多列索引中,只有查询语句中使用了多列索引中的第一个字段,多列索引才会被使用</li>
</ul>
<h4 id="创建空间索引">创建空间索引</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">space</span><span class="o">`</span> <span class="n">geometry</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="k">SPATIAL</span> <span class="k">KEY</span> <span class="o">`</span><span class="n">spatial_index</span><span class="o">`</span> <span class="p">(</span><span class="o">`</span><span class="n">space</span><span class="o">`</span><span class="p">)</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="使用create语句创建索引">使用create语句创建索引</h3>
<h4 id="创建普通索引-1">创建普通索引</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">index</span> <span class="err">索引名</span> <span class="k">on</span> <span class="err">数据表名</span> <span class="p">(</span><span class="err">字段名</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="创建唯一索引">创建唯一索引</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">unique</span> <span class="k">index</span> <span class="err">索引名</span> <span class="k">on</span> <span class="err">数据表名</span> <span class="p">(</span><span class="err">字段名</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="其他同唯一索引">其他同唯一索引</h4>
<h3 id="使用alter语句创建索引">使用alter语句创建索引</h3>
<h4 id="创建普通索引-2">创建普通索引</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="k">add</span> <span class="k">index</span> <span class="err">索引名</span><span class="p">(</span><span class="err">字段名</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="创建唯一索引-1">创建唯一索引</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">alter table 表名 add unique index 索引名(字段名);
</code></pre></td></tr></table>
</div>
</div><h4 id="其他同唯一索引-1">其他同唯一索引</h4>
<hr>
<h3 id="删除索引">删除索引</h3>
<h4 id="alter">alter</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">表名</span> <span class="k">drop</span> <span class="k">index</span> <span class="err">索引名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="drop">drop</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">drop</span> <span class="k">index</span> <span class="err">索引名</span> <span class="k">on</span> <span class="err">数据表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step03表数据的更新操作">Step03.表数据的更新操作</h1>
<h2 id="在mysql中支持将查询的结果插入到指定的数据表中">在MySQL中，支持将查询的结果插入到指定的数据表中</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">insert</span> <span class="k">into</span> <span class="err">数据表</span><span class="mi">1</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">数据表</span><span class="mi">2</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>这样就会将查询到数据表2中的的所有数据,全部插入到数据表1中</li>
</ul>
<h2 id="临时表">临时表</h2>
<ul>
<li>
<p>创建临时表,就是在<code>create</code> 、 <code>table</code>之间添加一个<code>temporary</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="n">temporary</span> <span class="k">table</span> <span class="err">数据表名</span> <span class="p">(</span><span class="n">xxx</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>若数据库不存在,操作临时表时必须使用<code>数据库.数据表</code>指定临时所在的数据库</p>
</li>
<li>
<p>注意:</p>
<ul>
<li>
<p>1.在数据库下面使用<code>show tables;</code>语句,临时表不会作为查询结果显示出来</p>
</li>
<li>
<p>2.临时表可以被执行任何普通数据表的操作</p>
</li>
<li>
<p>3.修改临时表名只能使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">旧表名</span> <span class="k">rename</span> <span class="err">新表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><p>,不能使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">rename</span> <span class="k">table</span> <span class="err">旧表名</span><span class="mi">1</span> <span class="k">to</span> <span class="err">新表名</span><span class="mi">1</span><span class="p">,</span><span class="err">旧表名</span><span class="mi">2</span> <span class="k">to</span> <span class="err">新表名</span><span class="mi">2</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<hr>
<h2 id="主键冲突">主键冲突</h2>
<ul>
<li>就是说,你某个字段是主键,多次插入这个字段的值可能会有重复,这时候就会报错</li>
<li>有两种解决方法</li>
</ul>
<h3 id="方法一更新数据">方法一,更新数据</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">insert</span> <span class="k">into</span> <span class="err">数据表名</span> <span class="k">values</span> <span class="p">(</span><span class="err">数据</span><span class="p">)</span> <span class="k">on</span> <span class="n">duplicate</span> <span class="k">key</span> <span class="k">update</span> <span class="err">字段</span><span class="mi">1</span><span class="o">=</span><span class="err">数据</span><span class="mi">1</span><span class="p">,</span><span class="err">字段</span><span class="mi">2</span><span class="o">=</span><span class="err">数据</span><span class="mi">2</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="方法二删除重复的主键数据">方法二,删除重复的主键数据</h3>
<h3 id="方法三使用replace语句删除的同时进行替换">方法三,使用replace语句,删除的同时进行替换</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">replace</span> <span class="k">into</span> <span class="err">表名</span> <span class="k">values</span> <span class="p">(</span><span class="err">数据</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="查询">查询</h2>
<h3 id="字段过滤查询">字段过滤查询</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="err">字段</span><span class="mi">1</span><span class="p">,</span><span class="err">字段</span><span class="mi">2</span><span class="p">,...</span> <span class="k">from</span> <span class="err">表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="值过滤查询">值过滤查询</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">表名</span> <span class="k">where</span> <span class="err">字段名</span> <span class="o">=</span> <span class="err">值</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="更新数据">更新数据</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">update</span> <span class="err">表名</span> <span class="kt">set</span> <span class="err">字段名</span> <span class="o">=</span> <span class="err">新值</span> <span class="k">where</span> <span class="err">字段</span> <span class="o">=</span> <span class="err">值</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="删除数据">删除数据</h2>
<h3 id="delete">delete</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">delete</span> <span class="k">from</span> <span class="err">表名</span> <span class="k">where</span> <span class="err">字段</span> <span class="o">=</span> <span class="err">值</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="truncate">truncate</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">truncate</span> <span class="err">数据表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>truncate命令可以删除表中全部数据,而且无法恢复</li>
</ul>
<hr>
<h1 id="step04表记录的检索查询">Step04.表记录的检索查询</h1>
<h2 id="where">where</h2>
<h3 id="not-in">(not) in</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">表名</span> <span class="k">where</span> <span class="err">字段名</span> <span class="p">(</span><span class="k">not</span><span class="p">)</span> <span class="k">in</span> <span class="p">(</span><span class="err">数据</span><span class="mi">1</span><span class="p">,</span><span class="err">数据</span><span class="mi">2</span><span class="p">...);</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>在一些数据范围内查找字段</li>
</ul>
<hr>
<h3 id="根据数值范围查询某字段">根据数值范围查询某字段</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">表名</span> <span class="k">where</span> <span class="err">字段名</span> <span class="p">(</span><span class="k">not</span><span class="p">)</span> <span class="k">between</span> <span class="err">小的值</span> <span class="k">and</span> <span class="err">大的值</span><span class="p">;</span> 
</code></pre></td></tr></table>
</div>
</div><ul>
<li>这种参数只支持数值类型</li>
</ul>
<h3 id="根据字段是否有空值查询">根据字段是否有空值查询</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">表名</span> <span class="k">where</span> <span class="err">字段名</span> <span class="k">is</span> <span class="p">(</span><span class="k">not</span><span class="p">)</span> <span class="no">null</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="去重查询">去重查询</h3>
<ul>
<li>在select前面加上distinct,查询时就会去重</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="k">distinct</span> <span class="err">字段名</span> <span class="k">from</span> <span class="err">表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>当然也可以多字段查询,特别注意：只有DISTINCT关键字后指定的多个字段值都相同，才会被认作是重复记录。</li>
</ul>
<h3 id="模糊查询">模糊查询</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">表名</span> <span class="k">where</span> <span class="err">字段名</span> <span class="k">like</span> <span class="s2">&#34;字符串&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>like关键字可以按照字符串中的内容进行模糊查询</li>
<li>但是直接这样写</li>
<li>比如你数据表中有<code>张三丰</code> <code>张四丰</code></li>
<li>你查询语句中写了个<code>张丰</code></li>
<li>是肯定查不到的</li>
<li>所以需要使用</li>
<li><code>%</code>或<code>_</code>符号</li>
<li>这两个符号可以匹配任意长度的字符串,也就是贪婪模式</li>
<li>真正实现了模糊查询</li>
<li>再次使用<code>张%丰</code></li>
<li>就可以将张三丰和张四丰都查出来了</li>
</ul>
<h3 id="and">and</h3>
<ul>
<li>
<p>and语句可以<code>与操作</code>多条查询条件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">where</span> <span class="err">条件</span><span class="mi">1</span> <span class="k">and</span> <span class="err">条件</span><span class="mi">2</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">where</span> <span class="n">id</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">and</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;张三丰&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="or">or</h3>
<ul>
<li>见and</li>
</ul>
<h2 id="高级查询">高级查询</h2>
<h3 id="聚合函数">聚合函数</h3>
<table>
<thead>
<tr>
<th align="center">函数名</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">count</td>
<td align="center">返回参数字段一共有几条不为NULL数据</td>
</tr>
<tr>
<td align="center">sum</td>
<td align="center">返回参数字段所有数据的总和</td>
</tr>
<tr>
<td align="center">avg</td>
<td align="center">返回参数字段所有数据的平均数</td>
</tr>
<tr>
<td align="center">max</td>
<td align="center">返回参数字段的最大值</td>
</tr>
<tr>
<td align="center">min</td>
<td align="center">返回参数字段的最小值</td>
</tr>
</tbody>
</table>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="nf">count</span><span class="p">(</span><span class="n">id</span><span class="p">)</span> <span class="k">from</span> <span class="err">表名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="排序">排序</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">表名</span> <span class="k">order</span> <span class="k">by</span> <span class="err">字段名</span> <span class="k">asc</span> <span class="o">|</span> <span class="k">desc</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span> <span class="k">asc</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="分组">分组</h3>
<blockquote>
<p>MySQL中GROUP BY语句用于对某个或某些字段查询分组，并返回这个字段重复记录的第一条，也就是每个小组（无排序）里面的第一条。</p>
</blockquote>
<ul>
<li>
<p>单纯的group by</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="err">字段名</span><span class="n">a</span><span class="p">,</span><span class="err">字段名</span><span class="n">b</span><span class="p">...</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">group</span> <span class="k">by</span> <span class="err">字段</span><span class="n">a</span><span class="p">,</span><span class="err">字段</span><span class="n">b</span><span class="p">...;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>having可以在group by基础上作进一步过滤</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="err">字段名</span><span class="n">a</span><span class="p">,</span><span class="err">字段名</span><span class="n">b</span><span class="p">...</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">group</span> <span class="k">by</span> <span class="err">字段</span><span class="n">a</span><span class="p">,</span><span class="err">字段</span><span class="n">b</span><span class="p">...</span> <span class="k">having</span> <span class="err">条件</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>where和having一起使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="err">字段名</span><span class="n">a</span><span class="p">,</span><span class="err">字段名</span><span class="n">b</span><span class="p">...</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">where</span> <span class="err">条件</span> <span class="k">group</span> <span class="k">by</span> <span class="err">字段</span><span class="n">a</span><span class="p">,</span><span class="err">字段</span><span class="n">b</span><span class="p">...;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>分组时使用聚合函数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="nf">count</span><span class="p">(</span><span class="err">字段</span><span class="n">a</span><span class="p">)...</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">group</span> <span class="k">by</span> <span class="err">字段</span><span class="n">a</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="限制查询数量">限制查询数量</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">limit</span> <span class="err">字段数量</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="应用排序后限制查询数量再更新数据">应用:排序后限制查询数量再更新数据</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">update</span> <span class="n">s1</span> <span class="kt">set</span> <span class="n">username</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span> <span class="k">desc</span> <span class="k">limit</span> <span class="mi">1</span><span class="p">;</span> 
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>查询出全部内容,并按照ID逆序排序,再取第一个,最后将这条数据的username设置为2</p>
</blockquote>
<hr>
<h2 id="连接查询">连接查询</h2>
<h3 id="内连接查询">内连接查询</h3>
<blockquote>
<p>内连接（INNER JOIN）又称简单连接或自然连接，使用比较运算符（=）根据每个表共有列的列值匹配两个表中的行，其查询结果仅包含符合查询条件和连接条件的行，即查询结果为两个表的交集。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">表</span><span class="mi">1</span> <span class="k">inner</span> <span class="k">join</span> <span class="err">表</span><span class="mi">2</span> <span class="k">on</span> <span class="err">表</span><span class="mi">1</span><span class="p">.</span><span class="err">字段</span> <span class="o">=</span> <span class="err">表</span><span class="mi">2</span><span class="p">.</span><span class="err">字段</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="外连接查询">外连接查询</h3>
<h4 id="左外连接">左外连接</h4>
<blockquote>
<p>关键字：left join on / left outer join on</p>
</blockquote>
<blockquote>
<p>语句：SELECT  * FROM a_table a left join b_table b ON a.a_id = b.b_id;</p>
</blockquote>
<blockquote>
<p>说明： left join 是left outer join的简写，它的全称是左外连接，是外连接中的一种。 左(外)连接，左表(a_table)的记录将会全部表示出来，而右表(b_table)只会显示符合搜索条件的记录。右表记录不足的地方均为NULL</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">left</span> <span class="k">join</span> <span class="n">s2</span> <span class="k">on</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="右外连接">右外连接</h4>
<blockquote>
<p>关键字：right join on / right outer join on</p>
</blockquote>
<blockquote>
<p>语句：SELECT  * FROM a_table a right outer join b_table b on a.a_id = b.b_id;</p>
</blockquote>
<blockquote>
<p>说明：right join是right outer join的简写，它的全称是右外连接，是外连接中的一种。与左(外)连接相反，右(外)连接，左表(a_table)只会显示符合搜索条件的记录，而右表(b_table)的记录将会全部表示出来。左表记录不足的地方均为NULL</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">right</span> <span class="k">join</span> <span class="n">s2</span> <span class="k">on</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="全连接">全连接</h3>
<blockquote>
<p>完全连接（FULL JOIN） 完全连接返回左表和右表中的所有记录，包括连接字段相等的记录和不相等的记录。如果左表的某行在右表中没有匹配行，将返回空值(NULL），反之亦然</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span><span class="p">)</span> <span class="k">union</span> <span class="k">all</span> <span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s2</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span><span class="p">)</span> <span class="k">union</span> <span class="k">all</span> <span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s2</span><span class="p">)</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span><span class="p">)</span> <span class="k">union</span> <span class="k">all</span> <span class="p">(</span><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s2</span><span class="p">)</span> <span class="k">order</span> <span class="k">by</span> <span class="n">id</span> <span class="k">desc</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="自连接查询">自连接查询</h3>
<ul>
<li>
<p>自连接不是一种新的连接形式，而只是一个表“自己跟自己连接”,这怎么做到呢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="mi">1</span><span class="err">、自连接其实还是两个表连接，只是将一个表用不同的别名，当做两个表。</span>
<span class="mi">2</span><span class="err">、自连接适用于一个表中的某个字段的值“来源于”当前表的另一个字段的情况。</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="err">语法形式</span><span class="p">:</span>
<span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">表名</span><span class="mi">1</span> <span class="k">as</span> <span class="n">a</span> <span class="p">[</span><span class="err">连接形式</span><span class="p">]</span> <span class="k">join</span> <span class="err">表名</span><span class="mi">1</span> <span class="k">as</span> <span class="n">b</span> <span class="k">on</span> <span class="n">a</span><span class="p">.</span><span class="err">字段名</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="err">字段名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>测试数据：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">area</span><span class="p">;</span>
<span class="o">+----+-----------+-----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">name</span>      <span class="o">|</span> <span class="n">parent_id</span> <span class="o">|</span>
<span class="o">+----+-----------+-----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="err">北京市</span>    <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="err">河北省</span>    <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="err">山东省</span>    <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">4</span> <span class="o">|</span> <span class="err">海淀区</span>    <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">5</span> <span class="o">|</span> <span class="err">保定</span>      <span class="o">|</span>         <span class="mi">2</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">6</span> <span class="o">|</span> <span class="err">衡水</span>      <span class="o">|</span>         <span class="mi">2</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">7</span> <span class="o">|</span> <span class="err">济南</span>      <span class="o">|</span>         <span class="mi">3</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">8</span> <span class="o">|</span> <span class="err">青岛</span>      <span class="o">|</span>         <span class="mi">3</span> <span class="o">|</span>
<span class="o">+----+-----------+-----------+</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="err">要求查询每个城市所在的省份</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">area</span> <span class="k">as</span> <span class="n">a</span> <span class="k">left</span> <span class="k">join</span> <span class="n">area</span> <span class="k">as</span> <span class="n">b</span> <span class="k">on</span> <span class="n">a</span><span class="p">.</span><span class="n">parent_id</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">id</span> <span class="k">where</span> <span class="n">a</span><span class="p">.</span><span class="n">parent_id</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span>
<span class="o">+----+-----------+-----------+------+-----------+-----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">name</span>      <span class="o">|</span> <span class="n">parent_id</span> <span class="o">|</span> <span class="n">id</span>   <span class="o">|</span> <span class="n">name</span>      <span class="o">|</span> <span class="n">parent_id</span> <span class="o">|</span>
<span class="o">+----+-----------+-----------+------+-----------+-----------+</span>
<span class="o">|</span>  <span class="mi">4</span> <span class="o">|</span> <span class="err">海淀区</span>    <span class="o">|</span>         <span class="mi">1</span> <span class="o">|</span>    <span class="mi">1</span> <span class="o">|</span> <span class="err">北京市</span>    <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">5</span> <span class="o">|</span> <span class="err">保定</span>      <span class="o">|</span>         <span class="mi">2</span> <span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span> <span class="err">河北省</span>    <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">6</span> <span class="o">|</span> <span class="err">衡水</span>      <span class="o">|</span>         <span class="mi">2</span> <span class="o">|</span>    <span class="mi">2</span> <span class="o">|</span> <span class="err">河北省</span>    <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">7</span> <span class="o">|</span> <span class="err">济南</span>      <span class="o">|</span>         <span class="mi">3</span> <span class="o">|</span>    <span class="mi">3</span> <span class="o">|</span> <span class="err">山东省</span>    <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">8</span> <span class="o">|</span> <span class="err">青岛</span>      <span class="o">|</span>         <span class="mi">3</span> <span class="o">|</span>    <span class="mi">3</span> <span class="o">|</span> <span class="err">山东省</span>    <span class="o">|</span>         <span class="mi">0</span> <span class="o">|</span>
<span class="o">+----+-----------+-----------+------+-----------+-----------+</span>
  
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="n">a</span><span class="p">.</span><span class="n">id</span><span class="p">,</span> <span class="n">a</span><span class="p">.</span><span class="n">name</span> <span class="k">as</span> <span class="err">地区</span><span class="p">,</span> <span class="n">b</span><span class="p">.</span><span class="n">name</span> <span class="k">as</span> <span class="err">省份</span> <span class="k">from</span> <span class="n">area</span> <span class="k">as</span> <span class="n">a</span> <span class="k">left</span> <span class="k">join</span> <span class="n">area</span> <span class="k">as</span> <span class="n">b</span> <span class="k">on</span> <span class="n">a</span><span class="p">.</span><span class="n">parent_id</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">id</span> <span class="k">where</span>      <span class="n">ent_id</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">;</span>
<span class="o">+----+-----------+-----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="err">地区</span>      <span class="o">|</span> <span class="err">省份</span>      <span class="o">|</span>
<span class="o">+----+-----------+-----------+</span>
<span class="o">|</span>  <span class="mi">4</span> <span class="o">|</span> <span class="err">海淀区</span>    <span class="o">|</span> <span class="err">北京市</span>    <span class="o">|</span>
<span class="o">|</span>  <span class="mi">5</span> <span class="o">|</span> <span class="err">保定</span>      <span class="o">|</span> <span class="err">河北省</span>    <span class="o">|</span>
<span class="o">|</span>  <span class="mi">6</span> <span class="o">|</span> <span class="err">衡水</span>      <span class="o">|</span> <span class="err">河北省</span>    <span class="o">|</span>
<span class="o">|</span>  <span class="mi">7</span> <span class="o">|</span> <span class="err">济南</span>      <span class="o">|</span> <span class="err">山东省</span>    <span class="o">|</span>
<span class="o">|</span>  <span class="mi">8</span> <span class="o">|</span> <span class="err">青岛</span>      <span class="o">|</span> <span class="err">山东省</span>    <span class="o">|</span>
<span class="o">+----+-----------+-----------+</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h3 id="子连接查询">子连接查询</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="mi">2</span>        <span class="o">|</span> <span class="mi">3</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="mi">2</span>        <span class="o">|</span> <span class="mi">3</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="mi">3</span>        <span class="o">|</span> <span class="mi">4</span>        <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">3</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">04</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s2</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="mi">22</span>       <span class="o">|</span> <span class="mi">33</span>       <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="mi">22</span>       <span class="o">|</span> <span class="mi">33</span>       <span class="o">|</span>
<span class="o">|</span>  <span class="mi">4</span> <span class="o">|</span> <span class="mi">33</span>       <span class="o">|</span> <span class="mi">44</span>       <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">3</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">where</span> <span class="n">id</span> <span class="k">in</span> <span class="p">(</span><span class="k">select</span> <span class="n">id</span> <span class="k">from</span> <span class="n">s2</span><span class="p">);</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="mi">2</span>        <span class="o">|</span> <span class="mi">3</span>        <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="mi">3</span>        <span class="o">|</span> <span class="mi">4</span>        <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">2</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="标量子查询">标量子查询</h4>
<blockquote>
<p>子查询返回的结果是一个数据，即一行一列</p>
</blockquote>
<ul>
<li>查询用户名为<code>&quot;张宇航&quot;</code>的<code>密码</code></li>
<li>就是说后面的条件查询括号返回的是一个字段的一个数据</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="n">password</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="p">(</span><span class="k">select</span> <span class="n">username</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;张宇航&#34;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="列子查询">列子查询</h4>
<blockquote>
<p>列子查询：子查询返回的结果是一个字段符合条件的所有数据，即一列多行。</p>
</blockquote>
<ul>
<li>
<p>就是标量子查询的多个数据,一列数据</p>
</li>
<li>
<p>使用in关键字,查询你where的字段是否在你后面的括号的结果列中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s2</span> <span class="k">where</span> <span class="n">id</span> <span class="k">in</span> <span class="p">(</span><span class="k">select</span> <span class="n">id</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;张宇航&#34;</span> <span class="k">or</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;张三&#34;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="带anysomeallexistsin的子查询">带any、some、all、exists、in的子查询</h4>
<ul>
<li>
<p>ANY、SOME查询任何一个满足条件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="nf">ANY</span><span class="p">(</span> <span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student2</span><span class="p">);</span>
<span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="nf">SOME</span><span class="p">(</span> <span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student2</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>使用All查询满足所有条件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span> <span class="k">ALL</span><span class="p">(</span> <span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student2</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>EXISTS查询存在</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="c1"># 条件不满足，返回空
</span><span class="c1"></span><span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student</span> <span class="k">WHERE</span> <span class="k">EXISTS</span><span class="p">(</span> <span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student2</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span><span class="mi">25</span><span class="p">);</span>
<span class="c1"># 条件满足，返回student所有的数据
</span><span class="c1"></span><span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student</span> <span class="k">WHERE</span> <span class="k">EXISTS</span><span class="p">(</span> <span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student2</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="o">&gt;</span><span class="mi">15</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>in查询</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student</span> <span class="k">WHERE</span> <span class="n">age</span> <span class="k">in</span> <span class="p">(</span> <span class="k">select</span> <span class="n">age</span> <span class="k">from</span> <span class="n">student2</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="给数据表取别名">给数据表取别名</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="err">表名</span> <span class="k">as</span> <span class="err">别名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">as</span> <span class="n">s</span> <span class="k">where</span> <span class="n">s</span><span class="p">.</span><span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;张宇航&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="正则表达式">正则表达式</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">where</span> <span class="n">username</span> <span class="k">regexp</span> <span class="s2">&#34;^张&#34;</span><span class="p">;</span>
<span class="o">+----+-----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span>  <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+-----------+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="err">张宇航</span> <span class="o">|</span> <span class="mi">123456</span>   <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="err">张三</span>    <span class="o">|</span> <span class="mi">3131</span>     <span class="o">|</span>
<span class="o">+----+-----------+----------+</span>
<span class="mi">2</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="外键">外键</h2>
<h3 id="修改表时创建外键">修改表时创建外键</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span> <span class="err">从表名</span> <span class="k">add</span> <span class="k">constraint</span> <span class="err">外键名</span> <span class="k">foreign</span> <span class="k">key</span> <span class="p">(</span><span class="err">主表字段</span><span class="p">)</span> <span class="k">references</span> <span class="err">从表名</span> <span class="p">(</span><span class="err">从表字段</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">table</span> <span class="nf">emp</span><span class="p">(</span>
    <span class="o">-&gt;</span> <span class="n">id</span> <span class="kt">int</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="n">username</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
    <span class="o">-&gt;</span> <span class="n">dep_id</span> <span class="kt">int</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">table</span> <span class="nf">dep</span><span class="p">(</span>
    <span class="o">-&gt;</span> <span class="n">id</span> <span class="kt">int</span> <span class="k">primary</span> <span class="k">key</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="n">name</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">));</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">alter</span> <span class="k">table</span> <span class="n">emp</span> <span class="k">add</span> <span class="k">constraint</span> <span class="n">emp_is_dep</span> <span class="k">foreign</span> <span class="k">key</span> <span class="p">(</span><span class="n">dep_id</span><span class="p">)</span> <span class="k">references</span> <span class="nf">emp</span> <span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">03</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">Records</span><span class="p">:</span> <span class="mi">0</span>  <span class="n">Duplicates</span><span class="p">:</span> <span class="mi">0</span>  <span class="n">Warnings</span><span class="p">:</span> <span class="mi">0</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="删除外键">删除外键</h3>
<ul>
<li>删除外键约束的语法如下</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span>  <span class="k">table</span> <span class="err">表名</span> <span class="k">drop</span> <span class="k">foreign</span> <span class="k">key</span> <span class="err">外键约束名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>若要在删除外键约束后，同时删除系统为外键创建的普通索引，则需要通过删除索引的方式来完成</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">table</span>  <span class="err">表名</span>  <span class="k">drop</span>   <span class="k">key</span> <span class="err">普通索引名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step05视图">Step05.视图</h1>
<h2 id="创建视图">创建视图</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"> <span class="k">CREATE</span><span class="p">[</span><span class="k">OR</span> <span class="k">REPLACE</span><span class="p">]</span> <span class="n">VIEW</span> <span class="n">viewname</span><span class="p">[(</span><span class="n">columnlist</span><span class="p">)]</span> <span class="k">AS</span> <span class="k">SELECT</span> <span class="n">statement</span>  
</code></pre></td></tr></table>
</div>
</div><blockquote>
<ul>
<li>CREATE表示创建新的视图；</li>
<li>REPLACE表示替换已经创建的视图；</li>
<li>[(columnlist)]表示可以显示的指出视图中有哪些列（必须和select语句对应）；</li>
<li>viewname为视图的名称；columnlist为属性列；</li>
<li>SELECT statement表示SELECT语句；</li>
</ul>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="o">`</span><span class="n">s1</span><span class="o">`</span> <span class="p">(</span>
  <span class="o">`</span><span class="n">id</span><span class="o">`</span> <span class="kt">int</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">username</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
  <span class="o">`</span><span class="n">password</span><span class="o">`</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span>
<span class="p">)</span> <span class="kp">ENGINE</span><span class="o">=</span><span class="n">InnoDB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">gbk</span><span class="p">;</span>

<span class="k">create</span> <span class="n">view</span> <span class="n">view_table</span> <span class="k">as</span> <span class="k">select</span> <span class="n">id</span><span class="p">,</span><span class="n">username</span> <span class="k">from</span> <span class="n">s1</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">desc</span> <span class="n">view_table</span><span class="p">;</span>
<span class="o">+----------+-------------+------+-----+---------+-------+</span>
<span class="o">|</span> <span class="n">Field</span>    <span class="o">|</span> <span class="n">Type</span>        <span class="o">|</span> <span class="no">Null</span> <span class="o">|</span> <span class="k">Key</span> <span class="o">|</span> <span class="k">Default</span> <span class="o">|</span> <span class="n">Extra</span> <span class="o">|</span>
<span class="o">+----------+-------------+------+-----+---------+-------+</span>
<span class="o">|</span> <span class="n">id</span>       <span class="o">|</span> <span class="kt">int</span>         <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="no">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="o">|</span> <span class="n">YES</span>  <span class="o">|</span>     <span class="o">|</span> <span class="no">NULL</span>    <span class="o">|</span>       <span class="o">|</span>
<span class="o">+----------+-------------+------+-----+---------+-------+</span>
<span class="mi">2</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="视图数据会同步于它的模版表">视图数据会同步于它的模版表</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">insert</span> <span class="k">into</span> <span class="nf">s1</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s2">&#34;zhang&#34;</span><span class="p">,</span><span class="s2">&#34;2123&#34;</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">view_table</span><span class="p">;</span>
<span class="o">+----+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span>
<span class="o">+----+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">zhang</span>    <span class="o">|</span>
<span class="o">+----+----------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="视图的增删改查等操作都和数据表基本一样因为视图就是个表来着">视图的增删改查等操作都和数据表基本一样,因为视图就是个表来着</h2>
<h3 id="查看视图">查看视图</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">desc</span> <span class="err">视图名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="更新视图数据">更新视图数据</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">update</span> <span class="err">视图名</span> <span class="kt">set</span> <span class="err">字段名</span> <span class="o">=</span> <span class="err">新值</span> <span class="k">where</span> <span class="err">字段名</span> <span class="o">=</span> <span class="s2">&#34;旧值&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>注意:当视图中数据被修改后,模版表的数据也会被修改,它们是双向同步的</li>
</ul>
<h3 id="修改视图结构">修改视图结构</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="n">view</span> <span class="n">view_t</span> <span class="k">as</span> <span class="k">select</span> <span class="n">username</span><span class="p">,</span><span class="n">password</span> <span class="k">from</span> <span class="n">s1</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>注意:如果模版表中某个字段在视图中存在,并且模版表这个字段被修改,那也要将视图中的这个字段修改,否则视图将会无效</li>
</ul>
<h3 id="删除视图">删除视图</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">drop</span> <span class="n">view</span> <span class="err">视图名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="多表创建视图">多表创建视图</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="err">张</span>      <span class="o">|</span> <span class="mi">2123</span>     <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">li</span>       <span class="o">|</span> <span class="mi">2442</span>     <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="n">wang</span>     <span class="o">|</span> <span class="mi">29</span>       <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">3</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s2</span><span class="p">;</span>
<span class="o">+----+--------------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">dep</span>          <span class="o">|</span>
<span class="o">+----+--------------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="err">市场销售</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="err">技术部</span>    <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="err">产品经理</span> <span class="o">|</span>
<span class="o">+----+--------------+</span>
<span class="mi">3</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="n">view</span> <span class="n">view_t</span> <span class="k">as</span> <span class="k">select</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">user_id</span><span class="p">,</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="p">,</span><span class="n">s2</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">dep_id</span><span class="p">,</span><span class="n">dep</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">left</span> <span class="k">join</span> <span class="n">s2</span> <span class="k">on</span> <span class="n">s1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">s2</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">view_t</span><span class="p">;</span>
<span class="o">+---------+----------+----------+--------+--------------+</span>
<span class="o">|</span> <span class="n">user_id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span> <span class="n">dep_id</span> <span class="o">|</span> <span class="n">dep</span>          <span class="o">|</span>
<span class="o">+---------+----------+----------+--------+--------------+</span>
<span class="o">|</span>       <span class="mi">1</span> <span class="o">|</span> <span class="err">张</span>      <span class="o">|</span> <span class="mi">2123</span>     <span class="o">|</span>      <span class="mi">1</span> <span class="o">|</span> <span class="err">市场销售</span> <span class="o">|</span>
<span class="o">|</span>       <span class="mi">2</span> <span class="o">|</span> <span class="n">li</span>       <span class="o">|</span> <span class="mi">2442</span>     <span class="o">|</span>      <span class="mi">2</span> <span class="o">|</span> <span class="err">技术部</span>    <span class="o">|</span>
<span class="o">|</span>       <span class="mi">3</span> <span class="o">|</span> <span class="n">wang</span>     <span class="o">|</span> <span class="mi">29</span>       <span class="o">|</span>      <span class="mi">3</span> <span class="o">|</span> <span class="err">产品经理</span> <span class="o">|</span>
<span class="o">+---------+----------+----------+--------+--------------+</span>
<span class="mi">3</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step06存储过程与触发器">Step06.存储过程与触发器</h1>
<h2 id="函数">函数</h2>
<h3 id="系统函数">系统函数</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="k">convert</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span><span class="o">/-</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="p">,</span><span class="n">signed</span><span class="p">)</span> <span class="n">res1</span><span class="p">,</span> <span class="nf">cast</span><span class="p">(</span><span class="mi">3</span><span class="p">.</span><span class="mi">6</span> <span class="o">/</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span> <span class="k">as</span> <span class="k">unsigned</span><span class="p">)</span> <span class="n">res2</span><span class="p">,</span> <span class="nf">unhex</span><span class="p">(</span><span class="s2">&#34;4d2889a&#34;</span><span class="p">)</span> <span class="n">res3</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="nf">char_length</span><span class="p">(</span><span class="s2">&#34;faoueow&#34;</span><span class="p">)</span> <span class="p">,</span> <span class="nf">length</span><span class="p">(</span><span class="s2">&#34;faoufaewu哦工商局&#34;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>strcmp函数,比较两个字符串大小</p>
<blockquote>
<ul>
<li>STRCMP()函数有两个参数，表示参与比较的字符串。</li>
<li>当第1个参数大于第2个参数时，返回1。</li>
<li>当第1个参数等于第2个参数时，返回0。</li>
<li>当第1个参数小于第2个参数时，返回-1。</li>
</ul>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="nf">strcmp</span><span class="p">(</span><span class="s2">&#34;d&#34;</span><span class="p">,</span><span class="s2">&#34;A&#34;</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>去除字符串左右两端的空格</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> 	<span class="nf">concat</span><span class="p">(</span><span class="s2">&#34;start&#34;</span><span class="p">,</span> <span class="nf">ltrim</span><span class="p">(</span><span class="s2">&#34; 111111 &#34;</span><span class="p">),</span> <span class="s2">&#34;end&#34;</span><span class="p">)</span> <span class="n">ltrim</span><span class="p">,</span> <span class="nf">concat</span><span class="p">(</span><span class="s2">&#34;start&#34;</span><span class="p">,</span> <span class="nf">rtrim</span><span class="p">(</span><span class="s2">&#34; 22222 &#34;</span><span class="p">),</span> <span class="s2">&#34;end&#34;</span><span class="p">)</span> <span class="n">rtrim</span><span class="p">,</span><span class="nf">concat</span><span class="p">(</span><span class="s2">&#34;start&#34;</span><span class="p">,</span> <span class="nf">trim</span><span class="p">(</span><span class="s2">&#34; 333333 &#34;</span><span class="p">),</span> <span class="s2">&#34;end&#34;</span><span class="p">)</span> <span class="n">trim</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="自定义函数">自定义函数</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="n">function</span> <span class="nf">say</span><span class="p">(</span><span class="n">str</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
    <span class="o">-&gt;</span> <span class="n">returns</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">return</span> <span class="nf">concat</span><span class="p">(</span><span class="s2">&#34;hello&#34;</span><span class="p">,</span><span class="s2">&#34;world&#34;</span><span class="p">);</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">02</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>mysql8版本使用这种方法会报错</p>
</li>
<li>
<p>设置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="kt">set</span> <span class="n">global</span> <span class="n">log_bin_trust_function_creators</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h4 id="查看创建函数的语句">查看创建函数的语句</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="k">create</span> <span class="n">function</span> <span class="err">函数名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="使用自己创建的函数">使用自己创建的函数</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="err">函数名</span><span class="p">(</span><span class="err">参数</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="删除自定义的函数">删除自定义的函数</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">drop</span> <span class="n">function</span> <span class="k">if</span> <span class="k">exists</span> <span class="err">函数名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="存储过程">存储过程</h2>
<h3 id="创建">创建</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">procedure</span> <span class="nf">proc</span><span class="p">(</span><span class="k">in</span> <span class="n">sid</span> <span class="kt">int</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">select</span> <span class="n">id</span><span class="p">,</span><span class="n">username</span> <span class="k">from</span> <span class="n">s1</span> <span class="k">where</span> <span class="n">id</span> <span class="o">&gt;</span> <span class="n">sid</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">03</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="调用">调用</h3>
<ul>
<li>
<p>通过call方法调用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">call</span> <span class="nf">proc</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="变量">变量</h2>
<h3 id="系统变量">系统变量</h3>
<h4 id="查找">查找</h4>
<ul>
<li>
<p>查看变量名以auto_inc开头的系统变量值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="n">variables</span> <span class="k">like</span> <span class="s2">&#34;auto_inc%&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>SELECT查看指定名称的当前系统变量值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">@@</span><span class="n">autocommit</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>带有“@@”的变量，MySQL会将其判断为系统变量或全局变量</p>
</blockquote>
</li>
</ul>
<h4 id="设置">设置</h4>
<ul>
<li>
<p>若修改的系统变量，只需在本次连接中有效，并且不影响其他连接MySQL服务器客户端的使用时，只能使用局部修改。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="kt">set</span> <span class="err">系统变量</span> <span class="o">=</span> <span class="err">新值</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="kt">set</span> <span class="n">autocommit</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>全局方式修改系统变量，对所有正在连接的客户端无效，它只针对新连接的客户端永久生效。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="kt">set</span> <span class="n">global</span> <span class="n">autocommit</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="会话变量">会话变量</h3>
<ul>
<li>会话变量：也可称为用户变量，指的是用户自定义的变量，跟MySQL当前客户端是绑定的，仅对当前用户使用的客户端生效。</li>
<li>会话变量的组成：“@”符号和变量名，在定义会话变量时必须为该变量赋值。</li>
<li>会话变量的赋值方式：一是利用SET语句，二是在SELECT语句中利用赋值符号“:=”完成赋值，最后一种是利用SELECT…INTO语句。</li>
</ul>
<h4 id="设置-1">设置</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="c1"># 方式1：使用SET赋值
</span><span class="c1"></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="kt">SET</span> <span class="o">@</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Tom&#39;</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="c1"># 方式2：在SELECT中使用赋值符号“:=”
</span><span class="c1"></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="o">@</span><span class="n">price</span> <span class="p">:</span><span class="o">=</span> <span class="n">price</span> <span class="k">FROM</span> <span class="n">sh_goods</span> <span class="k">LIMIT</span> <span class="mi">2</span><span class="p">;</span>
<span class="o">+-----------------+</span>
<span class="o">|</span> <span class="o">@</span><span class="n">price</span> <span class="p">:</span><span class="o">=</span> <span class="n">price</span> <span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="o">|</span>            <span class="mi">0</span><span class="p">.</span><span class="mi">50</span> <span class="o">|</span>
<span class="o">|</span>           <span class="mi">15</span><span class="p">.</span><span class="mi">00</span> <span class="o">|</span>
<span class="o">+-----------------+</span>
<span class="mi">2</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="c1">#方式3：使用SELECT…INTO语句
</span><span class="c1"></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">price</span> <span class="k">FROM</span> <span class="n">sh_goods</span> <span class="k">LIMIT</span> <span class="mi">1</span>
      <span class="k">INTO</span> <span class="o">@</span><span class="n">ids</span><span class="p">,</span> <span class="o">@</span><span class="n">names</span><span class="p">,</span> <span class="o">@</span><span class="n">prices</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="局部变量">局部变量</h3>
<ul>
<li>
<p>局部变量：相对于MySQL提供的系统变量和用户自定义的会话变量。</p>
</li>
<li>
<p>局部变量的作用范围仅在复合语句语法BEGIN和END语句之间，保证局部变量在除BEGIN和END之间以外的任何地方，不能被获取和修改。</p>
</li>
<li>
<p>方便在MySQL的函数和存储过程中保存需要操作的数据。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="n">function</span> <span class="nf">func</span><span class="p">()</span> <span class="n">returns</span> <span class="kt">int</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span> <span class="k">declare</span> <span class="n">age</span> <span class="kt">int</span> <span class="k">default</span> <span class="mi">10</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="k">return</span> <span class="n">age</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
   
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="nf">func</span><span class="p">();</span>
<span class="o">+--------+</span>
<span class="o">|</span> <span class="nf">func</span><span class="p">()</span> <span class="o">|</span>
<span class="o">+--------+</span>
<span class="o">|</span>     <span class="mi">10</span> <span class="o">|</span>
<span class="o">+--------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="流程控制">流程控制</h2>
<h3 id="普通">普通</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">where</span> <span class="k">if</span><span class="p">(</span><span class="err">条件表达式</span><span class="p">,</span><span class="err">表达式</span><span class="mi">1</span><span class="p">,</span><span class="err">表达式</span><span class="mi">2</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>当条件表达式的值为TRUE时，则判断的结果返回表达式1的值，否则返回表达式2的值。</li>
<li>条件表达式不能是与0或NULL进行比较的表达式。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">SELECT</span> <span class="n">id</span><span class="p">,</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">sh_goods</span> <span class="k">WHERE</span> <span class="k">IF</span><span class="p">(</span><span class="n">score</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="if-then">if-then</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">procedure</span> <span class="nf">isnull</span><span class="p">(</span><span class="k">in</span> <span class="n">val</span> <span class="kt">int</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span> <span class="k">if</span> <span class="n">val</span> <span class="k">is</span> <span class="no">null</span>
    <span class="o">-&gt;</span>     <span class="k">then</span> <span class="k">select</span> <span class="s2">&#34;the parameter is null&#34;</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="k">else</span>
    <span class="o">-&gt;</span>     <span class="k">select</span> <span class="s2">&#34;the parameter is not null&#34;</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">02</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">call</span> <span class="nf">isnull</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="o">+---------------------------+</span>
<span class="o">|</span> <span class="n">the</span> <span class="n">parameter</span> <span class="k">is</span> <span class="k">not</span> <span class="no">null</span> <span class="o">|</span>
<span class="o">+---------------------------+</span>
<span class="o">|</span> <span class="n">the</span> <span class="n">parameter</span> <span class="k">is</span> <span class="k">not</span> <span class="no">null</span> <span class="o">|</span>
<span class="o">+---------------------------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="case">case</h3>
<ul>
<li>
<p>第一种,case-when</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="p">,</span>
    <span class="o">-&gt;</span> <span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="n">id</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="k">then</span> <span class="s2">&#34;小&#34;</span>
    <span class="o">-&gt;</span> <span class="k">when</span> <span class="n">id</span> <span class="o">&lt;</span> <span class="mi">6</span> <span class="k">then</span> <span class="s2">&#34;大
</span><span class="s2">    -&gt; &#34;</span>
    <span class="o">-&gt;</span> <span class="k">else</span> <span class="s2">&#34;超大&#34;</span> <span class="n">end</span><span class="p">)</span> <span class="k">as</span> <span class="n">sid</span>
    <span class="o">-&gt;</span> <span class="k">from</span> <span class="n">s1</span><span class="p">;</span>
<span class="o">+----------+----------+--------+</span>
<span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span> <span class="n">sid</span>    <span class="o">|</span>
<span class="o">+----------+----------+--------+</span>
<span class="o">|</span> <span class="n">zhang</span>    <span class="o">|</span> <span class="mi">2123</span>     <span class="o">|</span> <span class="err">小</span>    <span class="o">|</span>
<span class="o">|</span> <span class="err">李</span>        <span class="o">|</span> <span class="mi">2442</span>    <span class="o">|</span> <span class="err">小</span>     <span class="o">|</span>
<span class="o">|</span> <span class="n">wang</span>     <span class="o">|</span> <span class="mi">29</span>       <span class="o">|</span> <span class="err">大</span>
   <span class="o">|</span>
<span class="o">|</span> <span class="mi">1</span>        <span class="o">|</span> <span class="mi">1</span>        <span class="o">|</span> <span class="err">大</span>
   <span class="o">|</span>
<span class="o">|</span> <span class="mi">32</span>       <span class="o">|</span> <span class="mi">63453</span>    <span class="o">|</span> <span class="err">超大</span> <span class="o">|</span>
<span class="o">+----------+----------+--------+</span>
<span class="mi">5</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>第二种,case-end case</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">procedure</span> <span class="nf">proc</span><span class="p">(</span><span class="k">in</span> <span class="n">id</span> <span class="kt">int</span><span class="p">)</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">case</span>
    <span class="o">-&gt;</span>         <span class="k">when</span> <span class="n">id</span> <span class="o">&lt;</span> <span class="mi">3</span> <span class="k">then</span> <span class="k">select</span> <span class="s2">&#34;牛逼&#34;</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="k">when</span> <span class="n">id</span> <span class="o">&lt;</span> <span class="mi">6</span> <span class="k">then</span> <span class="k">select</span> <span class="s2">&#34;差了点&#34;</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="k">else</span> <span class="k">select</span> <span class="s2">&#34;垃圾&#34;</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">end</span> <span class="k">case</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">04</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">call</span> <span class="nf">proc</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="o">+--------+</span>
<span class="o">|</span> <span class="err">差了点</span> <span class="o">|</span>
<span class="o">+--------+</span>
<span class="o">|</span> <span class="err">差了点</span> <span class="o">|</span>
<span class="o">+--------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="循环语句">循环语句</h2>
<h3 id="loop">loop</h3>
<ul>
<li>计算1-9之间数字的和</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">procedure</span> <span class="nf">proc</span><span class="p">()</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">declare</span> <span class="n">i</span><span class="p">,</span><span class="n">sum</span> <span class="kt">int</span> <span class="k">default</span> <span class="mi">0</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">sign</span><span class="p">:</span><span class="k">loop</span>
    <span class="o">-&gt;</span>         <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">10</span> <span class="k">then</span>
    <span class="o">-&gt;</span>             <span class="k">select</span> <span class="n">i</span><span class="p">,</span><span class="n">sum</span><span class="p">;</span>
    <span class="o">-&gt;</span>             <span class="k">leave</span> <span class="n">sign</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="k">else</span>
    <span class="o">-&gt;</span>             <span class="kt">set</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span>
    <span class="o">-&gt;</span>             <span class="kt">set</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="n">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">end</span> <span class="k">loop</span> <span class="n">sign</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">04</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="repeat">repeat</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">procedure</span> <span class="nf">proc</span><span class="p">()</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">declare</span> <span class="n">i</span><span class="p">,</span><span class="n">sum</span> <span class="kt">int</span> <span class="k">default</span> <span class="mi">0</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="k">repeat</span>
    <span class="o">-&gt;</span>         <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">then</span>
    <span class="o">-&gt;</span>             <span class="kt">set</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="n">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="kt">set</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">until</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">10</span> <span class="n">end</span> <span class="k">repeat</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="k">select</span> <span class="n">i</span><span class="p">,</span><span class="n">sum</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">call</span> <span class="nf">proc</span><span class="p">();</span>
<span class="o">+----+-----+</span>
<span class="o">|</span> <span class="n">i</span>  <span class="o">|</span> <span class="n">sum</span> <span class="o">|</span>
<span class="o">+----+-----+</span>
<span class="o">|</span> <span class="mi">11</span> <span class="o">|</span>  <span class="mi">25</span> <span class="o">|</span>
<span class="o">+----+-----+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="while">while</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">procedure</span> <span class="nf">proc</span><span class="p">()</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">declare</span> <span class="n">i</span><span class="p">,</span><span class="n">sum</span> <span class="kt">int</span> <span class="k">default</span> <span class="mi">0</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">10</span> <span class="n">do</span>
    <span class="o">-&gt;</span>         <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">then</span>
    <span class="o">-&gt;</span>             <span class="kt">set</span> <span class="n">sum</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">+</span> <span class="n">i</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="n">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="kt">set</span> <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">end</span> <span class="k">while</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="k">select</span> <span class="n">i</span><span class="p">,</span><span class="n">sum</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span><span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">call</span> <span class="nf">proc</span><span class="p">();</span>
<span class="o">+----+-----+</span>
<span class="o">|</span> <span class="n">i</span>  <span class="o">|</span> <span class="n">sum</span> <span class="o">|</span>
<span class="o">+----+-----+</span>
<span class="o">|</span> <span class="mi">11</span> <span class="o">|</span>  <span class="mi">25</span> <span class="o">|</span>
<span class="o">+----+-----+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="leave和iterate">leave和iterate</h3>
<ul>
<li>ITERATE语句用于结束本次循环的执行，开始下一轮循环的执行操作，重新开始循环。</li>
<li>LEAVE语句用于终止当前循环，跳出循环体。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">procedure</span> <span class="nf">proc</span><span class="p">()</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">declare</span> <span class="n">num</span> <span class="kt">int</span> <span class="k">default</span> <span class="mi">0</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">my_loop</span><span class="p">:</span><span class="k">loop</span>
    <span class="o">-&gt;</span>         <span class="kt">set</span> <span class="n">num</span> <span class="o">=</span> <span class="n">num</span> <span class="o">+</span> <span class="mi">2</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="k">if</span> <span class="n">num</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">then</span> <span class="k">iterate</span> <span class="n">my_loop</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="k">else</span> <span class="k">select</span> <span class="n">num</span><span class="p">;</span><span class="k">leave</span> <span class="n">my_loop</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="n">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">end</span> <span class="k">loop</span> <span class="n">my_loop</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">call</span> <span class="nf">proc</span><span class="p">();</span>
<span class="o">+-----+</span>
<span class="o">|</span> <span class="n">num</span> <span class="o">|</span>
<span class="o">+-----+</span>
<span class="o">|</span>   <span class="mi">6</span> <span class="o">|</span>
<span class="o">+-----+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="游标">游标</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">procedure</span> <span class="nf">proc</span><span class="p">()</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">declare</span> <span class="n">mark</span><span class="p">,</span><span class="n">cur_id</span><span class="p">,</span><span class="n">cur_username</span><span class="p">,</span><span class="n">cur_password</span> <span class="kt">int</span> <span class="k">default</span> <span class="mi">0</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="k">declare</span> <span class="n">cur</span> <span class="k">cursor</span> <span class="k">for</span>
    <span class="o">-&gt;</span>     <span class="k">select</span> <span class="n">id</span><span class="p">,</span><span class="n">username</span><span class="p">,</span><span class="n">password</span> <span class="k">from</span> <span class="n">s2</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="k">declare</span> <span class="k">continue</span> <span class="n">handler</span> <span class="k">for</span> <span class="k">sqlstate</span> <span class="s2">&#34;02000&#34;</span> <span class="kt">set</span> <span class="n">mark</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">open</span> <span class="n">cur</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="k">repeat</span>
    <span class="o">-&gt;</span>         <span class="k">fetch</span> <span class="n">cur</span> <span class="k">into</span> <span class="n">cur_id</span><span class="p">,</span><span class="n">cur_username</span><span class="p">,</span><span class="n">cur_password</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="k">if</span> <span class="n">cur_password</span> <span class="o">=</span> <span class="mi">29</span> <span class="k">then</span>
    <span class="o">-&gt;</span>             <span class="kt">set</span> <span class="n">cur_password</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
    <span class="o">-&gt;</span>             <span class="k">update</span> <span class="n">s2</span> <span class="kt">set</span> <span class="n">password</span> <span class="o">=</span> <span class="n">cur_password</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span> <span class="n">cur_id</span><span class="p">;</span>
    <span class="o">-&gt;</span>         <span class="n">end</span> <span class="k">if</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">until</span> <span class="n">mark</span> <span class="n">end</span> <span class="k">repeat</span><span class="p">;</span>
    <span class="o">-&gt;</span>     <span class="n">close</span> <span class="n">cur</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="触发器">触发器</h2>
<ul>
<li>
<p>当向表s1插入内容时,将s2中id为3的数据项的id减1</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">use</span> <span class="n">course</span><span class="p">;</span>
<span class="k">Database</span> <span class="n">changed</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="err">$$</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">create</span> <span class="k">trigger</span> <span class="n">insert_trigger</span> <span class="k">before</span> <span class="k">insert</span> <span class="k">on</span> <span class="n">s1</span> <span class="k">for</span> <span class="k">each</span> <span class="n">row</span>
    <span class="o">-&gt;</span> <span class="n">begin</span>
    <span class="o">-&gt;</span>     <span class="k">update</span> <span class="n">s2</span> <span class="kt">set</span> <span class="n">id</span> <span class="o">=</span> <span class="n">id</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">where</span> <span class="n">id</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="o">-&gt;</span> <span class="n">end</span>
    <span class="o">-&gt;</span> <span class="err">$$</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
   
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">delimiter</span> <span class="p">;</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">insert</span> <span class="k">into</span> <span class="nf">s1</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">99</span><span class="p">,</span><span class="s2">&#34;99&#34;</span><span class="p">,</span><span class="s2">&#34;99&#34;</span><span class="p">);</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s2</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span>        <span class="mi">1</span> <span class="o">|</span>     <span class="mi">2123</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span>        <span class="mi">2</span> <span class="o">|</span>     <span class="mi">2442</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span>        <span class="mi">3</span> <span class="o">|</span>       <span class="mi">30</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">5</span> <span class="o">|</span>        <span class="mi">5</span> <span class="o">|</span>        <span class="mi">1</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">6</span> <span class="o">|</span>        <span class="mi">8</span> <span class="o">|</span>    <span class="mi">63453</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">5</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="查看所有的触发器">查看所有的触发器</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="n">triggers</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="查看创建触发器的语句">查看创建触发器的语句</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="k">create</span> <span class="k">trigger</span> <span class="err">触发器名称</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="删除触发器">删除触发器</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">drop</span> <span class="k">trigger</span> <span class="err">数据库</span><span class="p">.</span><span class="err">触发器名称</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="事件">事件</h2>
<p>&hellip;</p>
<h2 id="预处理">预处理</h2>
<h3 id="查看事件调度器是否开启">查看事件调度器是否开启</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">show</span> <span class="n">variables</span> <span class="k">like</span> <span class="s2">&#34;event_scheduler&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="预处理的语句是字符串">预处理的语句是字符串</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">prepare</span> <span class="n">stmt</span> <span class="k">from</span> <span class="s2">&#34;select id,username,password from s1 where id = ?&#34;</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">Statement</span> <span class="n">prepared</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="kt">set</span> <span class="o">@</span><span class="n">my_id</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">execute</span> <span class="n">stmt</span> <span class="k">using</span> <span class="o">@</span><span class="n">my_id</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="n">wang</span>     <span class="o">|</span> <span class="mi">29</span>       <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">deallocate</span> <span class="n">prepare</span> <span class="n">stmt</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="预处理的语句是变量">预处理的语句是变量</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="kt">set</span> <span class="o">@</span><span class="k">sql</span> <span class="o">=</span> <span class="s2">&#34;select id,username,password from s1 where id = ?&#34;</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">prepare</span> <span class="n">stmt</span> <span class="k">from</span> <span class="o">@</span><span class="k">sql</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">Statement</span> <span class="n">prepared</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">execute</span> <span class="n">stmt</span> <span class="k">using</span> <span class="o">@</span><span class="n">my_id</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="n">wang</span>     <span class="o">|</span> <span class="mi">29</span>       <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">1</span> <span class="n">row</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">deallocate</span> <span class="n">prepare</span> <span class="n">stmt</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step07事务和锁">Step07.事务和锁</h1>
<h2 id="事务">事务</h2>
<h3 id="开启一个事务">开启一个事务</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">start</span> <span class="n">trasaction</span><span class="p">;</span>
<span class="k">update</span> <span class="p">...</span>
<span class="k">update</span> <span class="p">...</span>
<span class="n">commit</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="回滚事务">回滚事务</h3>
<ul>
<li>
<p>如果不想提交当前事务，可以取消事务（即回滚）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">rollback</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ROLLBACK语句只能针对未提交的事务执行回滚操作，已提交的事务是不能回滚的</p>
</li>
</ul>
<hr>
<ul>
<li>当执行COMMIT或ROLLBACK后，当前事务就会自动结束。</li>
<li>MySQL中的事务不允许嵌套，若在执行START TRANSACTION语句前上一个事务还未提交，会隐式地执行提交操作。</li>
<li>事务处理主要是针对数据表中数据的处理，不包括创建或删除数据库、数据表，修改表结构等操作，而且执行这类操作时会隐式地提交事务。例如：在使用START TRANSACTION开启事务后执行ALTER TABLE修改表结构，会隐式提交事务</li>
</ul>
<h3 id="保存点">保存点</h3>
<h4 id="通过保存点精确回滚到指定位置">通过保存点精确回滚到指定位置</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">zhang</span>    <span class="o">|</span> <span class="mi">2123</span>     <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">li</span>       <span class="o">|</span> <span class="mi">2442</span>     <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="n">wang</span>     <span class="o">|</span> <span class="mi">29</span>       <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">3</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">start</span> <span class="n">transaction</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">update</span> <span class="n">s1</span> <span class="kt">set</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;张&#34;</span> <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;zhang&#34;</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">Rows</span> <span class="n">matched</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Changed</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Warnings</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">savepoint</span> <span class="n">one</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">update</span> <span class="n">s1</span> <span class="kt">set</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;李&#34;</span> <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;li&#34;</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">Rows</span> <span class="n">matched</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Changed</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Warnings</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">rollback</span> <span class="k">to</span> <span class="n">savepoint</span> <span class="n">one</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">commit</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="err">张</span>      <span class="o">|</span> <span class="mi">2123</span>      <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">li</span>       <span class="o">|</span> <span class="mi">2442</span>     <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="n">wang</span>     <span class="o">|</span> <span class="mi">29</span>       <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">3</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="删除保存点">删除保存点</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="n">s1</span><span class="p">;</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span> <span class="n">id</span> <span class="o">|</span> <span class="n">username</span> <span class="o">|</span> <span class="n">password</span> <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="err">张</span>      <span class="o">|</span> <span class="mi">2123</span>     <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">li</span>       <span class="o">|</span> <span class="mi">2442</span>     <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="n">wang</span>     <span class="o">|</span> <span class="mi">29</span>       <span class="o">|</span>
<span class="o">+----+----------+----------+</span>
<span class="mi">3</span> <span class="n">rows</span> <span class="k">in</span> <span class="kt">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">start</span> <span class="n">transaction</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">update</span> <span class="n">s1</span> <span class="kt">set</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;zhang&#34;</span> <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;张&#34;</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">Rows</span> <span class="n">matched</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Changed</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Warnings</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">savepoint</span> <span class="n">one</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">update</span> <span class="n">s1</span> <span class="kt">set</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;李&#34;</span> <span class="k">where</span> <span class="n">username</span> <span class="o">=</span> <span class="s2">&#34;li&#34;</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">1</span> <span class="n">row</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
<span class="n">Rows</span> <span class="n">matched</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Changed</span><span class="p">:</span> <span class="mi">1</span>  <span class="n">Warnings</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">release</span> <span class="n">savepoint</span> <span class="n">one</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">rollback</span> <span class="k">to</span> <span class="n">savepoint</span> <span class="n">one</span><span class="p">;</span>
<span class="mi">1305</span> <span class="o">-</span> <span class="n">SAVEPOINT</span> <span class="n">one</span> <span class="n">does</span> <span class="k">not</span> <span class="n">exist</span>
<span class="n">mysql</span><span class="o">&gt;</span> 
</code></pre></td></tr></table>
</div>
</div><blockquote>
<ul>
<li>一个事务中可以创建多个保存点，在提交事务后，事务中的保存点就会被删除。</li>
<li>在回滚到某个保存点后，在该保存点之后创建过的保存点也会消失。</li>
</ul>
</blockquote>
<h2 id="锁">锁</h2>
<h3 id="只读方式锁定数据表">只读方式锁定数据表</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">mysql</span><span class="o">&gt;</span> <span class="k">lock</span> <span class="k">table</span> <span class="n">s1</span> <span class="k">read</span><span class="p">;</span>
<span class="n">Query</span> <span class="n">OK</span><span class="p">,</span> <span class="mi">0</span> <span class="n">rows</span> <span class="nf">affected</span> <span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span> <span class="n">sec</span><span class="p">)</span>
 
<span class="n">mysql</span><span class="o">&gt;</span> <span class="k">insert</span> <span class="k">into</span> <span class="nf">s1</span> <span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="s2">&#34;1&#34;</span><span class="p">,</span><span class="s2">&#34;1&#34;</span><span class="p">);</span>
<span class="mi">1099</span> <span class="o">-</span> <span class="k">Table</span> <span class="s1">&#39;s1&#39;</span> <span class="n">was</span> <span class="n">locked</span> <span class="k">with</span> <span class="n">a</span> <span class="k">READ</span> <span class="k">lock</span> <span class="k">and</span> <span class="n">can</span><span class="s1">&#39;t be updated
</span><span class="s1">mysql&gt; unlock tables;
</span><span class="s1">Query OK, 0 rows affected (0.00 sec)
</span><span class="s1"> 
</span><span class="s1">mysql&gt; insert into s1 (id,username,password) values (5,&#34;1&#34;,&#34;1&#34;);
</span><span class="s1">Query OK, 1 row affected (0.01 sec)
</span></code></pre></td></tr></table>
</div>
</div><h3 id="写方式锁定数据表">写方式锁定数据表</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">lock</span> <span class="k">table</span> <span class="err">数据表名</span> <span class="k">write</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="查询语句加锁">查询语句加锁</h3>
<h4 id="读锁">读锁</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">lock</span> <span class="k">in</span> <span class="n">share</span> <span class="n">mode</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="写锁">写锁</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="o">*</span> <span class="k">from</span> <span class="err">数据表名</span> <span class="k">for</span> <span class="k">update</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step08用户与权限">Step08.用户与权限</h1>
<h2 id="查询mysql数据库下的user表">查询mysql数据库下的user表</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="n">host</span><span class="p">,</span><span class="k">user</span> <span class="k">from</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="创建用户">创建用户</h2>
<ul>
<li>
<p>创建最普通的用户</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">user</span> <span class="err">用户名</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>设置主机名和密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">user</span> <span class="s2">&#34;用户名&#34;</span><span class="o">@</span><span class="s2">&#34;localhost&#34;</span> <span class="k">identified</span> <span class="k">by</span> <span class="s2">&#34;密码&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建多个用户</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">user</span> <span class="s2">&#34;用户名1&#34;</span><span class="o">@</span><span class="s2">&#34;localhost&#34;</span> <span class="k">identified</span> <span class="k">by</span> <span class="s2">&#34;密码1&#34;</span><span class="p">,</span><span class="s2">&#34;用户名2&#34;</span><span class="o">@</span><span class="s2">&#34;localhost&#34;</span> <span class="k">identified</span> <span class="k">by</span> <span class="s2">&#34;密码2&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>查看用户名和密码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">select</span> <span class="n">host</span><span class="p">,</span><span class="k">user</span><span class="p">,</span><span class="n">plugin</span><span class="p">,</span><span class="n">authentication_string</span> <span class="k">from</span> <span class="n">mysql</span><span class="p">.</span><span class="k">user</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="给用户设置密码">给用户设置密码</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">alter</span> <span class="k">user</span> <span class="err">用户名</span> <span class="k">identified</span> <span class="k">by</span> <span class="s2">&#34;密码&#34;</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="删除用户">删除用户</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">drop</span> <span class="k">user</span> <span class="k">if</span> <span class="k">exists</span> <span class="err">用户名</span><span class="mi">1</span><span class="p">,</span><span class="err">用户名</span><span class="mi">2</span><span class="p">...;</span>
</code></pre></td></tr></table>
</div>
</div>
    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Zhang's Blog</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2020-08-01
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/database/">DataBase</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">机器学习</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/c/">
            <span class="next-text nav-default">C</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://twitter.com/" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://www.facebook.com/" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://www.linkedin.com/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://www.google.com/" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/" class="iconfont icon-douban" title="douban"></a>
      <a href="https://getpocket.com/" class="iconfont icon-pocket" title="pocket"></a>
      <a href="https://www.tumblr.com/" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="https://www.instagram.com/" class="iconfont icon-instagram" title="instagram"></a>
      <a href="https://about.gitlab.com/" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="https://www.bilibili.com/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="http://localhost:1313/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://golang.org/">GoLang</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Author - 
    <a class="theme-link" href="https://space.bilibili.com/628950169/">Mr'zhang</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span>Zhang's Blog</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>








</body>
</html>
