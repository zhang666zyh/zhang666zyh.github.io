<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>MyBatis - Zhang&#39;s Blog的博客</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Zhang&#39;s Blog" /><meta name="description" content="Step1. 创建项目 Step2. 编写mybatis的第一个程序 Step3.增删改查 getUserByIdint id; updateUserUser user; addUserUser user; deleteUserint id; 总结 增删改查的所有源码不给出mybatis-config.xm" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.67.1 with theme even" />


<link rel="canonical" href="http://localhost:1313/post/mybatis/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="MyBatis" />
<meta property="og:description" content="Step1. 创建项目 Step2. 编写mybatis的第一个程序 Step3.增删改查 getUserByIdint id; updateUserUser user; addUserUser user; deleteUserint id; 总结 增删改查的所有源码不给出mybatis-config.xm" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/mybatis/" />
<meta property="article:published_time" content="2021-08-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-08-15T00:00:00+00:00" />
<meta itemprop="name" content="MyBatis">
<meta itemprop="description" content="Step1. 创建项目 Step2. 编写mybatis的第一个程序 Step3.增删改查 getUserByIdint id; updateUserUser user; addUserUser user; deleteUserint id; 总结 增删改查的所有源码不给出mybatis-config.xm">
<meta itemprop="datePublished" content="2021-08-15T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-08-15T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="16148">



<meta itemprop="keywords" content="Java,DataBase," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="MyBatis"/>
<meta name="twitter:description" content="Step1. 创建项目 Step2. 编写mybatis的第一个程序 Step3.增删改查 getUserByIdint id; updateUserUser user; addUserUser user; deleteUserint id; 总结 增删改查的所有源码不给出mybatis-config.xm"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Zhang&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/home/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">MyBlog</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Zhang&#39;s Blog</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/home/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">MyBlog</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">MyBatis</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-08-15 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#step1-创建项目">Step1. 创建项目</a></li>
    <li><a href="#step2-编写mybatis的第一个程序">Step2. 编写mybatis的第一个程序</a></li>
    <li><a href="#step3增删改查">Step3.增删改查</a>
      <ul>
        <li><a href="#getuserbyidint-id">getUserById(int id);</a></li>
        <li><a href="#updateuseruser-user">updateUser(User user);</a></li>
        <li><a href="#adduseruser-user">addUser(User user);</a></li>
        <li><a href="#deleteuserint-id">deleteUser(int id);</a></li>
        <li><a href="#总结">总结</a>
          <ul>
            <li><a href="#增删改查的所有源码不给出mybatis-configxml">增删改查的所有源码(不给出mybatis-config.xml)</a></li>
            <li><a href="#解析usermapperxml中关于mysql的语法">解析UserMapper.xml中关于MySQL的语法</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step4万能的map和模糊查询语句">Step4.万能的Map和模糊查询语句</a>
      <ul>
        <li><a href="#万能map">万能Map</a></li>
        <li><a href="#模糊查询语句">模糊查询语句</a></li>
      </ul>
    </li>
    <li><a href="#mybatis深入理解一之--与--区别以及-sql-预编译httpssegmentfaultcoma1190000004617028"><a href="https://segmentfault.com/a/1190000004617028">mybatis深入理解(一)之 # 与 $ 区别以及 sql 预编译</a></a></li>
    <li><a href="#step5配置之属性优化mybatis-configxml文件解析">Step5.配置之属性优化(mybatis-config.xml文件解析)</a></li>
    <li><a href="#step6配置之别名优化给实体类起别名避免写全类名">Step6.配置之别名优化(给实体类起别名避免写全类名)</a>
      <ul>
        <li><a href="#第一种方式通过typealiases标签给实体类起别名">第一种方式,通过<code>&lt;typeAliases&gt;</code>标签给实体类起别名</a></li>
        <li><a href="#第二种方式搜索包下的类通过注解给实体类起别名">第二种方式,搜索包下的类,通过注解给实体类起别名</a></li>
      </ul>
    </li>
    <li><a href="#step7配置之映射器说明">Step7.配置之映射器说明</a></li>
    <li><a href="#step8生命周期和作用域">Step8.生命周期和作用域</a></li>
    <li><a href="#step9resultset结果集映射">Step9.ResultSet结果集映射</a></li>
    <li><a href="#step10日志工厂">Step10.日志工厂</a></li>
    <li><a href="#step11limit实现分页">Step11.Limit实现分页</a></li>
    <li><a href="#step12rowbounds实现分页">Step12.RowBounds实现分页</a></li>
    <li><a href="#step13注解开发">Step13.注解开发</a>
      <ul>
        <li><a href="#接口的理解">接口的理解</a></li>
        <li><a href="#使用注解">使用注解</a></li>
      </ul>
    </li>
    <li><a href="#step14使用lombok">Step14.使用Lombok</a></li>
    <li><a href="#step15复杂查询环境搭建">Step15.复杂查询环境搭建</a>
      <ul>
        <li><a href="#创建数据库">创建数据库</a></li>
        <li><a href="#项目准备">项目准备</a></li>
        <li><a href="#多对一的处理">多对一的处理</a></li>
        <li><a href="#一对多的处理">一对多的处理</a></li>
      </ul>
    </li>
    <li><a href="#step16动态sql处理环境配置">Step16.动态SQL处理环境配置</a></li>
    <li><a href="#step17动态sql之if语句">Step17.动态SQL之IF语句</a></li>
    <li><a href="#step18动态sql语句之sql语句的拼接">Step18.动态SQL语句之SQL语句的拼接</a></li>
    <li><a href="#step19动态sql之foreach">Step19.动态SQL之forEach</a>
      <ul>
        <li><a href="#提取公共语句">提取公共语句</a></li>
      </ul>
    </li>
    <li><a href="#step20缓存">Step20.缓存</a>
      <ul>
        <li><a href="#一级缓存">一级缓存</a></li>
        <li><a href="#二级缓存">二级缓存</a></li>
      </ul>
    </li>
    <li><a href="#step21mybatis的缓存机制">Step21.MyBatis的缓存机制</a></li>
    <li><a href="#step22自定义缓存ehcache">Step22.自定义缓存Ehcache</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <!-- TOC -->
<ul>
<li><a href="#step1-%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE">Step1. 创建项目</a></li>
<li><a href="#step2-%E7%BC%96%E5%86%99mybatis%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E7%A8%8B%E5%BA%8F">Step2. 编写mybatis的第一个程序</a></li>
<li><a href="#step3%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5">Step3.增删改查</a>
<ul>
<li><a href="#getuserbyidint-id">getUserByIdint id;</a></li>
<li><a href="#updateuseruser-user">updateUserUser user;</a></li>
<li><a href="#adduseruser-user">addUserUser user;</a></li>
<li><a href="#deleteuserint-id">deleteUserint id;</a></li>
<li><a href="#%E6%80%BB%E7%BB%93">总结</a>
<ul>
<li><a href="#%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E7%9A%84%E6%89%80%E6%9C%89%E6%BA%90%E7%A0%81%E4%B8%8D%E7%BB%99%E5%87%BAmybatis-configxml">增删改查的所有源码不给出mybatis-config.xml</a></li>
<li><a href="#%E8%A7%A3%E6%9E%90usermapperxml%E4%B8%AD%E5%85%B3%E4%BA%8Emysql%E7%9A%84%E8%AF%AD%E6%B3%95">解析UserMapper.xml中关于MySQL的语法</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#step4%E4%B8%87%E8%83%BD%E7%9A%84map%E5%92%8C%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5">Step4.万能的Map和模糊查询语句</a>
<ul>
<li><a href="#%E4%B8%87%E8%83%BDmap">万能Map</a></li>
<li><a href="#%E6%A8%A1%E7%B3%8A%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5">模糊查询语句</a></li>
</ul>
</li>
<li><a href="#mybatis%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B8%80%E4%B9%8B--%E4%B8%8E--%E5%8C%BA%E5%88%AB%E4%BB%A5%E5%8F%8A-sql-%E9%A2%84%E7%BC%96%E8%AF%91">mybatis深入理解一之 # 与 $ 区别以及 sql 预编译</a></li>
<li><a href="#step5%E9%85%8D%E7%BD%AE%E4%B9%8B%E5%B1%9E%E6%80%A7%E4%BC%98%E5%8C%96mybatis-configxml%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90">Step5.配置之属性优化mybatis-config.xml文件解析</a></li>
<li><a href="#step6%E9%85%8D%E7%BD%AE%E4%B9%8B%E5%88%AB%E5%90%8D%E4%BC%98%E5%8C%96%E7%BB%99%E5%AE%9E%E4%BD%93%E7%B1%BB%E8%B5%B7%E5%88%AB%E5%90%8D%E9%81%BF%E5%85%8D%E5%86%99%E5%85%A8%E7%B1%BB%E5%90%8D">Step6.配置之别名优化给实体类起别名避免写全类名</a>
<ul>
<li><a href="#%E7%AC%AC%E4%B8%80%E7%A7%8D%E6%96%B9%E5%BC%8F%E9%80%9A%E8%BF%87typealiases%E6%A0%87%E7%AD%BE%E7%BB%99%E5%AE%9E%E4%BD%93%E7%B1%BB%E8%B5%B7%E5%88%AB%E5%90%8D">第一种方式,通过<typeAliases>标签给实体类起别名</a></li>
<li><a href="#%E7%AC%AC%E4%BA%8C%E7%A7%8D%E6%96%B9%E5%BC%8F%E6%90%9C%E7%B4%A2%E5%8C%85%E4%B8%8B%E7%9A%84%E7%B1%BB%E9%80%9A%E8%BF%87%E6%B3%A8%E8%A7%A3%E7%BB%99%E5%AE%9E%E4%BD%93%E7%B1%BB%E8%B5%B7%E5%88%AB%E5%90%8D">第二种方式,搜索包下的类,通过注解给实体类起别名</a></li>
</ul>
</li>
<li><a href="#step7%E9%85%8D%E7%BD%AE%E4%B9%8B%E6%98%A0%E5%B0%84%E5%99%A8%E8%AF%B4%E6%98%8E">Step7.配置之映射器说明</a></li>
<li><a href="#step8%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%92%8C%E4%BD%9C%E7%94%A8%E5%9F%9F">Step8.生命周期和作用域</a></li>
</ul>
<!-- /TOC -->
<ul>
<li><a href="https://mybatis.org/mybatis-3/zh/index.html">MyBatis官网</a></li>
<li>编写项目前的注意事项:
<ul>
<li>一、不要有中文</li>
<li>二、MySQL验证方式版本和JDBC的版本一直搞不清楚,所以不要写useSSL</li>
</ul>
</li>
</ul>
<h1 id="step1-创建项目">Step1. 创建项目</h1>
<ul>
<li>
<p>创建一个普通的maven项目</p>
</li>
<li>
<p>删除项目中的src目录</p>
</li>
<li>
<p>配置maven依赖</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span>
         <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
  
    <span class="nt">&lt;groupId&gt;</span>org.example<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>MyBatisStudy<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;packaging&gt;</span>pom<span class="nt">&lt;/packaging&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;modules&gt;</span>
        <span class="nt">&lt;module&gt;</span>mybatis_001<span class="nt">&lt;/module&gt;</span>
    <span class="nt">&lt;/modules&gt;</span>
  
    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;maven.compiler.source&gt;</span>8<span class="nt">&lt;/maven.compiler.source&gt;</span>
        <span class="nt">&lt;maven.compiler.target&gt;</span>8<span class="nt">&lt;/maven.compiler.target&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>
      
    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>5.1.47<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>4.12<span class="nt">&lt;/version&gt;</span>
            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.mybatis<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>mybatis<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>3.5.2<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>执行以下MySQL语句,创建mybatis数据库,并在这个数据库中创建user表</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">database</span> <span class="n">mybatis</span><span class="p">;</span>
<span class="k">use</span> <span class="n">mybatis</span><span class="p">;</span>
<span class="k">create</span> <span class="k">table</span> <span class="k">user</span><span class="p">(</span>
    <span class="n">id</span> <span class="kt">int</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">name</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="n">pwd</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span>
<span class="p">)</span><span class="kp">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">UTF8</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在当前项目下创建新模块(也就是子项目,普通的maven项目)</p>
</li>
</ul>
<h1 id="step2-编写mybatis的第一个程序">Step2. 编写mybatis的第一个程序</h1>
<ul>
<li>
<p>注意:在xml中不要写任何的中文防止报错</p>
</li>
<li>
<p>打开子项目中的pom.xml文件,你可以看到有这样一段代码</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;parent&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>MyBatisStudy<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.example<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.0-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/parent&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>继承父类,就是在子类中你不需要配置任何内容</p>
</li>
<li>
<p>在src/main目录下创建这三个目录</p>
<p><img src="https://img-blog.csdnimg.cn/20210927204645727.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBAdW5kZWZpbmVk,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>根据<a href="https://mybatis.org/mybatis-3/zh/getting-started.html">MyBatis官网</a>,我们需要编写Utils工具类来获取这个SqlSession实例化对象</p>
<p>在util目录下创建MyBatis.java文件</p>
<p><code>MyBatis.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.utils</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   MyBatisUtils
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
   
<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
   
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
   
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisUtils</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
    <span class="kd">static</span><span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
            <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
            <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
   
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">SqlSession</span> <span class="nf">getSqlSession</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在pojo目录下创建User.java</p>
<p><code>User.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   User
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">;</span>
  
    <span class="kd">public</span> <span class="nf">User</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pwd</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="nf">User</span><span class="o">()</span> <span class="o">{</span>
  
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPwd</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPwd</span><span class="o">(</span><span class="n">String</span> <span class="n">pwd</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pwd</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>
  
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&#34;User{&#34;</span> <span class="o">+</span>
                <span class="s">&#34;id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span>
                <span class="s">&#34;, name=&#39;&#34;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&#34;, pwd=&#39;&#34;</span> <span class="o">+</span> <span class="n">pwd</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>然后在Dao层编写接口UserDao.java</p>
<p><code>UserDao.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserDao
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserDao</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserList</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>通常是要写一个实现类继承接口,但是MyBatis的最大的特点就是<strong>免除了几乎所有的 JDBC 代码以及设置参数和获取结果集的工作</strong></p>
</li>
<li>
<p>这里我们换成xml配置文件</p>
</li>
<li>
<p>在Dao层创建一个和UserDao.java同级目录的UserMap.xml文件</p>
<p><code>UserDao.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="o">&lt;?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s">&#34;1.0&#34;</span> <span class="n">encoding</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span> <span class="o">?&gt;</span>
<span class="o">&lt;!</span><span class="n">DOCTYPE</span> <span class="n">mapper</span>
        <span class="n">PUBLIC</span> <span class="s">&#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;</span>
        <span class="s">&#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;</span><span class="o">&gt;</span>
  
<span class="o">&lt;!--</span><span class="n">namespace是命名空间</span><span class="o">,</span><span class="n">也就是你接口的全类名</span><span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="n">mapper</span> <span class="n">namespace</span><span class="o">=</span><span class="s">&#34;com.zhang.dao.UserDao&#34;</span><span class="o">&gt;</span>
<span class="o">&lt;!--</span>    <span class="n">一个select代表一个方法</span><span class="o">,</span><span class="n">id的内容就是方法</span><span class="o">,</span><span class="n">resultType的是返回值的类型</span><span class="o">(</span><span class="n">resultMap返回的是一个值</span><span class="o">,</span><span class="n">resultType是返回一种类型</span><span class="o">,</span><span class="n">这里要使用它元素的类型</span><span class="o">--&gt;</span>
    <span class="o">&lt;</span><span class="n">select</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;getUserList&#34;</span> <span class="n">resultType</span><span class="o">=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="o">&gt;</span>
<span class="o">--</span>         <span class="n">MySQL命令不要有</span><span class="o">;</span>
        <span class="n">select</span>  <span class="o">*</span> <span class="n">from</span> <span class="n">mybatis</span><span class="o">.</span><span class="na">user</span>
    <span class="o">&lt;/</span><span class="n">select</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">mapper</span><span class="o">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在resource目录下创建mybatis-config.xml文件</p>
<p><code>mybatis-config.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
<span class="c">&lt;!--                这里不要用SSL,程序会因为MySQL的验证方式和版本不兼容而报错的--&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;amp;characterEncoding=UTF-8&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/dataSource&gt;</span>
        <span class="nt">&lt;/environment&gt;</span>
    <span class="nt">&lt;/environments&gt;</span>
      
<span class="c">&lt;!--    这里是将你接口的配置文件(实现类)注册一下,你不过就是个xml文件吗,在里面就想使用人家的命令,你不过来登记一下能随便用吗--&gt;</span>
    <span class="nt">&lt;mappers&gt;</span>
        <span class="c">&lt;!--这里的路径要使用/分隔符--&gt;</span>
        <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;com/zhang/dao/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在test/java下创建com.zhang.dao目录</p>
</li>
<li>
<p>创建一个UserDaoTest.java文件</p>
<p><code>UserDaoTest.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserDaoTest
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoTest</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
    <span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="c1">//junit jar包下的@Test注解
</span><span class="c1"></span>    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="n">userDao</span><span class="o">.</span><span class="na">getUserList</span><span class="o">();</span>
  
        <span class="k">for</span><span class="o">(</span><span class="n">User</span> <span class="n">value</span> <span class="o">:</span> <span class="n">items</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
        <span class="o">}</span>
  
        <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>运行程序</p>
</li>
<li>
<p>关于test测试类中获取到查询结果的方法,上述是官网推荐的新方法</p>
</li>
<li>
<p>还有一种方法是旧方法,官网不推荐使用</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">&#34;com.zhang.dao.UserDao.getUserList&#34;</span><span class="o">);</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>sqlSession有好几个方法,如果结果是一个就selectOne,如果是多个就selectList,如果是Map类型就selectMap</p>
</li>
<li>
<p>最后就是对于启动项目后打包中配置文件加载失败的问题</p>
</li>
<li>
<p>我们在pom.xml文件中添加这样一段代码:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;resources&gt;</span>
            <span class="nt">&lt;resource&gt;</span>
                <span class="nt">&lt;directory&gt;</span>
                    src/main/resources
                <span class="nt">&lt;/directory&gt;</span>
                <span class="nt">&lt;includes&gt;</span>
                    <span class="nt">&lt;include&gt;</span>**/*.properties<span class="nt">&lt;/include&gt;</span>
                    <span class="nt">&lt;include&gt;</span>**/*.xml<span class="nt">&lt;/include&gt;</span>
                <span class="nt">&lt;/includes&gt;</span>
                <span class="nt">&lt;filtering&gt;</span>
                    true
                <span class="nt">&lt;/filtering&gt;</span>
            <span class="nt">&lt;/resource&gt;</span>
            <span class="nt">&lt;resource&gt;</span>
                <span class="nt">&lt;directory&gt;</span>
                    src/main/java
                <span class="nt">&lt;/directory&gt;</span>
                <span class="nt">&lt;includes&gt;</span>
                    <span class="nt">&lt;include&gt;</span>**/*.properties<span class="nt">&lt;/include&gt;</span>
                    <span class="nt">&lt;include&gt;</span>**/*.xml<span class="nt">&lt;/include&gt;</span>
                <span class="nt">&lt;/includes&gt;</span>
                <span class="nt">&lt;filtering&gt;</span>
                    true
                <span class="nt">&lt;/filtering&gt;</span>
            <span class="nt">&lt;/resource&gt;</span>
  
        <span class="nt">&lt;/resources&gt;</span>
    <span class="nt">&lt;/build&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>这段代码用于启动项目时进行资源过滤,防止资源导出失败</p>
</li>
</ul>
<h1 id="step3增删改查">Step3.增删改查</h1>
<ul>
<li>将UserDao.java接口改成UserMapper.java</li>
<li>然后将mybatis-config.xml和UserMapper.xml中的所有UserDao全部改成UserMapper,因为在Mybatis中通常都是用Mapper命名的</li>
<li>Step2中实现了一个对数据库表的查询</li>
<li>整套流程就是,你在mybatis-config.xml中写好数据库配置用于连接数据库</li>
<li>然后在下面的mapper中将你的实现类注册,这个实现类中包含了你要执行的SQL语句以及调用的方法。如果有返回值还会将查询结果返回给方法,返回值可能是一个,也可能是多个,列表、Map等</li>
<li>为什么要注册呢?我想是可能这只是个配置文件只加载一次,并不像JDBC里面全都是类,你可以动态的获取class。你想使用人家MySQL的东西,就必须在主配置文件中注册一下。就像网站一样,你都没有注册登录,怎么d登录,怎么进入人家的主页呢</li>
<li>注册完后就可以在Test测试类中调用方法了</li>
</ul>
<h2 id="getuserbyidint-id">getUserById(int id);</h2>
<ul>
<li>
<p>由于UserMapper.xml文件已经在mybatis-config.xml文件中注册过了</p>
</li>
<li>
<p>所以我们在UserMapper.java接口中新建一个方法getUserById(int id);根据id获取对象数据</p>
</li>
<li>
<p>然后在UserMapper.xml中实现它</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserById&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;int&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
  select * from mybatis.user where id = #{id}
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>最后在测试类中调用这个方法</p>
</li>
<li>
<p>在UserDaoTest.java中新建方法getUserById();</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getUserById</span><span class="o">(){</span>
    <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getUserById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>run</p>
</li>
</ul>
<h2 id="updateuseruser-user">updateUser(User user);</h2>
<ul>
<li>
<p>修改用户信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
  update mybatis.user set name = #{name},pwd=#{pwd} where id = #{id}
<span class="nt">&lt;/update&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">updataUser</span><span class="o">(){</span>
  <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">updateUser</span><span class="o">(</span><span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="s">&#34;hh&#34;</span><span class="o">,</span><span class="s">&#34;11111&#34;</span><span class="o">));</span>
  <span class="k">if</span><span class="o">(</span><span class="n">result</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">){</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;修改成功!!!&#34;</span><span class="o">);</span>
  <span class="o">}</span>
  <span class="n">sqlSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
  <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="adduseruser-user">addUser(User user);</h2>
<ul>
<li>
<p>向表中添加用户数据</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;addUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
  insert into mybatis.user (id,name,pwd) values (#{id},#{name},#{pwd})
    <span class="nt">&lt;/insert&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">addUser</span><span class="o">(){</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">addUser</span><span class="o">(</span><span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="n">4</span><span class="o">,</span><span class="s">&#34;隋艳萍&#34;</span><span class="o">,</span><span class="s">&#34;1234567&#34;</span><span class="o">));</span>
    <span class="k">if</span><span class="o">(</span><span class="n">result</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;添加成功!!!&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="deleteuserint-id">deleteUser(int id);</h2>
<ul>
<li>
<p>根据id删除表中的数据</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;int&#34;</span><span class="nt">&gt;</span>
  delete from mybatis.user where id = #{id}
<span class="nt">&lt;/delete&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteUser</span><span class="o">(){</span>
    <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">deleteUser</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
    <span class="k">if</span><span class="o">(</span><span class="n">result</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;删除成功!!!&#34;</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="总结">总结</h2>
<h3 id="增删改查的所有源码不给出mybatis-configxml">增删改查的所有源码(不给出mybatis-config.xml)</h3>
<p><code>User.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   User
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">User</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span> <span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pwd</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="nf">User</span><span class="o">()</span> <span class="o">{</span>

    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getPwd</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setPwd</span><span class="o">(</span><span class="n">String</span> <span class="n">pwd</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">pwd</span> <span class="o">=</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">&#34;User{&#34;</span> <span class="o">+</span>
                <span class="s">&#34;id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span>
                <span class="s">&#34;, name=&#39;&#34;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="s">&#34;, pwd=&#39;&#34;</span> <span class="o">+</span> <span class="n">pwd</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
                <span class="sc">&#39;}&#39;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>MyBatisUtils.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.utils</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   MyBatisUtils
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisUtils</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
    <span class="kd">static</span><span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
            <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
            <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kd">static</span> <span class="n">SqlSession</span> <span class="nf">getSqlSession</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>UserMapper</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserDao
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserList</span><span class="o">();</span>
    <span class="n">User</span> <span class="nf">getUserById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
    <span class="kt">int</span> <span class="nf">addUser</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
    <span class="kt">int</span> <span class="nf">updateUser</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span><span class="o">);</span>
    <span class="kt">int</span> <span class="nf">deleteUser</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>UserMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>

<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.UserMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserList&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
        select  * from mybatis.user
    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserById&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;int&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
        select * from mybatis.user where id = #{id}
    <span class="nt">&lt;/select&gt;</span>

    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;addUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
        insert into mybatis.user (id,name,pwd) values (#{id},#{name},#{pwd})
    <span class="nt">&lt;/insert&gt;</span>

    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
        update mybatis.user set name = #{name},pwd=#{pwd} where id = #{id}
    <span class="nt">&lt;/update&gt;</span>

    <span class="nt">&lt;delete</span> <span class="na">id=</span><span class="s">&#34;deleteUser&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;int&#34;</span><span class="nt">&gt;</span>
        delete from mybatis.user where id = #{id}
    <span class="nt">&lt;/delete&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="解析usermapperxml中关于mysql的语法">解析UserMapper.xml中关于MySQL的语法</h3>
<ul>
<li>
<p>查询语句使用select标签,id的值是方法名,parameterType是参数类型，resultType的值是返回值类型</p>
<ul>
<li>这里resultType如果是返回多个值的容器,那你也得写它单个元素的类型,在方法中使用相应的容器接收就好了</li>
<li>意思就是,在这个标签中执行MySQL语句,然后将结果返回给这个方法</li>
<li>其实就相当于你写了一堆Connection、PreparedStatement等</li>
<li>查询语句不需要提交事务</li>
</ul>
</li>
<li>
<p>insert标签是插入</p>
</li>
<li>
<p>update标签是修改</p>
</li>
<li>
<p>delete标签是删除</p>
</li>
<li>
<p>insert、update和delete都是对数据表数据进行改变的操作,需要提交事务(sqlSession.commit();)</p>
<ul>
<li>就像resultSet.executeUpdate();一样</li>
</ul>
</li>
<li>
<p>#{}符号用于获取方法中传递的参数,就像jsp中的el表达式${}一样</p>
<ul>
<li>
<p>如果你在接口中传递的是int id,那xml中直接写#{id}就好了</p>
</li>
<li>
<p>如果你传递的是对象,比如是一个new User(id,name,pwd);</p>
<ul>
<li>
<p>你想修改用户信息</p>
</li>
<li>
<p>标签就要用update,parameterType就等于User的全类名,因为除了查找操作的返回值是对象,其他的都是int,用于检测事务执行是否成功</p>
</li>
<li>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">update</span> <span class="n">mybatis</span><span class="p">.</span><span class="k">user</span> <span class="kt">set</span> <span class="n">name</span><span class="o">=</span><span class="c1">#{name},pwd=#{pwd} where id=#{id}
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>你传入的是User类型,MyBatis会自动帮你解析对象,并将对象的属性在MySQL语句的参数中中对号入座</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="step4万能的map和模糊查询语句">Step4.万能的Map和模糊查询语句</h1>
<h2 id="万能map">万能Map</h2>
<ul>
<li>
<p>在MyBatis种,对于MySQL的操作语句,我们还有其他写法,就是利用Map</p>
</li>
<li>
<p>这里用插入语句作为例子</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserById2&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
  select * from mybatis.user where id = #{userid}
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getUserById2</span><span class="o">(){</span>
  <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
  <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;userid&#34;</span><span class="o">,</span><span class="n">2</span><span class="o">);</span>
  <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getUserById2</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>el表达式中是map的键,MyBatis会自动在Map中将这个key对应的value取出</p>
</li>
</ul>
<h2 id="模糊查询语句">模糊查询语句</h2>
<ul>
<li>
<p>模糊查询语句主要将SQL注入的问题</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getUserListByName</span><span class="o">(){</span>
  <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">users</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getUserListByName</span><span class="o">(</span><span class="s">&#34;%张%&#34;</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span> <span class="o">:</span> <span class="n">users</span><span class="o">){</span>
      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserListByName&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
  select * from mybatis.user where name like #{value}
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>pw</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>张1</td>
<td>456</td>
</tr>
<tr>
<td>3</td>
<td>zhangchangquan</td>
<td>789</td>
</tr>
<tr>
<td>4</td>
<td>222</td>
<td>1234567</td>
</tr>
<tr>
<td>5</td>
<td>张3</td>
<td>1111111</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>这样是最安全的,因为它限定用户只能传一个值,#{}相当于PreparedStatement,会给传递的值加上引号,在执行前对语句进行一次过滤</p>
</li>
<li>
<p>而你如果这样写:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserListByName&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
  select * from mybatis.user where name like #{value} or 1=1
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>那就没得说了</p>
<h1 id="mybatis深入理解一之--与--区别以及-sql-预编译httpssegmentfaultcoma1190000004617028"><a href="https://segmentfault.com/a/1190000004617028">mybatis深入理解(一)之 # 与 $ 区别以及 sql 预编译</a></h1>
</li>
<li>
<p>%在MySQL中表示通配符,常用于模糊查询,例如匹配以'张'开头的所有字符</p>
</li>
</ul>
<h1 id="step5配置之属性优化mybatis-configxml文件解析">Step5.配置之属性优化(mybatis-config.xml文件解析)</h1>
<ul>
<li>在项目根目录下新建第二个模块<code>mybatis_002</code>(前面的一直都是<code>mybatis_001</code>)</li>
<li>随便留几个方法测试一下是否可以运行,其他的都删了</li>
</ul>
<p><code>mybatis-config.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
    <span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
<span class="c">&lt;!--                这里不要用SSL,程序会因为MySQL的验证方式和版本不兼容而报错的--&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;amp;characterEncoding=UTF-8&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/dataSource&gt;</span>
        <span class="nt">&lt;/environment&gt;</span>
    <span class="nt">&lt;/environments&gt;</span>

<span class="c">&lt;!--    这里是将你接口的配置文件(实现类)注册一下,你不过就是个xml文件吗,在里面就想使用人家的命令,你不过来登记一下能随便用吗--&gt;</span>
    <span class="nt">&lt;mappers&gt;</span>
        <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;com/zhang/dao/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>environments是多环境的意思</p>
<ul>
<li>意思就是mybatis支持多环境配置,但一个SqlSessionFactory只能选择一种环境</li>
<li>你可以在environments标签中写多个environment,也就是配置多个环境,然后在environments中根据id设置默认的环境为哪一套(default=id)</li>
</ul>
</li>
<li>
<p>transactionManager是事务管理器</p>
<ul>
<li>
<p>在MyBatis中有两种事务管理器,即type=&rdquo;[JDBC|MANAGED]&quot;;</p>
</li>
<li>
<p>JDBC</p>
<blockquote>
<p>这个配置就是直接使用了JDBC的提交和回滚设置,它依赖于从数据源得到的连接来管理事务作用域</p>
</blockquote>
</li>
<li>
<p>MANAGED</p>
<blockquote>
<p>这个配置几乎没做什么,它从来不提交或回滚一个连接,而是让容器来管理事物的整个生命周期(比如JEE应用服务器的上下文)。默认情况下它会关闭连接,然而一些容器不希望这样,因此需将closeConnection属性设置为false来阻止它默认的关闭行为</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;MANAGED&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;closeConnection&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/transactionManager&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>如果使用Spring + MyBatis,则没有必要配置管理器,因为Spring会使用自带的管理器来覆盖当前的配置</p>
</li>
</ul>
</li>
<li>
<p>dataSource是数据源的意思</p>
<ul>
<li>在MyBatis中有三种数据源,分别是[UNPOOLED|POOLED|JNDL]</li>
</ul>
</li>
<li>
<p>MyBatis默认的<code>transactionManager</code>是JDBC,默认的dataSource是<code>POOLED</code></p>
</li>
<li>
<p>剩下的就是<code>&lt;properties&gt;</code>了</p>
</li>
<li>
<p>这叫做属性</p>
</li>
<li>
<p>在其他地方也可以看到它,例如SpringBoot中的yaml或者properties文件,还有就是在刚学习JDBC的时候一些网课老师都会讲</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
<span class="c">&lt;!--这里不要用SSL,程序会因为MySQL的验证方式和版本不兼容而报错的--&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;amp;characterEncoding=UTF-8&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;123456&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>这里我们在resource下(也就是和<code>mybatis-config.xml</code>文件同级目录)新建<code>db.properties</code>文件</p>
<p><code>db.properties</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">driver=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3306/mybatis?useUnicode=true&amp;characterEncoding=UTF-8
username=root
password=123456
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>PS:这里的url不需要写<code>&amp;amp;</code></p>
</blockquote>
</li>
<li>
<p>然后在<code>mybatis-config.xml</code>中通过properties标签导入外部静态资源</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">    PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">    &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;db.properties&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driver}&#34;</span><span class="nt">/&gt;</span>
            <span class="c">&lt;!--                这里不要用SSL,程序会因为MySQL的验证方式和版本不兼容而报错的--&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${url}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
<span class="nt">&lt;/environments&gt;</span>
  
<span class="c">&lt;!--    这里是将你接口的配置文件(实现类)注册一下,你不过就是个xml文件吗,在里面就想使用人家的命令,你不过来登记一下能随便用吗--&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;com/zhang/dao/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>一样可以运行</p>
</li>
</ul>
<h1 id="step6配置之别名优化给实体类起别名避免写全类名">Step6.配置之别名优化(给实体类起别名避免写全类名)</h1>
<h2 id="第一种方式通过typealiases标签给实体类起别名">第一种方式,通过<code>&lt;typeAliases&gt;</code>标签给实体类起别名</h2>
<p><code>mybatis-config.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">    PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">    &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;db.properties&#34;</span><span class="nt">/&gt;</span>

<span class="nt">&lt;typeAliases&gt;</span>
    <span class="nt">&lt;typeAlias</span> <span class="na">type=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span> <span class="na">alias=</span><span class="s">&#34;User&#34;</span><span class="nt">&gt;&lt;/typeAlias&gt;</span>
<span class="nt">&lt;/typeAliases&gt;</span>

<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driver}&#34;</span><span class="nt">/&gt;</span>
            <span class="c">&lt;!--                这里不要用SSL,程序会因为MySQL的验证方式和版本不兼容而报错的--&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${url}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
<span class="nt">&lt;/environments&gt;</span>

<span class="c">&lt;!--    这里是将你接口的配置文件(实现类)注册一下,你不过就是个xml文件吗,在里面就想使用人家的命令,你不过来登记一下能随便用吗--&gt;</span>
<span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;com/zhang/dao/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p>然后在<code>UserMaper.xml</code>中的任何<code>com.zhang.pojo.User</code>都可以替换成<code>User</code></p>
<h2 id="第二种方式搜索包下的类通过注解给实体类起别名">第二种方式,搜索包下的类,通过注解给实体类起别名</h2>
<ul>
<li>搜索包下的所有类,在其他文件中使用包下的类的时候就不需要写全类名了</li>
</ul>
<p><code>mybatis-config.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;typeAliases&gt;</span>
	<span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.zhang.pojo&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/typeAliases&gt;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>User.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   User
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">org.apache.ibatis.type.Alias</span><span class="o">;</span>

<span class="nd">@Alias</span><span class="o">(</span><span class="s">&#34;hello&#34;</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">pwd</span><span class="o">;</span>
    <span class="c1">//...此处略去一万字
</span><span class="c1"></span><span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>然后就可以在<code>UserMapper.xml</code>中将任意的<code>com.zhang.pojo.User</code>替换成<code>hello</code></li>
<li>MyBatis会自动在指定的包下寻找注解中值wei<code>hello</code>的实体类</li>
<li>其实就是通过<code>typeAliases</code>和<code>package</code>找到类所在的路径</li>
<li>然后找到有<code>@Alias</code>注解的实体类,给这个实体类赋予别名为注解中的值</li>
</ul>
<h1 id="step7配置之映射器说明">Step7.配置之映射器说明</h1>
<ul>
<li>
<p>第一种方式,注册绑定我们的mapper文件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;mappers&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">resource=</span><span class="s">&#34;com/zhang/dao/UserMapper.xml&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>第二种方式,使用映射器接口实现类的完全限定类名</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;mappers&gt;</span>
  <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.zhang.dao.UserMapper&#34;</span><span class="nt">&gt;&lt;/mapper&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>这种方式有两点需要注意:</code></p>
<blockquote>
<p>dao层接口名和实现类的xml文件名必须相同</p>
</blockquote>
<blockquote>
<p>接口和实现类必须在同一目录下</p>
</blockquote>
</li>
<li>
<p>第三种,使用扫描包进行注入绑定</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.zhang.dao&#34;</span><span class="nt">&gt;&lt;/package&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="step8生命周期和作用域">Step8.生命周期和作用域</h1>
<ul>
<li>
<p>生命周期和作用域是至关重要的,错误地使用会导致严重的并发</p>
<p><img src="https://img-blog.csdnimg.cn/20211010201517217.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>这是目前MyBatis项目的运行模式</p>
</li>
<li>
<p>SqlSessionFactoryBuilder</p>
<blockquote>
<p>一旦创建了SqlSessionFactory就不再需要它了</p>
</blockquote>
<blockquote>
<p>局部变量</p>
</blockquote>
</li>
<li>
<p>SqlSessionFactory</p>
<blockquote>
<p>可以想象成:数据库连接池</p>
</blockquote>
<blockquote>
<p>SqlSessionFactory一旦被创建就一直应该存在,没有任何理由丢弃它或者重新创建一个实例</p>
</blockquote>
<ul>
<li>工厂吗,你得不断往外提供货物</li>
</ul>
<blockquote>
<p>最简单的就是使用单例模式或者静态单例模式</p>
</blockquote>
</li>
<li>
<p>SqlSession</p>
<blockquote>
<p>连接到连接池的一个请求</p>
</blockquote>
<blockquote>
<p>SeqSession的实例不是线程安全的,因此是不能被共享的,所以它的最佳作用域是请求或方法作用域</p>
</blockquote>
<blockquote>
<p>用完之后赶紧关闭,避免占用资源</p>
</blockquote>
</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/20211010203544723.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<h1 id="step9resultset结果集映射">Step9.ResultSet结果集映射</h1>
<ul>
<li>
<p>新建一个项目,然后测试一下如果可以跑</p>
</li>
<li>
<p>将<code>User.java</code>中的<code>pwd</code>改成<code>password</code></p>
</li>
<li>
<p>再次运行</p>
</li>
<li>
<p>结果如下:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">User{id=2, name=&#39;张1111111111&#39;, password=&#39;null&#39;}
User{id=3, name=&#39;zhangchangquan&#39;, password=&#39;null&#39;}
User{id=5, name=&#39;张3&#39;, password=&#39;null&#39;}
User{id=6, name=&#39;张6&#39;, password=&#39;null&#39;}
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>因为在<code>UserMapper.xml</code>实现类中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.UserMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserList&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
        select  * from mybatis.user
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>获取结果后配置文件会寻找resultType,也就是User,你数据库字段名和类的名称不匹配,赋值操作就会出问题</p>
</li>
<li>
<p>所以为了解决这种问题,使用ResultSet配置类</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.UserMapper&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--    &lt;select id=&#34;getUserList&#34; resultType=&#34;hello&#34;&gt;--&gt;</span>
<span class="c">&lt;!--        select  * from mybatis.user--&gt;</span>
<span class="c">&lt;!--    &lt;/select&gt;--&gt;</span>
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;UserMap&#34;</span> <span class="na">type=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;name&#34;</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;pwd&#34;</span> <span class="na">property=</span><span class="s">&#34;password&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserList&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;UserMap&#34;</span><span class="nt">&gt;</span>
        select  * from mybatis.user
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>在<code>&lt;select&gt;</code>中不是resultType了,而是resultMap,之后跳转到<code>&lt;resultMap&gt;</code>中</p>
</blockquote>
<blockquote>
<p><code>&lt;select&gt;</code>和<code>&lt;resultMap&gt;</code>是两个独立的标签,但你可以给<code>&lt;select&gt;</code>设置<code>id</code>属性,从而使得<code>&lt;select&gt;</code>和<code>&lt;resultMap&gt;</code>可以连接起来</p>
</blockquote>
<blockquote>
<p>在resultMap中将数据库中的字段名映射成实体类中的属性名</p>
</blockquote>
<blockquote>
<p>column是数据库字段名,property是实体类名</p>
</blockquote>
</li>
</ul>
<h1 id="step10日志工厂">Step10.日志工厂</h1>
<ul>
<li>
<p>日志,就是封装运行结果</p>
</li>
<li>
<p>在<code>UserMapping.java</code>中加上</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;settings&gt;</span>
  <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;STDOUT_LOGGING&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/settings&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>运行结果中就会出现更多的运行参数</p>
</li>
</ul>
<h1 id="step11limit实现分页">Step11.Limit实现分页</h1>
<ul>
<li>
<p>其实就是用<code>select * from user limit 0,3</code>这玩应</p>
</li>
<li>
<p>其他操作还是MyBatis</p>
</li>
<li>
<p>只是你想不想映射了</p>
<p><code>UserMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserDao
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserList</span><span class="o">();</span>
  
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserListLimit</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>UserMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.UserMapper&#34;</span><span class="nt">&gt;</span>
  
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;UserMap&#34;</span> <span class="na">type=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;name&#34;</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;pwd&#34;</span> <span class="na">property=</span><span class="s">&#34;password&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
  
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserListLimit&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;UserMap&#34;</span><span class="nt">&gt;</span>
        select * from user limit #{startid},#{endid}
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>UserDaoTest.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserDaoTest
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.dao.UserMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoTest</span> <span class="o">{</span>
  
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  
        <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;startid&#34;</span><span class="o">,</span><span class="n">0</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;endid&#34;</span><span class="o">,</span><span class="n">3</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getUserListLimit</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
  
        <span class="k">for</span><span class="o">(</span><span class="n">User</span> <span class="n">value</span> <span class="o">:</span> <span class="n">items</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
        <span class="o">}</span>
  
        <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="step12rowbounds实现分页">Step12.RowBounds实现分页</h1>
<ul>
<li>
<p>RowBounds是一种比较老的分页模式,它在<code>Test</code>中还使用<code>sqlSession.selectList</code></p>
<p><code>UserMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
  
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.UserMapper&#34;</span><span class="nt">&gt;</span>
  
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;UserMap&#34;</span> <span class="na">type=</span><span class="s">&#34;com.zhang.pojo.User&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;name&#34;</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;pwd&#34;</span> <span class="na">property=</span><span class="s">&#34;password&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
  
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserListLimit&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;UserMap&#34;</span><span class="nt">&gt;</span>
        select * from user limit #{startid},#{endid}
    <span class="nt">&lt;/select&gt;</span>
  
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getUserListRowBounds&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;UserMap&#34;</span><span class="nt">&gt;</span>
        select * from user
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>UserMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserDao
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserList</span><span class="o">();</span>
  
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserListLimit</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserListRowBounds</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>UserDaoTest.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserDaoTest
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.dao.UserMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.RowBounds</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserDaoTest</span> <span class="o">{</span>
  
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">test</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  
        <span class="n">HashMap</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;startid&#34;</span><span class="o">,</span><span class="n">0</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;endid&#34;</span><span class="o">,</span><span class="n">3</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">items</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getUserListLimit</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
  
        <span class="k">for</span><span class="o">(</span><span class="n">User</span> <span class="n">value</span> <span class="o">:</span> <span class="n">items</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">value</span><span class="o">);</span>
        <span class="o">}</span>
  
        <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
  
  
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getUserListRowBounds</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">RowBounds</span> <span class="n">rowBounds</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RowBounds</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">3</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">selectList</span><span class="o">(</span><span class="s">&#34;com.zhang.dao.UserMapper.getUserListRowBounds&#34;</span><span class="o">,</span><span class="kc">null</span><span class="o">,</span><span class="n">rowBounds</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span> <span class="o">:</span> <span class="n">userList</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>你需要做的只是new一个<code>RowBounds</code>,构造参数为指定的start和end,传到selectList中</p>
</blockquote>
</li>
<li>
<p>还有一种方式,就是<code>MybatisPageHelper</code>,目前作为了解,以防之后进公司用到</p>
<p><a href="https://pagehelper.github.io/">MyBatisPageHelper官网</a></p>
</li>
</ul>
<h1 id="step13注解开发">Step13.注解开发</h1>
<h2 id="接口的理解">接口的理解</h2>
<ul>
<li>==接口==最主要的作用就是``解耦```</li>
</ul>
<h2 id="使用注解">使用注解</h2>
<ul>
<li>
<p>在MyBatis中有两种方式配置Mapper</p>
</li>
<li>
<p>一种是==通过xml文件==实现接口</p>
</li>
<li>
<p>一种是通过注解==@Select==等</p>
</li>
<li>
<p>这里使用注解来代替==UserMapper.java==</p>
</li>
<li>
<p>删除<code>UserMapper.xml</code></p>
</li>
<li>
<p>修改<code>UserMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserDao
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Select</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">UserMapper</span> <span class="o">{</span>
    <span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from user&#34;</span><span class="o">)</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="nf">getUserList</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在<code>mybatis-config.xml</code>中修改配置为直接注册到==接口类==</p>
<p><code>mybatis-config.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">    PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">    &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;db.properties&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;settings&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;STDOUT_LOGGING&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>
    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.zhang.pojo&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>
<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driver}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${url}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
<span class="nt">&lt;/environments&gt;</span>
  
<span class="nt">&lt;mappers&gt;</span>
<span class="c">&lt;!--    &lt;mapper resource=&#34;com/zhang/dao/UserMapper.xml&#34;/&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;mapper class=&#34;com.zhang.dao.UserMapper&#34;&gt;&lt;/mapper&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;package name=&#34;com.zhang.dao&#34;&gt;&lt;/package&gt;--&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.zhang.dao.UserMapper&#34;</span><span class="nt">&gt;&lt;/mapper&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>最后编写<code>Test</code></p>
<p><code>UserMapperTest</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserMapperTest
</span><span class="cm"> * @Time     :   2021/10/14
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.dao.UserMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserMapperTest</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getUserList</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">UserMapper</span> <span class="n">userMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">UserMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">User</span><span class="o">&gt;</span> <span class="n">userList</span> <span class="o">=</span> <span class="n">userMapper</span><span class="o">.</span><span class="na">getUserList</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">User</span> <span class="n">user</span> <span class="o">:</span> <span class="n">userList</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="step14使用lombok">Step14.使用Lombok</h1>
<ul>
<li>
<p>Lombok就是用来给实体类生成get、set、有参无参构造以及hashCode、toString等等这些方法</p>
</li>
<li>
<p>通过==注解==的形式使用</p>
</li>
<li>
<p>需要在导入==lombok==的依赖</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>1.18.12<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>最好是在编译器中下载插件</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">@Data:自动生成无参构造器、get、set、toString方法
@AllArgsConstructor:自动生成有参构造
不过生成有参构造器后无参构造器也就没了,因为@Data只能创建隐式的无参构造器,一旦存在有参构造器,无参构造器会被覆盖
所以还需要
@NoArgsConstructor:显式生成无参构造器
@Getter:自动生成所有成员变量的get方法
@Setter:自动生成所有成员变量的set方法
@EqualsAndHashCode:生成equals、canEquals以及hashcode这样的方法
@ToString:生成toString方法
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="step15复杂查询环境搭建">Step15.复杂查询环境搭建</h1>
<h2 id="创建数据库">创建数据库</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">use</span> <span class="n">mybatis</span><span class="p">;</span>

<span class="k">create</span> <span class="k">table</span> <span class="nf">teacher</span><span class="p">(</span>
    <span class="n">id</span> <span class="kt">int</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span><span class="p">,</span>
    <span class="n">name</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">default</span> <span class="no">null</span><span class="p">,</span>
    <span class="k">primary</span> <span class="k">key</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">)</span><span class="kp">engine</span><span class="o">=</span><span class="n">innodb</span> <span class="k">default</span> <span class="kp">charset</span><span class="o">=</span><span class="n">utf8</span><span class="p">;</span>
<span class="k">insert</span> <span class="k">into</span> <span class="nf">teacher</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;张老师&#39;</span><span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="nf">student</span><span class="p">(</span>
    <span class="n">id</span> <span class="kt">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">NOT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="n">name</span> <span class="kt">VARCHAR</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="n">tid</span> <span class="kt">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span><span class="p">,</span>
    <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">),</span>
    <span class="k">KEY</span> <span class="nf">fktid</span> <span class="p">(</span><span class="n">tid</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">fktid</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">tid</span><span class="p">)</span> <span class="k">REFERENCES</span> <span class="nf">teacher</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">)</span><span class="kp">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">UTF8</span><span class="p">;</span>

<span class="k">insert</span> <span class="k">into</span> <span class="nf">student</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">tid</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;小张&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="k">insert</span> <span class="k">into</span> <span class="nf">student</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">tid</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;小王&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="k">insert</span> <span class="k">into</span> <span class="nf">student</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">tid</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;小李&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="k">insert</span> <span class="k">into</span> <span class="nf">student</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">tid</span><span class="p">)</span> <span class="k">values</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;小赵&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>这里涉及到定义外键的概念</p>
<blockquote>
<p>外键的定义</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="n">tid</span> <span class="kt">INT</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="k">DEFAULT</span> <span class="no">NULL</span>
<span class="k">CONSTRAINT</span> <span class="n">testid</span> <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="n">tid</span> <span class="k">REFERENCES</span> <span class="nf">teacher</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>其中,tid是需要定义出来的一个用于表示自身键的字段,也叫从键</p>
</blockquote>
<blockquote>
<p>references + 主键表名 + 主键</p>
</blockquote>
</li>
</ul>
<h2 id="项目准备">项目准备</h2>
<ul>
<li>
<p>创建一个新的Maven模块</p>
</li>
<li>
<p>创建dao层、pojo层和util层</p>
</li>
<li>
<p>创建<code>Student.java</code>、<code>Teacher.java</code>实体类</p>
<p><code>Student.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   Student
</span><span class="cm"> * @Time     :   2021/10/15
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
  
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Student</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Integer</span> <span class="n">tid</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Teacher.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   Teacher
</span><span class="cm"> * @Time     :   2021/10/15
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
  
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Teacher</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建<code>TeacherMapper.java</code>、<code>StudentMapper.java</code>接口</p>
<p><code>TeacherMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   TeacherMapper
</span><span class="cm"> * @Time     :   2021/10/15
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Select</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TeacherMapper</span> <span class="o">{</span>
    <span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from teacher where id=#{tid}&#34;</span><span class="o">)</span>
    <span class="n">Teacher</span> <span class="nf">getTeacher</span><span class="o">(</span><span class="nd">@Param</span><span class="o">(</span><span class="s">&#34;tid&#34;</span><span class="o">)</span> <span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>StudentMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   StudentMapper
</span><span class="cm"> * @Time     :   2021/10/15
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Select</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">StudentMapper</span> <span class="o">{</span>
  
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>复制原来的<code>MyBatisUtils.java</code>工具类、<code>db.properties</code>和<code>mybatis-config.xml</code></p>
<p><code>MybatisUtils.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.utils</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   MyBatisUtils
</span><span class="cm"> * @Time     :   2021/9/27
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">org.apache.ibatis.io.Resources</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisUtils</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">SqlSessionFactory</span> <span class="n">sqlSessionFactory</span><span class="o">;</span>
    <span class="kd">static</span><span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">resource</span> <span class="o">=</span> <span class="s">&#34;mybatis-config.xml&#34;</span><span class="o">;</span>
            <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">Resources</span><span class="o">.</span><span class="na">getResourceAsStream</span><span class="o">(</span><span class="n">resource</span><span class="o">);</span>
            <span class="n">sqlSessionFactory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SqlSessionFactoryBuilder</span><span class="o">().</span><span class="na">build</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
  
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">SqlSession</span> <span class="nf">getSqlSession</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">sqlSessionFactory</span><span class="o">.</span><span class="na">openSession</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>db.properties</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-pro" data-lang="pro"><span class="s">driver</span><span class="o">=</span><span class="s">com</span><span class="p">.</span><span class="s">mysql</span><span class="p">.</span><span class="s">jdbc</span><span class="p">.</span><span class="nv">Driver</span>
<span class="s">url</span><span class="o">=</span><span class="nn">jdbc</span><span class="p">:</span><span class="nn">mysql</span><span class="p">:</span><span class="o">//</span><span class="nn">localhost</span><span class="p">:</span><span class="mi">3306</span><span class="o">/</span><span class="s">mybatis?useUnicode</span><span class="o">=</span><span class="s">true&amp;characterEncoding</span><span class="o">=</span><span class="nv">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="s">username</span><span class="o">=</span><span class="s">root</span>
<span class="s">password</span><span class="o">=</span><span class="mi">123456</span>
</code></pre></td></tr></table>
</div>
</div><p><code>mybatis-config.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">    PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">    &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;db.properties&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;settings&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;STDOUT_LOGGING&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>
    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.zhang.pojo&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>
<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driver}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${url}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
<span class="nt">&lt;/environments&gt;</span>
  
<span class="nt">&lt;mappers&gt;</span>
<span class="c">&lt;!--    &lt;mapper resource=&#34;com/zhang/dao/UserMapper.xml&#34;/&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;mapper class=&#34;com.zhang.dao.UserMapper&#34;&gt;&lt;/mapper&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;package name=&#34;com.zhang.dao&#34;&gt;&lt;/package&gt;--&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.zhang.dao.TeacherMapper&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.zhang.dao.StudentMapper&#34;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在resource目录下创建com.zhang.Mapper</p>
</li>
<li>
<p>实现<code>StudentMapper.java</code>和<code>TeacherMapper.java</code></p>
<p><code>StudentMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.StudentMapper&#34;</span><span class="nt">&gt;</span>
  
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>TeacherMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.TeacherMapper&#34;</span><span class="nt">&gt;</span>
  
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这里注意:==DOCTYPE==指的是文档类型,如果是实现接口就要写mapper</p>
<p>否则可能是核心配置文件==configuration==等</p>
</blockquote>
<blockquote>
<p>而且最后面那个链接也要写成==mybatis-3-mapper.dtd==</p>
<p>mapper的工作空间就是要实现的接口</p>
</blockquote>
</li>
<li>
<p>最后一步,在==mybatis-config.xml==中配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">    PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">    &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;db.properties&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;settings&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;STDOUT_LOGGING&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>
    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.zhang.pojo&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>
<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driver}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${url}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
<span class="nt">&lt;/environments&gt;</span>
  
<span class="nt">&lt;mappers&gt;</span>
<span class="c">&lt;!--    &lt;mapper resource=&#34;com/zhang/dao/UserMapper.xml&#34;/&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;mapper class=&#34;com.zhang.dao.UserMapper&#34;&gt;&lt;/mapper&gt;--&gt;</span>
<span class="c">&lt;!--    &lt;package name=&#34;com.zhang.dao&#34;&gt;&lt;/package&gt;--&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.zhang.dao.TeacherMapper&#34;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.zhang.dao.StudentMapper&#34;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>不知道为啥,突然要在mapper中配置接口而不是==xml实现类==</p>
</blockquote>
</li>
<li>
<p>最后进行测试</p>
<p><code>TestDao.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.Mapper</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   TestDao
</span><span class="cm"> * @Time     :   2021/10/15
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.dao.TeacherMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDao</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">TeacherMapper</span> <span class="n">mapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">Teacher</span> <span class="n">teacher</span> <span class="o">=</span> <span class="n">mapper</span><span class="o">.</span><span class="na">getTeacher</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher</span><span class="o">);</span>
        <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="多对一的处理">多对一的处理</h2>
<ul>
<li>
<p>第一种方式,通过查询来处理</p>
<p><code>StudentMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   StudentMapper
</span><span class="cm"> * @Time     :   2021/10/15
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Student</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Param</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.annotations.Select</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">StudentMapper</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="nf">getStudent</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>StudentMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.StudentMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getStudent&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;StudentTeacher&#34;</span><span class="nt">&gt;</span>
        select * from student
    <span class="nt">&lt;/select&gt;</span>
  
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;StudentTeacher&#34;</span> <span class="na">type=</span><span class="s">&#34;Student&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;name&#34;</span> <span class="nt">/&gt;</span>
  
        <span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">&#34;teacher&#34;</span> <span class="na">column=</span><span class="s">&#34;tid&#34;</span> <span class="na">javaType=</span><span class="s">&#34;Teacher&#34;</span> <span class="na">select=</span><span class="s">&#34;getTeacher&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
  
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacher&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
        select * from teacher where id = #{id}
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>association:对象用association</p>
<p>集合用collection</p>
<p>property指的是对象名(要和实体类中定义的相同),column也是映射的名称,javaType是对象类型,select是选择映射哪个select的结果集(获取select返回的结果映射成对象)</p>
</blockquote>
</li>
<li>
<p>第二种方式,通过嵌套查询处理</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.StudentMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getStudent&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;StudentTeacher&#34;</span><span class="nt">&gt;</span>
        select s.id sid,s.name sname,t.name tname from student s,teacher t where s.id = t.id
    <span class="nt">&lt;/select&gt;</span>
      
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;StudentTeacher&#34;</span> <span class="na">type=</span><span class="s">&#34;Student&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;sid&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;sname&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;association</span> <span class="na">property=</span><span class="s">&#34;teacher&#34;</span> <span class="na">javaType=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;tname&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/association&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="一对多的处理">一对多的处理</h2>
<ul>
<li>
<p>这个我搞了半天,就是报错,原因就是我把resource下的<code>com.zhang.code</code>一个一个建的,又重新手动输入了一下<code>mybatis-config.xml</code>中的<code>mapper-class</code></p>
<p><code>Teacher.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   TeacherMapper
</span><span class="cm"> * @Time     :   2021/10/15
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Teacher</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">TeacherMapper</span> <span class="o">{</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Teacher</span><span class="o">&gt;</span> <span class="nf">getTeacher</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Student.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   Student
</span><span class="cm"> * @Time     :   2021/10/17
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
  
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Student</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">tid</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Teacher.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   Teacher
</span><span class="cm"> * @Time     :   2021/10/17
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
  
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Teacher</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Student</span><span class="o">&gt;</span> <span class="n">students</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>Teacher.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.TeacherMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacher&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
        select * from mybatis.teacher
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>UserMapperTest.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   UserMapperTest
</span><span class="cm"> * @Time     :   2021/10/17
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.dao.TeacherMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Teacher</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UserMapperTest</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getTeacher</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Teacher</span> <span class="n">teacher</span> <span class="o">:</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">TeacherMapper</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getTeacher</span><span class="o">()){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">teacher</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>一样,这个的student还是为空,仍然需要映射</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.TeacherMapper&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--    &lt;select id=&#34;getTeacher&#34; resultType=&#34;Teacher&#34;&gt;--&gt;</span>
<span class="c">&lt;!--        select * from mybatis.teacher--&gt;</span>
<span class="c">&lt;!--    &lt;/select&gt;--&gt;</span>
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;TeacherStudent&#34;</span> <span class="na">type=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;tid&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;tname&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;students&#34;</span> <span class="na">ofType=</span><span class="s">&#34;Student&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;sid&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;sname&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;tid&#34;</span> <span class="na">column=</span><span class="s">&#34;tid&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/collection&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacher&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;TeacherStudent&#34;</span><span class="nt">&gt;</span>
        select s.id sid,s.name sname,t.name tname from student s,teacher t where s.tid = t.id and t.id = #{tid}
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>collection处理集合,property是实体类中的字段名称,column是将字段名称映射成该值</p>
</li>
<li>
<p>ofType是集合中泛型的约束</p>
</li>
<li>
<p>上面这是一种方式</p>
</li>
<li>
<p>还有一种方式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.TeacherMapper&#34;</span><span class="nt">&gt;</span>
<span class="c">&lt;!--    &lt;select id=&#34;getTeacher&#34; resultType=&#34;Teacher&#34;&gt;--&gt;</span>
<span class="c">&lt;!--        select * from mybatis.teacher--&gt;</span>
<span class="c">&lt;!--    &lt;/select&gt;--&gt;</span>
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;TeacherStudent&#34;</span> <span class="na">type=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;tid&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;tname&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;students&#34;</span> <span class="na">ofType=</span><span class="s">&#34;Student&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span> <span class="na">column=</span><span class="s">&#34;sid&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span> <span class="na">column=</span><span class="s">&#34;sname&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;result</span> <span class="na">property=</span><span class="s">&#34;tid&#34;</span> <span class="na">column=</span><span class="s">&#34;tid&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/collection&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacher&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;TeacherStudent&#34;</span><span class="nt">&gt;</span>
        select s.id sid,s.name sname,t.name tname from student s,teacher t where s.tid = t.id and t.id = #{tid}
    <span class="nt">&lt;/select&gt;</span>
    
<span class="c">&lt;!--    &lt;======================================================&gt;--&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getTeacher2&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;TeacherStudent2&#34;</span><span class="nt">&gt;</span>
        select * from teacher where id = #{tid}
    <span class="nt">&lt;/select&gt;</span>
    <span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;TeacherStudent2&#34;</span> <span class="na">type=</span><span class="s">&#34;Teacher&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;students&#34;</span> <span class="na">javaType=</span><span class="s">&#34;ArrayList&#34;</span> <span class="na">ofType=</span><span class="s">&#34;Student&#34;</span> <span class="na">select=</span><span class="s">&#34;getStudent2&#34;</span> <span class="na">column=</span><span class="s">&#34;id&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/resultMap&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getStudent2&#34;</span> <span class="na">resultType=</span><span class="s">&#34;Student&#34;</span><span class="nt">&gt;</span>
        select * from student where tid = #{tid}
    <span class="nt">&lt;/select&gt;</span>
    
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>将getTeacher2中的获取结果映射到Teacher中,然后再通过collection获取getStudent2中获取到的所有学生信息也映射到Teacher中</p>
</blockquote>
<blockquote>
<p>property是Teacher中学生集合的属性名,javaType是集合类型,offType是集合中泛型,select是获取某个<code>&lt;select&gt;</code>标签的查询结果,column是将映射的<code>select</code>语句中的参数传递给获取的<code>select</code>标签</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h1 id="step16动态sql处理环境配置">Step16.动态SQL处理环境配置</h1>
<ul>
<li>
<p>创建一个新的项目</p>
</li>
<li>
<p>复制<code>MyBatisUtils.java</code>、<code>db.properties</code>和<code>mybatis-config.xml</code></p>
</li>
<li>
<p>创建<code>IDUtils.java</code></p>
<p><code>IDUtils.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.utils</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   IDUtils
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">java.util.UUID</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IDUtils</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getId</span><span class="o">(){</span>
        <span class="k">return</span> <span class="n">UUID</span><span class="o">.</span><span class="na">randomUUID</span><span class="o">().</span><span class="na">toString</span><span class="o">().</span><span class="na">replaceAll</span><span class="o">(</span><span class="s">&#34;-&#34;</span><span class="o">,</span><span class="s">&#34;.&#34;</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>TestMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">IDUtilsTest</span><span class="o">(){</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建数据表</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-mysql" data-lang="mysql"><span class="k">create</span> <span class="k">table</span> <span class="nf">blog</span><span class="p">(</span>
    <span class="n">id</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span> <span class="n">comment</span> <span class="s1">&#39;博客id&#39;</span><span class="p">,</span>
    <span class="n">title</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span> <span class="n">comment</span> <span class="s1">&#39;博客标题&#39;</span><span class="p">,</span>
    <span class="n">author</span> <span class="kt">varchar</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span> <span class="k">not</span> <span class="no">null</span> <span class="n">comment</span> <span class="s1">&#39;博客作者&#39;</span><span class="p">,</span>
    <span class="n">create_time</span> <span class="kt">datetime</span> <span class="k">not</span> <span class="no">null</span> <span class="n">comment</span> <span class="s1">&#39;创建时间&#39;</span><span class="p">,</span>
    <span class="n">views</span> <span class="kt">int</span> <span class="k">not</span> <span class="no">null</span> <span class="n">comment</span> <span class="s1">&#39;浏览量&#39;</span>
<span class="p">)</span><span class="kp">ENGINE</span><span class="o">=</span><span class="n">INNODB</span> <span class="k">DEFAULT</span> <span class="kp">CHARSET</span><span class="o">=</span><span class="n">UTF8</span><span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建pojo层</p>
<p><code>Blog.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   Blog
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
  
<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Blog</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">id</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">author</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">Date</span> <span class="n">createTime</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">views</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>创建dao层</p>
<p><code>BlogMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   BlogMapper
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Blog</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">BlogMapper</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">addBlog</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在resource下新建com/zhang/dao</p>
<p><code>BlogMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.BlogMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;addBlog&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
        insert into blog (id,title,author,create_time,views) values
        (#{id},#{title},#{author},#{createTime},#{views})
    <span class="nt">&lt;/insert&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置<code>mybatis-config.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE configuration
</span><span class="cp">    PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">    &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
<span class="nt">&lt;configuration&gt;</span>
<span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;db.properties&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;settings&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;STDOUT_LOGGING&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;mapUnderscoreToCamelCase&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/settings&gt;</span>
  
    <span class="nt">&lt;typeAliases&gt;</span>
        <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;com.zhang.pojo&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/typeAliases&gt;</span>
<span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driver}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${url}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/dataSource&gt;</span>
    <span class="nt">&lt;/environment&gt;</span>
<span class="nt">&lt;/environments&gt;</span>
  
<span class="nt">&lt;mappers&gt;</span>
    <span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.zhang.dao.BlogMapper&#34;</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/mappers&gt;</span>
<span class="nt">&lt;/configuration&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>日志工厂</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;STDOUT_LOGGING&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>支持映射实体类驼峰式命名规则</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;mapUnderscoreToCamelCase&#34;</span> <span class="na">value=</span><span class="s">true/</span><span class="nt">&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>将<code>BlogMapper.java</code>和<code>BlogMapper.xml</code>关联</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;mapper</span> <span class="na">class=</span><span class="s">&#34;com.zhang.dao.BlogMapper&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>最后测试</p>
<blockquote>
<p>注意这里直接通过构造器创建对象会报错,我也不知道为什么</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   TestMapper
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">com.zhang.dao.BlogMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Blog</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.IDUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
  
<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestMapper</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">IDUtilsTest</span><span class="o">(){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="o">}</span>
  
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addBlog</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
  
        <span class="n">Blog</span> <span class="n">blog1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&#34;1&#34;</span><span class="o">);</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Java&#34;</span><span class="o">);</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">100000</span><span class="o">);</span>
  
        <span class="n">Blog</span> <span class="n">blog2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&#34;2&#34;</span><span class="o">);</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Python&#34;</span><span class="o">);</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">100</span><span class="o">));</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">10000000</span><span class="o">);</span>
  
        <span class="n">Blog</span> <span class="n">blog3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&#34;3&#34;</span><span class="o">);</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;GoLang&#34;</span><span class="o">);</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">100000</span><span class="o">));</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">20000000</span><span class="o">);</span>
  
        <span class="n">Blog</span> <span class="n">blog4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="s">&#34;4&#34;</span><span class="o">);</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Spark&#34;</span><span class="o">);</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">10000000</span><span class="o">);</span>
  
  
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog1</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog2</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog3</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog4</span><span class="o">);</span>
  
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="step17动态sql之if语句">Step17.动态SQL之IF语句</h1>
<p><code>BlogMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   BlogMapper
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">com.zhang.pojo.Blog</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">BlogMapper</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">addBlog</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlogByIf</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>BlogMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.BlogMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;addBlog&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
        insert into blog (id,title,author,create_time,views) values
        (#{id},#{title},#{author},#{createTime},#{views})
    <span class="nt">&lt;/insert&gt;</span>

    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlogByIf&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
        select * from blog where 1=1
        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
            and title = #{title}
        <span class="nt">&lt;/if&gt;</span>

        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
            and author = #{author}
        <span class="nt">&lt;/if&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>TestMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   TestMapper
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">com.zhang.dao.BlogMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Blog</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.IDUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestMapper</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">IDUtilsTest</span><span class="o">(){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addBlog</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">Blog</span> <span class="n">blog1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Java&#34;</span><span class="o">);</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>

        <span class="n">Blog</span> <span class="n">blog2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Python&#34;</span><span class="o">);</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">100</span><span class="o">));</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>

        <span class="n">Blog</span> <span class="n">blog3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">100000</span><span class="o">));</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">2000</span><span class="o">);</span>

        <span class="n">Blog</span> <span class="n">blog4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Spark&#34;</span><span class="o">);</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>


        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog1</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog2</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog3</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog4</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getBlogByIf</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;Java&#34;</span><span class="o">,</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="n">blogList</span> <span class="o">=</span> <span class="n">blogMapper</span><span class="o">.</span><span class="na">getBlogByIf</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>

        <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogList</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p>==现在面临的问题就是,第一个addBlog无法添加到数据库==</p>
<h1 id="step18动态sql语句之sql语句的拼接">Step18.动态SQL语句之SQL语句的拼接</h1>
<ul>
<li>
<p>SQL语句在XML配置文件中可以使用when、if、choose等多个标签进行拼接,实现动态SQL语句</p>
<p><code>BlogMapper.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.BlogMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;insert</span> <span class="na">id=</span><span class="s">&#34;addBlog&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
        insert into mybatis.blog (id,title,author,create_time,views) values
        (#{id},#{title},#{author},#{createTime},#{views})
    <span class="nt">&lt;/insert&gt;</span>
  
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlogByIf&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
        select * from blog where 1=1
        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
            and title = #{title}
        <span class="nt">&lt;/if&gt;</span>
  
        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
            and author = #{author}
        <span class="nt">&lt;/if&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
  
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlogByChoose1&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
        select * from blog
        <span class="nt">&lt;where&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
                title = #{title}
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
                author = #{author}
            <span class="nt">&lt;/if&gt;</span>
        <span class="nt">&lt;/where&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
  
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlogByChoose2&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
        select * from mybatis.blog
        <span class="nt">&lt;where&gt;</span>
            <span class="nt">&lt;choose&gt;</span>
                <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;id != null&#34;</span><span class="nt">&gt;</span>id = #{id}<span class="nt">&lt;/when&gt;</span>
                <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>and title = #{title}<span class="nt">&lt;/when&gt;</span>
                <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>and author = #{author}<span class="nt">&lt;/when&gt;</span>
                <span class="nt">&lt;when</span> <span class="na">test=</span><span class="s">&#34;create_time != null&#34;</span><span class="nt">&gt;</span>and create_time = #{createTime}<span class="nt">&lt;/when&gt;</span>
                <span class="nt">&lt;otherwise&gt;</span>and views = #{views}<span class="nt">&lt;/otherwise&gt;</span>
            <span class="nt">&lt;/choose&gt;</span>
        <span class="nt">&lt;/where&gt;</span>
    <span class="nt">&lt;/select&gt;</span>
  
    <span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateBlog&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span><span class="nt">&gt;</span>
        update blog
        <span class="nt">&lt;set&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
                title = #{title},
            <span class="nt">&lt;/if&gt;</span>
            <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
                author = #{author}
            <span class="nt">&lt;/if&gt;</span>
        <span class="nt">&lt;/set&gt;</span>
        where id = #{id}
    <span class="nt">&lt;/update&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<p><code>BlogMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   BlogMapper
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">com.zhang.pojo.Blog</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">BlogMapper</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">addBlog</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlogByIf</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlogByChoose1</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlogByChoose2</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
    <span class="kt">void</span> <span class="nf">updateBlog</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>TestMapper.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   TestMapper
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">com.zhang.dao.BlogMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Blog</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.IDUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.HashMap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestMapper</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">IDUtilsTest</span><span class="o">(){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">addBlog</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">Blog</span> <span class="n">blog1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Java&#34;</span><span class="o">);</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">());</span>
        <span class="n">blog1</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>

        <span class="n">Blog</span> <span class="n">blog2</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Python&#34;</span><span class="o">);</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">100</span><span class="o">));</span>
        <span class="n">blog2</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">1000</span><span class="o">);</span>

        <span class="n">Blog</span> <span class="n">blog3</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">100000</span><span class="o">));</span>
        <span class="n">blog3</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">2000</span><span class="o">);</span>

        <span class="n">Blog</span> <span class="n">blog4</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Blog</span><span class="o">();</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setId</span><span class="o">(</span><span class="n">IDUtils</span><span class="o">.</span><span class="na">getId</span><span class="o">());</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="s">&#34;Spark&#34;</span><span class="o">);</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setAuthor</span><span class="o">(</span><span class="s">&#34;zhang&#34;</span><span class="o">);</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setCreateTime</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">(</span><span class="n">10</span><span class="o">));</span>
        <span class="n">blog4</span><span class="o">.</span><span class="na">setViews</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>


        <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog1</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog2</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog3</span><span class="o">);</span>
        <span class="n">blogMapper</span><span class="o">.</span><span class="na">addBlog</span><span class="o">(</span><span class="n">blog4</span><span class="o">);</span>

    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getBlogByIf</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;Java&#34;</span><span class="o">,</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="n">blogList</span> <span class="o">=</span> <span class="n">blogMapper</span><span class="o">.</span><span class="na">getBlogByIf</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>

        <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogList</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getBlogByChoose1</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;Java&#34;</span><span class="o">,</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="n">blogList</span> <span class="o">=</span> <span class="n">blogMapper</span><span class="o">.</span><span class="na">getBlogByChoose1</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>

        <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogList</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getBlogByChoose2</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">,</span><span class="s">&#34;a&#34;</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="n">blogList</span> <span class="o">=</span> <span class="n">blogMapper</span><span class="o">.</span><span class="na">getBlogByChoose2</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogList</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateBlog</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;title&#34;</span><span class="o">,</span><span class="s">&#34;Go&#34;</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;author&#34;</span><span class="o">,</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>
        <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">,</span><span class="s">&#34;a&#34;</span><span class="o">);</span>

        <span class="n">blogMapper</span><span class="o">.</span><span class="na">updateBlog</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>注意</p>
<ul>
<li>where-if语句中不要写and,写了也会被自动去除</li>
<li>where-choose-when语句中,除了首个when,其余的都要写and,包括otherwise</li>
<li>update-set-if语句中的if,除了最后一个if,其余的都要写逗号</li>
</ul>
</li>
</ul>
<h1 id="step19动态sql之foreach">Step19.动态SQL之forEach</h1>
<h2 id="提取公共语句">提取公共语句</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlogByIf&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
	select * from blog where 1=1
	<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
	    and title = #{title}
	<span class="nt">&lt;/if&gt;</span>

	<span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
	    and author = #{author}
	<span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;update</span> <span class="na">id=</span><span class="s">&#34;updateBlog&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span><span class="nt">&gt;</span>
    update blog
    <span class="nt">&lt;set&gt;</span>
        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
            title = #{title},
        <span class="nt">&lt;/if&gt;</span>
        <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
            author = #{author}
        <span class="nt">&lt;/if&gt;</span>
    <span class="nt">&lt;/set&gt;</span>
    where id = #{id}
<span class="nt">&lt;/update&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>要知道,这两个里面的代码是耦高度耦合的</li>
<li>可以像HTML一样,将公共部分提取出来</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;sql</span> <span class="na">id=</span><span class="s">&#34;if-title-author&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;title != null&#34;</span><span class="nt">&gt;</span>
        title = #{title}
    <span class="nt">&lt;/if&gt;</span>
    <span class="nt">&lt;if</span> <span class="na">test=</span><span class="s">&#34;author != null&#34;</span><span class="nt">&gt;</span>
        author = #{author}
    <span class="nt">&lt;/if&gt;</span>
<span class="nt">&lt;/sql&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>使用sql标签将公共部分代码包含起来,并为标签指定一个id</li>
<li>在其余代码中通过指定id调用这段代码</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlogByChoose1&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
    select * from blog
    <span class="nt">&lt;where&gt;</span>
       <span class="nt">&lt;include</span> <span class="na">refid=</span><span class="s">&#34;if-title-author&#34;</span><span class="nt">&gt;&lt;/include&gt;</span>
    <span class="nt">&lt;/where&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>只需要包含id就好了</p>
</blockquote>
<ul>
<li>还有就是forEach语句</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlogByForEach&#34;</span> <span class="na">parameterType=</span><span class="s">&#34;map&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
    select * from blog
    <span class="nt">&lt;where&gt;</span>
        <span class="nt">&lt;foreach</span> <span class="na">collection=</span><span class="s">&#34;ids&#34;</span> <span class="na">item=</span><span class="s">&#34;id&#34;</span> <span class="na">open=</span><span class="s">&#34;and (&#34;</span> <span class="na">close=</span><span class="s">&#34;)&#34;</span> <span class="na">separator=</span><span class="s">&#34;or&#34;</span><span class="nt">&gt;</span>
            id = #{id}
        <span class="nt">&lt;/foreach&gt;</span>
    <span class="nt">&lt;/where&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>collection是要遍历的集合,id是遍历过程中的单个元素,open是每个语句的开始,close是每次遍历语句的结束,separator是每次遍历语句的分隔符</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.dao</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   BlogMapper
</span><span class="cm"> * @Time     :   2021/10/19
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">com.zhang.pojo.Blog</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">interface</span> <span class="nc">BlogMapper</span> <span class="o">{</span>
    <span class="kt">void</span> <span class="nf">addBlog</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlogByIf</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlogByChoose1</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlogByChoose2</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
    <span class="kt">void</span> <span class="nf">updateBlog</span><span class="o">(</span><span class="n">Map</span> <span class="n">map</span><span class="o">);</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlogByForEach</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">map</span><span class="o">);</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getBlogByForEach</span><span class="o">(){</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
    <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">ids</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="n">ids</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;ids&#34;</span><span class="o">,</span><span class="n">ids</span><span class="o">);</span>
    <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogMapper</span><span class="o">.</span><span class="na">getBlogByForEach</span><span class="o">(</span><span class="n">map</span><span class="o">)){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>这里,如果想获取map的键,可以在forEach语句中通过index属性获取到,index就是传进forEach语句中map的key</li>
</ul>
<h1 id="step20缓存">Step20.缓存</h1>
<ul>
<li>
<p>访问数据库是这样的</p>
<p><img src="https://img-blog.csdnimg.cn/400a889a15544165b8d0a35ec8cd53bd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>缓存就是,因为我们对数据库的操作大部分都是查询,只有少部分的增删改。这就存在许多多次访问同样的数据的现象</p>
</li>
<li>
<p>所以需要在第一次访问数据库之后,将查询到的数据缓存到内存,以提升效率</p>
</li>
<li>
<p>之后再访问就直接进入cache中,内存的运行速度是非常快的</p>
<p><img src="https://img-blog.csdnimg.cn/6eafb38f30304f619f6d809259b0bec3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
</ul>
<h2 id="一级缓存">一级缓存</h2>
<ul>
<li>
<p>一级缓存只在这段代码范围内有效</p>
<blockquote>
<p>只在当前SqlSession范围内有效,一旦当前SqlSession关闭,一级缓存就死了</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/fe357cc6c8374510bd2f435b39b98df4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>SqlSession默认开启一级缓存</p>
</li>
<li>
<p>现在查询两次</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">getBlogByIf</span><span class="o">(){</span>
    <span class="n">SqlSession</span> <span class="n">sqlSession</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
    <span class="n">BlogMapper</span> <span class="n">blogMapper</span> <span class="o">=</span> <span class="n">sqlSession</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HashMap</span><span class="o">&lt;&gt;();</span>
    <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;Java&#34;</span><span class="o">,</span><span class="s">&#34;张宇航&#34;</span><span class="o">);</span>

	<span class="c1">// List&lt;Blog&gt; blogList = blogMapper.getBlogByIf(map);
</span><span class="c1"></span>
	<span class="c1">// for(Blog blog : blogList){
</span><span class="c1"></span>	<span class="c1">//     System.out.println(blog);
</span><span class="c1"></span>	<span class="c1">// }
</span><span class="c1"></span>
    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="n">blogList1</span> <span class="o">=</span> <span class="n">blogMapper</span><span class="o">.</span><span class="na">getBlogByIf</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>

    <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogList1</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="n">blogList2</span> <span class="o">=</span> <span class="n">blogMapper</span><span class="o">.</span><span class="na">getBlogByIf</span><span class="o">(</span><span class="n">map</span><span class="o">);</span>

    <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogList2</span><span class="o">){</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="n">sqlSession</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://img-blog.csdnimg.cn/71979f14f5864c0eb5faa4865420f531.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<ul>
<li>
<p>可以看到,SQL语句只执行了一次</p>
</li>
<li>
<p>现在手动清理一级缓存</p>
<p><img src="https://img-blog.csdnimg.cn/1d2e91141e2f4083923e95588ab5c0bc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>可以看到结果了</p>
</li>
</ul>
<h2 id="二级缓存">二级缓存</h2>
<ul>
<li>二级缓存的范围在namespace</li>
<li>当一级缓存死了(sqlSession.close();),那一级缓存就会将自身的缓存转存到二级缓存中</li>
<li>mybatis二级缓存默认关闭</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="nf">getBlog</span><span class="o">();</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlog&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span><span class="nt">&gt;</span>
	select * from blog
<span class="nt">&lt;/select&gt;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   TestDoubleCache
</span><span class="cm"> * @Time     :   2021/10/24
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>

<span class="kn">import</span> <span class="nn">com.zhang.dao.BlogMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.Blog</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.MyBatisUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">TestDoubleCache</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getBlog</span><span class="o">(){</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession1</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">SqlSession</span> <span class="n">sqlSession2</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSqlSession</span><span class="o">();</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper1</span> <span class="o">=</span> <span class="n">sqlSession1</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="n">BlogMapper</span> <span class="n">blogMapper2</span> <span class="o">=</span> <span class="n">sqlSession1</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">BlogMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="n">blogList1</span> <span class="o">=</span> <span class="n">blogMapper1</span><span class="o">.</span><span class="na">getBlog</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogList1</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">List</span><span class="o">&lt;</span><span class="n">Blog</span><span class="o">&gt;</span> <span class="n">blogList2</span> <span class="o">=</span> <span class="n">blogMapper1</span><span class="o">.</span><span class="na">getBlog</span><span class="o">();</span>
        <span class="k">for</span><span class="o">(</span><span class="n">Blog</span> <span class="n">blog</span> <span class="o">:</span> <span class="n">blogList2</span><span class="o">){</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">blog</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="n">sqlSession1</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="n">sqlSession2</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这样它还是会执行两次SQL语句</p>
</blockquote>
<ul>
<li>
<p>开启二级缓存</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;settings&gt;</span>
    <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;logImpl&#34;</span> <span class="na">value=</span><span class="s">&#34;STDOUT_LOGGING&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;mapUnderscoreToCamelCase&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/settings&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper
</span><span class="cp">        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span><span class="cp">        &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
<span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;com.zhang.dao.BlogMapper&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;cache/&gt;</span>
    <span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getBlog&#34;</span> <span class="na">resultType=</span><span class="s">&#34;com.zhang.pojo.Blog&#34;</span> <span class="na">useCache=</span><span class="s">&#34;true&#34;</span><span class="nt">&gt;</span>
        select * from blog
    <span class="nt">&lt;/select&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这样就会只执行一次SQL语句</p>
</blockquote>
<blockquote>
<p>因为第一个SqlSession执行完之后会将自身的一级缓存存储到二级缓存中</p>
</blockquote>
<blockquote>
<p>下一个SqlSession会自动到二级缓存中读取</p>
</blockquote>
<ul>
<li>
<p>cache还有一种版本</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;cache</span> <span class="na">eviction=</span><span class="s">&#34;FIFO&#34;</span>
       <span class="na">flushInterval=</span><span class="s">&#34;60000&#34;</span>
       <span class="na">size=</span><span class="s">&#34;512&#34;</span>
       <span class="na">readOnly=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这个更高级的配置设置了一个FIFO缓存,每隔60秒刷新一次,可储存的引用对象或者列表集合最多为512个,并且默认为只读,因此对其进行修改操作可能引发不同线程的异常</p>
</blockquote>
</li>
</ul>
<h1 id="step21mybatis的缓存机制">Step21.MyBatis的缓存机制</h1>
<p><img src="https://img-blog.csdnimg.cn/f84e33e4a50f4ecfb06954f51d6f4129.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<ul>
<li>第一次先连接数据库,第二次先进二级缓存中查找,再进一级缓存中查找,如果都没有就连接数据库</li>
<li>当一级缓存关闭的时候,SqlSession会将缓存转存到二级缓存中</li>
</ul>
<h1 id="step22自定义缓存ehcache">Step22.自定义缓存Ehcache</h1>
<ul>
<li>
<p>前面学的Mybatis是指可以存储在SqlSession和Mapper.xml中的</p>
</li>
<li>
<p>如果有更多需要,可以使用自定义缓存ehcache</p>
</li>
<li>
<p>在接口文件中配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;cache</span> <span class="na">type=</span><span class="s">&#34;org.mybatis.caches.ehcache.EhcacheCache&#34;</span><span class="nt">/&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>新建和mybatis-config.xml同级的<code>ehcache.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
<span class="nt">&lt;ehcache</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span class="na">xsi:noNamespaceSchemaLocation=</span><span class="s">&#34;http://ehcache.org/ehcache.xsd&#34;</span>
         <span class="na">updateCheck=</span><span class="s">&#34;false&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;diskStore</span> <span class="na">path=</span><span class="s">&#34;./tmpdir/Tmp_EhCache&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;defaultCache</span>
            <span class="na">eternal=</span><span class="s">&#34;false&#34;</span>
            <span class="na">maxElementsInMemory=</span><span class="s">&#34;10000&#34;</span>
            <span class="na">overflowToDisk=</span><span class="s">&#34;false&#34;</span>
            <span class="na">diskPersistent=</span><span class="s">&#34;false&#34;</span>
            <span class="na">timeToIdleSeconds=</span><span class="s">&#34;1800&#34;</span>
            <span class="na">timeToLiveSeconds=</span><span class="s">&#34;259200&#34;</span>
            <span class="na">memoryStoreEvictionPolicy=</span><span class="s">&#34;LRU&#34;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;cache</span>
            <span class="na">name=</span><span class="s">&#34;cloud_user&#34;</span>
            <span class="na">eternal=</span><span class="s">&#34;false&#34;</span>
            <span class="na">maxElementsInMemory=</span><span class="s">&#34;5000&#34;</span>
            <span class="na">overflowToDisk=</span><span class="s">&#34;false&#34;</span>
            <span class="na">diskPersistent=</span><span class="s">&#34;false&#34;</span>
            <span class="na">timeToIdleSeconds=</span><span class="s">&#34;1800&#34;</span>
            <span class="na">timeToLiveSeconds=</span><span class="s">&#34;1800&#34;</span>
            <span class="na">memoryStoreEvictionPolicy=</span><span class="s">&#34;LRU&#34;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ehcache&gt;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>随便运行程序</p>
</li>
</ul>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Zhang's Blog</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2021-08-15
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/java/">Java</a>
          <a href="/tags/database/">DataBase</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/mybatis%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E4%B8%80%E4%B9%8B-#-%E4%B8%8E-%E5%8C%BA%E5%88%AB%E4%BB%A5%E5%8F%8A-sql-%E9%A2%84%E7%BC%96%E8%AF%91/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">mybatis深入理解(一)之 # 与 $ 区别以及 sql 预编译</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/%E5%8D%8E%E4%B8%BA%E5%88%9B%E6%96%B0%E7%8F%ADpython%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
            <span class="next-text nav-default">华为创新班Python学习笔记</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://twitter.com/" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://www.facebook.com/" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://www.linkedin.com/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://www.google.com/" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/" class="iconfont icon-douban" title="douban"></a>
      <a href="https://getpocket.com/" class="iconfont icon-pocket" title="pocket"></a>
      <a href="https://www.tumblr.com/" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="https://www.instagram.com/" class="iconfont icon-instagram" title="instagram"></a>
      <a href="https://about.gitlab.com/" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="https://www.bilibili.com/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="http://localhost:1313/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://golang.org/">GoLang</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Author - 
    <a class="theme-link" href="https://space.bilibili.com/628950169/">Mr'zhang</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span>Zhang's Blog</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>








</body>
</html>
