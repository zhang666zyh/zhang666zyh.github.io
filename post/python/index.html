<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Python - Zhang&#39;s Blog的博客</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Zhang&#39;s Blog" /><meta name="description" content="Step01. 面向对象 1 2 3 4 5 6 7 8 9 10 11 class people: name = &amp;#34;zhangyuhang&amp;#34; age = 18 salary = 1000000000 def check(self): print(self.name) print(self.age) print(self.salary) myself = people() myself.check() Step02. Python生成自己的二维码 1 2 3 4 5 6 from MyQR import myqr myqr.run(words=&amp;#39;url&amp;#39;, picture=&amp;#39;LocalPath&amp;#39;, colorized=True, contrast=1.0) Step0" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.67.1 with theme even" />


<link rel="canonical" href="http://localhost:1313/post/python/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Python" />
<meta property="og:description" content="Step01. 面向对象 1 2 3 4 5 6 7 8 9 10 11 class people: name = &#34;zhangyuhang&#34; age = 18 salary = 1000000000 def check(self): print(self.name) print(self.age) print(self.salary) myself = people() myself.check() Step02. Python生成自己的二维码 1 2 3 4 5 6 from MyQR import myqr myqr.run(words=&#39;url&#39;, picture=&#39;LocalPath&#39;, colorized=True, contrast=1.0) Step0" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/python/" />
<meta property="article:published_time" content="2021-04-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-04-10T00:00:00+00:00" />
<meta itemprop="name" content="Python">
<meta itemprop="description" content="Step01. 面向对象 1 2 3 4 5 6 7 8 9 10 11 class people: name = &#34;zhangyuhang&#34; age = 18 salary = 1000000000 def check(self): print(self.name) print(self.age) print(self.salary) myself = people() myself.check() Step02. Python生成自己的二维码 1 2 3 4 5 6 from MyQR import myqr myqr.run(words=&#39;url&#39;, picture=&#39;LocalPath&#39;, colorized=True, contrast=1.0) Step0">
<meta itemprop="datePublished" content="2021-04-10T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-04-10T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="28010">



<meta itemprop="keywords" content="Python," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Python"/>
<meta name="twitter:description" content="Step01. 面向对象 1 2 3 4 5 6 7 8 9 10 11 class people: name = &#34;zhangyuhang&#34; age = 18 salary = 1000000000 def check(self): print(self.name) print(self.age) print(self.salary) myself = people() myself.check() Step02. Python生成自己的二维码 1 2 3 4 5 6 from MyQR import myqr myqr.run(words=&#39;url&#39;, picture=&#39;LocalPath&#39;, colorized=True, contrast=1.0) Step0"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Zhang&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/home/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">MyBlog</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Zhang&#39;s Blog</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/home/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">MyBlog</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Python</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-04-10 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#step01-面向对象">Step01. 面向对象</a></li>
    <li><a href="#step02-python生成自己的二维码">Step02. Python生成自己的二维码</a></li>
    <li><a href="#step03python弱智到爆炸的网络编程">Step03.Python弱智到爆炸的网络编程</a>
      <ul>
        <li><a href="#udp">UDP</a>
          <ul>
            <li><a href="#udp发送数据">UDP发送数据</a></li>
            <li><a href="#udp接收数据">UDP接收数据</a></li>
            <li><a href="#udp实现聊天">UDP实现聊天</a></li>
          </ul>
        </li>
        <li><a href="#tcp">TCP</a>
          <ul>
            <li><a href="#tcp接收数据">TCP接收数据</a></li>
            <li><a href="#tcp模拟qq">TCP模拟QQ</a></li>
            <li><a href="#tcp多线程聊天">TCP多线程聊天</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step04zip函数">Step04.Zip函数</a></li>
    <li><a href="#step05sort和sorted函数">Step05.sort和sorted函数</a>
      <ul>
        <li><a href="#sort与sorted的区别">sort()与sorted()的区别</a></li>
        <li><a href="#sorted-的用法">sorted() 的用法</a></li>
        <li><a href="#示例">示例</a></li>
      </ul>
    </li>
    <li><a href="#step06lambda">Step06.lambda</a></li>
    <li><a href="#step07matplotlib">Step07.matplotlib</a>
      <ul>
        <li><a href="#pyplot">pyplot</a>
          <ul>
            <li><a href="#pyplothist">pyplot.hist</a></li>
            <li><a href="#pyplotsubplot">pyplot.subplot</a></li>
            <li><a href="#pyplotplot">pyplot.plot</a></li>
            <li><a href="#解析一段代码">解析一段代码</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step08numpy">Step08.numpy</a>
      <ul>
        <li><a href="#numpyravel函数">numpy.ravel函数</a></li>
        <li><a href="#numpyabsolute">numpy.absolute</a></li>
        <li><a href="#numpymin">numpy.min</a></li>
        <li><a href="#numpyargmax">numpy.argmax()</a></li>
        <li><a href="#numpy中reshape函数的三种常见相关用法">numpy中reshape函数的三种常见相关用法</a>
          <ul>
            <li><a href="#numpyarangenreshapea-b-----依次生成n个自然数并且以a行b列的数组形式显示">numpy.arange(n).reshape(a, b) &mdash;&gt; 依次生成n个自然数，并且以a行b列的数组形式显示</a></li>
            <li><a href="#mat-or-arrayreshapec--1---必须是矩阵格式或者数组格式才能使用-reshapec--1-函数-表示将此矩阵或者数组重组以-c行d列的形式表示">mat (or array).reshape(c, -1)   必须是<strong>矩阵格式或者数组格式</strong>，才能使用 .reshape(c, -1) 函数， 表示将此矩阵或者数组重组，以 c行d列的形式表示</a></li>
            <li><a href="#reshape1-1转化成1行">reshape(1,-1)转化成1行：</a></li>
            <li><a href="#areshape2-1转换成两行">areshape(2,-1)转换成两行：</a></li>
            <li><a href="#reshape-11转换成1列">reshape(-1,1)转换成1列：</a></li>
            <li><a href="#reshape-12转化成两列">reshape(-1,2)转化成两列</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step09在python的list中使用for循环语句的技巧">Step09.在python的List中使用for循环语句的技巧</a>
      <ul>
        <li><a href="#简单替换for循环">简单替换for循环</a></li>
        <li><a href="#在list内的循环中使用if-条件">在list内的循环中使用if 条件</a></li>
        <li><a href="#使用更加复杂的表达式">使用更加复杂的表达式</a></li>
        <li><a href="#使用嵌套for循环语法">使用嵌套for循环语法</a></li>
        <li><a href="#尽量避免使用mapfilter这样的内置函数">尽量避免使用map(),filter()这样的内置函数</a></li>
        <li><a href="#尽量使用生成器generator变量来减少内存开销">尽量使用生成器(Generator)变量来减少内存开销</a></li>
      </ul>
    </li>
    <li><a href="#step10enumerate函数">Step10.enumerate函数</a></li>
    <li><a href="#step11string">Step11.string</a></li>
    <li><a href="#step12python远程连接服务器">Step12.Python远程连接服务器</a>
      <ul>
        <li><a href="#ssh">SSH</a>
          <ul>
            <li><a href="#普通版本">普通版本</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step13python解析json文件">Step13.Python解析JSON文件</a></li>
    <li><a href="#step14cmp_to_key函数">Step14.cmp_to_key函数</a></li>
    <li><a href="#step15python列表转换为字符串">Step15.python列表转换为字符串</a></li>
    <li><a href="#step16列表倒序">Step16.列表倒序</a>
      <ul>
        <li><a href="#sorted">sorted()</a></li>
        <li><a href="#切片-1">切片[::-1]</a></li>
      </ul>
    </li>
    <li><a href="#step17int">Step17.int()</a></li>
    <li><a href="#step18取字符串类型小数中的小数部分">Step18.取字符串类型小数中的小数部分</a></li>
    <li><a href="#step19ubuntu下安装pip">Step19.Ubuntu下安装pip</a></li>
    <li><a href="#step20random">Step20.Random</a></li>
    <li><a href="#step21python文件导出为exe">Step21.python文件导出为exe</a>
      <ul>
        <li><a href="#单文件">单文件</a></li>
      </ul>
    </li>
    <li><a href="#step21在函数中更改全局变量">Step21.在函数中更改全局变量</a></li>
    <li><a href="#step22将数据写入到excel文件">Step22.将数据写入到excel文件</a></li>
    <li><a href="#step23list去重">Step23.list去重</a></li>
    <li><a href="#step24tkinter">Step24.Tkinter</a>
      <ul>
        <li><a href="#实现一个随机数软件">实现一个随机数软件</a></li>
        <li><a href="#tkinter模块美化-ttkbootstrap">Tkinter模块美化-ttkbootstrap</a></li>
        <li><a href="#ttkbootstramp--selenium做一个天气查询软件">ttkbootstramp + selenium做一个天气查询软件</a></li>
      </ul>
    </li>
    <li><a href="#step25pyqt">Step25.PyQt</a>
      <ul>
        <li><a href="#实现一个随机数软件-1">实现一个随机数软件</a></li>
      </ul>
    </li>
    <li><a href="#step26python获取当前时间">Step26.python获取当前时间</a></li>
    <li><a href="#step27python图片转pdf">Step27.python图片转pdf</a></li>
    <li><a href="#step28python截图">Step28.python截图</a></li>
    <li><a href="#step29python录屏">Step29.python录屏</a></li>
    <li><a href="#step30指定时间后执行某函数">Step30.指定时间后执行某函数</a></li>
    <li><a href="#step31python文字转语音">Step31.Python文字转语音</a>
      <ul>
        <li><a href="#无脑版文字直接播放">无脑版,文字直接播放</a></li>
      </ul>
    </li>
    <li><a href="#step32判断变量真假">Step32.判断变量真假</a></li>
    <li><a href="#step33判断变量是否为某个值">Step33.判断变量是否为某个值</a></li>
    <li><a href="#step34math模块">Step34.math模块</a></li>
    <li><a href="#step35字符串">Step35.字符串</a>
      <ul>
        <li><a href="#切片函数split">切片函数split</a></li>
        <li><a href="#替换字符串中指定字符串">替换字符串中指定字符串</a></li>
        <li><a href="#向字符串中插入字符或字符串">向字符串中插入字符或字符串</a></li>
      </ul>
    </li>
    <li><a href="#step36datetime模块">Step36.datetime模块</a>
      <ul>
        <li><a href="#time--datetime--string-相互转换">time &amp; datetime &amp; string 相互转换</a></li>
        <li><a href="#获取今天是星期几">获取今天是星期几</a></li>
        <li><a href="#获取两个是日期之间距离多少天">获取两个是日期之间距离多少天</a></li>
      </ul>
    </li>
    <li><a href="#step372022年大二疫情上网课提醒助手">Step37.2022年大二疫情上网课提醒助手</a></li>
    <li><a href="#step38逆排序代码">Step38.逆排序代码</a>
      <ul>
        <li><a href="#暴力破解法">暴力破解法</a></li>
      </ul>
    </li>
    <li><a href="#step39图灵机器人--百度ai实现智能语音对话机器人">Step39.图灵机器人 + 百度AI实现智能语音对话机器人</a>
      <ul>
        <li><a href="#准备工具">准备工具</a>
          <ul>
            <li><a href="#图灵机器人">图灵机器人</a></li>
            <li><a href="#百度ai接口">百度AI接口</a></li>
            <li><a href="#库">库</a></li>
          </ul>
        </li>
        <li><a href="#代码部分">代码部分</a></li>
        <li><a href="#遇到的问题">遇到的问题</a></li>
      </ul>
    </li>
    <li><a href="#step40python--ajax前端实现的菜谱查询">Step40.Python + Ajax前端实现的菜谱查询</a>
      <ul>
        <li><a href="#前端">前端</a></li>
        <li><a href="#后端">后端</a></li>
      </ul>
    </li>
    <li><a href="#step41flask框架">Step41.Flask框架</a>
      <ul>
        <li><a href="#创建一个flask的app实例"><strong>创建一个Flask的app实例</strong></a></li>
        <li><a href="#创建接口"><strong>创建接口</strong></a></li>
        <li><a href="#flask跨域请求处理"><strong>Flask跨域请求处理</strong></a></li>
        <li><a href="#获取请求方法"><strong>获取请求方法</strong></a></li>
        <li><a href="#获取请求参数"><strong>获取请求参数</strong></a></li>
      </ul>
    </li>
    <li><a href="#step42python的base64转图片">Step42.Python的base64转图片</a></li>
    <li><a href="#step43flask--ajax--百度ai实现的果蔬菜谱生成">Step43.flask + ajax + 百度ai实现的果蔬菜谱生成</a>
      <ul>
        <li><a href="#前端-1">前端</a>
          <ul>
            <li><a href="#框架">框架</a></li>
            <li><a href="#样式">样式</a></li>
            <li><a href="#js">js</a></li>
          </ul>
        </li>
        <li><a href="#后端-1">后端</a>
          <ul>
            <li><a href="#先写个flask服务器测试ajax的连接请求">先写个flask服务器测试ajax的连接请求</a></li>
            <li><a href="#base64将前端ajax的base64转为图片">base64将前端ajax的base64转为图片</a></li>
            <li><a href="#百度ai识别果蔬图片信息模块"><code>百度AI识别果蔬图片信息</code>模块</a></li>
            <li><a href="#爬取指定名称的食谱">爬取指定<strong><code>名称</code></strong>的食谱</a></li>
            <li><a href="#将果蔬名--食谱保存到数据库">将果蔬名 + 食谱保存到数据库</a></li>
            <li><a href="#完整逻辑">完整逻辑</a></li>
          </ul>
        </li>
        <li><a href="#运行版本完整代码">运行版本完整代码</a>
          <ul>
            <li><a href="#前端-2">前端</a></li>
            <li><a href="#后端-2">后端</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step44python操纵mysql">Step44.python操纵mysql</a></li>
    <li><a href="#step45python操纵xlsx格式表格">Step45.Python操纵xlsx格式表格</a>
      <ul>
        <li><a href="#输出表格对象">输出表格对象</a></li>
        <li><a href="#操作整个表格表格属性">操作整个表格(表格属性)</a></li>
        <li><a href="#操作表格中的单个sheet表">操作表格中的单个sheet表</a>
          <ul>
            <li><a href="#访问sheet表的所有信息">访问sheet表的所有信息</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step46python生成echarts图表">Step46.Python生成echarts图表</a>
      <ul>
        <li><a href="#生成地图">生成地图</a>
          <ul>
            <li><a href="#省市地图">省市地图</a></li>
            <li><a href="#中国地图">中国地图</a></li>
            <li><a href="#世界地图">世界地图</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step47使用python生成词云">Step47.使用Python生成词云</a></li>
    <li><a href="#step48ffmpeg">Step48.ffmpeg</a>
      <ul>
        <li><a href="#批量合并ts文件合成mp4格式">批量合并ts文件,合成mp4格式</a></li>
        <li><a href="#切割mp4为m3u8格式">切割mp4为m3u8格式</a></li>
        <li><a href="#切片mp4为m3u8列表">切片mp4为m3u8列表</a></li>
      </ul>
    </li>
    <li><a href="#step49解决try-except抛出异常退出程序运行的问题">Step49.解决<code>try-except抛出异常退出程序运行</code>的问题</a></li>
    <li><a href="#step50ubuntu安装pip">Step50.Ubuntu安装pip</a></li>
    <li><a href="#step51ubuntu安装django环境">Step51.Ubuntu安装django环境</a></li>
    <li><a href="#step52python-thread">Step52.Python thread</a>
      <ul>
        <li><a href="#create-thread">Create thread</a>
          <ul>
            <li><a href="#common-creation-method">common creation method</a></li>
            <li><a href="#inherit-the-threadingthread-class-and-override-the-run-method-of-threadingthread">Inherit the threading.Thread class and override the run method of threading.Thread</a></li>
          </ul>
        </li>
        <li><a href="#daemon-thread">daemon thread</a></li>
        <li><a href="#thread-lock">Thread Lock</a>
          <ul>
            <li><a href="#mutex-lock">Mutex Lock</a></li>
            <li><a href="#recursive-locks">Recursive Locks</a></li>
          </ul>
        </li>
        <li><a href="#semaphore">Semaphore</a></li>
      </ul>
    </li>
    <li><a href="#step53python提取视频音频">Step53.python提取视频音频</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <p><img src="https://img-blog.csdnimg.cn/20210720004148145.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1pZSDE4NDE0NzQ2MTQ=,size_16,color_FFFFFF,t_70" alt="Photo-Head"></p>
<h1 id="step01-面向对象">Step01. 面向对象</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">class</span> <span class="nc">people</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;zhangyuhang&#34;</span>
    <span class="n">age</span> <span class="o">=</span> <span class="mi">18</span>
    <span class="n">salary</span> <span class="o">=</span> <span class="mi">1000000000</span>

    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">salary</span><span class="p">)</span>
<span class="n">myself</span> <span class="o">=</span> <span class="n">people</span><span class="p">()</span>
<span class="n">myself</span><span class="o">.</span><span class="n">check</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="step02-python生成自己的二维码">Step02. Python生成自己的二维码</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">MyQR</span> <span class="kn">import</span> <span class="n">myqr</span>

<span class="n">myqr</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">words</span><span class="o">=</span><span class="s1">&#39;url&#39;</span><span class="p">,</span>
        <span class="n">picture</span><span class="o">=</span><span class="s1">&#39;LocalPath&#39;</span><span class="p">,</span>
        <span class="n">colorized</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">contrast</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="step03python弱智到爆炸的网络编程">Step03.Python弱智到爆炸的网络编程</h1>
<h2 id="udp">UDP</h2>
<h3 id="udp发送数据">UDP发送数据</h3>
<p><code>UdpSend.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- encoding:UTF-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">@File     :   UdpTest.py
</span><span class="s2">@Time     :   2021/10/22 19:00
</span><span class="s2">@Author   :   张宇航
</span><span class="s2">@Contact  :   zhangzyh666@163.com
</span><span class="s2">@MyWeb    :   https://zhang666zyh.github.io
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="n">socket</span><span class="p">,</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">SOCK_DGRAM</span>

<span class="c1"># 创建套接字</span>
<span class="n">udp_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">SOCK_DGRAM</span><span class="p">)</span>

<span class="c1"># 指定发送的ip地址和端口</span>
<span class="n">ip_port</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span><span class="mi">8080</span><span class="p">)</span>


<span class="n">data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;请发送信息:&#34;</span><span class="p">)</span>

<span class="c1"># 发送信息,使用套接字的sendto方法,参数为数据(字符编码),端口号</span>
<span class="n">udp_socket</span><span class="o">.</span><span class="n">sendto</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;gb2312&#34;</span><span class="p">),</span><span class="n">ip_port</span><span class="p">)</span>

<span class="c1">#关闭资源</span>
<span class="n">udp_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="udp接收数据">UDP接收数据</h3>
<p><code>UdpReceive.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- encoding:UTF-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">@File     :   UdpReceive.py
</span><span class="s2">@Time     :   2021/10/22 19:38
</span><span class="s2">@Author   :   张宇航
</span><span class="s2">@Contact  :   zhangzyh666@163.com
</span><span class="s2">@MyWeb    :   https://zhang666zyh.github.io
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="n">socket</span><span class="p">,</span> <span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_DGRAM</span>

<span class="n">udp_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_DGRAM</span><span class="p">)</span>

<span class="c1"># 绑定本机地址</span>
<span class="n">udp_socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8989</span><span class="p">))</span>
<span class="n">ip_port</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">}</span>

<span class="c1"># 套接字获取网络层中的数据使用recvfrom方法,1024指的是一次最多接收1024个字节,返回结果是一个数组,第一个值是数据,第二个是ip地址和端口号</span>
<span class="n">receive_data</span> <span class="o">=</span> <span class="n">udp_socket</span><span class="o">.</span><span class="n">recvfrom</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span><span class="p">(</span><span class="n">receive_data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">receive_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;gb2312&#34;</span><span class="p">)))</span>

<span class="n">udp_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="udp实现聊天">UDP实现聊天</h3>
<p><code>UdpWeChat.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- encoding:UTF-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">@File     :   UdpWeChat.py
</span><span class="s2">@Time     :   2021/10/22 19:55
</span><span class="s2">@Author   :   张宇航
</span><span class="s2">@Contact  :   zhangzyh666@163.com
</span><span class="s2">@MyWeb    :   https://zhang666zyh.github.io
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="n">socket</span><span class="p">,</span> <span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_DGRAM</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="n">udp_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_DGRAM</span><span class="p">)</span>
<span class="n">udp_socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8989</span><span class="p">))</span>
<span class="n">ip_port</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span> <span class="mi">8080</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">receiveChat</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">receive_data</span> <span class="o">=</span> <span class="n">udp_socket</span><span class="o">.</span><span class="n">recvfrom</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2"> -&gt; </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">receive_data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">receive_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;gb2312&#39;</span><span class="p">)))</span>


<span class="k">def</span> <span class="nf">sendChat</span><span class="p">():</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">send_data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
        <span class="n">udp_socket</span><span class="o">.</span><span class="n">sendto</span><span class="p">(</span><span class="n">send_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;gb2312&#34;</span><span class="p">),</span> <span class="n">ip_port</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">sendChat</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">receiveChat</span><span class="p">)</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">t2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="n">t2</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="tcp">TCP</h2>
<h3 id="tcp接收数据">TCP接收数据</h3>
<p><code>TcpReceive.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- encoding:UTF-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">@File     :   TcpReceive.py
</span><span class="s2">@Time     :   2021/10/22 20:26
</span><span class="s2">@Author   :   张宇航
</span><span class="s2">@Contact  :   zhangzyh666@163.com
</span><span class="s2">@MyWeb    :   https://zhang666zyh.github.io
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">tcp_server_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">SOCK_STREAM</span><span class="p">)</span>

<span class="c1"># 指定本机端口</span>
<span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="mi">8989</span><span class="p">))</span>

<span class="c1"># 监听客户端的连接</span>
<span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>

<span class="c1"># 连接成功,返回一个客户端的套接字和一个客户端的端口号</span>
<span class="n">tcp_client_socket</span><span class="p">,</span><span class="n">tcp_client_info</span> <span class="o">=</span> <span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

<span class="c1"># tcp中的接收是recv,udp是recvfrom</span>
<span class="n">receive_data</span> <span class="o">=</span> <span class="n">tcp_client_socket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2"> -&gt; </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tcp_client_info</span><span class="p">,</span><span class="n">receive_data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;gb2312&#34;</span><span class="p">)))</span>

<span class="n">tcp_client_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">tcp_client_socket</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="tcp模拟qq">TCP模拟QQ</h3>
<p><code>TcpQQServer.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- encoding:UTF-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">@File     :   TcpQQServer.py
</span><span class="s2">@Time     :   2021/10/22 20:41
</span><span class="s2">@Author   :   张宇航
</span><span class="s2">@Contact  :   zhangzyh666@163.com
</span><span class="s2">@MyWeb    :   https://zhang666zyh.github.io
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># QQ的服务器,创建套接字第二个参数使用的是SOCK_STREAM</span>
<span class="n">tcp_server_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">)</span>

<span class="c1"># 指定服务器端口号</span>
<span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">1111</span><span class="p">))</span>

<span class="c1"># 监听客户端的连接</span>
<span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>

<span class="c1"># accept连接成功,返回一个客户端的套接字和客户端的ip地址和端口号</span>
<span class="n">client_socket</span><span class="p">,</span> <span class="n">client_info</span> <span class="o">=</span> <span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="c1"># TCP接收数据是recv,不是recvfrom(udp)</span>
    <span class="n">receive_data</span> <span class="o">=</span> <span class="n">client_socket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;gbk&#34;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2"> -&gt; </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">client_info</span><span class="p">,</span> <span class="n">receive_data</span><span class="p">))</span>

    <span class="n">send_data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>

    <span class="c1"># 因为建立连接的时候获取到了客户端的套接字,所以直接在服务器中使用客户端自己的套接字给自己发消息即可</span>
    <span class="n">client_socket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">send_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;gb2312&#34;</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>TcpQQClient.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- encoding:UTF-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">@File     :   TcpQQClient.py
</span><span class="s2">@Time     :   2021/10/22 20:48
</span><span class="s2">@Author   :   张宇航
</span><span class="s2">@Contact  :   zhangzyh666@163.com
</span><span class="s2">@MyWeb    :   https://zhang666zyh.github.io
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">client_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">)</span>

<span class="c1"># 连接指定ip和端口的服务器</span>
<span class="n">client_socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span> <span class="mi">1111</span><span class="p">))</span>

<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">client_data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>

    <span class="c1"># TCP发送消息使用的是send,  UDP使用的是sendto</span>
    <span class="n">client_socket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">client_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;gb2312&#34;</span><span class="p">))</span>

    <span class="n">receive_data</span> <span class="o">=</span> <span class="n">client_socket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;Server -&gt; </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="p">(</span><span class="n">receive_data</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;gb2312&#34;</span><span class="p">)))</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="tcp多线程聊天">TCP多线程聊天</h3>
<p><code>TcpMutithreadingWechatServer.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- encoding:UTF-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">@File     :   TcpMutithreadingWechatServer.py
</span><span class="s2">@Time     :   2021/10/22 21:39
</span><span class="s2">@Author   :   张宇航
</span><span class="s2">@Contact  :   zhangzyh666@163.com
</span><span class="s2">@MyWeb    :   https://zhang666zyh.github.io
</span><span class="s2">&#34;&#34;&#34;</span>

<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="n">client_sockets</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">tcp_server_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">)</span>

    <span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="s2">&#34;&#34;</span><span class="p">,</span> <span class="mi">1111</span><span class="p">))</span>

    <span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">listen</span><span class="p">()</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">client_socket</span><span class="p">,</span> <span class="n">client_info</span> <span class="o">=</span> <span class="n">tcp_server_socket</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        
        <span class="c1"># 无限循环,接收所有客户端的连接,只要连接成功就将这个socket储存到client_sockets中</span>
        <span class="n">client_sockets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">client_socket</span><span class="p">)</span>
        
        <span class="c1"># 当前连接成功的客户端开启一个进程,并在线程体中获取当前线程客户端发送过来的数据,依靠client_sockets将一个线程的客户端发送的数据发送给所有当前在线用户</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">sendMsg</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">client_socket</span><span class="p">,))</span><span class="c1"># 这里传参数类型是元组,如果只有一个值,要加括号</span>
        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">sendMsg</span><span class="p">(</span><span class="n">client_socket</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        
        <span class="c1"># 获取当前客户端线程发送给服务端的信息</span>
        <span class="n">receive_data</span> <span class="o">=</span> <span class="n">client_socket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        
        <span class="c1">#遍历当前所有客户端线程,并将当前客户端线程发送给服务端的数据发送给所有在线客户端</span>
        <span class="k">for</span> <span class="n">socket</span> <span class="ow">in</span> <span class="n">client_sockets</span><span class="p">:</span>
            <span class="n">socket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">receive_data</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>TcpMutithreadingWechatClient.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># -*- encoding:UTF-8 -*-</span>

<span class="s2">&#34;&#34;&#34;
</span><span class="s2">@File     :   TcpMutithreadingWechatClient.py
</span><span class="s2">@Time     :   2021/10/22 21:39
</span><span class="s2">@Author   :   张宇航
</span><span class="s2">@Contact  :   zhangzyh666@163.com
</span><span class="s2">@MyWeb    :   https://zhang666zyh.github.io
</span><span class="s2">&#34;&#34;&#34;</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="n">client_socket</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="n">client_socket</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="s2">&#34;127.0.0.1&#34;</span><span class="p">,</span><span class="mi">1111</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># 创建两个线程,一个发送一个接收,多线程并行</span>
    <span class="n">t_sendMsg</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">sendMsg</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">client_socket</span><span class="p">,))</span>
    <span class="n">t_sendMsg</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

    <span class="n">t_receiveMsg</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">receiveMsg</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">client_socket</span><span class="p">,))</span>
    <span class="n">t_receiveMsg</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">sendMsg</span><span class="p">(</span><span class="n">client_socket</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">send_data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&#34;&#34;</span><span class="p">)</span>
        <span class="n">client_socket</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">send_data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;gb2312&#34;</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">receiveMsg</span><span class="p">(</span><span class="n">client_socket</span><span class="p">):</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="n">receive_data</span> <span class="o">=</span> <span class="n">client_socket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;收到:-&gt;</span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">receive_data</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step04zip函数">Step04.Zip函数</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">zip<span class="o">()</span> 函数用于将可迭代的对象作为参数，将对象中对应的元素打包成一个个元组，然后返回由这些元组组成的列表。

如果各个迭代器的元素个数不一致，则返回列表长度与最短的对象相同，利用 * 号操作符，可以将元组解压为列表。
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">zipped</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>     <span class="c1"># 打包为元组的列表</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>              <span class="c1"># 元素个数与最短的列表一致</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">zipped</span><span class="p">)</span>          <span class="c1"># 与 zip 相反，*zipped 可理解为解压，返回二维矩阵式</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)]</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>这里的<code>zipped-&gt;zip(zip())</code>是被<code>zip函数的返回值</code>,相当于zip的逆操作(zip是将两个可迭代集合中每个元素分别拿出来合并为一个元组作为返回值list中的元素,而<code>zip(zip())</code>就是将集合中每个<code>元组元素</code>的两个值拿出来并分别作为两个list的元素</strong></p>
<h1 id="step05sort和sorted函数">Step05.sort和sorted函数</h1>
<h2 id="sort与sorted的区别">sort()与sorted()的区别</h2>
<p>1、sort() 是 list 的方法，只有 list 能用，而sorted() 是内置函数，可以对所有可迭代的对象进行排序操作；
2、list 的 sort() 方法是原地操作，无返回值，而内置函数 sorted() 方法是返回一个新的 list。</p>
<h2 id="sorted-的用法">sorted() 的用法</h2>
<blockquote>
<p><code>语法</code>：sorted(iterable, key=None, reverse=False)</p>
</blockquote>
<blockquote>
<p><code>参数</code>：<code>iterable</code> – 可迭代对象。
   <code>key</code> – 主要是用来进行比较的元素，只有一个参数，具体的函数的参数就是取自于可迭
      代对象中，指定可迭代对象中的一个元素来进行排序。
   <code>reverse</code> – 排序规则，reverse = True 降序 ， reverse = False 升序（默认）。</p>
</blockquote>
<blockquote>
<p><code>返回</code>：返回重新排序的<code>列表</code></p>
</blockquote>
<h2 id="示例">示例</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>
<span class="n">b</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><code>运行结果</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[(</span><span class="s1">&#39;b&#39;</span>, 2<span class="o">)</span>, <span class="o">(</span><span class="s1">&#39;a&#39;</span>, 1<span class="o">)</span>, <span class="o">(</span><span class="s1">&#39;d&#39;</span>, 4<span class="o">)</span>, <span class="o">(</span><span class="s1">&#39;c&#39;</span>, 3<span class="o">)]</span>
<span class="o">[(</span><span class="s1">&#39;a&#39;</span>, 1<span class="o">)</span>, <span class="o">(</span><span class="s1">&#39;b&#39;</span>, 2<span class="o">)</span>, <span class="o">(</span><span class="s1">&#39;c&#39;</span>, 3<span class="o">)</span>, <span class="o">(</span><span class="s1">&#39;d&#39;</span>, 4<span class="o">)]</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>示例中说明了<code>sorted()</code>函数的<code>key</code>,如果使用lambda参数,lambda函数的参数值将是<code>被排序的集合的迭代</code></strong></p>
<hr>
<h1 id="step06lambda">Step06.lambda</h1>
<blockquote>
<p>用它可以定义一个匿名函数.即当你需要一个函数,但又不想费神去命名一个函数,这时候,就可以使用 lambda了</p>
</blockquote>
<ul>
<li>看个例子</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">g</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>  <span class="c1"># 求 x+1 的和</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>结果</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">g<span class="o">(</span>1<span class="o">)</span>
2
g<span class="o">(</span>2<span class="o">)</span>
3
1
2
3
4
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<blockquote>
<p>可以这样认为，lambda作为一个表达式，定义了一个匿名函数，上例的代码x为入口参数，x+1为函数体</p>
</blockquote>
<ul>
<li>用函数来表示为</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
	<span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step07matplotlib">Step07.matplotlib</h1>
<h2 id="pyplot">pyplot</h2>
<h3 id="pyplothist">pyplot.hist</h3>
<ul>
<li>用于计算图像的直方图数据</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">hist</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">cumulative</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">,</span>
        <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">rwidth</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="c1"># x : (n,) array or sequence of (n,) arrays</span>
<span class="c1"># 这个参数是指定每个bin(箱子)分布的数据,对应x轴</span>

<span class="c1"># bins : integer or array_like, optional</span>
<span class="c1"># 这个参数指定bin(箱子)的个数,也就是总共有几条条状图</span>
<span class="c1"># </span>
<span class="c1"># normed : boolean, optional</span>
<span class="c1"># If True, the first element of the return tuple will be the counts normalized to form a probability density, i.e.,n/(len(x)`dbin)</span>
<span class="c1"># 这个参数指定密度,也就是每个条状图的占比例比,默认为1</span>
<span class="c1"># </span>
<span class="c1"># color : color or array_like of colors or None, optional</span>
<span class="c1"># 这个指定条状图的颜色</span>
<span class="c1"># </span>
<span class="c1"># facecolor: 直方图颜色</span>
<span class="c1"># </span>
<span class="c1"># edgecolor: 直方图边框颜色</span>
<span class="c1"># </span>
<span class="c1"># alpha: 透明度</span>
<span class="c1"># </span>
<span class="c1"># histtype: 直方图类型，‘bar’, ‘barstacked’, ‘step’, ‘stepfilled‘</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="pyplotsubplot">pyplot.subplot</h3>
<ul>
<li>
<p>plt.subplot(numRows, numCols, plotNum)</p>
<blockquote>
<p>其作用是把一个绘图区域分为多个子区域</p>
<p>并把需要绘制出来的图画在分好的指定区域内</p>
<p>函数的意思是将整个绘图区域分为numRows(行) * numCols(列 )个子区域</p>
<p>按照从左到右，从上到下的顺序依次给子区域进行编号</p>
<p>并将需要绘制的图画在编好的第plotNum(个)子区域中</p>
<p>如果numRows，numCols，plotNum这三个数都小于10的话</p>
<p>可以把它们缩写成一个三位证书，例如subplot(223)和subplot(2, 2, 3)是相同的</p>
</blockquote>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span> <span class="c1"># 表示分为两行两列，占用第一个，即第一行第一列的子图</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span> <span class="c1"># 表示分为两行两列，占用第一个，即第二行第一列的子图</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="c1"># 分为十行十列，占用第三个，即第一行第三列的子图</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="pyplotplot">pyplot.plot</h3>
<blockquote>
<p>直接在一张大的画布中画图，相当于<strong>获取当前活跃的的axes然后在上面作图</strong></p>
</blockquote>
<ul>
<li>参数可以传<code>cv2.calcHist</code>的返回值</li>
</ul>
<h3 id="解析一段代码">解析一段代码</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 画出一个1x2的的画布</span>
<span class="c1"># 开始设置第一个格子</span>
	<span class="c1"># 第一个格子显示图像, 并且为灰度图</span>
plt.subplot<span class="o">(</span>121<span class="o">)</span>, plt.imshow<span class="o">(</span>img, <span class="nv">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="o">)</span>
	<span class="c1"># 第一个格子的标题, 第一个格子的横纵坐标轴都不显示</span>
plt.title<span class="o">(</span><span class="s1">&#39;Input Image&#39;</span><span class="o">)</span>, plt.xticks<span class="o">([])</span>, plt.yticks<span class="o">([])</span>

<span class="c1"># 同第一个</span>
plt.subplot<span class="o">(</span>122<span class="o">)</span>, plt.imshow<span class="o">(</span>magitude_spectrum, <span class="nv">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="o">)</span>
plt.title<span class="o">(</span><span class="s1">&#39;Magitude Spectrum&#39;</span><span class="o">)</span>, plt.xticks<span class="o">([])</span>, plt.yticks<span class="o">([])</span>

<span class="c1"># 展示整张华北</span>
plt.show<span class="o">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step08numpy">Step08.numpy</h1>
<h2 id="numpyravel函数">numpy.ravel函数</h2>
<ul>
<li>将多维矩阵转换为一维矩阵</li>
</ul>
<h2 id="numpyabsolute">numpy.absolute</h2>
<ul>
<li>对矩阵中每个元素都取绝对值</li>
</ul>
<h2 id="numpymin">numpy.min</h2>
<ul>
<li>
<p>取矩阵中的最小值</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">())</span> <span class="c1">#无参，所有中的最小值</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span> <span class="c1"># axis=0; 每列的最小值</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span> <span class="c1"># axis=1；每行的最小值</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">1
  
<span class="o">[</span><span class="m">1</span> <span class="m">2</span> 3<span class="o">]</span>
  
<span class="o">[</span><span class="m">1</span> 2<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="numpyargmax">numpy.argmax()</h2>
<p>1.对一个一维向量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1">#取出a中元素最大值所对应的索引，此时最大值位6，其对应的位置索引值为4，（索引值默认从0开始）</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="c1">#4</span>
</code></pre></td></tr></table>
</div>
</div><p>2.对2维向量（通常意义下的矩阵）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
              <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">#对二维矩阵来讲a[0][1]会有两个索引方向，第一个方向为a[0]，默认按列方向搜索最大值</span>
			          <span class="c1">#a的第0列为1，9，3,最大值为9，所在位置为1，</span>
			          <span class="c1">#a的第一列为5，6，7,最大值为7，所在位置为2，</span>
			          <span class="c1">#此此类推，因为a有4列，所以得到的b为1行4列，</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="c1">#[1 2 2 1]</span>

<span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#现在按照a[0][1]中的a[1]方向，即行方向搜索最大值，</span>
					  <span class="c1">#a的第一行为1，5，5，2,最大值为5（虽然有2个5，但取第一个5所在的位置），索引值为1，</span>
					  <span class="c1">#a的第2行为9，6，2，8,最大值为9，索引值为0，</span>
					  <span class="c1">#因为a有3行，所以得到的c有3个值，即为1行3列</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="c1">#[1 0 2]</span>
</code></pre></td></tr></table>
</div>
</div><p>3.对于三维矩阵a[0][1][2]```,情况最为复制，但在lstm中应用最广</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
             	<span class="p">[</span>
                	<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                	<span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
                	<span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
              	<span class="p">],</span>
         		<span class="p">[</span>
              		<span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              		<span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
              		<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
          		<span class="p">],</span>
        		<span class="p">[</span>
              		<span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
              		<span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
              		<span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                <span class="p">]</span>
             <span class="p">])</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="c1">#对于三维度矩阵，a有三个方向a[0][1][2]</span>
					  <span class="c1">#当axis=0时，是在a[0]方向上找最大值，即两个矩阵做比较，具体</span>
					  <span class="c1">#(1)比较3个矩阵的第一行，即拿[1, 5, 5, 2],</span>
<span class="c1">#                         [-1, 7, -5, 2],</span>

<span class="c1">#                         [21, 6, -5, 2],</span>

<span class="c1">#再比较每一列的最大值在那个矩阵中，可以看出第一列1，-2，21最大值为21，在第三个矩阵中，索引值为2</span>
<span class="c1">#第2列5，7，6最大值为7，在第2个矩阵中，索引值为1.....，最终得出比较结果[2 1 0 0]</span>
<span class="c1">#再拿出三个矩阵的第二行，按照上述方法，得出比较结果 [0 2 0 0]</span>
<span class="c1">#一共有三个，所以最终得到的结果b就为3行4列矩阵</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="c1">#[[0 0 0 0]</span>
 <span class="c1">#[0 1 0 0]</span>
 <span class="c1">#[1 0 1 0]]</span>

<span class="n">c</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="c1">#对于三维度矩阵，a有三个方向a[0][1][2]</span>
<span class="c1">#当axis=1时，是在a[1]方向上找最大值，即在列方向比较，此时就是指在每个矩阵内部的列方向上进行比较</span>
<span class="c1">#(1)看第一个矩阵</span>
                  <span class="c1"># [1, 5, 5, 2],</span>
                  <span class="c1"># [9, -6, 2, 8],</span>
                  <span class="c1"># [-3, 7, -9, 1]</span>
<span class="c1">#比较每一列的最大值，可以看出第一列1，9，-3最大值为9，，索引值为1</span>
<span class="c1">#第2列5，-6，7最大值为7，，索引值为2</span>

<span class="c1"># 因此对第一个矩阵，找出索引结果为[1，2，0,1]</span>

<span class="c1">#再拿出2个，按照上述方法，得出比较结果 [1 0 2 1]</span>
<span class="c1">#一共有三个，所以最终得到的结果b就为3行4列矩阵</span>
<span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="c1">#[[1 2 0 1]</span>

 <span class="c1"># [1 0 2 1]</span>

 <span class="c1"># [0 1 2 1]]</span>

<span class="n">d</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="c1">#对于三维度矩阵，a有三个方向a[0][1][2]</span>
<span class="c1">#当axis=2时，是在a[2]方向上找最大值，即在行方向比较，此时就是指在每个矩阵内部的行方向上进行比较</span>
<span class="c1">#(1)看第一个矩阵</span>
                  <span class="c1"># [1, 5, 5, 2],</span>
                  <span class="c1"># [9, -6, 2, 8],</span>
                  <span class="c1"># [-3, 7, -9, 1]</span>
<span class="c1">#寻找第一行的最大值，可以看出第一行[1, 5, 5, 2]最大值为5，，索引值为1</span>
<span class="c1">#第2行[9, -6, 2, 8],最大值为9，，索引值为0</span>

<span class="c1"># 因此对第一个矩阵，找出行最大索引结果为[1，0，1]</span>

<span class="c1">#再拿出2个矩阵，按照上述方法，得出比较结果 [1 0 2 1]</span>
<span class="c1">#一共有三个，所以最终得到的结果d就为3行3列矩阵</span>
<span class="k">print</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="c1"># [[1 0 1]</span>

<span class="c1">#  [1 0 2]</span>

<span class="c1">#  [0 1 2]]</span>

<span class="c1">###################################################################</span>
<span class="c1">#最后一种情况，指定矩阵a[0, -1, :]，第一个数字0代表取出第一个矩阵（从前面可以看出a有3个矩阵）为</span>

<span class="c1"># [1, 5, 5, 2],</span>

<span class="c1"># [9, -6, 2, 8],</span>

<span class="c1"># [-3, 7, -9, 1]</span>

<span class="c1">#第二个数字“-1”代表拿出倒数第一行，为</span>

<span class="c1"># [-3, 7, -9, 1]</span>

<span class="c1">#这一行的最大索引值为1</span>

<span class="c1"># ，-1，代表最后一行</span>

<span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:])</span>
<span class="k">print</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="c1">#1</span>

<span class="c1">#h,取a的第2个矩阵</span>

<span class="c1"># [-1, 7, -5, 2],</span>

<span class="c1"># [9, 6, 2, 8],</span>

<span class="c1"># [3, 7, 9, 1]</span>

<span class="c1">#的第3行</span>

<span class="c1"># [3, 7, 9, 1]</span>

<span class="c1">#的最大值为9，索引为2</span>
<span class="n">h</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:])</span>
<span class="k">print</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="c1">#2</span>

<span class="n">g</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">,:,</span> <span class="mi">2</span><span class="p">])</span><span class="c1">#g,取出矩阵a，第2个矩阵的第3列为-5，2，9,最大值为9，索引为2</span>
<span class="k">print</span><span class="p">(</span><span class="n">g</span><span class="p">)</span><span class="c1">#</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="numpy中reshape函数的三种常见相关用法">numpy中reshape函数的三种常见相关用法</h2>
<h3 id="numpyarangenreshapea-b-----依次生成n个自然数并且以a行b列的数组形式显示">numpy.arange(n).reshape(a, b) &mdash;&gt; 依次生成n个自然数，并且以a行b列的数组形式显示</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span> <span class="c1">#生成16个自然数，以2行8列的形式显示</span>
<span class="c1"># Out: </span>
<span class="c1"># array([[ 0,  1,  2,  3,  4,  5,  6,  7],</span>
<span class="c1">#       [ 8,  9, 10, 11, 12, 13, 14, 15]])</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="mat-or-arrayreshapec--1---必须是矩阵格式或者数组格式才能使用-reshapec--1-函数-表示将此矩阵或者数组重组以-c行d列的形式表示">mat (or array).reshape(c, -1)   必须是<strong>矩阵格式或者数组格式</strong>，才能使用 .reshape(c, -1) 函数， 表示将此矩阵或者数组重组，以 c行d列的形式表示</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">arr</span><span class="o">.</span><span class="n">shape</span>    <span class="c1"># (a,b)</span>
<span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#改变维度为m行、d列 （-1表示列数自动计算，d= a*b /m ）</span>
<span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">m</span><span class="p">)</span> <span class="c1">#改变维度为d行、m列 （-1表示行数自动计算，d= a*b /m ）</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>-1的作用就在此**: 自动计算d：d=数组或者矩阵里面所有的元素个数/c**, d必须是整数，不然报错）</li>
</ul>
<blockquote>
<p>reshape(-1, m)即列数固定，行数需要计算</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">arr</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="n">arr</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">out:
</span><span class="s1">array([[ 0,  1,  2,  3,  4,  5,  6,  7],
</span><span class="s1">       [ 8,  9, 10, 11, 12, 13, 14, 15]])
</span><span class="s1">&#39;&#39;&#39;</span>
<span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#将arr变成4行的格式，列数自动计算的(c=4, d=16/4=4)</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">out:
</span><span class="s1">array([[ 0,  1,  2,  3],
</span><span class="s1">       [ 4,  5,  6,  7],
</span><span class="s1">       [ 8,  9, 10, 11],
</span><span class="s1">       [12, 13, 14, 15]])
</span><span class="s1">&#39;&#39;&#39;</span> 
<span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#将arr变成8行的格式，列数自动计算的(c=8, d=16/8=2)</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">out:
</span><span class="s1">array([[ 0,  1],
</span><span class="s1">       [ 2,  3],
</span><span class="s1">       [ 4,  5],
</span><span class="s1">       [ 6,  7],
</span><span class="s1">       [ 8,  9],
</span><span class="s1">       [10, 11],
</span><span class="s1">       [12, 13],
</span><span class="s1">       [14, 15]])
</span><span class="s1">&#39;&#39;&#39;</span> 
<span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1">#将arr变成10行的格式，列数自动计算的(c=10, d=16/10=1.6 != Int)</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">out:
</span><span class="s1">ValueError: cannot reshape array of size 16 into shape (10,newaxis)
</span><span class="s1">&#39;&#39;&#39;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>numpy.arange(a,b,c)  从 数字a起, 步长为c, 到b结束，生成array</li>
<li>numpy.arange(a,b,c).reshape(m,n) ：将array的维度变为m 行 n列。</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="c1">#间隔2生成数组，范围在1到12之间</span>

<span class="c1"># Out: array([ 1,  3,  5,  7,  9, 11])</span>
<span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="s1">&#39;&#39;&#39;
</span><span class="s1">Out: 
</span><span class="s1">array([[ 1,  3],
</span><span class="s1">       [ 5,  7],
</span><span class="s1">       [ 9, 11]])
</span><span class="s1">&#39;&#39;&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="reshape1-1转化成1行">reshape(1,-1)转化成1行：</h3>
<p><img src="https://img-blog.csdnimg.cn/20181121102711611.png" alt="img"></p>
<h3 id="areshape2-1转换成两行">areshape(2,-1)转换成两行：</h3>
<p><img src="https://img-blog.csdnimg.cn/20190511170410627.png" alt="img"></p>
<hr>
<h3 id="reshape-11转换成1列">reshape(-1,1)转换成1列：</h3>
<p><img src="https://img-blog.csdnimg.cn/20181121102749708.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x4bG9uZzg5OTQwMTAx,size_16,color_FFFFFF,t_70" alt="img"></p>
<h3 id="reshape-12转化成两列">reshape(-1,2)转化成两列</h3>
<p><img src="https://img-blog.csdnimg.cn/20181121102902256.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x4bG9uZzg5OTQwMTAx,size_16,color_FFFFFF,t_70" alt="img"></p>
<hr>
<h1 id="step09在python的list中使用for循环语句的技巧">Step09.在python的List中使用for循环语句的技巧</h1>
<h2 id="简单替换for循环">简单替换for循环</h2>
<ul>
<li>它的主要语法结构如下</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">my_list</span><span class="o">=</span><span class="p">[</span><span class="err">表达式</span> <span class="k">for</span> <span class="err">循环项</span> <span class="ow">in</span> <span class="err">循环体</span> <span class="p">(</span><span class="k">if</span> <span class="err">条件</span><span class="p">)]</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这里表达式可以为循环项，也可以为循环项的函数或者方法</p>
</blockquote>
<ul>
<li>下面我们看给例子</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Donald Trump&#34;</span>

<span class="c1">#list内的for循环语法,只使用一句代码</span>
<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>传统的for 循环语法是这么写的：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">name</span> <span class="o">=</span> <span class="s2">&#34;Donald Trump&#34;</span>

<span class="c1">#传统for循环语法,需要使用三句代码</span>
<span class="n">my_list</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
    <span class="n">my_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    
<span class="k">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>   
<span class="k">print</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>在这里传统的for循环需要使用三句代码, 而list内的for循环只使用了一句代码实现了同样的功能</p>
</blockquote>
<ul>
<li>我们再看一个例子：</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">array</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>

<span class="c1">#表达式可以为循环项的函数</span>
<span class="n">row_min</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">array</span> <span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">row_min</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>上面代码的作用是找出二维数组array(其实是list内嵌list)每一行的最小值，同样也只使用了一句代码。</p>
</blockquote>
<h2 id="在list内的循环中使用if-条件">在list内的循环中使用if 条件</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">names_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Washington&#34;</span><span class="p">,</span> <span class="s2">&#34;Trump&#34;</span><span class="p">,</span> <span class="s2">&#34;Obama&#34;</span><span class="p">,</span> <span class="s2">&#34;bush&#34;</span><span class="p">,</span> <span class="s2">&#34;Clinton&#34;</span><span class="p">,</span> <span class="s2">&#34;Reagan&#34;</span><span class="p">]</span>
<span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)]</span>
<span class="n">l2</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;W&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">l3</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">name</span><span class="o">.</span><span class="n">islower</span><span class="p">()]</span>
<span class="k">print</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="n">l2</span><span class="p">,</span> <span class="n">l3</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>我们发现在list循环中也可以很方便的使用if条件</p>
<p>这里我们在for循环的尾部使用了if条件语句</p>
<p>如果换成传统的for循环语法可能又要增加许多行业代码了</p>
</blockquote>
<h2 id="使用更加复杂的表达式">使用更加复杂的表达式</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">names_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;washington&#34;</span><span class="p">,</span> <span class="s2">&#34;trump&#34;</span><span class="p">,</span> <span class="s2">&#34;obama&#34;</span><span class="p">,</span> <span class="s2">&#34;bush&#34;</span><span class="p">,</span> <span class="s2">&#34;clinton&#34;</span><span class="p">,</span> <span class="s2">&#34;reagan&#34;</span><span class="p">]</span>

<span class="c1">#将人名首字母大写</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">new_names</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这里我们list内的表达式使用了循环项name的方法capitalize()</p>
</blockquote>
<ul>
<li>我们再看一个例子</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">my_list</span><span class="o">=</span><span class="p">[</span> <span class="err">表达式</span><span class="p">(</span><span class="k">if</span><span class="o">...</span><span class="k">else</span> <span class="err">条件</span><span class="p">)</span> <span class="k">for</span> <span class="err">循环项</span> <span class="ow">in</span> <span class="err">循环体</span> <span class="p">]</span>

<span class="n">names_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Washington&#34;</span><span class="p">,</span> <span class="s2">&#34;Trump&#34;</span><span class="p">,</span> <span class="s2">&#34;Obama&#34;</span><span class="p">,</span> <span class="s2">&#34;bush&#34;</span><span class="p">,</span> <span class="s2">&#34;Clinton&#34;</span><span class="p">,</span> <span class="s2">&#34;Reagan&#34;</span><span class="p">]</span>

<span class="c1">#在表达式中使用if条件</span>
<span class="n">new_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;Not President&#39;</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">new_names</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>之前我们是在for循环的尾部添加if 条件</p>
<p>不过我们也可以在表达式中使用if条件语句</p>
<p>这里需要指出的是表达式内的if条件语句中必须要同时使用else语句</p>
<p>这和之前在for循环尾部添加if条件有所不同</p>
</blockquote>
<ul>
<li>这是因为在表达式内的if语句必须遵循给变量赋值的python语法如</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="c1"># 语法错误</span>

<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>  
</code></pre></td></tr></table>
</div>
</div><h2 id="使用嵌套for循环语法">使用嵌套for循环语法</h2>
<blockquote>
<p>可以在list内使用嵌套for循环语法</p>
</blockquote>
<ul>
<li>下面我们看一个例子</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">names_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Trump&#34;</span><span class="p">,</span> <span class="s2">&#34;Obama&#34;</span><span class="p">,</span><span class="s2">&#34;Clinton&#34;</span><span class="p">]</span>

<span class="c1">#双重for循环</span>
<span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>下面是传统的两层for循环语句</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">names_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Trump&#34;</span><span class="p">,</span> <span class="s2">&#34;Obama&#34;</span><span class="p">,</span><span class="s2">&#34;Clinton&#34;</span><span class="p">]</span>

<span class="c1">#传统的双层for循环,需要使用4句代码</span>
<span class="n">chars</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
        <span class="n">chars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
        
<span class="k">print</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>我们看到传统的双层嵌套for循环需要使用4句代码</p>
<p>而list内的双层for循环只使用了一句代码</p>
<p>当然传统代码的可读性要比要比list内循环语句更好一些</p>
<p>因此也不太建议在list内加入太多的for循环，这样会使代码的可读性变差</p>
</blockquote>
<ul>
<li>另外我们还可以在两层for循环的中间使用if条件</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">names_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Trump&#34;</span><span class="p">,</span> <span class="s2">&#34;Obama&#34;</span><span class="p">,</span><span class="s2">&#34;bush&#34;</span><span class="p">]</span>

<span class="c1">#可以在两层for循环的中间使用if条件</span>
<span class="n">chars</span> <span class="o">=</span> <span class="p">[</span><span class="n">char</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="尽量避免使用mapfilter这样的内置函数">尽量避免使用map(),filter()这样的内置函数</h2>
<blockquote>
<p>python有一些内置函数如map()、filter(),这些内置函数使用简单</p>
<p>但是存在可读性差，不容易理解的缺点</p>
<p>一个良好的习惯是尽量使用list内的for循环来代替这些内置函数</p>
</blockquote>
<ul>
<li>map()函数可以这样替换</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># map函数</span>
<span class="n">L</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="err">循环体</span><span class="p">)</span>

<span class="c1"># 替换为</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">func</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="err">循环体</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">array</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">16</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
          <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>

<span class="n">row_min</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="n">array</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">row_min</span><span class="p">))</span>

<span class="c1">#替换为</span>
<span class="n">row_min</span> <span class="o">=</span> <span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">array</span> <span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">row_min</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>filter()函数可以替换为</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#filter函数</span>
<span class="n">L</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">condition_func</span><span class="p">,</span> <span class="err">循环体</span><span class="p">)</span>

<span class="c1"># 替换为</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="err">循环体</span> <span class="k">if</span> <span class="err">条件</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">names_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Trump&#34;</span><span class="p">,</span> <span class="s2">&#34;Obama&#34;</span><span class="p">,</span><span class="s2">&#34;bush&#34;</span><span class="p">]</span>
 
<span class="c1">#filter函数</span>
<span class="n">L1</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">name</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">,</span> <span class="n">names_list</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">L1</span><span class="p">))</span>
 
<span class="c1">#替换为：</span>
<span class="n">L2</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names_list</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">L2</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="尽量使用生成器generator变量来减少内存开销">尽量使用生成器(Generator)变量来减少内存开销</h2>
<blockquote>
<p>在python中定义一个list变量时</p>
<p>一般会给这个list变量立即分配内存</p>
<p>这种在定义变量时立即分配内存的方式会增加系统的内存开销</p>
<p>而一种高效的方法是只在定义变量时并不立即分配实际内存</p>
<p>只在真正使用变量时才会分配内存</p>
<p>这就是我们的Generator变量</p>
<p>在定义Generator变量时只要将原来list的方括号替换成圆括号即可:</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#list变量,立即分配实际内存</span>
<span class="n">L1</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="n">_000_000</span><span class="p">)]</span>
 
<span class="c1">#Generator变量,不分配实际内存</span>
<span class="n">L2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="n">_000_000</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">L1</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">L2</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">())</span>
</code></pre></td></tr></table>
</div>
</div><p>&mdash;&gt;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1">#list变量</span>
<span class="n">L1</span> <span class="o">=</span> <span class="p">[</span> <span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L1</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
 
<span class="c1">#替换为生成器变量</span>
<span class="n">L2</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">L2</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step10enumerate函数">Step10.enumerate函数</h1>
<ul>
<li>对于一个<code>可迭代集合</code>,在<code>循环体中</code>想同时获取元素在集合中<code>key和value</code>,可以使用enumerate函数</li>
</ul>
<hr>
<h1 id="step11string">Step11.string</h1>
<ul>
<li>
<p>可以使用join()来连接<code>list中的元素</code>和<code>字符串</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span>
<span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span> <span class="s1">&#39;llo&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span>
<span class="s1">&#39;Hello&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span>
<span class="s1">&#39;H-e-llo&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d</span><span class="o">=</span><span class="s1">&#39;*&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e</span><span class="o">=</span><span class="n">d</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">e</span>
<span class="s1">&#39;H*e*llo&#39;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step12python远程连接服务器">Step12.Python远程连接服务器</h1>
<h2 id="ssh">SSH</h2>
<h3 id="普通版本">普通版本</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">paramiko</span>

<span class="c1"># 建立一个sshclient对象</span>
<span class="n">ssh</span> <span class="o">=</span> <span class="n">paramiko</span><span class="o">.</span><span class="n">SSHClient</span><span class="p">()</span>
<span class="c1"># 允许将信任的主机自动加入到host_allow 列表，此方法必须放在connect方法的前面</span>
<span class="n">ssh</span><span class="o">.</span><span class="n">set_missing_host_key_policy</span><span class="p">(</span><span class="n">paramiko</span><span class="o">.</span><span class="n">AutoAddPolicy</span><span class="p">())</span>
<span class="c1"># 调用connect方法连接服务器</span>
<span class="n">ssh</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s1">&#39;ip&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>

<span class="c1"># while True:</span>
<span class="c1">#     order = input(&#39;==&gt;&#39;)</span>
<span class="c1">#     if order == &#39;exit&#39;:</span>
<span class="c1">#         # 关闭连接</span>
<span class="c1">#         ssh.close()</span>
<span class="c1">#         break</span>
<span class="c1">#     else:</span>
<span class="c1">#         # 执行命令</span>
<span class="c1">#         stdin, stdout, stderr = ssh.exec_command(order)</span>
<span class="c1">#         # 结果放到stdout中，如果有错误将放到stderr中</span>
<span class="c1">#         print(stdout.read().decode())</span>

<span class="c1"># 执行命令</span>
<span class="n">stdin</span><span class="p">,</span> <span class="n">stdout</span><span class="p">,</span> <span class="n">stderr</span> <span class="o">=</span> <span class="n">ssh</span><span class="o">.</span><span class="n">exec_command</span><span class="p">(</span><span class="s1">&#39;curl https://www.baidu.com&#39;</span><span class="p">)</span>
<span class="c1"># 结果放到stdout中，如果有错误将放到stderr中</span>
<span class="k">print</span><span class="p">(</span><span class="n">stdout</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
<span class="c1"># 关闭连接</span>
<span class="n">ssh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="step13python解析json文件">Step13.Python解析JSON文件</h1>
<ul>
<li>将json对象转换为字典</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="nb">dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">json_data</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>爬虫中requests模块,如果response是json格式,也可以使用这个方法(scrapy框架)</li>
</ul>
<h1 id="step14cmp_to_key函数">Step14.cmp_to_key函数</h1>
<blockquote>
<p>python3不支持比较函数</p>
<p>在一些接受key的函数中（例如sorted，min，max，heapq.nlargest，itertools.groupby）</p>
<p>key仅仅支持一个参数，就无法实现两个参数之间的对比</p>
<p>采用cmp_to_key 函数，可以接受两个参数，将两个参数做处理</p>
<p>比如做和做差，转换成一个参数，就可以应用于key关键字之后</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">cmp_to_key</span> 
<span class="n">L</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">cmp_to_key</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">y</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>
<span class="c1"># 输出：</span>
<span class="c1"># [23, 9, 2, 2, 1]</span>

<span class="nb">sorted</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="n">cmp_to_key</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">:</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">))</span>
<span class="c1"># 输出：</span>
<span class="c1">#[1, 2, 2, 9, 23]</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="step15python列表转换为字符串">Step15.python列表转换为字符串</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">list_a</span><span class="o">=</span><span class="p">[</span><span class="s2">&#34;345&#34;</span><span class="p">]</span>
<span class="n">str_a</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">list_a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">str_a</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">str_a</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>输出结果：</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">&lt;<span class="nb">type</span> <span class="s1">&#39;str&#39;</span>&gt;
345
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step16列表倒序">Step16.列表倒序</h1>
<ul>
<li><code>循环</code>代码多不适合一步<code>print</code>,<code>递归</code>当数据量过大浪费资源</li>
</ul>
<h2 id="sorted">sorted()</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="s1">&#39;&#39;&#39;
</span><span class="s1">遇到问题没人解答？小编创建了一个Python学习交流QQ群：579817333 
</span><span class="s1">寻找有志同道合的小伙伴，互帮互助,群里还有不错的视频学习教程和PDF电子书！
</span><span class="s1">&#39;&#39;&#39;</span>
<span class="n">listNode</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">newList</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">listNode</span><span class="p">,</span><span class="n">reverse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">newList</span><span class="p">)</span>

<span class="c1">#结果</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p><strong>这种方法只支持int</strong></p>
<h2 id="切片-1">切片[::-1]</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">listNode</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">li</span> <span class="o">=</span> <span class="n">listNode</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">li</span><span class="p">)</span>


<span class="c1">#结果</span>
<span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step17int">Step17.int()</h1>
<ul>
<li>int()函数用于将<code>数值类型</code>的数据转换成int类型</li>
<li>对于非数字类型不能直接转换,需要通过其他手段</li>
</ul>
<p><strong>比如float()函数,可以将str类型小数转换成float类型,而float类型是数值类型</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;1.1&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">)))</span> <span class="c1"># 1</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step18取字符串类型小数中的小数部分">Step18.取字符串类型小数中的小数部分</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">print</span><span class="p">(</span><span class="s1">&#39;0.&#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="mf">11.11</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))[</span><span class="mi">1</span><span class="p">])</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step19ubuntu下安装pip">Step19.Ubuntu下安装pip</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo apt-get install python3-pip
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step20random">Step20.Random</h1>
<ul>
<li>
<p>生成指定范围的整数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">)</span> <span class="c1"># 闭区间</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step21python文件导出为exe">Step21.python文件导出为exe</h1>
<h2 id="单文件">单文件</h2>
<ul>
<li>下载pyinstaller</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">pyinstaller -w -F xxx.py 
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>-w是隐藏默认的命令行黑窗口</p>
<p>-F</p>
<blockquote>
<p>表示希望将所有的程序全部打包在一起，生成的只有一个.exe文件，这样的文件集成度高，但是运行速度慢</p>
<p>如果不写-F，生成的还有一堆.dll文件，这样的程序里文件很多，但是运行速度比较快，这也是我们平时使用的程序的样式</p>
</blockquote>
</blockquote>
<hr>
<h1 id="step21在函数中更改全局变量">Step21.在函数中更改全局变量</h1>
<ul>
<li>
<p>python中禁止局部作用域更改全局变量</p>
</li>
<li>
<p>需要在局部作用域中声明要更改的变量为全部变量,此时操作的变量才是全部变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="mi">10</span>
  
<span class="k">def</span> <span class="nf">changeA</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">a</span>
    <span class="n">a</span> <span class="o">=</span> <span class="mi">20</span>
      
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># 20</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step22将数据写入到excel文件">Step22.将数据写入到excel文件</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hello.xlsx&#39;</span><span class="p">)</span> <span class="c1"># 建立文件</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span> <span class="c1"># 建立sheet,可以work.add_worksheet(&#39;employee&#39;)来指定sheet名，但中文名会报UnicodeDecodeErro的错误</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span> <span class="c1"># 向A1写入</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;guoshun&#39;</span><span class="p">)</span><span class="c1">#向第二行第二例写入guoshun</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step23list去重">Step23.list去重</h1>
<ul>
<li>
<p>set自动去重</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">list_array</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">list_array</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step24tkinter">Step24.Tkinter</h1>
<h2 id="实现一个随机数软件">实现一个随机数软件</h2>
<p><code>需求</code></p>
<blockquote>
<p>生成<code>指定范围</code>的<code>指定数量</code>随机数,将这些随机数分成<code>指定份数</code></p>
<p>点击<code>显示</code>按钮显示在<code>GUI面板的表格</code>上</p>
<p>点击<code>导出</code>按钮可以<code>导出excel文件</code></p>
</blockquote>
<p><code>实现</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">tkinter</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>
<span class="kn">import</span> <span class="nn">random</span>


<span class="k">class</span> <span class="nc">Main</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">notIn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">flag</span>

    <span class="k">def</span> <span class="nf">resData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">before_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>

        <span class="c1"># count = int(input(&#34;请输入随机次数:&#34;))  # count是随机次数，也就是随机数个数</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c1"># n = int(input(&#34;分成多少组显示:&#34;))  # n是分成几组</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&#34;不得高于60组&#34;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># 有60组的分组数量限制,因为正常都小于60组,也就那么几组,而且res1生成列表后后面一堆空的列表,所以生成随机数后需要将前面的有效值切片保存到新列表</span>

        <span class="c1"># 初始化用来存储随机数的列表</span>
        <span class="n">res1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">):</span>
            <span class="n">res1</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">random_res</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># random_res是生成的随机数列表</span>

        <span class="c1"># 生成的随机数</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_res</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">random_int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notIn</span><span class="p">(</span><span class="n">random_int</span><span class="p">,</span> <span class="n">random_res</span><span class="p">):</span>
                <span class="n">random_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_int</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">res1</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_res</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_res</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">group</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">res1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">before_n</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])</span>
                <span class="n">res</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="n">res_res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">res_child_list</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">res_child_set_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">res_child_list</span><span class="p">))</span>
            <span class="c1"># print(res_child_set_list)</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_child_set_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_child_list</span><span class="p">):</span>
                <span class="n">var_random</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_child_set_list</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">var_random</span> <span class="o">==</span> <span class="n">res_child_set_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                    <span class="n">res_child_set_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var_random</span><span class="p">)</span>
            <span class="n">res_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_child_set_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res_res</span>


<span class="n">root</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Tk</span><span class="p">()</span>
<span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&#34;软件&#34;</span><span class="p">)</span>  <span class="c1"># 窗口标题</span>
<span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s2">&#34;800x600&#34;</span><span class="p">)</span>

<span class="n">frame</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">frame</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">padx</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ipadx</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># 输入框名称</span>
<span class="n">count_label</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;随机数个数:&#39;</span><span class="p">)</span>
<span class="n">count_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

<span class="c1"># 保存输入值的变量</span>
<span class="n">count_string_var</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

<span class="c1"># 创建输入框</span>
<span class="n">count_input</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">count_string_var</span><span class="p">)</span>
<span class="n">count_input</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># 输入框名称</span>
<span class="n">n_label</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;分组个数:&#39;</span><span class="p">)</span>
<span class="n">n_label</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tkinter</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

<span class="c1"># 保存输入值的变量</span>
<span class="n">n_string_var</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>

<span class="c1"># 创建输入框</span>
<span class="n">n_input</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">n_string_var</span><span class="p">)</span>
<span class="n">n_input</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="s1">&#39;ew&#39;</span><span class="p">,</span> <span class="n">columnspan</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="c1"># excel_list = []</span>


<span class="c1"># def submit():</span>
<span class="c1">#     data = main.Main(count_string_var.get(), n_string_var.get())</span>
<span class="c1">#     res_list = data.resData()</span>
<span class="c1">#     # print(res_list)</span>
<span class="c1">#</span>
<span class="c1">#     global excel_list</span>
<span class="c1">#     for item in res_list:</span>
<span class="c1">#         excel_list.append(item)</span>
<span class="c1">#</span>
<span class="c1">#     childrens = tree.get_children()</span>
<span class="c1">#     for item in childrens:</span>
<span class="c1">#         tree.delete(item)</span>
<span class="c1">#</span>
<span class="c1">#     show(res_list)</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># def show(res_list):</span>
<span class="c1">#     pos = 0</span>
<span class="c1">#     for i in range(0, len(res_list)):</span>
<span class="c1">#         for j in range(0, len(res_list[i])):</span>
<span class="c1">#             tree.insert(&#39;&#39;, pos, values=(&#39;第&#39; + str(i + 1) + &#39;组&#39;, res_list[i][j]))</span>
<span class="c1">#             pos = pos + 1</span>
<span class="c1">#     tree.pack()</span>


<span class="k">def</span> <span class="nf">exportExcel</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">Main</span><span class="p">(</span><span class="n">count_string_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="n">n_string_var</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
    <span class="n">res_list</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">resData</span><span class="p">()</span>
    <span class="c1"># global excel_list</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">res_list</span><span class="p">:</span>
        <span class="n">item</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;------------------&#39;</span><span class="p">)</span>
        <span class="n">item</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;------------------&#39;</span><span class="p">)</span>

    <span class="n">excel</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;D://data.xlsx&#39;</span><span class="p">)</span>
    <span class="n">sheet</span> <span class="o">=</span> <span class="n">excel</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

    <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_list</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_list</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="s1">&#39;第&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;组&#39;</span><span class="p">)</span>
            <span class="n">sheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="n">res_list</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">excel</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c1"># res_list.clear()</span>


<span class="c1"># button1 = tkinter.Button(frame, text=&#34;生成&#34;, command=submit, default=&#39;active&#39;)</span>
<span class="c1"># button1.grid(row=2, column=1)</span>

<span class="n">button2</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&#34;退出&#34;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">root</span><span class="o">.</span><span class="n">quit</span><span class="p">)</span>
<span class="n">button2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">button3</span> <span class="o">=</span> <span class="n">tkinter</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&#34;导出&#34;</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="n">exportExcel</span><span class="p">)</span>
<span class="n">button3</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Treeview</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="n">tree</span><span class="p">[</span><span class="s2">&#34;columns&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;组号&#34;</span><span class="p">,</span> <span class="s2">&#34;数据&#34;</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&#34;组号&#34;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">column</span><span class="p">(</span><span class="s2">&#34;数据&#34;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s2">&#34;组号&#34;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&#34;组号&#34;</span><span class="p">)</span>
<span class="n">tree</span><span class="o">.</span><span class="n">heading</span><span class="p">(</span><span class="s2">&#34;数据&#34;</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&#34;数据&#34;</span><span class="p">)</span>

<span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="tkinter模块美化-ttkbootstrap">Tkinter模块美化-ttkbootstrap</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">ttkbootstrap</span> <span class="kn">as</span> <span class="nn">tk</span>

<span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span><span class="n">themename</span><span class="o">=</span><span class="s1">&#39;litera&#39;</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s1">&#39;350x500+500+500&#39;</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;萌新-注册页面&#39;</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">wm_attributes</span><span class="p">(</span><span class="s1">&#39;-topmost&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">username_str_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
<span class="n">password_str_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>

<span class="c1"># 0 女 1 男 -1 保密</span>
<span class="n">gender_str_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>
<span class="c1"># 兴趣爱好</span>
<span class="n">hobby_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(),</span> <span class="s1">&#39;吃&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(),</span> <span class="s1">&#39;喝&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(),</span> <span class="s1">&#39;玩&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">(),</span> <span class="s1">&#39;乐&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="c1"># 账户信息</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;用户名：&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">username_str_var</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;密  码：&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="n">password_str_var</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

<span class="c1"># 性别 单选框</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;性别：&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">radio_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">()</span>
<span class="n">radio_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="n">radio_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;男&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">gender_str_var</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="n">radio_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;女&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">gender_str_var</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Radiobutton</span><span class="p">(</span><span class="n">radio_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;保密&#39;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="n">gender_str_var</span><span class="p">,</span> <span class="n">value</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># 兴趣爱好</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;兴趣：&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">check_frame</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Frame</span><span class="p">()</span>
<span class="n">check_frame</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">check_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">hobby_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">variable</span><span class="o">=</span><span class="n">hobby_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">check_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">hobby_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">variable</span><span class="o">=</span><span class="n">hobby_list</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">bootstyle</span><span class="o">=</span><span class="s2">&#34;square-toggle&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span>
    <span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">check_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">hobby_list</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">variable</span><span class="o">=</span><span class="n">hobby_list</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">bootstyle</span><span class="o">=</span><span class="s2">&#34;round-toggle&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span>
    <span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">check_frame</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">hobby_list</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">variable</span><span class="o">=</span><span class="n">hobby_list</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="n">side</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span> <span class="n">padx</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># 生日</span>
<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;生日：&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">data_entry</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">DateEntry</span><span class="p">()</span>
<span class="n">data_entry</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data_entry</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>

<span class="c1"># print(birth_day.get())</span>

<span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
<span class="n">button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;提交&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_info</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;用户名&#39;</span><span class="p">:</span> <span class="n">username_str_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
        <span class="s1">&#39;密码&#39;</span><span class="p">:</span> <span class="n">password_str_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
        <span class="s1">&#39;性别&#39;</span><span class="p">:</span> <span class="n">gender_str_var</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span>
        <span class="s1">&#39;兴趣&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">h</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">hobby_list</span> <span class="k">if</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">()],</span>
        <span class="s1">&#39;生日&#39;</span><span class="p">:</span> <span class="n">data_entry</span><span class="o">.</span><span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.txt&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>



<span class="n">button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="n">get_info</span><span class="p">)</span>
<span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ttkbootstramp--selenium做一个天气查询软件">ttkbootstramp + selenium做一个天气查询软件</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span><span class="lnt">90
</span><span class="lnt">91
</span><span class="lnt">92
</span><span class="lnt">93
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="c1"># 实现无窗口</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.chrome.options</span> <span class="kn">import</span> <span class="n">Options</span>
<span class="kn">import</span> <span class="nn">ttkbootstrap</span> <span class="kn">as</span> <span class="nn">tk</span>

<span class="c1"># ------------------------------------------------- UI界面类 ----------------------------------------</span>
<span class="k">class</span> <span class="nc">UI</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ----------------------------------------- 创建界面 -----------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Window</span><span class="p">(</span><span class="n">themename</span><span class="o">=</span><span class="s1">&#39;litera&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">geometry</span><span class="p">(</span><span class="s1">&#39;800x700&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;萌新-注册页面&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">wm_attributes</span><span class="p">(</span><span class="s1">&#39;-topmost&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">province</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">city</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">()</span>

        <span class="c1"># ----------------------------------------- 创建输入框 --------------------------------------</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;请输入要查询的省份:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">province</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;请输入要查询的市:&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="n">pady</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Entry</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">textvariable</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">city</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>

        <span class="c1"># ------------------------------------------ 创建查询按钮 -----------------------------------</span>
        <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submit_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;查询&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submit_button</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submit_button</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">mainloop</span><span class="p">()</span>

    <span class="c1"># ----------------------------------------- 点击提交按钮后执行的方法 -------------------------------</span>
    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># print(self.province.get())</span>
        <span class="c1"># print(self.city.get())</span>
        <span class="n">webClower</span> <span class="o">=</span> <span class="n">WebClower</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">province</span><span class="o">.</span><span class="n">get</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">city</span><span class="o">.</span><span class="n">get</span><span class="p">())</span>
        <span class="c1"># print(webClower.query())</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">webClower</span><span class="o">.</span><span class="n">query</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sticky</span><span class="o">=</span><span class="n">tk</span><span class="o">.</span><span class="n">W</span><span class="p">)</span>


<span class="c1"># --------------------------------------------------- 爬取数据类 -----------------------------------------------------------</span>
<span class="k">class</span> <span class="nc">WebClower</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">province</span><span class="p">,</span> <span class="n">city</span><span class="p">):</span>
        <span class="c1"># ----------------------------------------------------- 参数 ------------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chrome_options</span> <span class="o">=</span> <span class="n">Options</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--headless&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chrome_options</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--disable-gpu&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://weathernew.pae.baidu.com/weathernew/pc?query=&#39;</span> <span class="o">+</span> <span class="n">province</span> <span class="o">+</span> <span class="n">city</span> <span class="o">+</span> <span class="s1">&#39;天气&amp;srcid=4982&#39;</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="c1"># -----------------------------------------------------------------------------------------------------------------</span>

        <span class="c1"># ----------------------------------------------------- 环境 -------------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s1">&#39;../chromedriver.exe&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">chrome_options</span><span class="p">)</span>
        <span class="c1"># -----------------------------------------------------------------------------------------------------------------</span>

    <span class="k">def</span> <span class="nf">query</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># ----------------------------------------------------- 信息 -------------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">url</span><span class="p">)</span>
        <span class="nb">all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                        <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[1]/p[1]/span[2]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">dushu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                          <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[2]/div[1]/span&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                      <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[2]/div[2]/div[2]/span[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">b</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                      <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[2]/div[2]/div[2]/span[2]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                      <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[2]/div[2]/div[2]/span[3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">shidu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                          <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[3]/span[1]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">ziwaixian</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                              <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[3]/span[2]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">richu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                          <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[3]/span[3]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
        <span class="n">riluo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">browser</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span>
                                          <span class="s1">&#39;//*[@id=&#34;sfr-app&#34;]/div/div[2]/div/div[2]/div/div[1]/div[3]/span[4]&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

        <span class="k">return</span> <span class="nb">all</span><span class="p">,</span> <span class="n">dushu</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">shidu</span><span class="p">,</span> <span class="n">ziwaixian</span><span class="p">,</span> <span class="n">richu</span><span class="p">,</span> <span class="n">riluo</span>

        <span class="c1"># ------------------------------------------------------------------------------------------------------------------</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">ui</span> <span class="o">=</span> <span class="n">UI</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step25pyqt">Step25.PyQt</h1>
<h2 id="实现一个随机数软件-1">实现一个随机数软件</h2>
<p><code>需求</code></p>
<blockquote>
<p>生成<code>指定范围</code>的<code>指定数量</code>随机数,将这些随机数分成<code>指定份数</code></p>
<p>点击<code>显示</code>按钮显示在<code>GUI面板的表格</code>上</p>
<p>点击<code>导出</code>按钮可以<code>导出excel文件</code></p>
</blockquote>
<p><code>实现</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">reportlab.lib.pagesizes</span> <span class="kn">import</span> <span class="n">portrait</span>
<span class="kn">from</span> <span class="nn">reportlab.pdfgen</span> <span class="kn">import</span> <span class="n">canvas</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">ImageGrab</span>


<span class="c1"># 算法类, 生成计算需要的二维随机数组</span>
<span class="k">class</span> <span class="nc">Main</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="n">count</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">notIn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">num</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">flag</span>

    <span class="k">def</span> <span class="nf">resData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">before_n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>

        <span class="c1"># count = int(input(&#34;请输入随机次数:&#34;))  # count是随机次数，也就是随机数个数</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="c1"># n = int(input(&#34;分成多少组显示:&#34;))  # n是分成几组</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
                <span class="k">print</span><span class="p">(</span><span class="s2">&#34;不得高于60组&#34;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span>

        <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># 有60组的分组数量限制,因为正常都小于60组,也就那么几组,而且res1生成列表后后面一堆空的列表,所以生成随机数后需要将前面的有效值切片保存到新列表</span>

        <span class="c1"># 初始化用来存储随机数的列表</span>
        <span class="n">res1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">60</span><span class="p">):</span>
            <span class="n">res1</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>

        <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">random_res</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># random_res是生成的随机数列表</span>

        <span class="c1"># 生成的随机数</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_res</span><span class="p">)</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">random_int</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notIn</span><span class="p">(</span><span class="n">random_int</span><span class="p">,</span> <span class="n">random_res</span><span class="p">):</span>
                <span class="n">random_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_int</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">group</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="n">res1</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_res</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">random_res</span><span class="p">):</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">group</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">group</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">res1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">before_n</span><span class="p">:</span>
                <span class="c1"># res[0].extend(res[len(res) - 1])</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">])):</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
                <span class="n">res</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="n">res_res</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">res_child_list</span> <span class="ow">in</span> <span class="n">res</span><span class="p">:</span>
            <span class="n">res_child_set_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">res_child_list</span><span class="p">))</span>
            <span class="c1"># print(res_child_set_list)</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_child_set_list</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_child_list</span><span class="p">):</span>
                <span class="n">var_random</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
                <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res_child_set_list</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">var_random</span> <span class="o">==</span> <span class="n">res_child_set_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">flag</span><span class="p">:</span>
                    <span class="n">res_child_set_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var_random</span><span class="p">)</span>
            <span class="n">res_res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_child_set_list</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">res_res</span>


<span class="k">class</span> <span class="nc">DataLocation</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DataLocation</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;火车头&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">header_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header_layout_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&#34;抽签表&#34;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">header_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header_layout_label</span><span class="p">)</span>
        <span class="c1"># -------------------------------------- 横向布局 -------------------------</span>
        <span class="c1"># ------------------------ 两个输入框 -----------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&#34;采样点数&#34;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">b_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&#34;火车车节数&#34;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

        <span class="c1"># -------------------------- 两个按钮 ------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_res_excel_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_res_excel</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&#34;生成并导出&#34;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_res_excel</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_res_excel</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableShowAndExport</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_res_excel_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_res_excel</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">btn_export_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_export</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s2">&#34;打印&#34;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_export</span><span class="o">.</span><span class="n">setMaximumWidth</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_export</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">window_capture</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">btn_export_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_export</span><span class="p">)</span>

        <span class="c1"># ---------------- 盒模型,将上面的输入框和按钮放在一行 ----------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_res_excel_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">btn_export_layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hbox</span><span class="p">)</span>

        <span class="c1"># --------------------------------------- 表格只生成一次 ------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span> <span class="o">=</span> <span class="n">QTableWidget</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="p">)</span>

        <span class="c1"># --------------------------------------- 底部的输入框 -------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&#34;采样员&#34;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">d_layout</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&#34;采样时间&#34;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">d_layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hbox1</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbox1</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_layout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hbox1</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">d_layout</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hbox1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tableShowAndExport</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#  ---------------------------------------- 获取数据 --------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">data_resource</span> <span class="o">=</span> <span class="n">Main</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data_resource</span><span class="o">.</span><span class="n">resData</span><span class="p">()</span>
            <span class="c1"># print(data)</span>
            <span class="c1"># print(type(data[0][0]))</span>

            <span class="c1"># ----------------------------------生成qt表格-----------------------------------------------</span>
            <span class="c1"># 其他操作全部随着点击按钮更新</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">horizontalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">setSectionResizeMode</span><span class="p">(</span><span class="n">QHeaderView</span><span class="o">.</span><span class="n">Stretch</span><span class="p">)</span>  <span class="c1"># 自适应宽度</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span><span class="s1">&#39;车厢序列&#39;</span><span class="p">,</span> <span class="s1">&#39;选点结果&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span>

            <span class="n">posLeft</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">posRight</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">right_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
                <span class="n">left</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%d</span><span class="s1">号车厢&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                    <span class="n">right_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">right</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right_list</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">posLeft</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">left</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tableWidget</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">posRight</span><span class="p">,</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="n">right</span><span class="p">))</span>
                <span class="n">posLeft</span> <span class="o">=</span> <span class="n">posLeft</span> <span class="o">+</span> <span class="mi">2</span>
                <span class="n">posRight</span> <span class="o">=</span> <span class="n">posRight</span> <span class="o">+</span> <span class="mi">2</span>
                <span class="n">right_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

            <span class="n">NowTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">d</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&#34;%Y年%m月</span><span class="si">%d</span><span class="s2">日 %H时:%M分:%S秒&#34;</span><span class="p">,</span> <span class="n">NowTime</span><span class="p">))</span>

            <span class="c1"># ---------------------------------- 导出excel ---------------------------------------------</span>
            <span class="n">data_copy</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">data_child_list</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">data_copy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_child_list</span><span class="p">)</span>

            <span class="n">excel</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\data.xlsx&#39;</span><span class="p">)</span>
            <span class="n">sheet</span> <span class="o">=</span> <span class="n">excel</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

            <span class="n">pos</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">right_excel_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_copy</span><span class="p">)):</span>
                <span class="n">sheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="s1">&#39;第&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;组&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data_copy</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
                    <span class="n">right_excel_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data_copy</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]))</span>
                <span class="n">right_excel</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">right_excel_list</span><span class="p">)</span>
                <span class="n">sheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pos</span><span class="p">),</span> <span class="n">right_excel</span><span class="p">)</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">right_excel_list</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">data_copy</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">excel</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1"># --------------------------- 图片转pdf ------------------------------------------</span>
    <span class="k">def</span> <span class="nf">jpg_to_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\file.png&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>

        <span class="n">user</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\file.pdf&#39;</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="n">portrait</span><span class="p">((</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)))</span>
        <span class="n">user</span><span class="o">.</span><span class="n">drawImage</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\file.png&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="n">user</span><span class="o">.</span><span class="n">showPage</span><span class="p">()</span>
        <span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

    <span class="c1"># ---------------------------- 截图 ----------------------------------------</span>
    <span class="k">def</span> <span class="nf">window_capture</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">660</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">1258</span><span class="p">,</span> <span class="mi">914</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ImageGrab</span><span class="o">.</span><span class="n">grab</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>

        <span class="c1"># 参数 保存截图文件的路径</span>
        <span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\file.png&#39;</span><span class="p">)</span>
        <span class="n">im</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">t_pdf</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="mf">5.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">jpg_to_pdf</span><span class="p">)</span>
        <span class="n">t_pdf</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">QApplication</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
    <span class="n">main</span> <span class="o">=</span> <span class="n">DataLocation</span><span class="p">()</span>   
    <span class="k">print</span><span class="p">(</span><span class="n">main</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
    <span class="n">main</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">exec_</span><span class="p">())</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step26python获取当前时间">Step26.python获取当前时间</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">time</span>
<span class="n">NowTime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span> <span class="c1">#获取当前时间</span>
<span class="k">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&#34;</span><span class="p">,</span> <span class="n">NowTime</span><span class="p">))</span> <span class="c1">#对当前时间进行格式化并输出</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>%Y 年（四位数：000-9999） 2020</li>
<li>%y 年（两位数：00-99） 2020 ：20</li>
<li>%m 月（01-12）</li>
<li>%d 日（0-31）</li>
<li>%H 小时（24小时制：0-23）</li>
<li>%I 小时（12小时制：01-12）</li>
<li>%M 分钟（00=59）</li>
<li>%S 秒（00-59）</li>
<li>%a 本地简化星期名称 星期四：Thu</li>
<li>%A 本地完整星期名称 星期四：Thursday</li>
<li>%b 本地简化的月份名称 七月：Jul</li>
<li>%B 本地完整的月份名称 七月：July</li>
<li>%c 本地相应的日期表示和时间表示 你电脑右下角是怎么表示的 就会输出什么格式 有秒数</li>
<li>%j 年内的一天（001-366）</li>
<li>%p 本地A.M.或P.M.的等价符</li>
<li>%U 一年中的星期数（00-53）星期天为星期的开始</li>
<li>%w 星期（0-6），星期天为星期的开始</li>
<li>%W 一年中的星期数（00-53）星期一为星期的开始</li>
<li>%x 本地相应的日期表示</li>
<li>%X 本地相应的时间表示</li>
<li>%Z 当前时区的名称</li>
<li>%% %号本身</li>
</ul>
<hr>
<h1 id="step27python图片转pdf">Step27.python图片转pdf</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">reportlab.lib.pagesizes</span> <span class="kn">import</span> <span class="n">portrait</span>
<span class="kn">from</span> <span class="nn">reportlab.pdfgen</span> <span class="kn">import</span> <span class="n">canvas</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="k">def</span> <span class="nf">jpg_to_pdf</span><span class="p">(</span><span class="n">jpg</span><span class="p">,</span> <span class="n">pdf_path</span><span class="p">):</span>
    <span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">jpg</span><span class="p">)</span><span class="o">.</span><span class="n">size</span>
    <span class="n">user</span> <span class="o">=</span> <span class="n">canvas</span><span class="o">.</span><span class="n">Canvas</span><span class="p">(</span><span class="n">pdf_path</span><span class="p">,</span> <span class="n">pagesize</span><span class="o">=</span><span class="n">portrait</span><span class="p">((</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)))</span>
    <span class="n">user</span><span class="o">.</span><span class="n">drawImage</span><span class="p">(</span><span class="n">jpg</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">user</span><span class="o">.</span><span class="n">showPage</span><span class="p">()</span>
    <span class="n">user</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">jpg_path</span> <span class="o">=</span> <span class="s1">&#39;code.png&#39;</span>
    <span class="n">pdf_path</span> <span class="o">=</span> <span class="s1">&#39;code.pdf&#39;</span>
    <span class="n">jpg_to_pdf</span><span class="p">(</span><span class="n">jpg_path</span><span class="p">,</span> <span class="n">pdf_path</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step28python截图">Step28.python截图</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">ImageGrab</span>
 
<span class="c1"># 参数说明</span>
<span class="c1"># 第一个参数 开始截图的x坐标</span>
<span class="c1"># 第二个参数 开始截图的y坐标</span>
<span class="c1"># 第三个参数 结束截图的x坐标</span>
<span class="c1"># 第四个参数 结束截图的y坐标</span>
<span class="n">bbox</span> <span class="o">=</span> <span class="p">(</span><span class="mi">760</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1160</span><span class="p">,</span> <span class="mi">1080</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">ImageGrab</span><span class="o">.</span><span class="n">grab</span><span class="p">(</span><span class="n">bbox</span><span class="p">)</span>
 
<span class="c1"># 参数 保存截图文件的路径</span>
<span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;zy.png&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step29python录屏">Step29.python录屏</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">ImageGrab</span>

<span class="n">m</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;输入录屏几分钟：&#34;</span><span class="p">))</span>
<span class="n">m</span><span class="o">=</span><span class="n">m</span><span class="o">*</span><span class="mi">60</span>
<span class="n">n</span><span class="o">=</span><span class="mi">1</span>
<span class="k">while</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">m</span><span class="p">:</span>
    <span class="n">sleep</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>
    <span class="n">im</span><span class="o">=</span><span class="n">ImageGrab</span><span class="o">.</span><span class="n">grab</span><span class="p">()</span>
    <span class="n">local</span><span class="o">=</span><span class="p">(</span><span class="sa">r</span><span class="s2">&#34;</span><span class="si">%s</span><span class="s2">.jpg&#34;</span><span class="o">%</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">im</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">local</span><span class="p">,</span><span class="s1">&#39;jpeg&#39;</span><span class="p">)</span>
    <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step30指定时间后执行某函数">Step30.指定时间后执行某函数</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Timer</span>

<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;hello, world&#34;</span><span class="p">)</span>
<span class="c1"># 指定10秒后执行hello函数</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">(</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">hello</span><span class="p">)</span>
<span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step31python文字转语音">Step31.Python文字转语音</h1>
<h2 id="无脑版文字直接播放">无脑版,文字直接播放</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pyttsx3</span>

<span class="n">text</span><span class="o">=</span><span class="s1">&#39;hello,world&#39;</span>

<span class="n">voice</span><span class="o">=</span><span class="n">pyttsx3</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<span class="n">voice</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="n">voice</span><span class="o">.</span><span class="n">runAndWait</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step32判断变量真假">Step32.判断变量真假</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;False&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step33判断变量是否为某个值">Step33.判断变量是否为某个值</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">a</span> <span class="o">=</span> <span class="s1">&#39;a&#39;</span>
<span class="k">if</span> <span class="n">a</span> <span class="ow">is</span> <span class="s1">&#39;a&#39;</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step34math模块">Step34.math模块</h1>
<ul>
<li>
<p>向上取整</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">math</span>
<span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>向下取整</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">math</span>
<span class="n">math</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span> <span class="n">x</span> <span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step35字符串">Step35.字符串</h1>
<h2 id="切片函数split">切片函数split</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">date</span> <span class="o">=</span> <span class="s1">&#39;2022-01-01&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">))</span> <span class="c1"># 切片结果是一个列表</span>
<span class="k">print</span><span class="p">(</span><span class="n">date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="替换字符串中指定字符串">替换字符串中指定字符串</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;</span><span class="se">\xa0</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="向字符串中插入字符或字符串">向字符串中插入字符或字符串</h2>
<ul>
<li>
<p>字符串转list,插入,转字符串</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">s1</span> <span class="o">=</span> <span class="s2">&#34;2021.12.2415:28:00&#34;</span>
<span class="n">t1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s1</span><span class="p">)</span>
<span class="n">t1</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">)</span> <span class="c1"># 1的位置插入&#39;e&#39;</span>
<span class="n">s1_new</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>  <span class="c1"># 连接起来</span>
<span class="k">print</span><span class="p">(</span><span class="n">s1_new</span><span class="p">)</span>
<span class="s1">&#39;2e021.12.2415:28:00&#39;</span>
  
  
<span class="n">s2</span> <span class="o">=</span> <span class="s2">&#34;2021.12.2415:28:00&#34;</span>
<span class="n">t2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">s2</span><span class="p">)</span>
<span class="n">t2</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span> <span class="c1"># 10的位置插入&#39; &#39;空格</span>
<span class="n">s2_new</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>  <span class="c1"># 连接起来</span>
<span class="k">print</span><span class="p">(</span><span class="n">s2_new</span><span class="p">)</span>
<span class="s1">&#39;2021.12.24 15:28:00&#39;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step36datetime模块">Step36.datetime模块</h1>
<h2 id="time--datetime--string-相互转换">time &amp; datetime &amp; string 相互转换</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/python</span>
<span class="c1"># -*- coding:utf-8 -*-</span>
 
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">time</span>
 
 
<span class="c1"># 日期时间字符串</span>
<span class="n">st</span> <span class="o">=</span> <span class="s2">&#34;2017-11-23 16:10:10&#34;</span>
<span class="c1"># 当前日期时间</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="c1"># 当前时间戳</span>
<span class="n">sp</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
 
<span class="c1"># 1.把datetime转成字符串</span>
<span class="k">def</span> <span class="nf">datetime2String</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;1.把datetime转成字符串: &#34;</span><span class="p">,</span> <span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&#34;</span><span class="p">))</span>
 
 
<span class="c1"># 2.把字符串转成datetime</span>
<span class="k">def</span> <span class="nf">string2Datetime</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;2.把字符串转成datetime: &#34;</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&#34;</span><span class="p">))</span>
 
 
<span class="c1"># 3.把字符串转成时间戳形式</span>
<span class="k">def</span> <span class="nf">string2Timestamp</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;3.把字符串转成时间戳形式:&#34;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&#34;</span><span class="p">)))</span>
 
 
<span class="c1"># 4.把时间戳转成字符串形式</span>
<span class="k">def</span> <span class="nf">timestamp2String</span><span class="p">(</span><span class="n">sp</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;4.把时间戳转成字符串形式: &#34;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&#34;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">(</span><span class="n">sp</span><span class="p">)))</span>
 
 
<span class="c1"># 5.把datetime类型转外时间戳形式</span>
<span class="k">def</span> <span class="nf">datetime2Timestamp</span><span class="p">(</span><span class="n">dt</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;5.把datetime类型转外时间戳形式:&#34;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>
 
 
<span class="c1"># 1.把datetime转成字符串</span>
<span class="n">datetime2String</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
<span class="c1"># 2.把字符串转成datetime</span>
<span class="n">string2Datetime</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
<span class="c1"># 3.把字符串转成时间戳形式</span>
<span class="n">string2Timestamp</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
<span class="c1"># 4.把时间戳转成字符串形式</span>
<span class="n">timestamp2String</span><span class="p">(</span><span class="n">sp</span><span class="p">)</span>
<span class="c1"># 5.把datetime类型转外时间戳形式</span>
<span class="n">datetime2Timestamp</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="获取今天是星期几">获取今天是星期几</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="n">dayOfWeek</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoweekday</span><span class="p">()</span> <span class="c1">###返回数字1-7代表周一到周日</span>
<span class="n">day_Week</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span> <span class="c1">###返回从0开始的数字，比如今天是星期5，那么返回的就是4</span>
<span class="k">print</span><span class="p">(</span><span class="n">dayOfWeek</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">day_Week</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="获取两个是日期之间距离多少天">获取两个是日期之间距离多少天</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">demo</span><span class="p">(</span><span class="n">day1</span><span class="p">,</span> <span class="n">day2</span><span class="p">):</span>

<span class="n">time_array1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">day1</span><span class="p">,</span> <span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2">&#34;</span><span class="p">)</span>

<span class="n">timestamp_day1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">time_array1</span><span class="p">))</span>

<span class="n">time_array2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">day2</span><span class="p">,</span> <span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2">&#34;</span><span class="p">)</span>

<span class="n">timestamp_day2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">time_array2</span><span class="p">))</span>

<span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">timestamp_day2</span> <span class="o">-</span> <span class="n">timestamp_day1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">60</span> <span class="o">//</span> <span class="mi">60</span> <span class="o">//</span> <span class="mi">24</span>

<span class="k">return</span> <span class="n">result</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step372022年大二疫情上网课提醒助手">Step37.2022年大二疫情上网课提醒助手</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="kn">as</span> <span class="nn">date</span>
<span class="kn">import</span> <span class="nn">pyttsx3</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="n">flag</span> <span class="o">=</span> <span class="bp">False</span>


<span class="c1"># 获取当前是星期几</span>
<span class="k">def</span> <span class="nf">getDayOfWeek</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">())</span><span class="o">.</span><span class="n">isoweekday</span><span class="p">()</span>  <span class="c1"># 返回数字1-7代表周一到周日</span>


<span class="c1"># 获取当前日期并格式化为 xxxx-xx-xx xx-xx-xx</span>
<span class="k">def</span> <span class="nf">getCurrentDate</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">date</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H-%M-%S&#34;</span><span class="p">)</span>


<span class="c1"># 获取当前是第几周,从2022年2月26日开始计算</span>
<span class="k">def</span> <span class="nf">getBetterWeek</span><span class="p">():</span>
    <span class="c1"># 将 xxxx-xx-xx xx-xx-xx 时间字符串转换为时间对象</span>
    <span class="c1"># 开始时间</span>
    <span class="n">time_array1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2022-02-26&#39;</span><span class="p">,</span> <span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2">&#34;</span><span class="p">)</span>

    <span class="n">timestamp_day1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">time_array1</span><span class="p">))</span>

    <span class="c1"># 结束时间,也就是当前时间</span>
    <span class="n">time_array2</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">getCurrentDate</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2">&#34;</span><span class="p">)</span>

    <span class="n">timestamp_day2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="n">time_array2</span><span class="p">))</span>

    <span class="n">daysStr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">((</span><span class="n">timestamp_day2</span> <span class="o">-</span> <span class="n">timestamp_day1</span><span class="p">)</span> <span class="o">//</span> <span class="mi">60</span> <span class="o">//</span> <span class="mi">60</span> <span class="o">//</span> <span class="mi">24</span><span class="p">)</span>

    <span class="n">days</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">daysStr</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">days</span> <span class="o">/</span> <span class="mi">7</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>


<span class="c1"># 播放语音函数</span>
<span class="k">def</span> <span class="nf">say</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">voice</span> <span class="o">=</span> <span class="n">pyttsx3</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

    <span class="n">voice</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

    <span class="n">voice</span><span class="o">.</span><span class="n">runAndWait</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">isMonday</span><span class="p">():</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">getCurrentDate</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">week</span> <span class="o">=</span> <span class="n">getBetterWeek</span><span class="p">()</span>

    <span class="k">global</span> <span class="n">flag</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10点30分,有一门课程要上,课程为:数据库系统原理&#34;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;14时30分,有一门课程要上,课程为:网络爬虫技术&#34;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">15</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;16点25分,有一门课要上,课程为:行业数据采集开发&#34;</span><span class="p">)</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;19点30分,有一门课要上,课程为:服装设计&#34;</span><span class="p">)</span>

        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="c1"># print(week)</span>
    <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;10-10-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10点30分,有一门课程要上,课程为:数据库系统原理&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;14-15-10&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;14时30分,有一门课程要上,课程为:网络爬虫技术&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;16-10-10&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">15</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;16点25分,有一门课要上,课程为:行业数据采集开发&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;19-15-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;19点30分,有一门课要上,课程为:服装设计&#34;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">isTuesday</span><span class="p">():</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">getCurrentDate</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">week</span> <span class="o">=</span> <span class="n">getBetterWeek</span><span class="p">()</span>

    <span class="k">global</span> <span class="n">flag</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;8点30分,有一门课程要上,课程为:毛概&#34;</span><span class="p">)</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10时30分,有一门课程要上,课程为:操作系统&#34;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">15</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;16点25分,有一门课要上,课程为:行业数据采集开发&#34;</span><span class="p">)</span>

        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;08-15-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;8点30分,有一门课程要上,课程为:毛概&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;10-10-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10时30分,有一门课程要上,课程为:操作系统&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;161010&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">15</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;16点25分,有一门课要上,课程为:行业数据采集开发&#34;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">isWednesday</span><span class="p">():</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">getCurrentDate</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">week</span> <span class="o">=</span> <span class="n">getBetterWeek</span><span class="p">()</span>

    <span class="k">global</span> <span class="n">flag</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;08时30分,有一门课程要上,课程为:线性代数&#34;</span><span class="p">)</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10时30分,有一门课程要上,课程为:大数据技术基础&#34;</span><span class="p">)</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;14时30分,有一门课程要上,课程为:MySQL&#34;</span><span class="p">)</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;16时10分,有一门课程要上,课程为:太极拳&#34;</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;08-15-10&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;08时30分,有一门课程要上,课程为:线性代数&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;10-10-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10时30分,有一门课程要上,课程为:大数据技术基础&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;14-15-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;14时30分,有一门课程要上,课程为:MySQL&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;16-10-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;16时10分,有一门课程要上,课程为:太极拳&#34;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">isThursday</span><span class="p">():</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">getCurrentDate</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">week</span> <span class="o">=</span> <span class="n">getBetterWeek</span><span class="p">()</span>

    <span class="k">global</span> <span class="n">flag</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;08时30分,有一门课程要上,课程为:爬虫&#34;</span><span class="p">)</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10时30分,有一门课程要上,课程为:毛概&#34;</span><span class="p">)</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;19点30分,有一门课要上,课程为:选修中外电影&#34;</span><span class="p">)</span>
        <span class="n">flag</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;08-15-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;08时30分,有一门课程要上,课程为:爬虫&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;10-10-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10时30分,有一门课程要上,课程为:毛概&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;19-15-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;19点30分,有一门课要上,课程为:选修中外电影&#34;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">isFriday</span><span class="p">():</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">getCurrentDate</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">week</span> <span class="o">=</span> <span class="n">getBetterWeek</span><span class="p">()</span>

    <span class="k">global</span> <span class="n">flag</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">flag</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;08时30分,有一门课程要上,课程为:大数据技术基础&#34;</span><span class="p">)</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10时30分,有一门课程要上,课程为:线性代数&#34;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">15</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;14点30分,有一门课要上,课程为:行业数据采集开发&#34;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">15</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;16点25分,有一门课要上,课程为:行业数据采集开发&#34;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;08-15-10&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;08时30分,有一门课程要上,课程为:大数据技术基础&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;10-10-10&#39;</span><span class="p">:</span>
        <span class="n">say</span><span class="p">(</span><span class="s2">&#34;10时30分,有一门课程要上,课程为:线性代数&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;14-15-10&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">15</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;14点30分,有一门课要上,课程为:行业数据采集开发&#34;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">time</span> <span class="o">==</span> <span class="s1">&#39;16-10-10&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">13</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">14</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">15</span> <span class="ow">or</span> <span class="n">week</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;16点25分,有一门课要上,课程为:行业数据采集开发&#34;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">isSaturday</span><span class="p">():</span>
    <span class="n">say</span><span class="p">(</span><span class="s2">&#34;大哥,今天是星期六&#34;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">isSunday</span><span class="p">():</span>
    <span class="n">say</span><span class="p">(</span><span class="s2">&#34;大哥,今天是星期日&#34;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">dayOfWeek</span> <span class="o">=</span> <span class="n">getDayOfWeek</span><span class="p">()</span>

    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">getCurrentDate</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">21</span><span class="p">:</span>
            <span class="n">say</span><span class="p">(</span><span class="s2">&#34;可算上完课了,tnnd&#34;</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="k">if</span> <span class="n">dayOfWeek</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">isMonday</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">dayOfWeek</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">isTuesday</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">dayOfWeek</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">isWednesday</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">dayOfWeek</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">isThursday</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">dayOfWeek</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">isFriday</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">dayOfWeek</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">isSaturday</span><span class="p">()</span>
            <span class="k">break</span>
        <span class="k">elif</span> <span class="n">dayOfWeek</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">isSunday</span><span class="p">()</span>
            <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step38逆排序代码">Step38.逆排序代码</h1>
<blockquote>
<p>在一个排列中，如果一对数的前后位置与大小顺序相反，即前面的数大于后面的数，那么它们就称为一个逆序。一个排列中逆序的总数就称为这个排列的逆序数。一个排列中所有逆序总数叫做这个排列的逆序数。也就是说，对于n个不同的元素，先规定各元素之间有一个标准次序（例如n个 不同的自然数，可规定从小到大为标准次序），于是在这n个元素的任一排列中，当某两个元素的先后次序与标准次序不同时，就说有1个逆序。一个排列中所有逆序总数叫做这个排列的逆序数。</p>
</blockquote>
<h2 id="暴力破解法">暴力破解法</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">inverse_number</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="s1">&#39;input a number which is string than,you will get the inverse number&#39;</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">string</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">string</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">string</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">ans</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">ans</span>
 
<span class="k">print</span><span class="p">(</span><span class="n">inverse_number</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&#34;Please input the number: &#34;</span><span class="p">)))</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step39图灵机器人--百度ai实现智能语音对话机器人">Step39.图灵机器人 + 百度AI实现智能语音对话机器人</h1>
<h2 id="准备工具">准备工具</h2>
<h3 id="图灵机器人">图灵机器人</h3>
<ul>
<li>购买图灵机器人</li>
<li>然后复制它的apikey</li>
</ul>
<h3 id="百度ai接口">百度AI接口</h3>
<ul>
<li>
<p><a href="http://ai.baidu.com/">官网</a></p>
</li>
<li>
<p>注册账号</p>
</li>
<li>
<p>注册成功后登录</p>
</li>
<li>
<p><code>控制台</code>创建应用</p>
</li>
<li>
<p>创建成功后复制应用的</p>
<blockquote>
<p>AppID</p>
<p>API Key</p>
<p>Secret Key</p>
</blockquote>
</li>
</ul>
<hr>
<h3 id="库">库</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">pip install pipwin
pipwin install PyAudio
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">SpeechRecognition
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">baiduaip</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="代码部分">代码部分</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">aip</span> <span class="kn">import</span> <span class="n">AipSpeech</span>  <span class="c1"># 百度ai库,用于音频转语音</span>
<span class="kn">import</span> <span class="nn">requests</span>  <span class="c1"># 请求网络资源库</span>
<span class="kn">import</span> <span class="nn">json</span>  <span class="c1"># json库,用于处理json数据</span>
<span class="kn">import</span> <span class="nn">speech_recognition</span> <span class="kn">as</span> <span class="nn">sr</span>  <span class="c1"># 语音转文字库,可调用麦克风</span>
<span class="kn">import</span> <span class="nn">win32com.client</span>

<span class="c1"># 初始化语音</span>
<span class="n">speaker</span> <span class="o">=</span> <span class="n">win32com</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">Dispatch</span><span class="p">(</span><span class="s2">&#34;SAPI.SpVoice&#34;</span><span class="p">)</span>


<span class="c1"># ----------------------------------------------- 语音生成音频文件,录音并以当前时间戳保存到voices文件中 ----------------------------------------------------------</span>
<span class="c1"># Use SpeechRecognition to record 使用语音识别录制</span>
<span class="k">def</span> <span class="nf">my_record</span><span class="p">(</span><span class="n">rate</span><span class="o">=</span><span class="mi">16000</span><span class="p">):</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">Recognizer</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">sr</span><span class="o">.</span><span class="n">Microphone</span><span class="p">(</span><span class="n">sample_rate</span><span class="o">=</span><span class="n">rate</span><span class="p">)</span> <span class="k">as</span> <span class="n">source</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;please say something&#34;</span><span class="p">)</span>
        <span class="n">audio</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;voices/myvoices.wav&#34;</span><span class="p">,</span> <span class="s2">&#34;wb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">audio</span><span class="o">.</span><span class="n">get_wav_data</span><span class="p">())</span>

<span class="c1"># --------------------------------------------------------------------------------------------------------------------------------------------------------</span>


<span class="c1"># -------------------------------------------------------------- 百度ai音频转文字 ---------------------------------------------------------------------------</span>

<span class="c1"># 将说话后录制的音频转换为文本</span>
<span class="n">APP_ID</span> <span class="o">=</span> <span class="s1">&#39;25739713&#39;</span>
<span class="n">API_KEY</span> <span class="o">=</span> <span class="s1">&#39;2qHyxyjMytCTHlpk8yUZNCrw&#39;</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s1">&#39;WIVvXYjGtCZuRmpmBmSFGcXNksgiwFF0&#39;</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">AipSpeech</span><span class="p">(</span><span class="n">APP_ID</span><span class="p">,</span> <span class="n">API_KEY</span><span class="p">,</span> <span class="n">SECRET_KEY</span><span class="p">)</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;voices/myvoices.wav&#39;</span>


<span class="k">def</span> <span class="nf">listen</span><span class="p">():</span>
    <span class="c1"># 读取录音文件</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
        <span class="n">voices</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># 参数dev_pid：1536普通话(支持简单的英文识别)、1537普通话(纯中文识别)、1737英语、1637粤语、1837四川话、1936普通话远场</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">asr</span><span class="p">(</span><span class="n">voices</span><span class="p">,</span> <span class="s1">&#39;wav&#39;</span><span class="p">,</span> <span class="mi">16000</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;dev_pid&#39;</span><span class="p">:</span> <span class="mi">1537</span><span class="p">,</span> <span class="p">})</span>
        <span class="n">result_text</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s2">&#34;result&#34;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;you said: &#34;</span> <span class="o">+</span> <span class="n">result_text</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result_text</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;KeyError&#34;</span><span class="p">)</span>
        <span class="n">speaker</span><span class="o">.</span><span class="n">Speak</span><span class="p">(</span><span class="s2">&#34;我没有听清楚，请再说一遍...&#34;</span><span class="p">)</span>

<span class="c1"># --------------------------------------------------------------------------------------------------------------------------------------------------------</span>

<span class="c1"># -----------------------------------------------------图灵机器人,将用户说出的音频转成的文字发送给图灵机器人API----------------------------------------------------</span>
<span class="c1"># 图灵机器人的API_KEY、API_URL</span>
<span class="n">turing_api_key</span> <span class="o">=</span> <span class="s2">&#34;e6817080079f4936ba116966d02c793b&#34;</span>
<span class="n">api_url</span> <span class="o">=</span> <span class="s2">&#34;http://openapi.tuling123.com/openapi/api/v2&#34;</span>  <span class="c1"># 图灵机器人api网址</span>

<span class="c1"># 请求头,类型是JSON数据</span>
<span class="c1"># 对一个url发起请求需要指定它的请求头才能成功</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/json;charset=UTF-8&#39;</span><span class="p">}</span>


<span class="c1"># ------------------------------------------------------------------ 图灵机器人回复 -------------------------------------------------------------------------</span>
<span class="c1"># https://www.kancloud.cn/turing/www-tuling123-com/718227 官方接口文档</span>
<span class="k">def</span> <span class="nf">Turing</span><span class="p">(</span><span class="n">text_words</span><span class="o">=</span><span class="s2">&#34;&#34;</span><span class="p">):</span>
    <span class="c1"># 调用图灵机器人api时,你需要在url中添加一个请求参数</span>
    <span class="c1"># 该请求参数参照 图灵机器人 官网</span>
    <span class="n">req</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&#34;reqType&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&#34;perception&#34;</span><span class="p">:</span> <span class="p">{</span>
            <span class="c1"># 请求的文本信息,图灵机器人会分析你发送的文本并给出响应</span>
            <span class="s2">&#34;inputText&#34;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&#34;text&#34;</span><span class="p">:</span> <span class="n">text_words</span>
            <span class="p">},</span>

            <span class="c1"># 客户端属性,地址随意</span>
            <span class="s2">&#34;selfInfo&#34;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&#34;location&#34;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&#34;city&#34;</span><span class="p">:</span> <span class="s2">&#34;北京&#34;</span><span class="p">,</span>
                    <span class="s2">&#34;province&#34;</span><span class="p">:</span> <span class="s2">&#34;北京&#34;</span><span class="p">,</span>
                    <span class="s2">&#34;street&#34;</span><span class="p">:</span> <span class="s2">&#34;车公庄&#34;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="c1"># 用户参数</span>
        <span class="s2">&#34;userInfo&#34;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&#34;apiKey&#34;</span><span class="p">:</span> <span class="n">turing_api_key</span><span class="p">,</span>  <span class="c1"># 你的图灵机器人apiKey</span>
            <span class="s2">&#34;userId&#34;</span><span class="p">:</span> <span class="s2">&#34;Nieson&#34;</span>  <span class="c1"># 用户唯一标识(随便填, 非密钥)</span>
        <span class="p">}</span>
    <span class="p">}</span>


    <span class="n">req</span><span class="p">[</span><span class="s2">&#34;perception&#34;</span><span class="p">][</span><span class="s2">&#34;inputText&#34;</span><span class="p">][</span><span class="s2">&#34;text&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text_words</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s2">&#34;post&#34;</span><span class="p">,</span> <span class="n">api_url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">req</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">response_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="c1"># 取值方法参照官方文档</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">response_dict</span><span class="p">[</span><span class="s2">&#34;results&#34;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&#34;values&#34;</span><span class="p">][</span><span class="s2">&#34;text&#34;</span><span class="p">]</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;AI Robot said: &#34;</span> <span class="o">+</span> <span class="n">result</span><span class="p">)</span> <span class="c1"># 打印出图灵机器人回复的信息</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="c1"># ---------------------------------------------------------------------------------------------------------------------------------------------------------</span>


<span class="c1"># 语音合成，输出机器人的回答</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="n">my_record</span><span class="p">()</span> <span class="c1"># 打开麦克风,录音并转为音频</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">listen</span><span class="p">()</span> <span class="c1"># 上一步转出的音频转为文字</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">Turing</span><span class="p">(</span><span class="n">request</span><span class="p">)</span> <span class="c1"># 将上一步转出的文字,通过requests的POST请求的方式发送给图灵机器人,并接收图灵机器人返回的数据</span>
    <span class="n">speaker</span><span class="o">.</span><span class="n">Speak</span><span class="p">(</span><span class="n">response</span><span class="p">)</span> <span class="c1"># 将上一步图灵机器人给出的响应文字播放语音</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="遇到的问题">遇到的问题</h2>
<ul>
<li>
<p>在使用speech_recognition模块录音时，出现了调用pyaudio时的错误：OSError: [Errno -9999] Unanticipated host error</p>
<blockquote>
<p>设置-隐私-麦克风 下关闭/开启麦克风的应用<a href="https://so.csdn.net/so/search?q=%E8%AE%BF%E9%97%AE%E6%9D%83%E9%99%90&amp;spm=1001.2101.3001.7020">访问权限</a>即可解决问题</p>
</blockquote>
</li>
</ul>
<hr>
<h1 id="step40python--ajax前端实现的菜谱查询">Step40.Python + Ajax前端实现的菜谱查询</h1>
<ul>
<li>
<p>功能</p>
<blockquote>
<p>前端上传图片,后端对图片进行识别,返回给前端该图片中食材对应的烹饪方法</p>
</blockquote>
</li>
<li>
<p>实现</p>
<ul>
<li>
<p>前端</p>
<blockquote>
<p>前端使用<code>input</code>标签进行文件上传</p>
<p>在前端获取图片的<code>base64</code>格式</p>
<p>将<code>base64</code>字符串通过ajax以<code>GET</code>请求方式发送到后端python的flask服务器</p>
</blockquote>
</li>
<li>
<p>后端</p>
<blockquote>
<p>接收前端发送的请求和图片base64格式数据</p>
<p>将图片转为本地文件</p>
<p>调用百度ai接口,查询图片</p>
<p>获取返回结果,就是图片中食材对应的菜品做法</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h2 id="前端">前端</h2>
<p><code>index.html</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Document<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="c">&lt;!-- 上传文件标签 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;file&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">button</span><span class="p">&gt;</span>点我上传图片<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c1">// 监听该元素事件
</span><span class="c1"></span>
    <span class="c1">// FileReader对象允许网络程序或异步读取存储在计算机上应用的数据文件（或原始数据用户）的内容
</span><span class="c1"></span>    <span class="c1">// File或使用Blob 指定要读取的文件
</span><span class="c1"></span>
    <span class="c1">// File
</span><span class="c1"></span>    <span class="c1">// 文件（File）接口提供有关文件的信息，并允许网页中的 JavaScript 访问其内容
</span><span class="c1"></span>    <span class="c1">// 通常情况下， File 对象是来自用户在一个 &lt; input &gt; 元素上选择文件后返回的 FileList 对象 
</span><span class="c1"></span>    <span class="c1">// File的FileList通过File.files获取
</span><span class="c1"></span>    <span class="c1">// 也可以是来自由拖放操作生成的 DataTransfer 对象
</span><span class="c1"></span>    <span class="c1">// 或者来自 HTMLCanvasElement 上的 mozGetAsFile() API
</span><span class="c1"></span>    <span class="kd">let</span> <span class="nx">xw_File</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;file&#34;</span><span class="p">);</span>
    <span class="nx">xw_File</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&#34;change&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="c1">// 调用查询图片base64格式文本方法
</span><span class="c1"></span>        <span class="nx">xw_show</span><span class="p">(</span><span class="nx">xw_File</span><span class="p">.</span><span class="nx">files</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">})</span>



    <span class="c1">// FileReader
</span><span class="c1"></span>    <span class="c1">// FileReader 对象允许Web应用程序异步读取存储在用户计算机上的文件（或原始数据缓冲区）的内容
</span><span class="c1"></span>    <span class="c1">// 使用 File 或 Blob 对象指定要读取的文件或数据
</span><span class="c1"></span>    <span class="c1">// 其中File对象可以是来自用户在一个&lt;input&gt;元素上选择文件后返回的FileList对象
</span><span class="c1"></span>    <span class="c1">// 也可以来自拖放操作生成的 DataTransfer对象
</span><span class="c1"></span>    <span class="c1">// 还可以是来自在一个HTMLCanvasElement上执行mozGetAsFile()方法后返回结果
</span><span class="c1"></span>
    <span class="c1">// FileReader.onload
</span><span class="c1"></span>    <span class="c1">// 当 FileReader 读取文件的方式为  readAsArrayBuffer, readAsBinaryString, readAsDataURL 或者 readAsText 的时候
</span><span class="c1"></span>    <span class="c1">// 会触发一个 load 事件
</span><span class="c1"></span>    <span class="c1">// 从而可以使用  FileReader.onload 属性对该事件进行处理
</span><span class="c1"></span>    <span class="c1">// 文件里的文本会在 evt.target.result 被打印出来
</span><span class="c1"></span>    <span class="kd">function</span> <span class="nx">xw_show</span><span class="p">(</span><span class="nx">xw_filedata</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">imgReaderl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileReader</span><span class="p">();</span>
        <span class="nx">imgReaderl</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">)</span> <span class="c1">//图片base64
</span><span class="c1"></span>            <span class="nx">upfun</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">imgReaderl</span><span class="p">.</span><span class="nx">readAsDataURL</span><span class="p">(</span><span class="nx">xw_filedata</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">upfun</span><span class="p">(</span><span class="nx">base64</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
            <span class="nx">contentType</span><span class="o">:</span> <span class="s1">&#39;application/json;charset=utf-8&#39;</span><span class="p">,</span> <span class="c1">// 此处注意，不能漏
</span><span class="c1"></span>            <span class="nx">url</span><span class="o">:</span> <span class="s2">&#34;http://127.0.0.1:80/upload&#34;</span><span class="p">,</span>
            <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">base64</span><span class="o">:</span> <span class="nx">base64</span>
            <span class="p">},</span>
            <span class="nx">crossDomain</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// 跨域请求,后端flask也需要设置
</span><span class="c1"></span>            <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="后端">后端</h2>
<p><code>webServer.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># --------------------------------------------------- 服务器,其他模块都是被它调用 -----------------------------------------------------------</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>
<span class="kn">from</span> <span class="nn">flask_cors</span> <span class="kn">import</span> <span class="n">CORS</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="kn">import</span> <span class="nn">GetVegetableName</span>
<span class="kn">import</span> <span class="nn">NameToBook</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="c1"># flask跨域处理</span>
<span class="n">CORS</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">supports_credentials</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c1"># 图片上传接口</span>
<span class="nd">@app.route</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">upload</span><span class="p">():</span>
    <span class="c1"># GET请求</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;get&#34;</span><span class="p">)</span>

        <span class="c1"># print(request.args.get(&#39;base64&#39;))</span>

        <span class="c1"># 取出ajax发送数据中的base64图片</span>
        <span class="c1"># 并转为本地图片</span>
        <span class="n">base64ToImg</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># 将转出的图片上传到百度ai获取菜名</span>
        <span class="n">NameToBook</span><span class="o">.</span><span class="n">nameToBook</span><span class="p">(</span><span class="n">GetVegetableName</span><span class="o">.</span><span class="n">getVegetableName</span><span class="p">())</span>

        <span class="k">return</span> <span class="s1">&#39;success&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;post&#34;</span><span class="p">)</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;success&#39;</span>


<span class="c1"># base64转图片</span>
<span class="k">def</span> <span class="nf">base64ToImg</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>


<span class="c1"># ----------------------------------------------------------------------------------------------------------------------------------------------------</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>GetVegetableName.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># --------------------------------------------------------- 百度ai识别果蔬图片返回果蔬名称 -------------------------------------------------------------</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="c1"># 百度ai的api要求的,需要通过项目的APPKEY可secretKey获取到项目的accessToken</span>
<span class="k">def</span> <span class="nf">getAssessToken</span><span class="p">():</span>
    <span class="c1"># client_id 为官网获取的AK， client_secret 为官网获取的SK</span>
    <span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=NoLjM2DKzU7PoxaDGXBGtK3c&amp;client_secret=xiOEo1MvWBs8ysBftBg80M6k81USbbSR&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">getVegetableName</span><span class="p">():</span>
    <span class="s1">&#39;&#39;&#39;
</span><span class="s1">    细粒度图像识别
</span><span class="s1">    &#39;&#39;&#39;</span>

    <span class="n">request_url</span> <span class="o">=</span> <span class="s2">&#34;https://aip.baidubce.com/rest/2.0/image-classify/v1/classify/ingredient&#34;</span>
    <span class="c1"># 二进制方式打开图片文件</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;image&#34;</span><span class="p">:</span> <span class="n">img</span><span class="p">}</span>
    <span class="n">access_token</span> <span class="o">=</span> <span class="n">getAssessToken</span><span class="p">()</span>
    <span class="n">request_url</span> <span class="o">=</span> <span class="n">request_url</span> <span class="o">+</span> <span class="s2">&#34;?access_token=&#34;</span> <span class="o">+</span> <span class="n">access_token</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">request_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>NameToBook.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># ----------------------------------------------- 爬虫,使用&#34;百度AI识别的果蔬名称&#34;爬取美食网站里的食谱 -----------------------------------------</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36&#39;</span>
<span class="p">}</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://home.meishichina.com/search/&#39;</span>


<span class="k">def</span> <span class="nf">nameToBook</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
        <span class="c1"># 指定食材页面里的菜谱列表 - 页面中的一个url</span>
        <span class="c1"># print(tree.xpath(&#39;//*[@id=&#34;search_res_list&#34;]/ul/li[&#39; + str(i) + &#39;]/div[2]/h4/a/@href&#39;))</span>
        <span class="n">child_url</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;search_res_list&#34;]/ul/li[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]/div[2]/h4/a/@href&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">child_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">child_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">child_response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
        <span class="n">child_tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">child_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">child_title</span> <span class="o">=</span> <span class="n">child_tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;recipe_title&#34;]/text()&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">child_title</span><span class="p">)</span>
        <span class="n">child_li_list</span> <span class="o">=</span> <span class="n">child_tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;/html/body/div[5]/div/div[1]/div[3]/div/div[5]/ul/li&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child_li</span> <span class="ow">in</span> <span class="n">child_li_list</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="n">child_li</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;./div[2]/text()&#39;</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;-----&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step41flask框架">Step41.Flask框架</h1>
<p><strong>便捷好用的web服务器</strong></p>
<ul>
<li>
<p>导入资源包</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">make_response</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>flask跨域请求</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask_cors</span> <span class="kn">import</span> <span class="n">CORS</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="创建一个flask的app实例"><strong>创建一个Flask的app实例</strong></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>其中,app.run()的参数
<table>
<thead>
<tr>
<th align="center">参数</th>
<th align="center">值</th>
<th align="center">作用</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">debug</td>
<td align="center">True</td>
<td align="center">是否开启调试</td>
</tr>
<tr>
<td align="center">host</td>
<td align="center">String</td>
<td align="center">指定主机</td>
</tr>
<tr>
<td align="center">port</td>
<td align="center">int</td>
<td align="center">指定端口</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h2 id="创建接口"><strong>创建接口</strong></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="nd">@app.route</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;/api&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">api</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;success&#39;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>参数</p>
<ul>
<li>
<p>methods</p>
<blockquote>
<p>这个接口支持GET、POST请求</p>
</blockquote>
</li>
<li>
<p>rule</p>
<blockquote>
<p>接口路由</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>返回值</p>
<blockquote>
<p>&lsquo;success&rsquo;</p>
</blockquote>
</li>
<li>
<p>说明</p>
<blockquote>
<p>该方法就成为了flask的app实例的一个路由为<code>http://host:port/api</code>的子接口</p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="flask跨域请求处理"><strong>Flask跨域请求处理</strong></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">CORS</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">supports_credentials</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>参数</p>
<ul>
<li>
<p>app</p>
<blockquote>
<p>需要跨域请求的flask实例</p>
</blockquote>
</li>
<li>
<p>supports_credentials</p>
<blockquote>
<p>母鸡</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>作用</p>
<blockquote>
<p>使得当前服务器可以进行跨域请求</p>
</blockquote>
</li>
</ul>
<hr>
<h2 id="获取请求方法"><strong>获取请求方法</strong></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">request</span><span class="o">.</span><span class="n">method</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>返回值</p>
<blockquote>
<p>str</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h2 id="获取请求参数"><strong>获取请求参数</strong></h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="n">request</span><span class="o">.</span><span class="n">data</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>json</p>
<blockquote>
<p>可以使用json.loads(request.data)</p>
<p>将前端传过来的byte类型的json数据</p>
<p>转为json格式</p>
</blockquote>
</li>
</ul>
<hr>
<h1 id="step42python的base64转图片">Step42.Python的base64转图片</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># base64转图片</span>
<span class="k">def</span> <span class="nf">base64ToImg</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>注意</p>
<blockquote>
<p>base64文本格式中</p>
<p>开头的<code>data:image/jpeg;base64,</code>不是图片内容</p>
<p>使用后端脚本将<code>base64</code>转为<code>图片</code>,需要对<code>base64</code>图片进行处理</p>
</blockquote>
</li>
</ul>
<hr>
<h1 id="step43flask--ajax--百度ai实现的果蔬菜谱生成">Step43.flask + ajax + 百度ai实现的果蔬菜谱生成</h1>
<h2 id="前端-1">前端</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;container&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>食材分析与食品匹配系统<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;eat&#34;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;vegetableName&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;item1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;item2&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;item3&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;item4&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="c">&lt;!-- 代替 input file 样式的假按钮 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;fileShell&#34;</span><span class="p">&gt;</span>选择图片<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="c">&lt;!-- 上传文件标签,样式被隐藏 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;file&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;send&#34;</span><span class="p">&gt;</span>点击生成菜谱<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="框架">框架</h3>
<ul>
<li>
<p>class=&quot;eat&rdquo;</p>
<blockquote>
<p>放置菜谱的盒子</p>
</blockquote>
<ul>
<li>
<p>vegetableName</p>
<blockquote>
<p>果蔬名称</p>
</blockquote>
</li>
<li>
<p>item</p>
<blockquote>
<p>菜谱列表</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>id=&quot;fileShell&rdquo;</p>
<blockquote>
<p>选择图片按钮</p>
</blockquote>
<ul>
<li>
<p>input file</p>
<blockquote>
<p>因为input file自带样式太丑</p>
<p>将input file样式-&gt;display:none;</p>
<p>使用另一个id=&quot;fileShell&quot;代替</p>
<p><strong>当点击id=&quot;fileShell&quot;时,通过js触发input file的点击事件</strong></p>
</blockquote>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="样式">样式</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="o">&lt;</span><span class="nt">style</span><span class="o">&gt;</span>
        <span class="nt">body</span> <span class="p">{</span>
            <span class="k">background</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="s2">&#34;background.png&#34;</span><span class="p">)</span> <span class="kc">fixed</span> <span class="kc">no-repeat</span><span class="p">;</span>
            <span class="k">background-size</span><span class="p">:</span> <span class="kc">cover</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">{</span>
            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
            <span class="k">top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
            <span class="k">left</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
            <span class="k">transform</span><span class="p">:</span> <span class="nb">translate</span><span class="p">(</span><span class="mi">-50</span><span class="kt">%</span><span class="p">,</span> <span class="mi">-50</span><span class="kt">%</span><span class="p">);</span>
            <span class="k">display</span><span class="p">:</span> <span class="kc">flex</span><span class="p">;</span>
            <span class="k">flex-direction</span><span class="p">:</span> <span class="kc">column</span><span class="p">;</span>
            <span class="k">justify-content</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
            <span class="k">align-items</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="nt">h1</span> <span class="p">{</span>
            <span class="k">color</span><span class="p">:</span> <span class="mh">#fff</span><span class="p">;</span>
            <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">9</span><span class="kt">px</span> <span class="mi">5</span><span class="kt">px</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span>
            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">.</span><span class="nc">eat</span> <span class="p">{</span>
            <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
            <span class="k">height</span><span class="p">:</span> <span class="mi">400</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">background-color</span><span class="p">:</span> <span class="mh">#fff</span><span class="p">;</span>
            <span class="k">margin</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">opacity</span><span class="p">:</span> <span class="mf">.7</span><span class="p">;</span>
            <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">9</span><span class="kt">px</span> <span class="mi">5</span><span class="kt">px</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">);</span>
            <span class="k">display</span><span class="p">:</span> <span class="kc">flex</span><span class="p">;</span>
            <span class="k">flex-direction</span><span class="p">:</span> <span class="kc">column</span><span class="p">;</span>
            <span class="c">/* 纵向隐藏滚轮 */</span>
            <span class="k">overflow-y</span><span class="p">:</span> <span class="kc">scroll</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">.</span><span class="nc">eat</span> <span class="p">#</span><span class="nn">vegetableName</span> <span class="p">{</span>
            <span class="k">font-weight</span><span class="p">:</span> <span class="mi">700</span><span class="p">;</span>
            <span class="k">font-size</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
            <span class="k">margin</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">.</span><span class="nc">eat</span> <span class="p">.</span><span class="nc">item</span> <span class="p">{</span>
            <span class="k">margin</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
            <span class="k">padding</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">#</span><span class="nn">fileShell</span> <span class="p">{</span>
            <span class="k">width</span><span class="p">:</span> <span class="mi">300</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
            <span class="k">background-color</span><span class="p">:</span> <span class="kc">orange</span><span class="p">;</span>
            <span class="k">line-height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">color</span><span class="p">:</span> <span class="mh">#fff</span><span class="p">;</span>
            <span class="k">font-weight</span><span class="p">:</span> <span class="mi">700</span><span class="p">;</span>
            <span class="k">font-size</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">#</span><span class="nn">file</span> <span class="p">{</span>
            <span class="k">display</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">.</span><span class="nc">send</span> <span class="p">{</span>
            <span class="k">width</span><span class="p">:</span> <span class="mi">300</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">background-color</span><span class="p">:</span> <span class="kc">greenyellow</span><span class="p">;</span>
            <span class="k">border</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">margin</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">color</span><span class="p">:</span> <span class="mh">#fff</span><span class="p">;</span>
            <span class="k">font-weight</span><span class="p">:</span> <span class="mi">700</span><span class="p">;</span>
            <span class="k">font-size</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="o">&lt;/</span><span class="nt">style</span><span class="o">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>放置菜谱的盒子,设置个纵向滚轮</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">overflow-y:scroll<span class="p">;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h3 id="js">js</h3>
<h4 id="监听idfileshell按钮事件">监听<code>id=&quot;fileShell&quot;</code>按钮事件</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// 监听该元素事件
</span><span class="c1"></span>
    <span class="c1">// FileReader对象允许网络程序或异步读取存储在计算机上应用的数据文件（或原始数据用户）的内容
</span><span class="c1"></span>    <span class="c1">// File或使用Blob 指定要读取的文件
</span><span class="c1"></span>
    <span class="c1">// File
</span><span class="c1"></span>    <span class="c1">// 文件（File）接口提供有关文件的信息，并允许网页中的 JavaScript 访问其内容
</span><span class="c1"></span>    <span class="c1">// 通常情况下， File 对象是来自用户在一个 &lt; input &gt; 元素上选择文件后返回的 FileList 对象 
</span><span class="c1"></span>    <span class="c1">// File的FileList通过File.files获取
</span><span class="c1"></span>    <span class="c1">// 也可以是来自由拖放操作生成的 DataTransfer 对象
</span><span class="c1"></span>    <span class="c1">// 或者来自 HTMLCanvasElement 上的 mozGetAsFile() API
</span><span class="c1"></span>
    <span class="c1">// input file样式太丑了
</span><span class="c1"></span>    <span class="c1">// 使用一个div代替input file
</span><span class="c1"></span>    <span class="c1">// input file -&gt; display:none
</span><span class="c1"></span>    <span class="c1">// 点击div时,就触发input file的点击事件,从而使得连锁反应继续下去
</span><span class="c1"></span>    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#fileShell&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#file&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
        <span class="p">})</span>
    <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>当点击id=fileShell</li>
<li>触发input file的点击事件</li>
</ul>
<h4 id="input-file的监听事件"><code>input file</code>的监听事件</h4>
<ul>
<li>
<p>不断监听<code>input file</code>的<code>change</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">xw_File</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;file&#34;</span><span class="p">);</span>
    <span class="nx">xw_File</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&#34;change&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="c1">// 调用查询图片base64格式文本方法
</span><span class="c1"></span>        <span class="nx">xw_show</span><span class="p">(</span><span class="nx">xw_File</span><span class="p">.</span><span class="nx">files</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">})</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>点击后,调用xw_show方法</p>
</li>
<li>
<p>xw_File.files</p>
<blockquote>
<p>input file上传的file对象</p>
</blockquote>
</li>
</ul>
<h4 id="xw_show方法用于获取input-file上传的图片的base64格式资源"><code>xw_show</code>方法,用于获取<code>input file</code>上传的图片的<code>base64</code>格式资源</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="c1">// FileReader
</span><span class="c1"></span>    <span class="c1">// FileReader 对象允许Web应用程序异步读取存储在用户计算机上的文件（或原始数据缓冲区）的内容
</span><span class="c1"></span>    <span class="c1">// 使用 File 或 Blob 对象指定要读取的文件或数据
</span><span class="c1"></span>    <span class="c1">// 其中File对象可以是来自用户在一个&lt;input&gt;元素上选择文件后返回的FileList对象
</span><span class="c1"></span>    <span class="c1">// 也可以来自拖放操作生成的 DataTransfer对象
</span><span class="c1"></span>    <span class="c1">// 还可以是来自在一个HTMLCanvasElement上执行mozGetAsFile()方法后返回结果
</span><span class="c1"></span>
    <span class="c1">// FileReader.onload
</span><span class="c1"></span>    <span class="c1">// 当 FileReader 读取文件的方式为  readAsArrayBuffer, readAsBinaryString, readAsDataURL 或者 readAsText 的时候
</span><span class="c1"></span>    <span class="c1">// 会触发一个 load 事件
</span><span class="c1"></span>    <span class="c1">// 从而可以使用  FileReader.onload 属性对该事件进行处理
</span><span class="c1"></span>    <span class="c1">// 文件里的文本会在 evt.target.result 被打印出来
</span><span class="c1"></span>    <span class="kd">function</span> <span class="nx">xw_show</span><span class="p">(</span><span class="nx">xw_filedata</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">imgReaderl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileReader</span><span class="p">();</span>
        <span class="nx">imgReaderl</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">)</span> <span class="c1">//图片base64
</span><span class="c1"></span>            <span class="nx">upfun</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">imgReaderl</span><span class="p">.</span><span class="nx">readAsDataURL</span><span class="p">(</span><span class="nx">xw_filedata</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="获取图片base64后将base64通过ajax发送给后台服务器">获取图片base64后,将base64通过ajax发送给后台服务器</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">upfun</span><span class="p">(</span><span class="nx">base64</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
            <span class="nx">contentType</span><span class="o">:</span> <span class="s1">&#39;application/json;charset=utf-8&#39;</span><span class="p">,</span> <span class="c1">// 此处注意，不能漏
</span><span class="c1"></span>            <span class="nx">url</span><span class="o">:</span> <span class="s2">&#34;http://127.0.0.1:80/upload&#34;</span><span class="p">,</span>
            <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">base64</span><span class="o">:</span> <span class="nx">base64</span>
            <span class="p">},</span>
            <span class="nx">crossDomain</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// 跨域请求,后端flask也需要设置
</span><span class="c1"></span>            <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">vegetableName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;vegetableName&#34;</span><span class="p">);</span>
                <span class="nx">vegetableName</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">vegetableName</span> <span class="o">+</span> <span class="s2">&#34;的做法&#34;</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">item1</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;item1&#34;</span><span class="p">);</span>
                <span class="nx">item1</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">eat1</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">item2</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;item2&#34;</span><span class="p">);</span>
                <span class="nx">item2</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">eat2</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">item3</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;item3&#34;</span><span class="p">);</span>
                <span class="nx">item3</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">eat3</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">item4</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;item4&#34;</span><span class="p">);</span>
                <span class="nx">item4</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">eat4</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h2 id="后端-1">后端</h2>
<h3 id="先写个flask服务器测试ajax的连接请求">先写个flask服务器测试ajax的连接请求</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>
<span class="kn">from</span> <span class="nn">flask_cors</span> <span class="kn">import</span> <span class="n">CORS</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="c1"># flask跨域处理</span>
<span class="n">CORS</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">supports_credentials</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c1"># 图片上传接口</span>
<span class="nd">@app.route</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">upload</span><span class="p">():</span>
    <span class="c1"># GET请求</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;get&#34;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">&#39;success&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;post&#34;</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;success&#39;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>注意:需要跨域处理</li>
</ul>
<hr>
<h3 id="base64将前端ajax的base64转为图片">base64将前端ajax的base64转为图片</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># base64转图片</span>
<span class="k">def</span> <span class="nf">base64ToImg</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="百度ai识别果蔬图片信息模块"><code>百度AI识别果蔬图片信息</code>模块</h3>
<ul>
<li>
<p><a href="https://ai.baidu.com/">百度AI官网</a></p>
</li>
<li>
<p>创建果蔬图片识别项目</p>
</li>
<li>
<p>读文档即可</p>
</li>
<li>
<p>创建<code>GetVegetableName.py</code>模块</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># --------------------------------------- 百度ai识别果蔬图片返回果蔬名称 -----------------------------------</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">base64</span>
  
<span class="c1"># 百度ai的api要求的,需要通过项目的APPKEY可secretKey获取到项目的accessToken</span>
<span class="k">def</span> <span class="nf">getAssessToken</span><span class="p">():</span>
    <span class="c1"># client_id 为官网获取的AK， client_secret 为官网获取的SK</span>
    <span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=NoLjM2DKzU7PoxaDGXBGtK3c&amp;client_secret=xiOEo1MvWBs8ysBftBg80M6k81USbbSR&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span>
  
  
<span class="k">def</span> <span class="nf">getVegetableName</span><span class="p">():</span>
    <span class="s1">&#39;&#39;&#39;
</span><span class="s1">    细粒度图像识别
</span><span class="s1">    &#39;&#39;&#39;</span>
  
    <span class="n">request_url</span> <span class="o">=</span> <span class="s2">&#34;https://aip.baidubce.com/rest/2.0/image-classify/v1/classify/ingredient&#34;</span>
    <span class="c1"># 二进制方式打开图片文件</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
  
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;image&#34;</span><span class="p">:</span> <span class="n">img</span><span class="p">}</span>
    <span class="n">access_token</span> <span class="o">=</span> <span class="n">getAssessToken</span><span class="p">()</span>
    <span class="n">request_url</span> <span class="o">=</span> <span class="n">request_url</span> <span class="o">+</span> <span class="s2">&#34;?access_token=&#34;</span> <span class="o">+</span> <span class="n">access_token</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">request_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="c1"># 提取API返回的json数据中的 果蔬名称</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="爬取指定名称的食谱">爬取指定<strong><code>名称</code></strong>的食谱</h3>
<ul>
<li>
<p>xpath永远的神</p>
</li>
<li>
<p>调用函数,只需要传果蔬名称作为参数,就可以返回该果蔬对应的4个菜谱</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># ----------------------------------------------- 爬虫,使用&#34;百度AI识别的果蔬名称&#34;爬取美食网站里的食谱 -----------------------------------------</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="kn">import</span> <span class="nn">SaveToMysql</span>
  
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36&#39;</span>
<span class="p">}</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://home.meishichina.com/search/&#39;</span>
  
  
<span class="k">def</span> <span class="nf">nameToBook</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
  
    <span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
  
    <span class="n">vegetableList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># 一个食材爬4种做法</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
        <span class="c1"># 指定食材页面里的菜谱列表 - 页面中的一个url</span>
        <span class="c1"># print(tree.xpath(&#39;//*[@id=&#34;search_res_list&#34;]/ul/li[&#39; + str(i) + &#39;]/div[2]/h4/a/@href&#39;))</span>
        <span class="n">child_url</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;search_res_list&#34;]/ul/li[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]/div[2]/h4/a/@href&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">child_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">child_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">child_response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
        <span class="n">child_tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">child_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
  
        <span class="c1"># 其中一个做法页面的标题</span>
        <span class="n">child_title</span> <span class="o">=</span> <span class="n">child_tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;recipe_title&#34;]/text()&#39;</span><span class="p">)</span>
        <span class="c1"># print(child_title)</span>
        <span class="n">vegetableName</span> <span class="o">=</span> <span class="n">child_title</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  
        <span class="c1"># 其中一个做法页面的菜谱,因为它不同步骤是分开的,在获取后需要加进list中,最后通过&#39;&#39;.join合并成一个</span>
        <span class="n">vegetableEatList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># 其中一个做法页面中的做法(li)列表按</span>
        <span class="n">child_li_list</span> <span class="o">=</span> <span class="n">child_tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;/html/body/div[5]/div/div[1]/div[3]/div/div[5]/ul/li&#39;</span><span class="p">)</span>
        <span class="c1"># 获取每一个做法</span>
        <span class="k">for</span> <span class="n">child_li</span> <span class="ow">in</span> <span class="n">child_li_list</span><span class="p">:</span>
            <span class="c1"># print(child_li.xpath(&#39;./div[2]/text()&#39;))</span>
            <span class="c1"># 添加到 其中一个做法页面的菜谱 列表中</span>
            <span class="n">vegetableEatList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child_li</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;./div[2]/text()&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># print(vegetableName)</span>
        <span class="c1"># print(vegetableName + &#39;-&#39; + &#39;&#39;.join(vegetableEatList))</span>
        <span class="n">vegetableList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vegetableName</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vegetableEatList</span><span class="p">))</span>
        <span class="c1"># print(&#39;-----&#39;)</span>
    <span class="n">SaveToMysql</span><span class="o">.</span><span class="n">saveToMysql</span><span class="p">(</span>
        <span class="s1">&#39;insert into eats (vegetableName,eat1,eat2,eat3,eat4) values (&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">vegetableList</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vegetableList</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vegetableList</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">vegetableList</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h3 id="将果蔬名--食谱保存到数据库">将果蔬名 + 食谱保存到数据库</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pymysql</span>


<span class="k">def</span> <span class="nf">saveToMysql</span><span class="p">(</span><span class="n">info</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&#34;localhost&#34;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s2">&#34;root&#34;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&#34;123456&#34;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s2">&#34;vegetableeat&#34;</span><span class="p">)</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="c1"># cursor.execute(&#39;insert into eats (vegetableName,eat1,eat2,eat3,eat4) values (&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;)&#39;.format(&#34;1&#34;,&#34;2&#34;,&#34;3&#34;,&#34;4&#34;,&#34;5&#34;))</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">getToMySql</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&#34;localhost&#34;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s2">&#34;root&#34;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&#34;123456&#34;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s2">&#34;vegetableeat&#34;</span><span class="p">)</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select * from eats where vegetableName=&#34;&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>  <span class="c1"># 查询的是一个嵌套元组</span>

    <span class="c1"># print(res)</span>

    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="完整逻辑">完整逻辑</h3>
<ul>
<li>flask接收前端ajax请求发送的base64图片</li>
<li>将base64转为本地图片</li>
<li>百度AI识别该图片,返回果蔬名称</li>
<li>爬虫根据指定的果蔬名称,爬取指定的菜谱并返回</li>
<li>将果蔬名和菜谱保存到数据库</li>
</ul>
<hr>
<h2 id="运行版本完整代码">运行版本完整代码</h2>
<h3 id="前端-2">前端</h3>
<p><code>index.html</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;UTF-8&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1.0&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>食材分析与食品匹配系统<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">style</span><span class="p">&gt;</span>
        <span class="nt">body</span> <span class="p">{</span>
            <span class="k">background</span><span class="p">:</span> <span class="nb">url</span><span class="p">(</span><span class="s2">&#34;background.png&#34;</span><span class="p">)</span> <span class="kc">fixed</span> <span class="kc">no-repeat</span><span class="p">;</span>
            <span class="k">background-size</span><span class="p">:</span> <span class="kc">cover</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">{</span>
            <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
            <span class="k">top</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
            <span class="k">left</span><span class="p">:</span> <span class="mi">50</span><span class="kt">%</span><span class="p">;</span>
            <span class="k">transform</span><span class="p">:</span> <span class="nb">translate</span><span class="p">(</span><span class="mi">-50</span><span class="kt">%</span><span class="p">,</span> <span class="mi">-50</span><span class="kt">%</span><span class="p">);</span>
            <span class="k">display</span><span class="p">:</span> <span class="kc">flex</span><span class="p">;</span>
            <span class="k">flex-direction</span><span class="p">:</span> <span class="kc">column</span><span class="p">;</span>
            <span class="k">justify-content</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
            <span class="k">align-items</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="nt">h1</span> <span class="p">{</span>
            <span class="k">color</span><span class="p">:</span> <span class="mh">#fff</span><span class="p">;</span>
            <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">9</span><span class="kt">px</span> <span class="mi">5</span><span class="kt">px</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span>
            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">.</span><span class="nc">eat</span> <span class="p">{</span>
            <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
            <span class="k">height</span><span class="p">:</span> <span class="mi">400</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">background-color</span><span class="p">:</span> <span class="mh">#fff</span><span class="p">;</span>
            <span class="k">margin</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">opacity</span><span class="p">:</span> <span class="mf">.7</span><span class="p">;</span>
            <span class="k">box-shadow</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">9</span><span class="kt">px</span> <span class="mi">5</span><span class="kt">px</span> <span class="nb">rgba</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">);</span>
            <span class="k">display</span><span class="p">:</span> <span class="kc">flex</span><span class="p">;</span>
            <span class="k">flex-direction</span><span class="p">:</span> <span class="kc">column</span><span class="p">;</span>
            <span class="c">/* 纵向隐藏滚轮 */</span>
            <span class="k">overflow-y</span><span class="p">:</span> <span class="kc">scroll</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">.</span><span class="nc">eat</span> <span class="p">#</span><span class="nn">vegetableName</span> <span class="p">{</span>
            <span class="k">font-weight</span><span class="p">:</span> <span class="mi">700</span><span class="p">;</span>
            <span class="k">font-size</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
            <span class="k">margin</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">.</span><span class="nc">eat</span> <span class="p">.</span><span class="nc">item</span> <span class="p">{</span>
            <span class="k">margin</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
            <span class="k">padding</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">#</span><span class="nn">fileShell</span> <span class="p">{</span>
            <span class="k">width</span><span class="p">:</span> <span class="mi">300</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">text-align</span><span class="p">:</span> <span class="kc">center</span><span class="p">;</span>
            <span class="k">background-color</span><span class="p">:</span> <span class="kc">orange</span><span class="p">;</span>
            <span class="k">line-height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">color</span><span class="p">:</span> <span class="mh">#fff</span><span class="p">;</span>
            <span class="k">font-weight</span><span class="p">:</span> <span class="mi">700</span><span class="p">;</span>
            <span class="k">font-size</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">#</span><span class="nn">file</span> <span class="p">{</span>
            <span class="k">display</span><span class="p">:</span> <span class="kc">none</span><span class="p">;</span>
        <span class="p">}</span>
        
        <span class="p">.</span><span class="nc">container</span> <span class="p">.</span><span class="nc">send</span> <span class="p">{</span>
            <span class="k">width</span><span class="p">:</span> <span class="mi">300</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">background-color</span><span class="p">:</span> <span class="kc">greenyellow</span><span class="p">;</span>
            <span class="k">border</span><span class="p">:</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">border-radius</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">margin</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
            <span class="k">color</span><span class="p">:</span> <span class="mh">#fff</span><span class="p">;</span>
            <span class="k">font-weight</span><span class="p">:</span> <span class="mi">700</span><span class="p">;</span>
            <span class="k">font-size</span><span class="p">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdn.jsdelivr.net/npm/jquery@3.2/dist/jquery.min.js&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>

<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;container&#34;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span>食材分析与食品匹配系统<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;eat&#34;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;vegetableName&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;item1&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;item2&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;item3&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;item&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;item4&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="c">&lt;!-- 代替 input file 样式的假按钮 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;fileShell&#34;</span><span class="p">&gt;</span>选择图片<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="c">&lt;!-- 上传文件标签,样式被隐藏 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;file&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;file&#34;</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>

<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="c1">// 监听该元素事件
</span><span class="c1"></span>
    <span class="c1">// FileReader对象允许网络程序或异步读取存储在计算机上应用的数据文件（或原始数据用户）的内容
</span><span class="c1"></span>    <span class="c1">// File或使用Blob 指定要读取的文件
</span><span class="c1"></span>
    <span class="c1">// File
</span><span class="c1"></span>    <span class="c1">// 文件（File）接口提供有关文件的信息，并允许网页中的 JavaScript 访问其内容
</span><span class="c1"></span>    <span class="c1">// 通常情况下， File 对象是来自用户在一个 &lt; input &gt; 元素上选择文件后返回的 FileList 对象 
</span><span class="c1"></span>    <span class="c1">// File的FileList通过File.files获取
</span><span class="c1"></span>    <span class="c1">// 也可以是来自由拖放操作生成的 DataTransfer 对象
</span><span class="c1"></span>    <span class="c1">// 或者来自 HTMLCanvasElement 上的 mozGetAsFile() API
</span><span class="c1"></span>
    <span class="c1">// input file样式太丑了
</span><span class="c1"></span>    <span class="c1">// 使用一个div代替input file
</span><span class="c1"></span>    <span class="c1">// input file -&gt; display:none
</span><span class="c1"></span>    <span class="c1">// 点击div时,就触发input file的点击事件,从而使得连锁反应继续下去
</span><span class="c1"></span>    <span class="nx">$</span><span class="p">(</span><span class="nb">document</span><span class="p">).</span><span class="nx">ready</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#fileShell&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;#file&#39;</span><span class="p">).</span><span class="nx">click</span><span class="p">();</span>
        <span class="p">})</span>
    <span class="p">})</span>


    <span class="kd">let</span> <span class="nx">xw_File</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;file&#34;</span><span class="p">);</span>
    <span class="nx">xw_File</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&#34;change&#34;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="c1">// 调用查询图片base64格式文本方法
</span><span class="c1"></span>        <span class="nx">xw_show</span><span class="p">(</span><span class="nx">xw_File</span><span class="p">.</span><span class="nx">files</span><span class="p">)</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">})</span>



    <span class="c1">// FileReader
</span><span class="c1"></span>    <span class="c1">// FileReader 对象允许Web应用程序异步读取存储在用户计算机上的文件（或原始数据缓冲区）的内容
</span><span class="c1"></span>    <span class="c1">// 使用 File 或 Blob 对象指定要读取的文件或数据
</span><span class="c1"></span>    <span class="c1">// 其中File对象可以是来自用户在一个&lt;input&gt;元素上选择文件后返回的FileList对象
</span><span class="c1"></span>    <span class="c1">// 也可以来自拖放操作生成的 DataTransfer对象
</span><span class="c1"></span>    <span class="c1">// 还可以是来自在一个HTMLCanvasElement上执行mozGetAsFile()方法后返回结果
</span><span class="c1"></span>
    <span class="c1">// FileReader.onload
</span><span class="c1"></span>    <span class="c1">// 当 FileReader 读取文件的方式为  readAsArrayBuffer, readAsBinaryString, readAsDataURL 或者 readAsText 的时候
</span><span class="c1"></span>    <span class="c1">// 会触发一个 load 事件
</span><span class="c1"></span>    <span class="c1">// 从而可以使用  FileReader.onload 属性对该事件进行处理
</span><span class="c1"></span>    <span class="c1">// 文件里的文本会在 evt.target.result 被打印出来
</span><span class="c1"></span>    <span class="kd">function</span> <span class="nx">xw_show</span><span class="p">(</span><span class="nx">xw_filedata</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">imgReaderl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FileReader</span><span class="p">();</span>
        <span class="nx">imgReaderl</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">)</span> <span class="c1">//图片base64
</span><span class="c1"></span>            <span class="nx">upfun</span><span class="p">(</span><span class="nx">evt</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">result</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">imgReaderl</span><span class="p">.</span><span class="nx">readAsDataURL</span><span class="p">(</span><span class="nx">xw_filedata</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
    <span class="p">}</span>

    <span class="kd">function</span> <span class="nx">upfun</span><span class="p">(</span><span class="nx">base64</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;GET&#39;</span><span class="p">,</span>
            <span class="nx">contentType</span><span class="o">:</span> <span class="s1">&#39;application/json;charset=utf-8&#39;</span><span class="p">,</span> <span class="c1">// 此处注意，不能漏
</span><span class="c1"></span>            <span class="nx">url</span><span class="o">:</span> <span class="s2">&#34;http://127.0.0.1:80/upload&#34;</span><span class="p">,</span>
            <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span>
            <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">base64</span><span class="o">:</span> <span class="nx">base64</span>
            <span class="p">},</span>
            <span class="nx">crossDomain</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="c1">// 跨域请求,后端flask也需要设置
</span><span class="c1"></span>            <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
                <span class="kd">var</span> <span class="nx">vegetableName</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;vegetableName&#34;</span><span class="p">);</span>
                <span class="nx">vegetableName</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">vegetableName</span> <span class="o">+</span> <span class="s2">&#34;的做法&#34;</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">item1</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;item1&#34;</span><span class="p">);</span>
                <span class="nx">item1</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">eat1</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">item2</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;item2&#34;</span><span class="p">);</span>
                <span class="nx">item2</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">eat2</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">item3</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;item3&#34;</span><span class="p">);</span>
                <span class="nx">item3</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">eat3</span><span class="p">;</span>

                <span class="kd">var</span> <span class="nx">item4</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;item4&#34;</span><span class="p">);</span>
                <span class="nx">item4</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">eat4</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">error</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="后端-2">后端</h3>
<p><code>webServer.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># --------------------------------------------------- 服务器,其他模块都是被它调用 -----------------------------------------------------------</span>

<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">request</span>
<span class="kn">from</span> <span class="nn">flask_cors</span> <span class="kn">import</span> <span class="n">CORS</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="kn">import</span> <span class="nn">GetVegetableName</span>
<span class="kn">import</span> <span class="nn">SaveToMysql</span>

<span class="c1"># import SaveToMysql</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="c1"># flask跨域处理</span>
<span class="n">CORS</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">supports_credentials</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>


<span class="c1"># 图片上传接口</span>
<span class="nd">@app.route</span><span class="p">(</span><span class="n">rule</span><span class="o">=</span><span class="s1">&#39;/upload&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;GET&#39;</span><span class="p">,</span> <span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">upload</span><span class="p">():</span>
    <span class="c1"># GET请求</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;GET&#39;</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;get&#34;</span><span class="p">)</span>

        <span class="c1"># 将前端ajax传过来的base64图片转为本地图片</span>
        <span class="n">base64ToImg</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># 使用图灵机器人识别转换后的果蔬图片,并返回图片中果蔬的信息,提取出果蔬名称</span>
        <span class="c1"># 进入数据库查询该果蔬名称对应的菜谱</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">SaveToMysql</span><span class="o">.</span><span class="n">getToMySql</span><span class="p">(</span><span class="n">GetVegetableName</span><span class="o">.</span><span class="n">getVegetableName</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># 将返回的数据清洗,将菜谱和果蔬名称返回给前端ajax</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;vegetableName&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;eat1&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="s1">&#39;eat2&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
            <span class="s1">&#39;eat3&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
            <span class="s1">&#39;eat4&#39;</span><span class="p">:</span> <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>

        <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&#34;post&#34;</span><span class="p">)</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;base64&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;success&#39;</span>


<span class="c1"># base64转图片</span>
<span class="k">def</span> <span class="nf">base64ToImg</span><span class="p">(</span><span class="n">base</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">base</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>


<span class="c1"># ----------------------------------------------------------------------------------------------------------------------------------------------------</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p><code>GetVegetableName.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># --------------------------------------------------------- 百度ai识别果蔬图片返回果蔬名称 -------------------------------------------------------------</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">base64</span>

<span class="c1"># 百度ai的api要求的,需要通过项目的APPKEY可secretKey获取到项目的accessToken</span>
<span class="k">def</span> <span class="nf">getAssessToken</span><span class="p">():</span>
    <span class="c1"># client_id 为官网获取的AK， client_secret 为官网获取的SK</span>
    <span class="n">host</span> <span class="o">=</span> <span class="s1">&#39;https://aip.baidubce.com/oauth/2.0/token?grant_type=client_credentials&amp;client_id=NoLjM2DKzU7PoxaDGXBGtK3c&amp;client_secret=xiOEo1MvWBs8ysBftBg80M6k81USbbSR&#39;</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;access_token&#39;</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">getVegetableName</span><span class="p">():</span>
    <span class="s1">&#39;&#39;&#39;
</span><span class="s1">    细粒度图像识别
</span><span class="s1">    &#39;&#39;&#39;</span>

    <span class="n">request_url</span> <span class="o">=</span> <span class="s2">&#34;https://aip.baidubce.com/rest/2.0/image-classify/v1/classify/ingredient&#34;</span>
    <span class="c1"># 二进制方式打开图片文件</span>
    <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;1.png&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;image&#34;</span><span class="p">:</span> <span class="n">img</span><span class="p">}</span>
    <span class="n">access_token</span> <span class="o">=</span> <span class="n">getAssessToken</span><span class="p">()</span>
    <span class="n">request_url</span> <span class="o">=</span> <span class="n">request_url</span> <span class="o">+</span> <span class="s2">&#34;?access_token=&#34;</span> <span class="o">+</span> <span class="n">access_token</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;content-type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">request_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;result&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
</code></pre></td></tr></table>
</div>
</div><p><code>NameToBook.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># ----------------------------------------------- 爬虫,使用&#34;百度AI识别的果蔬名称&#34;爬取美食网站里的食谱 -----------------------------------------</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="kn">import</span> <span class="nn">SaveToMysql</span>

<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36&#39;</span>
<span class="p">}</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://home.meishichina.com/search/&#39;</span>


<span class="k">def</span> <span class="nf">nameToBook</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span> <span class="o">+</span> <span class="n">name</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="n">vegetableList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># 一个食材爬4种做法</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
        <span class="c1"># 指定食材页面里的菜谱列表 - 页面中的一个url</span>
        <span class="c1"># print(tree.xpath(&#39;//*[@id=&#34;search_res_list&#34;]/ul/li[&#39; + str(i) + &#39;]/div[2]/h4/a/@href&#39;))</span>
        <span class="n">child_url</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;search_res_list&#34;]/ul/li[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;]/div[2]/h4/a/@href&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">child_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">child_url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">child_response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;utf-8&#39;</span>
        <span class="n">child_tree</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">child_response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

        <span class="c1"># 其中一个做法页面的标题</span>
        <span class="n">child_title</span> <span class="o">=</span> <span class="n">child_tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;//*[@id=&#34;recipe_title&#34;]/text()&#39;</span><span class="p">)</span>
        <span class="c1"># print(child_title)</span>
        <span class="n">vegetableName</span> <span class="o">=</span> <span class="n">child_title</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># 其中一个做法页面的菜谱,因为它不同步骤是分开的,在获取后需要加进list中,最后通过&#39;&#39;.join合并成一个</span>
        <span class="n">vegetableEatList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># 其中一个做法页面中的做法(li)列表按</span>
        <span class="n">child_li_list</span> <span class="o">=</span> <span class="n">child_tree</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;/html/body/div[5]/div/div[1]/div[3]/div/div[5]/ul/li&#39;</span><span class="p">)</span>
        <span class="c1"># 获取每一个做法</span>
        <span class="k">for</span> <span class="n">child_li</span> <span class="ow">in</span> <span class="n">child_li_list</span><span class="p">:</span>
            <span class="c1"># print(child_li.xpath(&#39;./div[2]/text()&#39;))</span>
            <span class="c1"># 添加到 其中一个做法页面的菜谱 列表中</span>
            <span class="n">vegetableEatList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">child_li</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;./div[2]/text()&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># print(vegetableName)</span>
        <span class="c1"># print(vegetableName + &#39;-&#39; + &#39;&#39;.join(vegetableEatList))</span>
        <span class="n">vegetableList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vegetableName</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">vegetableEatList</span><span class="p">))</span>
        <span class="c1"># print(&#39;-----&#39;)</span>
    <span class="n">SaveToMysql</span><span class="o">.</span><span class="n">saveToMysql</span><span class="p">(</span>
        <span class="s1">&#39;insert into eats (vegetableName,eat1,eat2,eat3,eat4) values (&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">name</span><span class="p">,</span> <span class="n">vegetableList</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vegetableList</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vegetableList</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">vegetableList</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
</code></pre></td></tr></table>
</div>
</div><p><code>SaveToMysql.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pymysql</span>


<span class="k">def</span> <span class="nf">saveToMysql</span><span class="p">(</span><span class="n">info</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&#34;localhost&#34;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s2">&#34;root&#34;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&#34;123456&#34;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s2">&#34;vegetableeat&#34;</span><span class="p">)</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="c1"># cursor.execute(&#39;insert into eats (vegetableName,eat1,eat2,eat3,eat4) values (&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;,&#34;{}&#34;)&#39;.format(&#34;1&#34;,&#34;2&#34;,&#34;3&#34;,&#34;4&#34;,&#34;5&#34;))</span>
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">getToMySql</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&#34;localhost&#34;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s2">&#34;root&#34;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&#34;123456&#34;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s2">&#34;vegetableeat&#34;</span><span class="p">)</span>

    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>

    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;select * from eats where vegetableName=&#34;&#39;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;&#34;&#39;</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>  <span class="c1"># 查询的是一个嵌套元组</span>

    <span class="c1"># print(res)</span>

    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>

    <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step44python操纵mysql">Step44.python操纵mysql</h1>
<ul>
<li>
<p>安装pymongo</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pymysql</span>
  
<span class="k">def</span> <span class="nf">app</span><span class="p">(</span><span class="n">sql</span><span class="p">):</span>
    <span class="n">db</span> <span class="o">=</span> <span class="n">pymysql</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s2">&#34;主机名&#34;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s2">&#34;数据库用户名&#34;</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="s2">&#34;数据库密码&#34;</span><span class="p">,</span> <span class="n">database</span><span class="o">=</span><span class="s2">&#34;数据库名&#34;</span><span class="p">)</span>
  
    <span class="n">cursor</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
  
    <span class="n">cursor</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql</span><span class="p">)</span>
  
    <span class="n">res</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>  <span class="c1"># 查询结果是一个嵌套元组</span>
  
    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
  
    <span class="n">db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>注意</p>
<p><strong>写语句时,例如insert</strong></p>
<p><strong>插入数据如果是字符串必须带&rdquo;&quot;,否则会报错</strong></p>
</li>
</ul>
<hr>
<h1 id="step45python操纵xlsx格式表格">Step45.Python操纵xlsx格式表格</h1>
<ul>
<li>下载<code>openpyxl</code>模块</li>
</ul>
<h2 id="输出表格对象">输出表格对象</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">openpyxl</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;Book1.xlsx&#39;</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">wb</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">wb</span><span class="p">))</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="操作整个表格表格属性">操作整个表格(表格属性)</h2>
<ul>
<li>
<p>sheetnames：获取工作簿中的表（列表）</p>
</li>
<li>
<p>active：获取当前活跃的Worksheet</p>
</li>
<li>
<p>worksheets：以列表的形式返回所有的Worksheet(表格)</p>
</li>
<li>
<p>read_only：判断是否以read_only模式打开Excel文档</p>
</li>
<li>
<p>encoding：获取文档的字符集编码</p>
</li>
<li>
<p>properties：获取文档的元数据，如标题，创建者，创建日期等</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">openpyxl</span>
  
<span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;Book2.xlsx&#39;</span><span class="p">)</span> <span class="c1"># 加载表格为对象</span>
<span class="k">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">)</span> <span class="c1"># 获取表格文件中所有sheet名称列表</span>
<span class="k">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">active</span><span class="p">)</span> <span class="c1"># 获取当前活跃的sheet名称</span>
<span class="k">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">worksheets</span><span class="p">)</span> <span class="c1"># 以列表形式获取所有Worksheet</span>
<span class="k">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">read_only</span><span class="p">)</span> <span class="c1"># 判断是否以只读模式打开excel文档</span>
<span class="k">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">encoding</span><span class="p">)</span> <span class="c1"># 判断文档的字符编码</span>
<span class="k">print</span><span class="p">(</span><span class="n">wb</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span>  <span class="c1"># 获取文档元数据(标题、作者、创建日期等)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h2 id="操作表格中的单个sheet表">操作表格中的单个sheet表</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">openpyxl</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;Book2.xlsx&#39;</span><span class="p">)</span>
<span class="c1">##选择要操作的工作表， 返回工作表对象</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

<span class="c1">#获取工作表的名称</span>
<span class="k">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
<span class="c1"># 获取工作表中行和列的最值</span>

<span class="k">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">max_column</span><span class="p">)</span> <span class="c1"># 表格的最大列</span>
<span class="k">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">max_row</span><span class="p">)</span> <span class="c1"># 表格的最大行</span>
<span class="k">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">min_column</span><span class="p">)</span> <span class="c1"># 表格的最小列</span>
<span class="k">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">min_row</span><span class="p">)</span> <span class="c1"># 表格的最小行</span>

<span class="c1">##修改表的名称</span>
<span class="n">sheet</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;sheet1&#39;</span>
<span class="k">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>

<span class="c1"># 返回指定行指定列的单元格信息</span>
<span class="k">print</span><span class="p">(</span><span class="n">sheet</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">sheet</span><span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">row</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">column</span><span class="p">,</span> <span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">,</span><span class="n">cell</span><span class="o">.</span><span class="n">coordinate</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="访问sheet表的所有信息">访问sheet表的所有信息</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">openpyxl</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">openpyxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="s1">&#39;Book2.xlsx&#39;</span><span class="p">)</span>
<span class="c1">##选择要操作的工作表， 返回工作表对象</span>
<span class="n">sheet</span> <span class="o">=</span> <span class="n">wb</span><span class="p">[</span><span class="s1">&#39;排序商品信息&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">sheet</span><span class="o">.</span><span class="n">rows</span><span class="p">:</span>
    <span class="c1"># 循环遍历每一个单元格</span>
    <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="c1"># 获取单元格的内容</span>
        <span class="k">print</span><span class="p">(</span><span class="n">cell</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
    <span class="k">print</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step46python生成echarts图表">Step46.Python生成echarts图表</h1>
<h2 id="生成地图">生成地图</h2>
<p>安装环境</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">pip install echarts-countries-pypkg <span class="c1"># 全球国家地图</span>
pip install echarts-china-provinces-pypkg <span class="c1"># 中国省份地图</span>
pip install echarts-china-cities-pypkg <span class="c1"># 中国城市地图</span>
pip install echarts-china-counties-pypkg
pip install echarts-china-misc-pypkg
pip install echarts-united-kingdom-pypkg
</code></pre></td></tr></table>
</div>
</div><h3 id="省市地图">省市地图</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># 生成html</span>
<span class="kn">from</span> <span class="nn">pyecharts</span> <span class="kn">import</span> <span class="n">options</span> <span class="k">as</span> <span class="n">opts</span>
<span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">Map</span>
<span class="n">c</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Map</span><span class="p">()</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&#34;商家A&#34;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;岳麓区&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;望城区&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">]],</span> <span class="s2">&#34;长沙&#34;</span><span class="p">)</span> <span class="c1">#is_map_symbol_show=False去掉小红点</span>
    <span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span>
        <span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;Map-长沙地图&#34;</span><span class="p">,</span> <span class="n">pos_left</span><span class="o">=</span><span class="s2">&#34;center&#34;</span><span class="p">,),</span> 
        <span class="n">visualmap_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">VisualMapOpts</span><span class="p">(</span><span class="n">max_</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">min_</span><span class="o">=-</span><span class="mi">100</span><span class="p">),</span>
        <span class="n">legend_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">LegendOpts</span><span class="p">(</span><span class="n">is_show</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span> <span class="c1"># 隐藏标签</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&#34;map_长沙.html&#34;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="中国地图">中国地图</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyecharts</span> <span class="kn">import</span> <span class="n">options</span> <span class="k">as</span> <span class="n">opts</span>
<span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">Map</span>

<span class="n">c</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Map</span><span class="p">()</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&#34;商家A&#34;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;湖南&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;浙江&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">]],</span> <span class="s2">&#34;china&#34;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span>
        <span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;Map&#34;</span><span class="p">),</span>
        <span class="n">visualmap_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">VisualMapOpts</span><span class="p">(</span><span class="n">max_</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">is_piecewise</span><span class="o">=</span><span class="bp">True</span><span class="p">),</span>
        <span class="n">legend_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">LegendOpts</span><span class="p">(</span><span class="n">is_show</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&#34;map_中国.html&#34;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="世界地图">世界地图</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">pyecharts</span> <span class="kn">import</span> <span class="n">options</span> <span class="k">as</span> <span class="n">opts</span>
<span class="kn">from</span> <span class="nn">pyecharts.charts</span> <span class="kn">import</span> <span class="n">Map</span>
<span class="kn">from</span> <span class="nn">pyecharts.faker</span> <span class="kn">import</span> <span class="n">Faker</span>

<span class="n">c</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">Map</span><span class="p">()</span>
    <span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&#34;商家A&#34;</span><span class="p">,</span> <span class="p">[[</span><span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
                <span class="p">[</span><span class="s1">&#39;United States&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">]],</span> <span class="s2">&#34;world&#34;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_series_opts</span><span class="p">(</span><span class="n">label_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">LabelOpts</span><span class="p">(</span><span class="n">is_show</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
    <span class="o">.</span><span class="n">set_global_opts</span><span class="p">(</span>
        <span class="n">title_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">TitleOpts</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&#34;Map-世界地图&#34;</span><span class="p">),</span>
        <span class="n">visualmap_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">VisualMapOpts</span><span class="p">(</span><span class="n">max_</span><span class="o">=</span><span class="mi">200</span><span class="p">),</span>
        <span class="n">legend_opts</span><span class="o">=</span><span class="n">opts</span><span class="o">.</span><span class="n">LegendOpts</span><span class="p">(</span><span class="n">is_show</span><span class="o">=</span><span class="bp">False</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="s2">&#34;map_world.html&#34;</span><span class="p">)</span>
<span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step47使用python生成词云">Step47.使用Python生成词云</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>

<span class="kn">import</span> <span class="nn">wordcloud</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>


<span class="k">def</span> <span class="nf">myWordCloud</span><span class="p">():</span>
    <span class="c1"># ------------------------------------------------ 请求数据 -------------------------------------------------------------</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://api.yimian.xyz/coro&#39;</span>  <span class="c1"># 疫情API</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/99.0.4844.84 Safari/537.36&#39;</span>
    <span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="n">city_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">json_data</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;cities&#39;</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cities&#39;</span><span class="p">]:</span>
                <span class="n">cityName</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;cityName&#39;</span><span class="p">]</span>
                <span class="n">cCount</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;confirmedCount&#39;</span><span class="p">]</span>
                <span class="n">sCount</span> <span class="o">=</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;suspectedCount&#39;</span><span class="p">]</span>
                <span class="n">total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cCount</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">sCount</span><span class="p">)</span>
                <span class="n">city_dict</span><span class="p">[</span><span class="n">cityName</span><span class="p">]</span> <span class="o">=</span> <span class="n">total</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cityName</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;cityName&#39;</span><span class="p">]</span>
            <span class="n">cCount</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;confirmedCount&#39;</span><span class="p">]</span>
            <span class="n">sCount</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;suspectedCount&#39;</span><span class="p">]</span>
            <span class="n">total</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">cCount</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">sCount</span><span class="p">)</span>
            <span class="n">city_dict</span><span class="p">[</span><span class="n">cityName</span><span class="p">]</span> <span class="o">=</span> <span class="n">total</span>

    <span class="c1"># print(city_dict)</span>

    <span class="c1"># ---------------------------------------------------- 保存数据到文件 -----------------------------------------------------</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;city_count.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">city_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;{k}:{v}</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------ 生成词云 --------------------------------------------------------</span>

    <span class="n">ccloud</span> <span class="o">=</span> <span class="n">wordcloud</span><span class="o">.</span><span class="n">WordCloud</span><span class="p">(</span><span class="n">font_path</span><span class="o">=</span><span class="s1">&#39;webclower/XinYeHuiTi-2.otf&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1600</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">900</span><span class="p">)</span>  <span class="c1"># 中文字体防止乱码,图片尺寸</span>
    <span class="n">ccloud</span><span class="o">.</span><span class="n">generate_from_frequencies</span><span class="p">(</span><span class="n">frequencies</span><span class="o">=</span><span class="n">city_dict</span><span class="p">)</span>  <span class="c1"># 词云中数据文件</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ccloud</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;bilinear&#39;</span><span class="p">)</span>  <span class="c1"># 参数为:词云对象,二维图片</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>  <span class="c1"># 图片不显示坐标轴</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;wordcloud.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># 参数:图片名, (取消图片自带白边)   注:保存操作必须要在显示之前(可能显示后文件流就被关闭了)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># 显示图片</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step48ffmpeg">Step48.ffmpeg</h1>
<ul>
<li>环境配置见<code>爬虫-项目-哔哩哔哩视频爬取</code></li>
</ul>
<h2 id="批量合并ts文件合成mp4格式">批量合并ts文件,合成mp4格式</h2>
<ul>
<li>第一种</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">ffmpeg</span> <span class="o">-</span><span class="n">i</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//iqiyi.cdn9-okzy.com/20200817/14102_affc3951/index.m3u8 -acodec copy -vcodec copy -absf aac_adtstoasc video.mp4
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>第二种</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">ffmpeg</span> <span class="o">-</span><span class="n">i</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//iqiyi.cdn9-okzy.com/20200817/14102_affc3951/index.m3u8 -acodec copy -vcodec copy output.mp4
</span></code></pre></td></tr></table>
</div>
</div><h2 id="切割mp4为m3u8格式">切割mp4为m3u8格式</h2>
<ul>
<li>第一种</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">ffmpeg</span> <span class="o">-</span><span class="nx">i</span> <span class="nx">raw_video</span><span class="p">.</span><span class="nx">mp4</span> <span class="o">-</span><span class="nx">c</span> <span class="nx">copy</span> <span class="o">-</span><span class="kd">map</span> <span class="mi">0</span> <span class="o">-</span><span class="nx">f</span> <span class="nx">segment</span> <span class="o">-</span><span class="nx">segment_list</span> <span class="nx">hls</span><span class="o">/</span><span class="nx">video</span><span class="p">.</span><span class="nx">m3u8</span> <span class="nx">hls</span><span class="o">/</span><span class="nx">video</span><span class="o">%</span><span class="nx">d</span><span class="p">.</span><span class="nx">ts</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>第二种</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="nt">ffmpeg</span> <span class="nt">-i</span> <span class="nt">Video</span><span class="p">.</span><span class="nc">mp4</span> <span class="nt">-c</span> <span class="nt">copy</span> <span class="nt">-map</span> <span class="nt">0</span> <span class="nt">-f</span> <span class="nt">segment</span> <span class="nt">-segment_list</span> <span class="nt">video_playlist</span><span class="p">.</span><span class="nc">m3u8</span> <span class="nt">-segment_time</span> <span class="nt">2</span> <span class="nt">video</span><span class="o">%</span><span class="nt">03d</span><span class="p">.</span><span class="nc">ts</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>第三种</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="nt">ffmpeg</span> <span class="nt">-i</span> <span class="nt">Video</span><span class="p">.</span><span class="nc">mp4</span> <span class="nt">-c</span> <span class="nt">copy</span> <span class="nt">-bsf</span><span class="p">:</span><span class="nd">v</span> <span class="nt">h264_mp4toannexb</span> <span class="nt">-map</span> <span class="nt">0</span> <span class="nt">-f</span> <span class="nt">segment</span> <span class="nt">-segment_time</span> <span class="nt">10</span> <span class="nt">-segment_format</span> <span class="nt">mpegts</span>  <span class="nt">-segment_list</span> <span class="nt">video_playlist</span><span class="p">.</span><span class="nc">m3u8</span>  <span class="nt">video</span><span class="o">%</span><span class="nt">03d</span><span class="p">.</span><span class="nc">ts</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="切片mp4为m3u8列表">切片mp4为m3u8列表</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-css" data-lang="css"><span class="nt">ffmpeg</span> <span class="nt">-i</span> <span class="nt">Video</span><span class="p">.</span><span class="nc">mp4</span> <span class="nt">-c</span> <span class="nt">copy</span> <span class="nt">-hls_time</span> <span class="nt">2</span> <span class="nt">-hls_list_size</span> <span class="nt">0</span> <span class="nt">video_playlist</span><span class="p">.</span><span class="nc">m3u8</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step49解决try-except抛出异常退出程序运行的问题">Step49.解决<code>try-except抛出异常退出程序运行</code>的问题</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">start</span><span class="p">():</span>
    <span class="n">a</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">a</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
    	<span class="err">异常</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;异常&#39;</span><span class="p">)</span>
        <span class="n">start</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step50ubuntu安装pip">Step50.Ubuntu安装pip</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo apt install python3-pip
</code></pre></td></tr></table>
</div>
</div><h1 id="step51ubuntu安装django环境">Step51.Ubuntu安装django环境</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 安装django</span>
pip3 install <span class="nv">django</span><span class="o">==</span>2.2 -i https://pypi.douban.com/simple
<span class="c1"># 安装django-admin</span>
sudo apt install python3-pip
</code></pre></td></tr></table>
</div>
</div><h1 id="step52python-thread">Step52.Python thread</h1>
<h2 id="create-thread">Create thread</h2>
<h3 id="common-creation-method">common creation method</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;The {}th task&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;2s&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;1s&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;0s&#39;</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,))</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,))</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">t2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="inherit-the-threadingthread-class-and-override-the-run-method-of-threadingthread">Inherit the threading.Thread class and override the run method of threading.Thread</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">class</span> <span class="nc">MyThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyThread</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>  <span class="c1"># st write refactored run function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;The {}th task</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;2s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;1s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;0s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">MyThread</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">MyThread</span><span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">t2</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="daemon-thread">daemon thread</h2>
<ul>
<li>when the main thread ends,it will not wait for the child thread and exit the program directly.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>


<span class="k">class</span> <span class="nc">MyThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyThread</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>  <span class="c1"># st write refactored run function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;The {}th task</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;2s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;1s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;0s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">MyThread</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">setDaemon</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>in the daemon thread environment,if you want the main thread to wait for the child thread to finish running before exiting,you need to add the join method after the start method</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">time</span>
  
  
<span class="k">class</span> <span class="nc">MyThread</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MyThread</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>  <span class="c1"># st write refactored run function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
  
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;The {}th task</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">))</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;2s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;1s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;0s</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  
  
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">MyThread</span><span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">)</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">setDaemon</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="n">t1</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h2 id="thread-lock">Thread Lock</h2>
<h3 id="mutex-lock">Mutex Lock</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span><span class="p">,</span> <span class="n">Lock</span>


<span class="k">def</span> <span class="nf">work</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">n</span>
    <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">n</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">temp</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">work</span><span class="p">)</span>
        <span class="n">l</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>  <span class="c1"># after the start method is called,the current thread enters the ready state and waits for the memory to allocate space.Once the allocated space is obtained,the thread&#39;s method is execute.</span>
        <span class="k">print</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># time.sleep(2)  # Since the execution speed of the for loop is much faster than the speed of allocating space, if the delay function is not added, the for loop will be executed immediately, and then the next for loop will be executed immediately, and finally the thread method will be executed.</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">l</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">p</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="recursive-locks">Recursive Locks</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>


<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">gl_num</span>
    <span class="n">lock</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>
    <span class="n">gl_num</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">gl_num</span><span class="p">)</span>
    <span class="n">lock</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">gl_num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">RLock</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;th&#39;</span><span class="p">)</span>
        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="semaphore">Semaphore</h2>
<ul>
<li>
<p>Mutual exclusion locks allow only one thread to change data at the same time, while Semaphore allows a certain number of threads to change data at the same time. For example, there are 3 pits in the toilet.That only allows a maximum of 3 people to use the toilet, and the people behind can only wait outside. You can&rsquo;t go in until the people inside come out.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">threading</span>
  
  
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">):</span>
    <span class="n">semaphore</span><span class="o">.</span><span class="n">acquire</span><span class="p">()</span>  <span class="c1"># add lock</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;run the thread:</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">semaphore</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>  <span class="c1"># freed</span>
  
  
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">semaphore</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">BoundedSemaphore</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Mutual exclusion locks allow only one thread to change data at the same time, while Semaphore allows a certain number of threads to change data at the same time. For example, there are 3 pits in the toilet.That only allows a maximum of 3 people to use the toilet, and the people behind can only wait outside. You can&#39;t go in until the people inside come out.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">22</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">run</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;t-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">,</span> <span class="n">semaphore</span><span class="p">))</span>
        <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">threading</span><span class="o">.</span><span class="n">active_count</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;----------all threads done-----------&#39;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step53python提取视频音频">Step53.python提取视频音频</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">pip install moviepy
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">from</span> <span class="nn">moviepy.editor</span> <span class="kn">import</span> <span class="n">AudioFileClip</span>
<span class="n">my_audio_clip</span> <span class="o">=</span> <span class="n">AudioFileClip</span><span class="p">(</span><span class="s2">&#34;GreatestWork.mp4&#34;</span><span class="p">)</span>
<span class="n">my_audio_clip</span><span class="o">.</span><span class="n">write_audiofile</span><span class="p">(</span><span class="s2">&#34;GreatestWork.mp3&#34;</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><hr>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Zhang's Blog</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2021-04-10
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/python/">Python</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/jsp/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">JSP</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">
            <span class="next-text nav-default">机器学习</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://twitter.com/" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://www.facebook.com/" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://www.linkedin.com/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://www.google.com/" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/" class="iconfont icon-douban" title="douban"></a>
      <a href="https://getpocket.com/" class="iconfont icon-pocket" title="pocket"></a>
      <a href="https://www.tumblr.com/" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="https://www.instagram.com/" class="iconfont icon-instagram" title="instagram"></a>
      <a href="https://about.gitlab.com/" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="https://www.bilibili.com/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="http://localhost:1313/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://golang.org/">GoLang</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Author - 
    <a class="theme-link" href="https://space.bilibili.com/628950169/">Mr'zhang</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span>Zhang's Blog</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>








</body>
</html>
