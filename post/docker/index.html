<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Docker - Zhang&#39;s Blog的博客</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Zhang&#39;s Blog" /><meta name="description" content="Step1.什么是Docker 虚拟机就是一个系统内核、一个大的lib环境以及许多许多的应用程序,所有应用都是运行在他们俩之上的 这样的缺点就是" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.67.1 with theme even" />


<link rel="canonical" href="http://localhost:1313/post/docker/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Docker" />
<meta property="og:description" content="Step1.什么是Docker 虚拟机就是一个系统内核、一个大的lib环境以及许多许多的应用程序,所有应用都是运行在他们俩之上的 这样的缺点就是" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/docker/" />
<meta property="article:published_time" content="2021-10-04T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-10-04T00:00:00+00:00" />
<meta itemprop="name" content="Docker">
<meta itemprop="description" content="Step1.什么是Docker 虚拟机就是一个系统内核、一个大的lib环境以及许多许多的应用程序,所有应用都是运行在他们俩之上的 这样的缺点就是">
<meta itemprop="datePublished" content="2021-10-04T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-10-04T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="11991">



<meta itemprop="keywords" content="中间件," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Docker"/>
<meta name="twitter:description" content="Step1.什么是Docker 虚拟机就是一个系统内核、一个大的lib环境以及许多许多的应用程序,所有应用都是运行在他们俩之上的 这样的缺点就是"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Zhang&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/home/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">MyBlog</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Zhang&#39;s Blog</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/home/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">MyBlog</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Docker</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-10-04 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#step1什么是docker">Step1.什么是Docker</a></li>
    <li><a href="#step2docker安装">Step2.Docker安装</a>
      <ul>
        <li><a href="#docker名词解读">Docker名词解读</a></li>
        <li><a href="#安装">安装</a>
          <ul>
            <li><a href="#centos">CentOS</a></li>
            <li><a href="#redcat">RedCat</a></li>
          </ul>
        </li>
        <li><a href="#卸载">卸载</a></li>
      </ul>
    </li>
    <li><a href="#step3run的流程和docker原理">Step3.Run的流程和Docker原理</a></li>
    <li><a href="#step4镜像的基本命令">Step4.镜像的基本命令</a>
      <ul>
        <li><a href="#帮助">帮助</a>
          <ul>
            <li><a href="#命令">命令</a></li>
            <li><a href="#docs">docs</a></li>
          </ul>
        </li>
        <li><a href="#镜像命令">镜像命令</a>
          <ul>
            <li><a href="#docker-images"><code>docker images</code></a></li>
            <li><a href="#docker-search-镜像"><code>docker search 镜像</code></a></li>
            <li><a href="#docker-pull-镜像名"><code>docker pull 镜像名</code></a></li>
            <li><a href="#docker-rmi--f"><code>docker rmi -f</code></a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step5容器的基本命令">Step5.容器的基本命令</a>
      <ul>
        <li><a href="#新建容器并启动">新建容器并启动</a></li>
        <li><a href="#列出所有运行的容器">列出所有运行的容器</a></li>
        <li><a href="#删除容器">删除容器</a></li>
        <li><a href="#启动和停止容器的操作">启动和停止容器的操作</a></li>
      </ul>
    </li>
    <li><a href="#step6其他常用命令">Step6.其他常用命令</a></li>
    <li><a href="#step7进入容器的命令和拷贝命令">Step7.进入容器的命令和拷贝命令</a>
      <ul>
        <li><a href="#进入容器">进入容器</a></li>
        <li><a href="#拷贝命令">拷贝命令</a></li>
      </ul>
    </li>
    <li><a href="#step8配置nginx">Step8.配置nginx</a></li>
    <li><a href="#step9配置tomcat">Step9.配置tomcat</a></li>
    <li><a href="#step10docker配置elasticsearch">Step10.docker配置ElasticSearch</a></li>
    <li><a href="#step11docker配置portainerportainer可视化页面">Step11.docker配置portainer/portainer(可视化页面)</a></li>
    <li><a href="#step12docker配置mongodb">Step12.docker配置mongoDB</a></li>
    <li><a href="#step13镜像之联合文件系统">Step13.镜像之联合文件系统</a></li>
    <li><a href="#step14镜像原理之分层理解">Step14.镜像原理之分层理解</a></li>
    <li><a href="#step15commit一个镜像">Step15.commit一个镜像</a></li>
    <li><a href="#step16容器数据卷使用">Step16.容器数据卷使用</a>
      <ul>
        <li><a href="#具名挂载和匿名挂载">具名挂载和匿名挂载</a>
          <ul>
            <li><a href="#拓展">拓展</a></li>
          </ul>
        </li>
        <li><a href="#dockerfile">Dockerfile</a></li>
      </ul>
    </li>
    <li><a href="#step17docker-compose">Step17.docker-compose</a>
      <ul>
        <li><a href="#什么是docker-compose">什么是docker-compose</a></li>
        <li><a href="#docker-compose的安装">docker-compose的安装</a></li>
        <li><a href="#开始使用docker-compose">开始使用docker-compose</a>
          <ul>
            <li><a href="#构建环境">构建环境</a></li>
          </ul>
        </li>
        <li><a href="#docker-compose配置文件解读">docker-compose配置文件解读</a></li>
        <li><a href="#使用dockercompose一键发布wordpress博客">使用dockercompose一键发布wordpress博客</a></li>
        <li><a href="#本地编写微服务项目通过dockercompose一键发布">本地编写微服务项目通过dockercompose一键发布</a></li>
      </ul>
    </li>
    <li><a href="#step18mac完全卸载docker">Step18.mac完全卸载docker</a>
      <ul>
        <li><a href="#heading"></a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <h1 id="step1什么是docker">Step1.什么是Docker</h1>
<p><img src="https://img-blog.csdnimg.cn/ca27dee4c4bb4227b464fedfa289a0cc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<ul>
<li>虚拟机就是一个系统内核、一个大的lib环境以及许多许多的应用程序,所有应用都是运行在他们俩之上的</li>
<li>这样的缺点就是如果某一个应用环境出现问题了,可能会导致整个虚拟机的崩溃</li>
<li>而且它是虚拟出来一个硬件配置,虚拟出来一个电脑,比较浪费资源</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/01aef1c323a6459b87fd88a05d96f5df.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_18,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/f6fb552f9c9840c6bcf3300e0e0eebec.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/ae6d628fa02f424f9c062e591e72e4b4.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<hr>
<h1 id="step2docker安装">Step2.Docker安装</h1>
<h2 id="docker名词解读">Docker名词解读</h2>
<p><img src="https://img-blog.csdnimg.cn/c9bd1b792cc54687934669153054784b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/dd640f3ee317487b9e7a7e2630007817.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<ul>
<li>仓库就是用来存储镜像的地方</li>
<li>镜像就是平时用的那些环境,例如tomcat、redis、nginx等</li>
<li>通过镜像创建容器</li>
<li>比如想创建一个tomcat容器,就通过仓库(repository)中已经存在的tomcat镜像创建一个tomcat容器</li>
<li>一个镜像可以创建多个容器(例如tomcat1、tomcat2等)</li>
<li>每一个容器就像是一个小的Linux服务器,用来运行创建它的镜像在实际环境中所代表的环境</li>
</ul>
<h2 id="安装">安装</h2>
<h3 id="centos">CentOS</h3>
<ul>
<li>
<p><a href="https://www.docker.com/">官网</a></p>
</li>
<li>
<p>找到CentOS的安装文档</p>
<blockquote>
<p><img src="https://img-blog.csdnimg.cn/1a35dba686e34c44a280cdbd967dbe1c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/8160c9c1db2147cb803f5b76cffbc9fd.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/8b0fcf54679c4848b75b18fe9ec61477.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/1ea124032a1e4de8b36993eb87812883.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/e297880eb2a74fcfa73f0beffb8f7898.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</blockquote>
</li>
<li>
<p>查看CentOS系统配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># cat /etc/os-release</span>
<span class="nv">NAME</span><span class="o">=</span><span class="s2">&#34;CentOS Linux&#34;</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="s2">&#34;8 (Core)&#34;</span>
<span class="nv">ID</span><span class="o">=</span><span class="s2">&#34;centos&#34;</span>
<span class="nv">ID_LIKE</span><span class="o">=</span><span class="s2">&#34;rhel fedora&#34;</span>
<span class="nv">VERSION_ID</span><span class="o">=</span><span class="s2">&#34;8&#34;</span>
<span class="nv">PLATFORM_ID</span><span class="o">=</span><span class="s2">&#34;platform:el8&#34;</span>
<span class="nv">PRETTY_NAME</span><span class="o">=</span><span class="s2">&#34;CentOS Linux 8 (Core)&#34;</span>
<span class="nv">ANSI_COLOR</span><span class="o">=</span><span class="s2">&#34;0;31&#34;</span>
<span class="nv">CPE_NAME</span><span class="o">=</span><span class="s2">&#34;cpe:/o:centos:centos:8&#34;</span>
<span class="nv">HOME_URL</span><span class="o">=</span><span class="s2">&#34;https://www.centos.org/&#34;</span>
<span class="nv">BUG_REPORT_URL</span><span class="o">=</span><span class="s2">&#34;https://bugs.centos.org/&#34;</span>
  
<span class="nv">CENTOS_MANTISBT_PROJECT</span><span class="o">=</span><span class="s2">&#34;CentOS-8&#34;</span>
<span class="nv">CENTOS_MANTISBT_PROJECT_VERSION</span><span class="o">=</span><span class="s2">&#34;8&#34;</span>
<span class="nv">REDHAT_SUPPORT_PRODUCT</span><span class="o">=</span><span class="s2">&#34;centos&#34;</span>
<span class="nv">REDHAT_SUPPORT_PRODUCT_VERSION</span><span class="o">=</span><span class="s2">&#34;8&#34;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>删除旧版本Docker</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">yum remove docker <span class="se">\</span>
                  docker-client <span class="se">\</span>
                  docker-client-latest <span class="se">\</span>
                  docker-common <span class="se">\</span>
                  docker-latest <span class="se">\</span>
                  docker-latest-logrotate <span class="se">\</span>
                  docker-logrotate <span class="se">\</span>
                  docker-engine
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>下载一些工具</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">yum install -y yum-utils
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>配置docker镜像仓库</p>
<blockquote>
<p>官方的是</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">sudo yum-config-manager <span class="se">\</span>
    --add-repo <span class="se">\</span>
    https://download.docker.com/linux/centos/docker-ce.repo
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>但是速度极慢,所以使用阿里云docker镜像地址</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>安装docker核心、客户端和容器</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">yum install docker-ce docker-ce-cli containerd.io
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>安装完毕,就可以启动docker了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">systemctl start docker
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>运行helloworld</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">docker run hello-world
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker run hello-world</span>
<span class="c1"># 发现docker中没有这个镜像</span>
Unable to find image <span class="s1">&#39;hello-world:latest&#39;</span> locally
  
<span class="c1"># 从刚才配置的阿里云镜像仓库远程拉取hello-world镜像</span>
latest: Pulling from library/hello-world
2db29710123e: Pull <span class="nb">complete</span> 
  
<span class="c1"># 拉取到了,就返回一个签名信息,证明拉取OK了</span>
Digest: sha256:cc15c5b292d8525effc0f89cb299f1804f3a725c8d05e158653a563f15e4f685
Status: Downloaded newer image <span class="k">for</span> hello-world:latest
  
<span class="c1"># 出现这句话,说明docker已经安装成功了</span>
Hello from Docker!
This message shows that your installation appears to be working correctly.
  
To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the <span class="s2">&#34;hello-world&#34;</span> image from the Docker Hub.
    <span class="o">(</span>amd64<span class="o">)</span>
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.
  
To try something more ambitious, you can run an Ubuntu container with:
 $ docker run -it ubuntu bash
  
Share images, automate workflows, and more with a free Docker ID:
 https://hub.docker.com/
  
For more examples and ideas, visit:
 https://docs.docker.com/get-started/
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>查看docker版本</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker version
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>查看当前docker容器中所有镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images</span>
REPOSITORY    TAG       IMAGE ID       CREATED       SIZE
hello-world   latest    feb5d9fea6a5   <span class="m">8</span> weeks ago   13.3kB
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>可以看到,这里面是有一个hello-world的</p>
</blockquote>
</li>
</ul>
<h3 id="redcat">RedCat</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 安装libcgroup</span>
rpm -ivh libcgroup-0.41-21.el7.x86_64.rpm 
wget https://get.docker.com/rpm/1.7.1/centos-6/RPMS/x86_64/docker-engine-1.7.1-1.el6.x86_64.rpm
rpm -ivh docker-engine-1.7.1-1.el6.x86_64.rpm
</code></pre></td></tr></table>
</div>
</div><h2 id="卸载">卸载</h2>
<p><img src="https://img-blog.csdnimg.cn/a619bc0d6bf3418ba028cbcaf721a7d8.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<hr>
<h1 id="step3run的流程和docker原理">Step3.Run的流程和Docker原理</h1>
<p><img src="https://img-blog.csdnimg.cn/9512f38655b544e78a3ee3dbba7e0727.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/b1ba3a1f84c64b6080fabf3e7795eab2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/b44e99b620b34210ba8d40ba21f9dddc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<hr>
<h1 id="step4镜像的基本命令">Step4.镜像的基本命令</h1>
<h2 id="帮助">帮助</h2>
<h3 id="命令">命令</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">docker version <span class="c1"># 查看docker的版本号</span>
docker info <span class="c1"># 查看docker的系统信息</span>
docker 命令<span class="o">(</span>可不写<span class="o">)</span> --help <span class="c1"># 查看docker的所有命令/查看指定命令的帮助</span>
</code></pre></td></tr></table>
</div>
</div><p><code>docker info</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker info</span>

<span class="c1"># 客户端</span>
Client:
 Context:    default
 Debug Mode: <span class="nb">false</span>
 Plugins:
  app: Docker App <span class="o">(</span>Docker Inc., v0.9.1-beta3<span class="o">)</span>
  buildx: Build with BuildKit <span class="o">(</span>Docker Inc., v0.6.3-docker<span class="o">)</span>
  scan: Docker Scan <span class="o">(</span>Docker Inc., v0.9.0<span class="o">)</span>

<span class="c1"># 服务器</span>
Server:
 Containers: <span class="m">2</span> <span class="c1"># 跟容器相关的</span>
  Running: <span class="m">0</span> <span class="c1"># 运行了几个</span>
  Paused: <span class="m">0</span> <span class="c1"># 暂停了几个</span>
  Stopped: <span class="m">2</span> <span class="c1"># 停止了几个</span>
 Images: <span class="m">1</span> <span class="c1"># 有几个镜像(这里是刚开始安装时候只启动了一个hello-world)</span>
 Server Version: 20.10.11 <span class="c1"># 服务器版本</span>
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: <span class="nb">true</span>
  Native Overlay Diff: <span class="nb">true</span>
  userxattr: <span class="nb">false</span>
 Logging Driver: json-file
 Cgroup Driver: cgroupfs
 Cgroup Version: 1
 
 <span class="c1"># 插件信息</span>
 Plugins:
  Volume: <span class="nb">local</span>
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file <span class="nb">local</span> logentries splunk syslog
 Swarm: inactive
 Runtimes: runc io.containerd.runc.v2 io.containerd.runtime.v1.linux
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 7b11cfaabd73bb80907dd23182b9347b4245eb5d
 runc version: v1.0.2-0-g52b36a2
 init version: de40ad0
 Security Options:
  seccomp
   Profile: default
 Kernel Version: 4.18.0-305.10.2.el8_4.x86_64
 Operating System: CentOS Linux <span class="m">8</span> <span class="o">(</span>Core<span class="o">)</span>
 OSType: linux
 Architecture: x86_64
 CPUs: 1
 Total Memory: 1.775GiB
 Name: VM-16-16-centos
 ID: OB2T:ILVD:ZKUY:4AOS:WHLT:5V7O:P3CW:K7LZ:RQAZ:2ZP7:3OVF:QJAT
 Docker Root Dir: /var/lib/docker
 Debug Mode: <span class="nb">false</span>
 Registry: https://index.docker.io/v1/
 Labels:
 Experimental: <span class="nb">false</span>
 Insecure Registries:
  127.0.0.0/8
 Live Restore Enabled: <span class="nb">false</span>
</code></pre></td></tr></table>
</div>
</div><p><code>docker --help</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker --help</span>

Usage:  docker <span class="o">[</span>OPTIONS<span class="o">]</span> COMMAND

A self-sufficient runtime <span class="k">for</span> containers

Options:
      --config string      Location of client config files <span class="o">(</span>default <span class="s2">&#34;/root/.docker&#34;</span><span class="o">)</span>
  -c, --context string     Name of the context to use to connect to the daemon <span class="o">(</span>overrides DOCKER_HOST env var and default context <span class="nb">set</span> with <span class="s2">&#34;docker context use&#34;</span><span class="o">)</span>
  -D, --debug              Enable debug mode
  -H, --host list          Daemon socket<span class="o">(</span>s<span class="o">)</span> to connect to
  -l, --log-level string   Set the logging level <span class="o">(</span><span class="s2">&#34;debug&#34;</span><span class="p">|</span><span class="s2">&#34;info&#34;</span><span class="p">|</span><span class="s2">&#34;warn&#34;</span><span class="p">|</span><span class="s2">&#34;error&#34;</span><span class="p">|</span><span class="s2">&#34;fatal&#34;</span><span class="o">)</span> <span class="o">(</span>default <span class="s2">&#34;info&#34;</span><span class="o">)</span>
      --tls                Use TLS<span class="p">;</span> implied by --tlsverify
      --tlscacert string   Trust certs signed only by this CA <span class="o">(</span>default <span class="s2">&#34;/root/.docker/ca.pem&#34;</span><span class="o">)</span>
      --tlscert string     Path to TLS certificate file <span class="o">(</span>default <span class="s2">&#34;/root/.docker/cert.pem&#34;</span><span class="o">)</span>
      --tlskey string      Path to TLS key file <span class="o">(</span>default <span class="s2">&#34;/root/.docker/key.pem&#34;</span><span class="o">)</span>
      --tlsverify          Use TLS and verify the remote
  -v, --version            Print version information and quit

Management Commands:
  app*        Docker App <span class="o">(</span>Docker Inc., v0.9.1-beta3<span class="o">)</span>
  builder     Manage builds
  buildx*     Build with BuildKit <span class="o">(</span>Docker Inc., v0.6.3-docker<span class="o">)</span>
  config      Manage Docker configs
  container   Manage containers
  context     Manage contexts
  image       Manage images
  manifest    Manage Docker image manifests and manifest lists
  network     Manage networks
  node        Manage Swarm nodes
  plugin      Manage plugins
  scan*       Docker Scan <span class="o">(</span>Docker Inc., v0.9.0<span class="o">)</span>
  secret      Manage Docker secrets
  service     Manage services
  stack       Manage Docker stacks
  swarm       Manage Swarm
  system      Manage Docker
  trust       Manage trust on Docker images
  volume      Manage volumes

Commands:
  attach      Attach <span class="nb">local</span> standard input, output, and error streams to a running container
  build       Build an image from a Dockerfile
  commit      Create a new image from a container<span class="s1">&#39;s changes
</span><span class="s1">  cp          Copy files/folders between a container and the local filesystem
</span><span class="s1">  create      Create a new container
</span><span class="s1">  diff        Inspect changes to files or directories on a container&#39;</span>s filesystem
  events      Get real <span class="nb">time</span> events from the server
  <span class="nb">exec</span>        Run a <span class="nb">command</span> in a running container
  <span class="nb">export</span>      Export a container<span class="s1">&#39;s filesystem as a tar archive
</span><span class="s1">  history     Show the history of an image
</span><span class="s1">  images      List images
</span><span class="s1">  import      Import the contents from a tarball to create a filesystem image
</span><span class="s1">  info        Display system-wide information
</span><span class="s1">  inspect     Return low-level information on Docker objects
</span><span class="s1">  kill        Kill one or more running containers
</span><span class="s1">  load        Load an image from a tar archive or STDIN
</span><span class="s1">  login       Log in to a Docker registry
</span><span class="s1">  logout      Log out from a Docker registry
</span><span class="s1">  logs        Fetch the logs of a container
</span><span class="s1">  pause       Pause all processes within one or more containers
</span><span class="s1">  port        List port mappings or a specific mapping for the container
</span><span class="s1">  ps          List containers
</span><span class="s1">  pull        Pull an image or a repository from a registry
</span><span class="s1">  push        Push an image or a repository to a registry
</span><span class="s1">  rename      Rename a container
</span><span class="s1">  restart     Restart one or more containers
</span><span class="s1">  rm          Remove one or more containers
</span><span class="s1">  rmi         Remove one or more images
</span><span class="s1">  run         Run a command in a new container
</span><span class="s1">  save        Save one or more images to a tar archive (streamed to STDOUT by default)
</span><span class="s1">  search      Search the Docker Hub for images
</span><span class="s1">  start       Start one or more stopped containers
</span><span class="s1">  stats       Display a live stream of container(s) resource usage statistics
</span><span class="s1">  stop        Stop one or more running containers
</span><span class="s1">  tag         Create a tag TARGET_IMAGE that refers to SOURCE_IMAGE
</span><span class="s1">  top         Display the running processes of a container
</span><span class="s1">  unpause     Unpause all processes within one or more containers
</span><span class="s1">  update      Update configuration of one or more containers
</span><span class="s1">  version     Show the Docker version information
</span><span class="s1">  wait        Block until one or more containers stop, then print their exit codes
</span><span class="s1">
</span><span class="s1">Run &#39;</span>docker COMMAND --help<span class="err">&#39;</span> <span class="k">for</span> more information on a command.

To get more <span class="nb">help</span> with docker, check out our guides at https://docs.docker.com/go/guides/
</code></pre></td></tr></table>
</div>
</div><h3 id="docs">docs</h3>
<p><img src="https://img-blog.csdnimg.cn/968a3707142c490a9c9ae4a4aacaa1e2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><a href="https://docs.docker.com/reference/">docker-docs</a></p>
<h2 id="镜像命令">镜像命令</h2>
<h3 id="docker-images"><code>docker images</code></h3>
<blockquote>
<p>查看所有本地主机上的镜像</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images</span>
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    feb5d9fea6a5   <span class="m">2</span> months ago   13.3kB
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>REPOSITORY:镜像仓库名</p>
<p>TAG:镜像标签</p>
<p>IMAGE ID:镜像ID</p>
<p>CREATE:镜像创建时间</p>
<p>SIZE:镜像大小</p>
</blockquote>
<ul>
<li>
<p>docker images -a / docker images &ndash;all</p>
<blockquote>
<p>查看所有本地主机上的镜像</p>
<p>其实和docker-images是一样的</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images -a</span>
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    feb5d9fea6a5   <span class="m">2</span> months ago   13.3kB
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images --all</span>
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
hello-world   latest    feb5d9fea6a5   <span class="m">2</span> months ago   13.3kB
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>docker images -q / docker images &ndash;quiet</p>
<blockquote>
<p>只显示所有镜像的ID</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images -q</span>
feb5d9fea6a5
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images --quiet</span>
feb5d9fea6a5
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="docker-search-镜像"><code>docker search 镜像</code></h3>
<blockquote>
<p>寻找docker应用商店中的镜像应用,例如mysql、tomcat等</p>
</blockquote>
<ul>
<li>
<p>有两种查询方式</p>
<ul>
<li>
<p>通过官网</p>
<p><img src="https://img-blog.csdnimg.cn/f7380d5eb4bc4e5a875d58c5f0453ccc.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/184a043550b0485eb77c65ca19070734.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/2cfbcf1955544bc385f42bfd62a9b274.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
<li>
<p>通过命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker search mysql</span>
NAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
mysql                             MySQL is a widely used, open-source relation…   <span class="m">11712</span>     <span class="o">[</span>OK<span class="o">]</span>       
mariadb                           MariaDB Server is a high performing open sou…   <span class="m">4464</span>      <span class="o">[</span>OK<span class="o">]</span>       
mysql/mysql-server                Optimized MySQL Server Docker images. Create…   <span class="m">870</span>                  <span class="o">[</span>OK<span class="o">]</span>
percona                           Percona Server is a fork of the MySQL relati…   <span class="m">563</span>       <span class="o">[</span>OK<span class="o">]</span>       
phpmyadmin                        phpMyAdmin - A web interface <span class="k">for</span> MySQL and M…   <span class="m">377</span>       <span class="o">[</span>OK<span class="o">]</span>       
centos/mysql-57-centos7           MySQL 5.7 SQL database server                   <span class="m">92</span>                   
mysql/mysql-cluster               Experimental MySQL Cluster Docker images. Cr…   <span class="m">89</span>                   
centurylink/mysql                 Image containing mysql. Optimized to be link…   <span class="m">59</span>                   <span class="o">[</span>OK<span class="o">]</span>
databack/mysql-backup             Back up mysql databases to... anywhere!         <span class="m">53</span>                   
prom/mysqld-exporter                                                              <span class="m">43</span>                   <span class="o">[</span>OK<span class="o">]</span>
deitch/mysql-backup               REPLACED! Please use http://hub.docker.com/r…   <span class="m">41</span>                   <span class="o">[</span>OK<span class="o">]</span>
tutum/mysql                       Base docker image to run a MySQL database se…   <span class="m">35</span>                   
linuxserver/mysql                 A Mysql container, brought to you by LinuxSe…   <span class="m">34</span>                   
schickling/mysql-backup-s3        Backup MySQL to S3 <span class="o">(</span>supports periodic backup…   <span class="m">31</span>                   <span class="o">[</span>OK<span class="o">]</span>
mysql/mysql-router                MySQL Router provides transparent routing be…   <span class="m">23</span>                   
centos/mysql-56-centos7           MySQL 5.6 SQL database server                   <span class="m">21</span>                   
arey/mysql-client                 Run a MySQL client from a docker container      <span class="m">19</span>                   <span class="o">[</span>OK<span class="o">]</span>
fradelg/mysql-cron-backup         MySQL/MariaDB database backup using cron tas…   <span class="m">16</span>                   <span class="o">[</span>OK<span class="o">]</span>
openshift/mysql-55-centos7        DEPRECATED: A Centos7 based MySQL v5.5 image…   <span class="m">6</span>                    
devilbox/mysql                    Retagged MySQL, MariaDB and PerconaDB offici…   <span class="m">3</span>                    
ansibleplaybookbundle/mysql-apb   An APB which deploys RHSCL MySQL                <span class="m">3</span>                    <span class="o">[</span>OK<span class="o">]</span>
idoall/mysql                      MySQL is a widely used, open-source relation…   <span class="m">3</span>                    <span class="o">[</span>OK<span class="o">]</span>
jelastic/mysql                    An image of the MySQL database server mainta…   <span class="m">2</span>                    
centos/mysql-80-centos7           MySQL 8.0 SQL database server                   <span class="m">2</span>                    
widdpim/mysql-client              Dockerized MySQL Client <span class="o">(</span>5.7<span class="o">)</span> including Curl…   <span class="m">1</span>                    <span class="o">[</span>OK<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>可以看到,mysql有name、star等字段</p>
<p>想通过命令查询指定数量范围star的字段</p>
</blockquote>
<blockquote>
<p>当然每个命令都有 &ndash;filter等这种命令</p>
<p>可以通过 &ndash;help查询</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker search --help</span>
    
Usage:  docker search <span class="o">[</span>OPTIONS<span class="o">]</span> TERM
    
Search the Docker Hub <span class="k">for</span> images
    
Options:
  -f, --filter filter   Filter output based on conditions provided
      --format string   Pretty-print search using a Go template
      --limit int       Max number of search results <span class="o">(</span>default 25<span class="o">)</span>
      --no-trunc        Don<span class="err">&#39;</span>t truncate output
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>&ndash;filter就是过滤器,通过过滤器查询指定stars的mysql</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker search --filter stars=6000 mysql</span>
NAME      DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED
mysql     MySQL is a widely used, open-source relation…   <span class="m">11712</span>     <span class="o">[</span>OK<span class="o">]</span>       
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这种命令其实还是需要读官方文档才找得到</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<h3 id="docker-pull-镜像名"><code>docker pull 镜像名</code></h3>
<blockquote>
<p>上面是查询Docker Hub上的所有镜像,这个就是将指定镜像下载到本地主机上</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker pull mysql</span>
Using default tag: latest <span class="c1"># tag:如果没有这个tag,默认是latest</span>
latest: Pulling from library/mysql <span class="c1"># 从哪个仓库下载mysql</span>

<span class="c1"># docker的核心,分层下载</span>
<span class="c1"># 联合文件系统</span>
a10c77af2613: Pull <span class="nb">complete</span>  
b76a7eb51ffd: Pull <span class="nb">complete</span> 
258223f927e4: Pull <span class="nb">complete</span> 
2d2c75386df9: Pull <span class="nb">complete</span> 
63e92e4046c9: Pull <span class="nb">complete</span> 
f5845c731544: Pull <span class="nb">complete</span> 
bd0401123a9b: Pull <span class="nb">complete</span> 
3ef07ec35f1a: Pull <span class="nb">complete</span> 
c93a31315089: Pull <span class="nb">complete</span> 
3349ed800d44: Pull <span class="nb">complete</span> 
6d01857ca4c1: Pull <span class="nb">complete</span> 
4cc13890eda8: Pull <span class="nb">complete</span> 

<span class="c1"># 防伪签名,证明这个东西是docker的</span>
Digest: sha256:aeecae58035f3868bf4f00e5fc623630d8b438db9d05f4d8c6538deb14d4c31b
Status: Downloaded newer image <span class="k">for</span> mysql:latest

<span class="c1"># 这个东西就是下载镜像的真实地址,docker pull mysql和docker pull docker.io/library/mysql:latest</span>
<span class="c1"># 是一样的</span>
docker.io/library/mysql:latest
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>指定镜像版本号下载</p>
<p><img src="https://img-blog.csdnimg.cn/4af65c6d9fc54df986e5b8a9f8732c31.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<blockquote>
<p>可以看到,这里有几个是已存在的</p>
<p>docker的分层下载就是这样,如果不同版本之间有相同的层级,就不会下载而拿过来直接用,只需要下载指定版本中现有版本层级中没有的就好</p>
<p>Linux内核思想的联合文件系统</p>
</blockquote>
</li>
</ul>
<h3 id="docker-rmi--f"><code>docker rmi -f</code></h3>
<blockquote>
<p>删除镜像</p>
</blockquote>
<blockquote>
<p>docker rmi -f 镜像id</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images</span>
REPOSITORY    TAG       IMAGE ID       CREATED        SIZE
mysql         5.7       8b43c6af2ad0   <span class="m">5</span> days ago     448MB
mysql         latest    b05128b000dd   <span class="m">5</span> days ago     516MB
hello-world   latest    feb5d9fea6a5   <span class="m">2</span> months ago   13.3kB
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker rmi -f feb5d9fea6a5</span>
Untagged: hello-world:latest
Untagged: hello-world@sha256:cc15c5b292d8525effc0f89cb299f1804f3a725c8d05e158653a563f15e4f685
Deleted: sha256:feb5d9fea6a5e9606aa995e879d862b825965ba48de054caab5ef356dc6b3412
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images</span>
REPOSITORY   TAG       IMAGE ID       CREATED      SIZE
mysql        5.7       8b43c6af2ad0   <span class="m">5</span> days ago   448MB
mysql        latest    b05128b000dd   <span class="m">5</span> days ago   516MB
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这个是根据镜像ID删除镜像</p>
</blockquote>
<blockquote>
<p>docker rmf -f 容器id							   # 根据容器id删除镜像</p>
<p>docker rmf -f 容器id 容器id 容器id		# 删除多个镜像</p>
<p>docker rmf -f $(docker images -aq)     # 递归删除所有镜像</p>
</blockquote>
<hr>
<h1 id="step5容器的基本命令">Step5.容器的基本命令</h1>
<ul>
<li>
<p>push一个centos</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker pull centos
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="新建容器并启动">新建容器并启动</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">-it <span class="c1"># 使用交互方式运行,进入容器查看内容(centos等)</span>
-d  <span class="c1"># 后台方式运行(nginx、tomcat等)</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>启动centos</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run -it centos /bin/bash
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>查看目录命令使用ll无用,只能用ls</p>
</blockquote>
</li>
<li>
<p>退出centos</p>
<ul>
<li>
<p>退出同时终止运行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">exit</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>退出同时继续运行</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">Ctrl + P + Q
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<h2 id="列出所有运行的容器">列出所有运行的容器</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">docker ps <span class="c1"># 查看当前正在运行的所有容器</span>

docker ps -a <span class="c1"># 列出当前正在运行的容器 + 历史运行容器</span>

docker ps -a -n<span class="o">=</span><span class="m">2</span> <span class="c1"># 列出指定数量的(正在运行的容器 + 历史运行容器)</span>

docker ps -aq <span class="c1"># 显示所有的容器ID(正在运行的容器 + 历史运行容器)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="删除容器">删除容器</h2>
<ul>
<li>
<p>docker ps</p>
<blockquote>
<p>查看正在运行的容器</p>
</blockquote>
</li>
<li>
<p>docker ps -a</p>
<blockquote>
<p>查看所有容器(所有运行的和没运行的)</p>
</blockquote>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND       CREATED         STATUS         PORTS     NAMES
f3709c2f450e   centos    <span class="s2">&#34;/bin/bash&#34;</span>   <span class="m">9</span> minutes ago   Up <span class="m">9</span> minutes             mystifying_heisenberg
fc2a65db2ba1   centos    <span class="s2">&#34;/bin/bash&#34;</span>   <span class="m">3</span> hours ago     Up <span class="m">3</span> hours    
loving_feistel
<span class="c1"># 这里有两个正在运行的centos容器</span>

<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker rm f3709c2f450e</span>
Error response from daemon: You cannot remove a running container f3709c2f450eabab722dbcc971037cd71b6b703587d11d68f08c08d015383548. Stop the container before attempting removal or force remove
<span class="c1"># 普通的rm不能删除运行时容器,需要使用rm -f强制删除</span>

<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker rm -f f3709c2f450e</span>
f3709c2f450e
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND       CREATED       STATUS       PORTS     NAMES
fc2a65db2ba1   centos    <span class="s2">&#34;/bin/bash&#34;</span>   <span class="m">3</span> hours ago   Up <span class="m">3</span> hours             loving_feistel
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker rm -f fc2a65db2ba1</span>
fc2a65db2ba1
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>递归删除全部容器</p>
<blockquote>
<p>docker rm -f $(docker ps -aq)</p>
<p>递归删除全部镜像是docker rmi -f $(docker images -aq)</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker pull nginx</span>
Using default tag: latest
latest: Pulling from library/nginx
eff15d958d66: Pull <span class="nb">complete</span> 
1e5351450a59: Pull <span class="nb">complete</span> 
2df63e6ce2be: Pull <span class="nb">complete</span> 
9171c7ae368c: Pull <span class="nb">complete</span> 
020f975acd28: Pull <span class="nb">complete</span> 
266f639b35ad: Pull <span class="nb">complete</span> 
Digest: sha256:097c3a0913d7e3a5b01b6c685a60c03632fc7a2b50bc8e35bcaa3691d788226e
Status: Downloaded newer image <span class="k">for</span> nginx:latest
docker.io/library/nginx:latest
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images</span>
REPOSITORY   TAG       IMAGE ID       CREATED        SIZE
nginx        latest    ea335eea17ab   <span class="m">6</span> days ago     141MB
centos       latest    5d0da3dc9764   <span class="m">2</span> months ago   231MB
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker run -it nginx /bin/bash</span>
root@d7e73358614c:/# <span class="nb">exit</span>
<span class="nb">exit</span>
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES
24ccf0b12289   nginx     <span class="s2">&#34;/docker-entrypoint.…&#34;</span>   <span class="m">23</span> seconds ago   Up <span class="m">22</span> seconds   80/tcp    interesting_mayer
5b9674789253   nginx     <span class="s2">&#34;/docker-entrypoint.…&#34;</span>   <span class="m">49</span> seconds ago   Up <span class="m">49</span> seconds   80/tcp    angry_elbakyan
d38112408bdc   centos    <span class="s2">&#34;/bin/bash&#34;</span>              <span class="m">3</span> minutes ago    Up <span class="m">2</span> minutes              charming_panini
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker rm -f $(docker ps -aq)</span>
d7e73358614c
24ccf0b12289
5b9674789253
d38112408bdc
cc2e3960daec
bc29f177ebec
2dbebd8b0e99
b1fbc451734e
920405f261e2
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>还有一种删除全部容器的方式就是</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps -a -q | xargs docker rm</span>
086fe6d9ecee
5d145bd9c71a
Error response from daemon: You cannot remove a running container 21f6aa3a18f605313ab6236c1e1affe3f562fd364979d1eab7ec5bec64102ac8. Stop the container before attempting removal or force remove
Error response from daemon: You cannot remove a running container 517a3bd46696701fd9e7a4e6049ed39606bd4bc578687f695e4d556803e04014. Stop the container before attempting removal or force remove
Error response from daemon: You cannot remove a running container f858e30e0d96a9fc552bcceb8d48267acfe76a50f17b085fad5b3f4c09beb197. Stop the container before attempting removal or force remove
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>不过还是需要<code>-f</code>强制删除</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps -a -q | xargs docker rm -f</span>
21f6aa3a18f6
517a3bd46696
f858e30e0d96
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
</code></pre></td></tr></table>
</div>
</div></blockquote>
</li>
</ul>
<h2 id="启动和停止容器的操作">启动和停止容器的操作</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker start 容器id <span class="c1"># 启动指定容器</span>
docker restart 容器id <span class="c1"># 重启指定容器</span>
docker stop 容器id <span class="c1"># 停止当前正在运行的容器</span>
docker <span class="nb">kill</span> 容器id <span class="c1"># 强制停止当前容器</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="step6其他常用命令">Step6.其他常用命令</h1>
<p><code>后台启动容器 -d</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># systemctl start docker</span>
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker run -d centos</span> 
743517684b1b293fac255c4097afd5af234040febbf25dd069fc7b70f8dc6477
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>docker 容器使用后台运行,就必须有个前台应用</p>
<p>docker发现没有前台应用,就会自动停止</p>
</blockquote>
<p><code>查看日志</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 以后台运行方式启动centos容器并在容器中运行一段脚本(死循环一直打印zhangyuhang)</span>
docker run -d centos /bin/sh <span class="s2">&#34;while true;do echo zhangyuhang;sleep 1;done&#34;</span>

<span class="c1"># 查看指定条数的日志</span>
docker logs -tf --tail <span class="m">10</span> 容器id
    2021-11-24T18:20:47.517392497Z zhangyuhang
    2021-11-24T18:20:48.519141099Z zhangyuhang
    2021-11-24T18:20:49.520792484Z zhangyuhang
    2021-11-24T18:20:50.522437648Z zhangyuhang
    2021-11-24T18:20:51.524139523Z zhangyuhang
    2021-11-24T18:20:52.525845327Z zhangyuhang
    2021-11-24T18:20:53.527535060Z zhangyuhang
    2021-11-24T18:20:54.529611687Z zhangyuhang
    2021-11-24T18:20:55.531713897Z zhangyuhang
    2021-11-24T18:20:56.533733062Z zhangyuhang
    2021-11-24T18:20:57.535817820Z zhangyuhang
<span class="c1"># 查看所有日志</span>
docker logs -tf 容器id

<span class="c1"># 退出</span>
docker <span class="nb">kill</span> 容器id
	<span class="c1"># 或者</span>
	docker stop 容器id
</code></pre></td></tr></table>
</div>
</div><p><code>查看容器内部信息</code></p>
<ul>
<li>
<p>前台启动centos</p>
<blockquote>
<p>docker top 容器id</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">systemctl start docker
docker run -it centos /bin/bash -c <span class="s2">&#34;while true;do echo zhang;sleep 1;done&#34;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>查看容器中的进程</p>
<blockquote>
<p>docker inspect 容器id</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker top 5866b73a2eff</span>
UID                 PID                 PPID                C                   STIME               TTY                 TIME                CMD
root                <span class="m">126115</span>              <span class="m">126097</span>              <span class="m">0</span>                   09:00               pts/0               00:00:00            /bin/bash -c <span class="k">while</span> true<span class="p">;</span><span class="k">do</span> <span class="nb">echo</span> zhangyuhang<span class="p">;</span>sleep 1<span class="p">;</span><span class="k">done</span>
root                <span class="m">126352</span>              <span class="m">126115</span>              <span class="m">0</span>                   09:01               pts/0               00:00:00            /usr/bin/coreutils --coreutils-prog-shebang<span class="o">=</span>sleep /usr/bin/sleep 1
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>容器的PID(父进程),CMD(容器控制台输入的命令)总之我也看不懂</p>
</blockquote>
</li>
<li>
<p>查看容器镜像中的具体信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker inspect 5866b73a2eff</span>
<span class="o">[</span>
    <span class="o">{</span>
          <span class="c1"># 容器id,可以看到,ps时的id只占了容器镜像整体id的一部分(缩写)</span>
        <span class="s2">&#34;Id&#34;</span>: <span class="s2">&#34;5866b73a2effbad30a10f043bdc3f50901538876d9acc85097b35bc68f24d7d1&#34;</span>,
          
        <span class="c1"># 创建时间</span>
        <span class="s2">&#34;Created&#34;</span>: <span class="s2">&#34;2021-11-26T01:00:25.379499515Z&#34;</span>,
          
        <span class="c1"># 当前的bash路径</span>
        <span class="s2">&#34;Path&#34;</span>: <span class="s2">&#34;/bin/bash&#34;</span>,
          
        <span class="c1"># 命令参数</span>
        <span class="s2">&#34;Args&#34;</span>: <span class="o">[</span>
            <span class="s2">&#34;-c&#34;</span>,
            <span class="s2">&#34;while true;do echo zhangyuhang;sleep 1;done&#34;</span>
        <span class="o">]</span>,
          
        <span class="c1"># 状态</span>
        <span class="s2">&#34;State&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Status&#34;</span>: <span class="s2">&#34;running&#34;</span>,
            <span class="s2">&#34;Running&#34;</span>: true,
            <span class="s2">&#34;Paused&#34;</span>: false,
            <span class="s2">&#34;Restarting&#34;</span>: false,
            <span class="s2">&#34;OOMKilled&#34;</span>: false,
            <span class="s2">&#34;Dead&#34;</span>: false,
            <span class="s2">&#34;Pid&#34;</span>: 126115,
            <span class="s2">&#34;ExitCode&#34;</span>: 0,
            <span class="s2">&#34;Error&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;StartedAt&#34;</span>: <span class="s2">&#34;2021-11-26T01:00:25.971462258Z&#34;</span>,
            <span class="s2">&#34;FinishedAt&#34;</span>: <span class="s2">&#34;0001-01-01T00:00:00Z&#34;</span>
        <span class="o">}</span>,
          
        <span class="c1"># 镜像</span>
        <span class="s2">&#34;Image&#34;</span>: <span class="s2">&#34;sha256:5d0da3dc976460b72c77d94c8a1ad043720b0416bfc16c52c45d4847e53fadb6&#34;</span>,
        <span class="s2">&#34;ResolvConfPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/5866b73a2effbad30a10f043bdc3f50901538876d9acc85097b35bc68f24d7d1/resolv.conf&#34;</span>,
          
        <span class="c1"># 镜像名称路径</span>
        <span class="s2">&#34;HostnamePath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/5866b73a2effbad30a10f043bdc3f50901538876d9acc85097b35bc68f24d7d1/hostname&#34;</span>,
          
        <span class="c1"># 镜像路径</span>
        <span class="s2">&#34;HostsPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/5866b73a2effbad30a10f043bdc3f50901538876d9acc85097b35bc68f24d7d1/hosts&#34;</span>,
          
        <span class="c1"># 日志路径</span>
        <span class="s2">&#34;LogPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/5866b73a2effbad30a10f043bdc3f50901538876d9acc85097b35bc68f24d7d1/5866b73a2effbad30a10f043bdc3f50901538876d9acc85097b35bc68f24d7d1-json.log&#34;</span>,
        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;/interesting_colden&#34;</span>,
          
        <span class="c1"># 重启次数</span>
        <span class="s2">&#34;RestartCount&#34;</span>: 0,
          
        <span class="c1"># 驱动</span>
        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;overlay2&#34;</span>,
          
        <span class="c1"># 平台</span>
        <span class="s2">&#34;Platform&#34;</span>: <span class="s2">&#34;linux&#34;</span>,
        <span class="s2">&#34;MountLabel&#34;</span>: <span class="s2">&#34;&#34;</span>,
        <span class="s2">&#34;ProcessLabel&#34;</span>: <span class="s2">&#34;&#34;</span>,
        <span class="s2">&#34;AppArmorProfile&#34;</span>: <span class="s2">&#34;&#34;</span>,
        <span class="s2">&#34;ExecIDs&#34;</span>: null,
          
        <span class="c1"># 主机配置</span>
        <span class="s2">&#34;HostConfig&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Binds&#34;</span>: null,
            <span class="s2">&#34;ContainerIDFile&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;LogConfig&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;Type&#34;</span>: <span class="s2">&#34;json-file&#34;</span>,
                <span class="s2">&#34;Config&#34;</span>: <span class="o">{}</span>
            <span class="o">}</span>,
            <span class="s2">&#34;NetworkMode&#34;</span>: <span class="s2">&#34;default&#34;</span>,
            <span class="s2">&#34;PortBindings&#34;</span>: <span class="o">{}</span>,
            <span class="s2">&#34;RestartPolicy&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;no&#34;</span>,
                <span class="s2">&#34;MaximumRetryCount&#34;</span>: 0
            <span class="o">}</span>,
            <span class="s2">&#34;AutoRemove&#34;</span>: false,
            <span class="s2">&#34;VolumeDriver&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;VolumesFrom&#34;</span>: null,
            <span class="s2">&#34;CapAdd&#34;</span>: null,
            <span class="s2">&#34;CapDrop&#34;</span>: null,
            <span class="s2">&#34;CgroupnsMode&#34;</span>: <span class="s2">&#34;host&#34;</span>,
            <span class="s2">&#34;Dns&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DnsOptions&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DnsSearch&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;ExtraHosts&#34;</span>: null,
            <span class="s2">&#34;GroupAdd&#34;</span>: null,
            <span class="s2">&#34;IpcMode&#34;</span>: <span class="s2">&#34;private&#34;</span>,
            <span class="s2">&#34;Cgroup&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Links&#34;</span>: null,
            <span class="s2">&#34;OomScoreAdj&#34;</span>: 0,
            <span class="s2">&#34;PidMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Privileged&#34;</span>: false,
            <span class="s2">&#34;PublishAllPorts&#34;</span>: false,
            <span class="s2">&#34;ReadonlyRootfs&#34;</span>: false,
            <span class="s2">&#34;SecurityOpt&#34;</span>: null,
            <span class="s2">&#34;UTSMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;UsernsMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;ShmSize&#34;</span>: 67108864,
            <span class="s2">&#34;Runtime&#34;</span>: <span class="s2">&#34;runc&#34;</span>,
            <span class="s2">&#34;ConsoleSize&#34;</span>: <span class="o">[</span>
                0,
                0
            <span class="o">]</span>,
            <span class="s2">&#34;Isolation&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;CpuShares&#34;</span>: 0,
            <span class="s2">&#34;Memory&#34;</span>: 0,
            <span class="s2">&#34;NanoCpus&#34;</span>: 0,
            <span class="s2">&#34;CgroupParent&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;BlkioWeight&#34;</span>: 0,
            <span class="s2">&#34;BlkioWeightDevice&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;BlkioDeviceReadBps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceWriteBps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceReadIOps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceWriteIOps&#34;</span>: null,
            <span class="s2">&#34;CpuPeriod&#34;</span>: 0,
            <span class="s2">&#34;CpuQuota&#34;</span>: 0,
            <span class="s2">&#34;CpuRealtimePeriod&#34;</span>: 0,
            <span class="s2">&#34;CpuRealtimeRuntime&#34;</span>: 0,
            <span class="s2">&#34;CpusetCpus&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;CpusetMems&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Devices&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DeviceCgroupRules&#34;</span>: null,
            <span class="s2">&#34;DeviceRequests&#34;</span>: null,
            <span class="s2">&#34;KernelMemory&#34;</span>: 0,
            <span class="s2">&#34;KernelMemoryTCP&#34;</span>: 0,
            <span class="s2">&#34;MemoryReservation&#34;</span>: 0,
            <span class="s2">&#34;MemorySwap&#34;</span>: 0,
            <span class="s2">&#34;MemorySwappiness&#34;</span>: null,
            <span class="s2">&#34;OomKillDisable&#34;</span>: false,
            <span class="s2">&#34;PidsLimit&#34;</span>: null,
            <span class="s2">&#34;Ulimits&#34;</span>: null,
            <span class="s2">&#34;CpuCount&#34;</span>: 0,
            <span class="s2">&#34;CpuPercent&#34;</span>: 0,
            <span class="s2">&#34;IOMaximumIOps&#34;</span>: 0,
            <span class="s2">&#34;IOMaximumBandwidth&#34;</span>: 0,
            <span class="s2">&#34;MaskedPaths&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/proc/asound&#34;</span>,
                <span class="s2">&#34;/proc/acpi&#34;</span>,
                <span class="s2">&#34;/proc/kcore&#34;</span>,
                <span class="s2">&#34;/proc/keys&#34;</span>,
                <span class="s2">&#34;/proc/latency_stats&#34;</span>,
                <span class="s2">&#34;/proc/timer_list&#34;</span>,
                <span class="s2">&#34;/proc/timer_stats&#34;</span>,
                <span class="s2">&#34;/proc/sched_debug&#34;</span>,
                <span class="s2">&#34;/proc/scsi&#34;</span>,
                <span class="s2">&#34;/sys/firmware&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;ReadonlyPaths&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/proc/bus&#34;</span>,
                <span class="s2">&#34;/proc/fs&#34;</span>,
                <span class="s2">&#34;/proc/irq&#34;</span>,
                <span class="s2">&#34;/proc/sys&#34;</span>,
                <span class="s2">&#34;/proc/sysrq-trigger&#34;</span>
            <span class="o">]</span>
        <span class="o">}</span>,
          
        <span class="c1"># 其他配置(驱动)</span>
        <span class="s2">&#34;GraphDriver&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Data&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;LowerDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/903ef94d6ad01d4952535429cf5ab0f3b1d9d653855637290ff2ddb55ac32c13-init/diff:/var/lib/docker/overlay2/e4934273521f1c50cfb856498832cc26cbd03ff784f975d47cd6068d63a39590/diff&#34;</span>,
                <span class="s2">&#34;MergedDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/903ef94d6ad01d4952535429cf5ab0f3b1d9d653855637290ff2ddb55ac32c13/merged&#34;</span>,
                <span class="s2">&#34;UpperDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/903ef94d6ad01d4952535429cf5ab0f3b1d9d653855637290ff2ddb55ac32c13/diff&#34;</span>,
                <span class="s2">&#34;WorkDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/903ef94d6ad01d4952535429cf5ab0f3b1d9d653855637290ff2ddb55ac32c13/work&#34;</span>
            <span class="o">}</span>,
            <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;overlay2&#34;</span>
        <span class="o">}</span>,
          
        <span class="c1"># 挂载</span>
        <span class="s2">&#34;Mounts&#34;</span>: <span class="o">[]</span>,
          
        <span class="c1"># 配置</span>
        <span class="s2">&#34;Config&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Hostname&#34;</span>: <span class="s2">&#34;5866b73a2eff&#34;</span>,
            <span class="s2">&#34;Domainname&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;User&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;AttachStdin&#34;</span>: true,
            <span class="s2">&#34;AttachStdout&#34;</span>: true,
            <span class="s2">&#34;AttachStderr&#34;</span>: true,
            <span class="s2">&#34;Tty&#34;</span>: true,
            <span class="s2">&#34;OpenStdin&#34;</span>: true,
            <span class="s2">&#34;StdinOnce&#34;</span>: true,
            <span class="s2">&#34;Env&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;Cmd&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/bin/bash&#34;</span>,
                <span class="s2">&#34;-c&#34;</span>,
                <span class="s2">&#34;while true;do echo zhangyuhang;sleep 1;done&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;Image&#34;</span>: <span class="s2">&#34;centos&#34;</span>,
            <span class="s2">&#34;Volumes&#34;</span>: null,
            <span class="s2">&#34;WorkingDir&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Entrypoint&#34;</span>: null,
            <span class="s2">&#34;OnBuild&#34;</span>: null,
            <span class="s2">&#34;Labels&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;org.label-schema.build-date&#34;</span>: <span class="s2">&#34;20210915&#34;</span>,
                <span class="s2">&#34;org.label-schema.license&#34;</span>: <span class="s2">&#34;GPLv2&#34;</span>,
                <span class="s2">&#34;org.label-schema.name&#34;</span>: <span class="s2">&#34;CentOS Base Image&#34;</span>,
                <span class="s2">&#34;org.label-schema.schema-version&#34;</span>: <span class="s2">&#34;1.0&#34;</span>,
                <span class="s2">&#34;org.label-schema.vendor&#34;</span>: <span class="s2">&#34;CentOS&#34;</span>
            <span class="o">}</span>
        <span class="o">}</span>,
          
        <span class="c1"># 网络配置</span>
        <span class="s2">&#34;NetworkSettings&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Bridge&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;SandboxID&#34;</span>: <span class="s2">&#34;c6e9a222d58e9b8ebdbd206d32771c17599673b59f141659cea10301822ec192&#34;</span>,
            <span class="s2">&#34;HairpinMode&#34;</span>: false,
            <span class="s2">&#34;LinkLocalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;LinkLocalIPv6PrefixLen&#34;</span>: 0,
            <span class="s2">&#34;Ports&#34;</span>: <span class="o">{}</span>,
            <span class="s2">&#34;SandboxKey&#34;</span>: <span class="s2">&#34;/var/run/docker/netns/c6e9a222d58e&#34;</span>,
            <span class="s2">&#34;SecondaryIPAddresses&#34;</span>: null,
            <span class="s2">&#34;SecondaryIPv6Addresses&#34;</span>: null,
            <span class="s2">&#34;EndpointID&#34;</span>: <span class="s2">&#34;bce7cd6632ddca78ebd539f370bff36805789357d695d592e1976d06c65d2aa7&#34;</span>,
            <span class="s2">&#34;Gateway&#34;</span>: <span class="s2">&#34;172.17.0.1&#34;</span>,
            <span class="s2">&#34;GlobalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;GlobalIPv6PrefixLen&#34;</span>: 0,
            <span class="s2">&#34;IPAddress&#34;</span>: <span class="s2">&#34;172.17.0.2&#34;</span>,
            <span class="s2">&#34;IPPrefixLen&#34;</span>: 16,
            <span class="s2">&#34;IPv6Gateway&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;MacAddress&#34;</span>: <span class="s2">&#34;02:42:ac:11:00:02&#34;</span>,
            <span class="s2">&#34;Networks&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;bridge&#34;</span>: <span class="o">{</span>
                    <span class="s2">&#34;IPAMConfig&#34;</span>: null,
                    <span class="s2">&#34;Links&#34;</span>: null,
                    <span class="s2">&#34;Aliases&#34;</span>: null,
                    <span class="s2">&#34;NetworkID&#34;</span>: <span class="s2">&#34;e6673d6d35e4dcf6beca0bafdd67cae2eb0447df803f462391425583937d7afb&#34;</span>,
                    <span class="s2">&#34;EndpointID&#34;</span>: <span class="s2">&#34;bce7cd6632ddca78ebd539f370bff36805789357d695d592e1976d06c65d2aa7&#34;</span>,
                    <span class="s2">&#34;Gateway&#34;</span>: <span class="s2">&#34;172.17.0.1&#34;</span>,
                    <span class="s2">&#34;IPAddress&#34;</span>: <span class="s2">&#34;172.17.0.2&#34;</span>,
                    <span class="s2">&#34;IPPrefixLen&#34;</span>: 16,
                    <span class="s2">&#34;IPv6Gateway&#34;</span>: <span class="s2">&#34;&#34;</span>,
                    <span class="s2">&#34;GlobalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
                    <span class="s2">&#34;GlobalIPv6PrefixLen&#34;</span>: 0,
                    <span class="s2">&#34;MacAddress&#34;</span>: <span class="s2">&#34;02:42:ac:11:00:02&#34;</span>,
                    <span class="s2">&#34;DriverOpts&#34;</span>: null
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="step7进入容器的命令和拷贝命令">Step7.进入容器的命令和拷贝命令</h1>
<h2 id="进入容器">进入容器</h2>
<ul>
<li>
<p>打开一个新的终端</p>
<blockquote>
<p>docker exec(可执行) -it(前台交互) 容器id 以什么样的命令进入</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run -it centos /bin/bash <span class="s2">&#34;while true;do echo zhang;sleep 1;done&#34;</span>
<span class="sb">```</span>Ctrl + Q + P<span class="sb">```</span>
docker <span class="nb">exec</span> -it 容器名称 /bin/bash 
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>进入当前运行时镜像进程</p>
<blockquote>
<p>docker attach 容器id</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker attach 5866b73a2eff</span>
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
zhangyuhang
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="拷贝命令">拷贝命令</h2>
<ul>
<li>
<p>从docker容器中拷贝文件到主机</p>
<blockquote>
<p>docker cp 容器id:文件在容器中的路径 要拷贝到的主机路径</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker cp 8ff4a142fd9e:/dockerForCopyToHost/dockerForCopyToHost.java /etc</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step8配置nginx">Step8.配置nginx</h1>
<ul>
<li>
<p>pull一个nginx镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker pull nginx
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>运行</p>
<blockquote>
<p>&ndash;name可以指定运行的容器名</p>
<p>-p可以暴露指定端口号</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker run -d --name nginx01 -p 3333:80 nginx</span>
eaef55fd9df5bf9b07af04f89b1d9ee0c5d7e0ebcaa94f903292f5ea0bbcf305
<span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># curl localhost:3333</span>
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Welcome to nginx!&lt;/title&gt;
&lt;style&gt;
html <span class="o">{</span> color-scheme: light dark<span class="p">;</span> <span class="o">}</span>
body <span class="o">{</span> width: 35em<span class="p">;</span> margin: <span class="m">0</span> auto<span class="p">;</span>
font-family: Tahoma, Verdana, Arial, sans-serif<span class="p">;</span> <span class="o">}</span>
&lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1&gt;Welcome to nginx!&lt;/h1&gt;
&lt;p&gt;If you see this page, the nginx web server is successfully installed and
working. Further configuration is required.&lt;/p&gt;
  
&lt;p&gt;For online documentation and support please refer to
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;http://nginx.org/&#34;</span>&gt;nginx.org&lt;/a&gt;.&lt;br/&gt;
Commercial support is available at
&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&#34;http://nginx.com/&#34;</span>&gt;nginx.com&lt;/a&gt;.&lt;/p&gt;
  
&lt;p&gt;&lt;em&gt;Thank you <span class="k">for</span> using nginx.&lt;/em&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>即使云服务器中的3333端口安全组没打开,在服务器内网(docker)也是可以访问的</p>
</li>
<li>
<p>但是要在本机访问,就需要打开服务器防火墙中的3333端口</p>
<p><img src="https://img-blog.csdnimg.cn/be135b06e357480ab1b0896d9ea1aacb.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/4b9e880a747d4783955699b5d3ae296a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
<li>
<p>nginx的默认端口是80,但是在外网通过3333还能访问是因为</p>
<p><img src="https://img-blog.csdnimg.cn/34fa464eee874354b9fb093af598ffaa.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
</ul>
<h1 id="step9配置tomcat">Step9.配置tomcat</h1>
<ul>
<li>
<p>pull一个tomcat镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker pull tomcat
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>云服务器防火墙里开启3344端口作为docker-tomcat8080端口的映射</p>
<blockquote>
<p>这里原来我用的是4444端口,结果TM半天不行</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run -d --name tomcat01 -p 3344:8080 tomcat
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>发现404</p>
<blockquote>
<p>但是有404就说明可访问,但是就是docker-&gt;tomcat-&gt;webapps中无资源可访问</p>
</blockquote>
</li>
<li>
<p>下面是全套命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1"># 创建并以后台方式运行tomcat01容器</span>
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker run -d --name tomcat01 -p 3344:8080 tomcat</span>
f153edda761bbf4ef8efa5b58a2da7a88a765eee28fecf307937812156984275
  
<span class="c1"># 打开新终端进入容器内部</span>
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker exec -it tomcat01 /bin/bash</span>
  
<span class="c1"># 下面是查看容器中webapps下面没有东西然后将webapps.dist下的所有文件复制到webapps下</span>
root@f153edda761b:/usr/local/tomcat# ls
BUILDING.txt	 LICENSE  README.md	 RUNNING.txt  conf  logs	    temp     webapps.dist
CONTRIBUTING.md  NOTICE   RELEASE-NOTES  bin	      lib   native-jni-lib  webapps  work
root@f153edda761b:/usr/local/tomcat# <span class="nb">cd</span> webapps
root@f153edda761b:/usr/local/tomcat/webapps# ls
root@f153edda761b:/usr/local/tomcat/webapps# <span class="nb">cd</span> ..
root@f153edda761b:/usr/local/tomcat# <span class="nb">cd</span> webapps.dist
root@f153edda761b:/usr/local/tomcat/webapps.dist# ls
ROOT  docs  examples  host-manager  manager
root@f153edda761b:/usr/local/tomcat/webapps.dist# <span class="nb">cd</span> ..
root@f153edda761b:/usr/local/tomcat# cp -r webapps.dist/* webapps
root@f153edda761b:/usr/local/tomcat# <span class="nb">cd</span> webapps
root@f153edda761b:/usr/local/tomcat/webapps# ls
ROOT  docs  examples  host-manager  manager
root@f153edda761b:/usr/local/tomcat/webapps# <span class="nb">cd</span> ..
root@f153edda761b:/usr/local/tomcat# <span class="nb">read</span> escape sequence
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>重新访问http://ip:3344</p>
<p><img src="https://img-blog.csdnimg.cn/f27b814839df45f9b35d67268483e612.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
</ul>
<h1 id="step10docker配置elasticsearch">Step10.docker配置ElasticSearch</h1>
<ul>
<li>
<p>这玩应太占内存了,1核2G下载启动就占你1.几G内存</p>
</li>
<li>
<p>学生机就先不试了</p>
</li>
<li>
<p>安装并启动</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">docker run -d --name elasticsearch --net somenetwork -p 9200:9200 -p 9300:9300 -e <span class="s2">&#34;discovery.type=single-node&#34;</span> elasticsearch:tag
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>&ndash;net somenetwork是网络配置,-e是集群的意思(single-node单节点)</p>
</blockquote>
</li>
<li>
<p>docker stats</p>
<blockquote>
<p>查看主机内存状态</p>
</blockquote>
</li>
</ul>
<h1 id="step11docker配置portainerportainer可视化页面">Step11.docker配置portainer/portainer(可视化页面)</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker pull portainer/portainer
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>它这玩应就这么写,我也不知道怎么回事</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">docker run -d --name portainer01 -p 3355:9000 portainer/portainer
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>访问ip:3355</p>
<p>还是端口要在服务器的安全组中打开</p>
</blockquote>
<h1 id="step12docker配置mongodb">Step12.docker配置mongoDB</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker pull mongo

<span class="c1"># -v是将数据卷挂载将主机的目录$PWD/db映射到容器的data/db,这是为了存储数据库运行时的数据</span>
docker run -p 27000:27017 -v <span class="nv">$PWD</span>/db:/data/db -d mongo:latest

<span class="c1"># 在mongo运行时打开新端口访问</span>
docker <span class="nb">exec</span> -it 容器id /bin/bash

<span class="c1"># 进入后输入mongo</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="step13镜像之联合文件系统">Step13.镜像之联合文件系统</h1>
<p><img src="https://img-blog.csdnimg.cn/b7b6880e386c4cfbb79c331eda3c6cf5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/7f8e8f92399e4347bd796f2a9c5dd086.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/22e7394091414662aa4e5666bb39b067.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<h1 id="step14镜像原理之分层理解">Step14.镜像原理之分层理解</h1>
<p><img src="https://img-blog.csdnimg.cn/9c320ac329c748a4bc534dae6deec715.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/8b726e5ea1f243d39d62476e5e6ab624.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/276a035d6f6f40fda1ded7c6122f2c34.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/2b705835272547b8898f8f9c07ff1e8f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/44c56a61fadc4637b4e15ee8e8828987.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/cce746d0cca04df5b1016716904838b3.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<hr>
<h1 id="step15commit一个镜像">Step15.commit一个镜像</h1>
<ul>
<li>
<p>因为docker中的tomcat是阉割版本的,webapps没有文件,每次启动都需要复制文件夹</p>
</li>
<li>
<p>所以能不能将当前配置好并能成功运行的镜像打包成自己的镜像呢?</p>
</li>
<li>
<p>docker中启动配置好一个tomcat并以后台方式运行</p>
</li>
<li>
<p><code>Ctrl + Q + P</code>退出</p>
</li>
<li>
<p>打包镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker commit -a<span class="o">=</span><span class="s2">&#34;作者&#34;</span> -m<span class="o">=</span><span class="s2">&#34;信息&#34;</span> 容器id 要打包成的镜像名:版本号
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker commit -a<span class="o">=</span><span class="s2">&#34;zhang&#34;</span> -m<span class="o">=</span><span class="s2">&#34;mytomcat&#34;</span> 49f4a5b3cc6c mytomcat:1.0
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>commit时的镜像名:后面的是tag(版本号)</p>
</blockquote>
</li>
<li>
<p>查看镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker images</span>
REPOSITORY            TAG       IMAGE ID       CREATED          SIZE
mytomcat              1.0       3a20fb127a30   <span class="m">12</span> minutes ago   684MB
tomcat                latest    904a98253fbf   <span class="m">7</span> days ago       680MB
nginx                 latest    ea335eea17ab   <span class="m">9</span> days ago       141MB
mongo                 latest    4253856b2570   <span class="m">9</span> days ago       701MB
centos                latest    5d0da3dc9764   <span class="m">2</span> months ago     231MB
portainer/portainer   latest    580c0e4e98b0   <span class="m">8</span> months ago     79.1MB
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>运行自己的镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run -d --name mytomcat -p 3344:8080 mytomcat:1.0
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>注意,运行自己commit的镜像后面一定要加上tag(版本号)</p>
</blockquote>
</li>
</ul>
<h1 id="step16容器数据卷使用">Step16.容器数据卷使用</h1>
<ul>
<li>
<p>image是运行在容器中的,容器一旦停止,容器中的数据也就随之消失</p>
</li>
<li>
<p>所以可以将容器中的目录中的数据挂载到本地卷目录中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run -d -v /home/dockerdisk:/home centos /bin/bash
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>-v的意思是挂载</p>
<p>:前面的是本机卷目录,后面是容器下的目录</p>
</blockquote>
</li>
<li>
<p>这样本机中的<code>/home/dockerdisk</code>和容器中的<code>/home</code>中的数据就可以实时同步了</p>
</li>
<li>
<p>可以测试一下</p>
</li>
<li>
<p>在容器中的/home目录下新建一个test.java</p>
</li>
<li>
<p>随便写</p>
<p><code>test.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.controller</span><span class="o">;</span>
  
<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IndexController</span><span class="o">{</span>
      
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>然后进入本机<code>/home/dockerdisk</code>下,会发现有一个<code>test.java</code>文件</p>
</li>
<li>
<p>这并不能证明两个目录中的数据是实时同步的</p>
</li>
<li>
<p>更改容器中<code>test.java</code>中的数据</p>
<p><code>test.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.controller</span><span class="o">;</span>
  
<span class="nd">@Controller</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">IndexController</span><span class="o">{</span>
    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;/hello&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">index</span><span class="o">(){</span>
        <span class="k">return</span> <span class="s">&#34;index.html&#34;</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在本机<code>/home/dockerdisk</code>目录中</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">vim test.java
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>会发现数据也变了</p>
</blockquote>
</li>
</ul>
<h2 id="具名挂载和匿名挂载">具名挂载和匿名挂载</h2>
<ul>
<li>
<p>随意挂载一个centos</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run -it -v /home/dockerdisk:/home nginx /bin/bash
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>通过volume查看所有的挂载信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker volume ls</span>
DRIVER    VOLUME NAME
<span class="nb">local</span>     4ec0d9644206791523333e5c15fe08274206aa344e60bbf76e842e7320833d3a
<span class="nb">local</span>     74cea031f6c8e7f98f87257b287d7044ce9d95be6e651a8d42e02faad3291a9d
<span class="nb">local</span>     600c763f03fc8b40bd9c951ece151d63eb335ffc350d4e9dec3954996fbc4596
<span class="nb">local</span>     945c83066d10da2e8f92744e498c813891de92c5dd87e849801cc661f7bf3b60
<span class="nb">local</span>     6017639120cd0954b9d8c99d1000a18d587ca24f295e82e355fa9de73cc71c58
<span class="nb">local</span>     b7e6a2dcf02fa213b769ad72396d731514d4ce8b727a9911a639fdb82be7a314
<span class="nb">local</span>     df6f5f438a53457f067da95cf0cb0fdd278c4ec9c9a05a8928f54854ef22f519
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>这些就是挂载过的情况</p>
</blockquote>
</li>
<li>
<p>可以看到,VOLUME NAME都是一堆编码,匿名挂载</p>
</li>
<li>
<p>通过运行命令可以进行具名挂载</p>
</li>
<li>
<p>随便挂载一个nginx</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker run -it -v juming-nginx:/etc/nginx nginx /bin/bash</span>
root@97d844fc3e67:/# <span class="nb">exit</span>
<span class="nb">exit</span>
<span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker volume ls</span>
DRIVER    VOLUME NAME
<span class="nb">local</span>     4ec0d9644206791523333e5c15fe08274206aa344e60bbf76e842e7320833d3a
<span class="nb">local</span>     74cea031f6c8e7f98f87257b287d7044ce9d95be6e651a8d42e02faad3291a9d
<span class="nb">local</span>     600c763f03fc8b40bd9c951ece151d63eb335ffc350d4e9dec3954996fbc4596
<span class="nb">local</span>     945c83066d10da2e8f92744e498c813891de92c5dd87e849801cc661f7bf3b60
<span class="nb">local</span>     6017639120cd0954b9d8c99d1000a18d587ca24f295e82e355fa9de73cc71c58
<span class="nb">local</span>     b7e6a2dcf02fa213b769ad72396d731514d4ce8b727a9911a639fdb82be7a314
<span class="nb">local</span>     df6f5f438a53457f067da95cf0cb0fdd278c4ec9c9a05a8928f54854ef22f519
<span class="nb">local</span>     juming-centos
<span class="nb">local</span>     juming-nginx
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>那这个信息是存在哪的呢</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker volume inspect juming-nginx</span>
<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&#34;CreatedAt&#34;</span>: <span class="s2">&#34;2021-11-28T09:36:55+08:00&#34;</span>,
        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
        <span class="s2">&#34;Labels&#34;</span>: null,
        <span class="s2">&#34;Mountpoint&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/juming-nginx/_data&#34;</span>,
        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;juming-nginx&#34;</span>,
        <span class="s2">&#34;Options&#34;</span>: null,
        <span class="s2">&#34;Scope&#34;</span>: <span class="s2">&#34;local&#34;</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>三种挂载方式</p>
<ul>
<li>匿名挂载: -v 容器内路径</li>
<li>具名挂载: -v 挂载名称:容器内部要挂载的路径</li>
<li>指定路径挂载: -v 宿主机路径:容器内部路径</li>
</ul>
</li>
</ul>
<h3 id="拓展">拓展</h3>
<ul>
<li>:ro代表只读操作(readonly)</li>
<li>:rw代表可读可写操作(readwrite)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker run -it -v juming-nginx:/etc/nginx:ro nginx /bin/bash
docker run -it -v juming-nginx:/etc/nginx:rw nginx /bin/bash
</code></pre></td></tr></table>
</div>
</div><h2 id="dockerfile">Dockerfile</h2>
<ul>
<li>
<p>dockerfile和commit类似,是另一种自定义镜像的方式</p>
</li>
<li>
<p>在<code>/home</code>下创建<code>dockerfile_images</code>目录</p>
</li>
<li>
<p>然后在<code>dockerfile_images</code>下创建<code>dockerfile</code></p>
<p><code>dockerfile</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="k">FROM</span><span class="s"> centos # 基础镜像</span><span class="err">
</span><span class="err"></span><span class="k">VOLUME</span> <span class="p">[</span><span class="s2">&#34;volume01&#34;</span><span class="p">,</span><span class="s2">&#34;volume02&#34;</span><span class="p">]</span> <span class="c1"># 要挂载的容器内部的卷</span><span class="err">
</span><span class="err"></span><span class="k">CMD</span> <span class="nb">echo</span> <span class="s2">&#34;----end----&#34;</span> <span class="c1"># 执行成功后的操作</span><span class="err">
</span><span class="err"></span><span class="k">CMD</span> /bin/bash <span class="c1"># 进入/bin/bash</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>使用刚才的这个dockerfile文件构建自己的镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos dockerfile_images<span class="o">]</span><span class="c1"># docker build -f /home/dockerfile_images/dockerfile -t zhang/centos:1.0 .</span>
Sending build context to Docker daemon  14.85kB
Step 1/4 : FROM centos
 ---&gt; 5d0da3dc9764
Step 2/4 : VOLUME <span class="o">[</span><span class="s2">&#34;volume01&#34;</span>,<span class="s2">&#34;volume02&#34;</span><span class="o">]</span>
 ---&gt; Running in 59e9976acc63
Removing intermediate container 59e9976acc63
 ---&gt; b10bf3405efd
Step 3/4 : CMD <span class="nb">echo</span> <span class="s2">&#34;----end----&#34;</span>
 ---&gt; Running in 71677452467e
Removing intermediate container 71677452467e
 ---&gt; ca7ca2cdb2b7
Step 4/4 : CMD /bin/bash
 ---&gt; Running in 64e4fc88a08a
Removing intermediate container 64e4fc88a08a
 ---&gt; cabc164891bd
Successfully built cabc164891bd
Successfully tagged zhang/centos:1.0
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>和commit一样,在构建镜像时镜像名称后面写了镜像版本号,在运行时也要写上版本号</p>
<p>dockerfile文件要写全路径</p>
</blockquote>
</li>
<li>
<p>运行自己的镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos dockerfile_images<span class="o">]</span><span class="c1"># docker images</span>
REPOSITORY            TAG       IMAGE ID       CREATED         SIZE
zhang/centos          1.0       cabc164891bd   <span class="m">7</span> minutes ago   231MB
mytomcat              1.0       3a20fb127a30   <span class="m">39</span> hours ago    684MB
tomcat                latest    904a98253fbf   <span class="m">9</span> days ago      680MB
nginx                 latest    ea335eea17ab   <span class="m">10</span> days ago     141MB
mysql                 latest    b05128b000dd   <span class="m">10</span> days ago     516MB
mongo                 latest    4253856b2570   <span class="m">11</span> days ago     701MB
centos                latest    5d0da3dc9764   <span class="m">2</span> months ago    231MB
portainer/portainer   latest    580c0e4e98b0   <span class="m">8</span> months ago    79.1MB
<span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker run -it zhang/centos:1.0 /bin/bash</span>
<span class="o">[</span>root@03523083e3da /<span class="o">]</span><span class="c1"># ls -l</span> 
total 56
lrwxrwxrwx   <span class="m">1</span> root root    <span class="m">7</span> Nov  <span class="m">3</span>  <span class="m">2020</span> bin -&gt; usr/bin
drwxr-xr-x   <span class="m">5</span> root root  <span class="m">360</span> Nov <span class="m">28</span> 04:19 dev
drwxr-xr-x   <span class="m">1</span> root root <span class="m">4096</span> Nov <span class="m">28</span> 04:19 etc
drwxr-xr-x   <span class="m">2</span> root root <span class="m">4096</span> Nov  <span class="m">3</span>  <span class="m">2020</span> home
lrwxrwxrwx   <span class="m">1</span> root root    <span class="m">7</span> Nov  <span class="m">3</span>  <span class="m">2020</span> lib -&gt; usr/lib
lrwxrwxrwx   <span class="m">1</span> root root    <span class="m">9</span> Nov  <span class="m">3</span>  <span class="m">2020</span> lib64 -&gt; usr/lib64
drwx------   <span class="m">2</span> root root <span class="m">4096</span> Sep <span class="m">15</span> 14:17 lost+found
drwxr-xr-x   <span class="m">2</span> root root <span class="m">4096</span> Nov  <span class="m">3</span>  <span class="m">2020</span> media
drwxr-xr-x   <span class="m">2</span> root root <span class="m">4096</span> Nov  <span class="m">3</span>  <span class="m">2020</span> mnt
drwxr-xr-x   <span class="m">2</span> root root <span class="m">4096</span> Nov  <span class="m">3</span>  <span class="m">2020</span> opt
dr-xr-xr-x <span class="m">115</span> root root    <span class="m">0</span> Nov <span class="m">28</span> 04:19 proc
dr-xr-x---   <span class="m">2</span> root root <span class="m">4096</span> Sep <span class="m">15</span> 14:17 root
drwxr-xr-x  <span class="m">11</span> root root <span class="m">4096</span> Sep <span class="m">15</span> 14:17 run
lrwxrwxrwx   <span class="m">1</span> root root    <span class="m">8</span> Nov  <span class="m">3</span>  <span class="m">2020</span> sbin -&gt; usr/sbin
drwxr-xr-x   <span class="m">2</span> root root <span class="m">4096</span> Nov  <span class="m">3</span>  <span class="m">2020</span> srv
dr-xr-xr-x  <span class="m">13</span> root root    <span class="m">0</span> Nov <span class="m">28</span> 04:19 sys
drwxrwxrwt   <span class="m">7</span> root root <span class="m">4096</span> Sep <span class="m">15</span> 14:17 tmp
drwxr-xr-x  <span class="m">12</span> root root <span class="m">4096</span> Sep <span class="m">15</span> 14:17 usr
drwxr-xr-x  <span class="m">20</span> root root <span class="m">4096</span> Sep <span class="m">15</span> 14:17 var
drwxr-xr-x   <span class="m">2</span> root root <span class="m">4096</span> Nov <span class="m">28</span> 04:19 volume01
drwxr-xr-x   <span class="m">2</span> root root <span class="m">4096</span> Nov <span class="m">28</span> 04:19 volume02
<span class="o">[</span>root@03523083e3da /<span class="o">]</span><span class="c1"># cd volume01</span>
<span class="o">[</span>root@03523083e3da volume01<span class="o">]</span><span class="c1"># vi test.java</span>
<span class="o">[</span>root@03523083e3da volume01<span class="o">]</span><span class="c1"># ls -l</span>
total 4
-rw-r--r-- <span class="m">1</span> root root <span class="m">77</span> Nov <span class="m">28</span> 04:20 test.java
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>前面说是把容器中的volume01、volume02目录挂载到本机上,这里也在volume01里面创建了一个test.java文件</p>
</li>
<li>
<p>但是这个volume01中的test.java究竟在宿主机的什么位置呢</p>
</li>
<li>
<p>通过inspect可以查看镜像信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE              COMMAND       CREATED          STATUS          PORTS     NAMES
03523083e3da   zhang/centos:1.0   <span class="s2">&#34;/bin/bash&#34;</span>   <span class="m">34</span> minutes ago   Up <span class="m">34</span> minutes             upbeat_lumiere
<span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker inspect 03523083e3da</span>
<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&#34;Id&#34;</span>: <span class="s2">&#34;03523083e3da55e2a5d70bcef3ff4015d8df5b77a913e61e562b5f1ca8cd6891&#34;</span>,
        <span class="s2">&#34;Created&#34;</span>: <span class="s2">&#34;2021-11-28T04:19:19.544542896Z&#34;</span>,
        <span class="s2">&#34;Path&#34;</span>: <span class="s2">&#34;/bin/bash&#34;</span>,
        <span class="s2">&#34;Args&#34;</span>: <span class="o">[]</span>,
        <span class="s2">&#34;State&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Status&#34;</span>: <span class="s2">&#34;running&#34;</span>,
            <span class="s2">&#34;Running&#34;</span>: true,
            <span class="s2">&#34;Paused&#34;</span>: false,
            <span class="s2">&#34;Restarting&#34;</span>: false,
            <span class="s2">&#34;OOMKilled&#34;</span>: false,
            <span class="s2">&#34;Dead&#34;</span>: false,
            <span class="s2">&#34;Pid&#34;</span>: 590613,
            <span class="s2">&#34;ExitCode&#34;</span>: 0,
            <span class="s2">&#34;Error&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;StartedAt&#34;</span>: <span class="s2">&#34;2021-11-28T04:19:20.029154929Z&#34;</span>,
            <span class="s2">&#34;FinishedAt&#34;</span>: <span class="s2">&#34;0001-01-01T00:00:00Z&#34;</span>
        <span class="o">}</span>,
        <span class="s2">&#34;Image&#34;</span>: <span class="s2">&#34;sha256:cabc164891bd9995bb5e6ae199b8c685da8c9e53a0d3d698d151acd282f37402&#34;</span>,
        <span class="s2">&#34;ResolvConfPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/03523083e3da55e2a5d70bcef3ff4015d8df5b77a913e61e562b5f1ca8cd6891/resolv.conf&#34;</span>,
        <span class="s2">&#34;HostnamePath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/03523083e3da55e2a5d70bcef3ff4015d8df5b77a913e61e562b5f1ca8cd6891/hostname&#34;</span>,
        <span class="s2">&#34;HostsPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/03523083e3da55e2a5d70bcef3ff4015d8df5b77a913e61e562b5f1ca8cd6891/hosts&#34;</span>,
        <span class="s2">&#34;LogPath&#34;</span>: <span class="s2">&#34;/var/lib/docker/containers/03523083e3da55e2a5d70bcef3ff4015d8df5b77a913e61e562b5f1ca8cd6891/03523083e3da55e2a5d70bcef3ff4015d8df5b77a913e61e562b5f1ca8cd6891-json.log&#34;</span>,
        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;/upbeat_lumiere&#34;</span>,
        <span class="s2">&#34;RestartCount&#34;</span>: 0,
        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;overlay2&#34;</span>,
        <span class="s2">&#34;Platform&#34;</span>: <span class="s2">&#34;linux&#34;</span>,
        <span class="s2">&#34;MountLabel&#34;</span>: <span class="s2">&#34;&#34;</span>,
        <span class="s2">&#34;ProcessLabel&#34;</span>: <span class="s2">&#34;&#34;</span>,
        <span class="s2">&#34;AppArmorProfile&#34;</span>: <span class="s2">&#34;&#34;</span>,
        <span class="s2">&#34;ExecIDs&#34;</span>: null,
        <span class="s2">&#34;HostConfig&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Binds&#34;</span>: null,
            <span class="s2">&#34;ContainerIDFile&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;LogConfig&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;Type&#34;</span>: <span class="s2">&#34;json-file&#34;</span>,
                <span class="s2">&#34;Config&#34;</span>: <span class="o">{}</span>
            <span class="o">}</span>,
            <span class="s2">&#34;NetworkMode&#34;</span>: <span class="s2">&#34;default&#34;</span>,
            <span class="s2">&#34;PortBindings&#34;</span>: <span class="o">{}</span>,
            <span class="s2">&#34;RestartPolicy&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;no&#34;</span>,
                <span class="s2">&#34;MaximumRetryCount&#34;</span>: 0
            <span class="o">}</span>,
            <span class="s2">&#34;AutoRemove&#34;</span>: false,
            <span class="s2">&#34;VolumeDriver&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;VolumesFrom&#34;</span>: null,
            <span class="s2">&#34;CapAdd&#34;</span>: null,
            <span class="s2">&#34;CapDrop&#34;</span>: null,
            <span class="s2">&#34;CgroupnsMode&#34;</span>: <span class="s2">&#34;host&#34;</span>,
            <span class="s2">&#34;Dns&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DnsOptions&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DnsSearch&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;ExtraHosts&#34;</span>: null,
            <span class="s2">&#34;GroupAdd&#34;</span>: null,
            <span class="s2">&#34;IpcMode&#34;</span>: <span class="s2">&#34;private&#34;</span>,
            <span class="s2">&#34;Cgroup&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Links&#34;</span>: null,
            <span class="s2">&#34;OomScoreAdj&#34;</span>: 0,
            <span class="s2">&#34;PidMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Privileged&#34;</span>: false,
            <span class="s2">&#34;PublishAllPorts&#34;</span>: false,
            <span class="s2">&#34;ReadonlyRootfs&#34;</span>: false,
            <span class="s2">&#34;SecurityOpt&#34;</span>: null,
            <span class="s2">&#34;UTSMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;UsernsMode&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;ShmSize&#34;</span>: 67108864,
            <span class="s2">&#34;Runtime&#34;</span>: <span class="s2">&#34;runc&#34;</span>,
            <span class="s2">&#34;ConsoleSize&#34;</span>: <span class="o">[</span>
                0,
                0
            <span class="o">]</span>,
            <span class="s2">&#34;Isolation&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;CpuShares&#34;</span>: 0,
            <span class="s2">&#34;Memory&#34;</span>: 0,
            <span class="s2">&#34;NanoCpus&#34;</span>: 0,
            <span class="s2">&#34;CgroupParent&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;BlkioWeight&#34;</span>: 0,
            <span class="s2">&#34;BlkioWeightDevice&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;BlkioDeviceReadBps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceWriteBps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceReadIOps&#34;</span>: null,
            <span class="s2">&#34;BlkioDeviceWriteIOps&#34;</span>: null,
            <span class="s2">&#34;CpuPeriod&#34;</span>: 0,
            <span class="s2">&#34;CpuQuota&#34;</span>: 0,
            <span class="s2">&#34;CpuRealtimePeriod&#34;</span>: 0,
            <span class="s2">&#34;CpuRealtimeRuntime&#34;</span>: 0,
            <span class="s2">&#34;CpusetCpus&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;CpusetMems&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Devices&#34;</span>: <span class="o">[]</span>,
            <span class="s2">&#34;DeviceCgroupRules&#34;</span>: null,
            <span class="s2">&#34;DeviceRequests&#34;</span>: null,
            <span class="s2">&#34;KernelMemory&#34;</span>: 0,
            <span class="s2">&#34;KernelMemoryTCP&#34;</span>: 0,
            <span class="s2">&#34;MemoryReservation&#34;</span>: 0,
            <span class="s2">&#34;MemorySwap&#34;</span>: 0,
            <span class="s2">&#34;MemorySwappiness&#34;</span>: null,
            <span class="s2">&#34;OomKillDisable&#34;</span>: false,
            <span class="s2">&#34;PidsLimit&#34;</span>: null,
            <span class="s2">&#34;Ulimits&#34;</span>: null,
            <span class="s2">&#34;CpuCount&#34;</span>: 0,
            <span class="s2">&#34;CpuPercent&#34;</span>: 0,
            <span class="s2">&#34;IOMaximumIOps&#34;</span>: 0,
            <span class="s2">&#34;IOMaximumBandwidth&#34;</span>: 0,
            <span class="s2">&#34;MaskedPaths&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/proc/asound&#34;</span>,
                <span class="s2">&#34;/proc/acpi&#34;</span>,
                <span class="s2">&#34;/proc/kcore&#34;</span>,
                <span class="s2">&#34;/proc/keys&#34;</span>,
                <span class="s2">&#34;/proc/latency_stats&#34;</span>,
                <span class="s2">&#34;/proc/timer_list&#34;</span>,
                <span class="s2">&#34;/proc/timer_stats&#34;</span>,
                <span class="s2">&#34;/proc/sched_debug&#34;</span>,
                <span class="s2">&#34;/proc/scsi&#34;</span>,
                <span class="s2">&#34;/sys/firmware&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;ReadonlyPaths&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/proc/bus&#34;</span>,
                <span class="s2">&#34;/proc/fs&#34;</span>,
                <span class="s2">&#34;/proc/irq&#34;</span>,
                <span class="s2">&#34;/proc/sys&#34;</span>,
                <span class="s2">&#34;/proc/sysrq-trigger&#34;</span>
            <span class="o">]</span>
        <span class="o">}</span>,
        <span class="s2">&#34;GraphDriver&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Data&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;LowerDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/5224d33ca37be6a3a8427a13925e93e73d9a58cfd729557db05bc2fd82a45cae-init/diff:/var/lib/docker/overlay2/e4934273521f1c50cfb856498832cc26cbd03ff784f975d47cd6068d63a39590/diff&#34;</span>,
                <span class="s2">&#34;MergedDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/5224d33ca37be6a3a8427a13925e93e73d9a58cfd729557db05bc2fd82a45cae/merged&#34;</span>,
                <span class="s2">&#34;UpperDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/5224d33ca37be6a3a8427a13925e93e73d9a58cfd729557db05bc2fd82a45cae/diff&#34;</span>,
                <span class="s2">&#34;WorkDir&#34;</span>: <span class="s2">&#34;/var/lib/docker/overlay2/5224d33ca37be6a3a8427a13925e93e73d9a58cfd729557db05bc2fd82a45cae/work&#34;</span>
            <span class="o">}</span>,
            <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;overlay2&#34;</span>
        <span class="o">}</span>,
        <span class="s2">&#34;Mounts&#34;</span>: <span class="o">[</span>
            <span class="o">{</span>
                <span class="s2">&#34;Type&#34;</span>: <span class="s2">&#34;volume&#34;</span>,
                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;27cf7a77b52c9d0b7fe33d2cc4b62f53695137e1d503c483a16d915f35ca62cf&#34;</span>,
                <span class="s2">&#34;Source&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/27cf7a77b52c9d0b7fe33d2cc4b62f53695137e1d503c483a16d915f35ca62cf/_data&#34;</span>,
                <span class="s2">&#34;Destination&#34;</span>: <span class="s2">&#34;volume01&#34;</span>,
                <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
                <span class="s2">&#34;Mode&#34;</span>: <span class="s2">&#34;&#34;</span>,
                <span class="s2">&#34;RW&#34;</span>: true,
                <span class="s2">&#34;Propagation&#34;</span>: <span class="s2">&#34;&#34;</span>
            <span class="o">}</span>,
            <span class="o">{</span>
                <span class="s2">&#34;Type&#34;</span>: <span class="s2">&#34;volume&#34;</span>,
                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;fa90e81428519592eb57487670ff44d819f96fa7809ff83d319c8dff8aec9011&#34;</span>,
                <span class="s2">&#34;Source&#34;</span>: <span class="s2">&#34;/var/lib/docker/volumes/fa90e81428519592eb57487670ff44d819f96fa7809ff83d319c8dff8aec9011/_data&#34;</span>,
                <span class="s2">&#34;Destination&#34;</span>: <span class="s2">&#34;volume02&#34;</span>,
                <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;local&#34;</span>,
                <span class="s2">&#34;Mode&#34;</span>: <span class="s2">&#34;&#34;</span>,
                <span class="s2">&#34;RW&#34;</span>: true,
                <span class="s2">&#34;Propagation&#34;</span>: <span class="s2">&#34;&#34;</span>
            <span class="o">}</span>
        <span class="o">]</span>,
        <span class="s2">&#34;Config&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Hostname&#34;</span>: <span class="s2">&#34;03523083e3da&#34;</span>,
            <span class="s2">&#34;Domainname&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;User&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;AttachStdin&#34;</span>: true,
            <span class="s2">&#34;AttachStdout&#34;</span>: true,
            <span class="s2">&#34;AttachStderr&#34;</span>: true,
            <span class="s2">&#34;Tty&#34;</span>: true,
            <span class="s2">&#34;OpenStdin&#34;</span>: true,
            <span class="s2">&#34;StdinOnce&#34;</span>: true,
            <span class="s2">&#34;Env&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;Cmd&#34;</span>: <span class="o">[</span>
                <span class="s2">&#34;/bin/bash&#34;</span>
            <span class="o">]</span>,
            <span class="s2">&#34;Image&#34;</span>: <span class="s2">&#34;zhang/centos:1.0&#34;</span>,
            <span class="s2">&#34;Volumes&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;volume01&#34;</span>: <span class="o">{}</span>,
                <span class="s2">&#34;volume02&#34;</span>: <span class="o">{}</span>
            <span class="o">}</span>,
            <span class="s2">&#34;WorkingDir&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;Entrypoint&#34;</span>: null,
            <span class="s2">&#34;OnBuild&#34;</span>: null,
            <span class="s2">&#34;Labels&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;org.label-schema.build-date&#34;</span>: <span class="s2">&#34;20210915&#34;</span>,
                <span class="s2">&#34;org.label-schema.license&#34;</span>: <span class="s2">&#34;GPLv2&#34;</span>,
                <span class="s2">&#34;org.label-schema.name&#34;</span>: <span class="s2">&#34;CentOS Base Image&#34;</span>,
                <span class="s2">&#34;org.label-schema.schema-version&#34;</span>: <span class="s2">&#34;1.0&#34;</span>,
                <span class="s2">&#34;org.label-schema.vendor&#34;</span>: <span class="s2">&#34;CentOS&#34;</span>
            <span class="o">}</span>
        <span class="o">}</span>,
        <span class="s2">&#34;NetworkSettings&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Bridge&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;SandboxID&#34;</span>: <span class="s2">&#34;cfdd6a13bfc07346073491f7b6013de09abc56dc5b9510a6ebd3b12795fc1ce3&#34;</span>,
            <span class="s2">&#34;HairpinMode&#34;</span>: false,
            <span class="s2">&#34;LinkLocalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;LinkLocalIPv6PrefixLen&#34;</span>: 0,
            <span class="s2">&#34;Ports&#34;</span>: <span class="o">{}</span>,
            <span class="s2">&#34;SandboxKey&#34;</span>: <span class="s2">&#34;/var/run/docker/netns/cfdd6a13bfc0&#34;</span>,
            <span class="s2">&#34;SecondaryIPAddresses&#34;</span>: null,
            <span class="s2">&#34;SecondaryIPv6Addresses&#34;</span>: null,
            <span class="s2">&#34;EndpointID&#34;</span>: <span class="s2">&#34;e892bbf6cb7c11ceb4771b88ae3a23bacd30181f970a1894414771ff8c55765c&#34;</span>,
            <span class="s2">&#34;Gateway&#34;</span>: <span class="s2">&#34;172.17.0.1&#34;</span>,
            <span class="s2">&#34;GlobalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;GlobalIPv6PrefixLen&#34;</span>: 0,
            <span class="s2">&#34;IPAddress&#34;</span>: <span class="s2">&#34;172.17.0.2&#34;</span>,
            <span class="s2">&#34;IPPrefixLen&#34;</span>: 16,
            <span class="s2">&#34;IPv6Gateway&#34;</span>: <span class="s2">&#34;&#34;</span>,
            <span class="s2">&#34;MacAddress&#34;</span>: <span class="s2">&#34;02:42:ac:11:00:02&#34;</span>,
            <span class="s2">&#34;Networks&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;bridge&#34;</span>: <span class="o">{</span>
                    <span class="s2">&#34;IPAMConfig&#34;</span>: null,
                    <span class="s2">&#34;Links&#34;</span>: null,
                    <span class="s2">&#34;Aliases&#34;</span>: null,
                    <span class="s2">&#34;NetworkID&#34;</span>: <span class="s2">&#34;bffdaeb53bd1e68f8da1fbed23b2ae1a2fed3acf62a6556ec4c15ad94e1662e7&#34;</span>,
                    <span class="s2">&#34;EndpointID&#34;</span>: <span class="s2">&#34;e892bbf6cb7c11ceb4771b88ae3a23bacd30181f970a1894414771ff8c55765c&#34;</span>,
                    <span class="s2">&#34;Gateway&#34;</span>: <span class="s2">&#34;172.17.0.1&#34;</span>,
                    <span class="s2">&#34;IPAddress&#34;</span>: <span class="s2">&#34;172.17.0.2&#34;</span>,
                    <span class="s2">&#34;IPPrefixLen&#34;</span>: 16,
                    <span class="s2">&#34;IPv6Gateway&#34;</span>: <span class="s2">&#34;&#34;</span>,
                    <span class="s2">&#34;GlobalIPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>,
                    <span class="s2">&#34;GlobalIPv6PrefixLen&#34;</span>: 0,
                    <span class="s2">&#34;MacAddress&#34;</span>: <span class="s2">&#34;02:42:ac:11:00:02&#34;</span>,
                    <span class="s2">&#34;DriverOpts&#34;</span>: null
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>看Mounts部分的source,就知道资源同步路径在哪里了</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># cd var/lib/docker/volumes/27cf7a77b52c9d0b7fe33d2cc4b62f53695137e1d503c483a16d915f35ca62cf/_data</span>
<span class="o">[</span>root@VM-16-16-centos _data<span class="o">]</span><span class="c1"># ll</span>
total 4
-rw-r--r-- <span class="m">1</span> root root <span class="m">77</span> Nov <span class="m">28</span> 12:20 test.java
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="step17docker-compose">Step17.docker-compose</h1>
<h2 id="什么是docker-compose">什么是docker-compose</h2>
<p><img src="https://img-blog.csdnimg.cn/cf5b6940265645988a9b643a78cbba0d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<blockquote>
<p>任何地方都可以使用dockercompose</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/c62d7242586d4371aaaf414ea3c4638a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/380c838bcf3148cfbcd76b4cb46be655.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<h2 id="docker-compose的安装">docker-compose的安装</h2>
<ul>
<li>
<p>官网中基础知识都在<code>Guides</code>,而docker-compose这种官方开源项目都在<code>Manuals</code>中</p>
</li>
<li>
<p>官方的下载命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">curl -L <span class="s2">&#34;https://github.com/docker/compose/releases/download/1.29.2/docker-compose-</span><span class="k">$(</span>uname -s<span class="k">)</span><span class="s2">-</span><span class="k">$(</span>uname -m<span class="k">)</span><span class="s2">&#34;</span> -o /usr/local/bin/docker-compose
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>但这个地址卡的要死,所以说换个地址</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">https://get.daocloud.io/docker/compose/releases/download/1.25.5/docker-compose
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>下载成功后赋予权限</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">sudo chmod +x /usr/local/bin/docker-compose
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>查看版本号</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">dockercompose -v
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h2 id="开始使用docker-compose">开始使用docker-compose</h2>
<h3 id="构建环境">构建环境</h3>
<blockquote>
<p>构建环境部分全部照搬官网</p>
</blockquote>
<ul>
<li>
<p>在任意目录下(我是直接在系统根目录下创建了一个dockerFrame)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">mkdir composetest
<span class="nb">cd</span> composetest
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在<code>composetest</code>下创建一个<code>app.py</code></p>
<p><code>app.py</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">time</span>
  
<span class="kn">import</span> <span class="nn">redis</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
  
<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="n">cache</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;redis&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">6379</span><span class="p">)</span>
  
<span class="k">def</span> <span class="nf">get_hit_count</span><span class="p">():</span>
    <span class="n">retries</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">cache</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s1">&#39;hits&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">redis</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">retries</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">exc</span>
            <span class="n">retries</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
  
<span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello</span><span class="p">():</span>
    <span class="n">count</span> <span class="o">=</span> <span class="n">get_hit_count</span><span class="p">()</span>
    <span class="k">return</span> <span class="s1">&#39;Hello World! I have been seen {} times.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>可以看出,这个文件是加载redis和Flask的相关配置</p>
</blockquote>
</li>
<li>
<p>在<code>composetest</code>下创建一个<code>requirements.txt</code></p>
<p><code>requirements.txt</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">flask
redis
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在根目录下创建一个<code>Dockerfile</code>文件</p>
<p><code>Dockerfile</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="c"># syntax=docker/dockerfile:1</span><span class="err">
</span><span class="err"></span><span class="k">FROM</span><span class="s"> python:3.7-alpine</span><span class="err">
</span><span class="err"></span><span class="k">WORKDIR</span><span class="s"> /code</span><span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">FLASK_APP</span><span class="o">=</span>app.py<span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">FLASK_RUN_HOST</span><span class="o">=</span><span class="m">0</span>.0.0.0<span class="err">
</span><span class="err"></span><span class="k">RUN</span> apk add --no-cache gcc musl-dev linux-headers<span class="err">
</span><span class="err"></span><span class="k">COPY</span> requirements.txt requirements.txt<span class="err">
</span><span class="err"></span><span class="k">RUN</span> pip install -r requirements.txt<span class="err">
</span><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 5000</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> . .<span class="err">
</span><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;flask&#34;</span><span class="p">,</span> <span class="s2">&#34;run&#34;</span><span class="p">]</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>在根目录下创建<code>docker-compose.yml</code></p>
<p><code>docker-compose.yml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="k">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.9&#34;</span><span class="w">
</span><span class="w"></span>services<span class="p">:</span><span class="w">
</span><span class="w">  </span>web<span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="k">build</span><span class="p">:</span><span class="w"> </span>.<span class="w">
</span><span class="w">    </span>ports<span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;5000:5000&#34;</span><span class="w">
</span><span class="w">  </span>redis<span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="k">image</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;redis:alpine&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>后面启动项目时候可能因为version问题报错,根据报错修改版本</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">ERROR: Version in <span class="s2">&#34;./docker-compose.yml&#34;</span> is unsupported. You might be seeing this error because you<span class="err">&#39;</span>re using the wrong Compose file version. Either specify a supported version <span class="o">(</span>e.g <span class="s2">&#34;2.2&#34;</span> or <span class="s2">&#34;3.3&#34;</span><span class="o">)</span> and place your service definitions under the <span class="sb">`</span>services<span class="sb">`</span> key, or omit the <span class="sb">`</span>version<span class="sb">`</span> key and place your service definitions at the root of the file to use version 1.
For more on the Compose file format versions, see https://docs.docker.com/compose/compose-file/
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>如果<code>/dockerFrame/composetest</code>目录下如果有这些配置,说明齐活了</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos dockerFrame<span class="o">]</span><span class="c1"># cd composetest</span>
<span class="o">[</span>root@VM-16-16-centos composetest<span class="o">]</span><span class="c1"># ll</span>
total 16
-rw-r--r-- <span class="m">1</span> root root <span class="m">514</span> Nov <span class="m">28</span> 16:08 app.py
-rw-r--r-- <span class="m">1</span> root root <span class="m">111</span> Nov <span class="m">28</span> 16:13 docker-compose.yml
-rw-r--r-- <span class="m">1</span> root root <span class="m">281</span> Nov <span class="m">28</span> 16:09 Dockerfile
-rw-r--r-- <span class="m">1</span> root root  <span class="m">12</span> Nov <span class="m">28</span> 16:24 requirements.txt
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>构建项目</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker-compose build
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>启动项目(在当前文件夹下/存放这几个配置文件的目录下面)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker-compose up
</code></pre></td></tr></table>
</div>
</div><p><img src="https://img-blog.csdnimg.cn/040773a71bb842f7905813c752761e0e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
<li>
<p>启动后重新开启一个终端查看docker容器进程</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos /<span class="o">]</span><span class="c1"># docker ps</span>
CONTAINER ID   IMAGE             COMMAND                  CREATED          STATUS          PORTS                                       NAMES
8245e18cf142   redis:alpine      <span class="s2">&#34;docker-entrypoint.s…&#34;</span>   <span class="m">47</span> seconds ago   Up <span class="m">45</span> seconds   6379/tcp                                    composetest_redis_1
bf7f4e53b3d4   composetest_web   <span class="s2">&#34;flask run&#34;</span>              <span class="m">47</span> seconds ago   Up <span class="m">45</span> seconds   0.0.0.0:5000-&gt;5000/tcp, :::5000-&gt;5000/tcp   composetest_web_1
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>可以看到,正常运行的情况下是存在两个进程<code>redis</code>和<code>web</code></p>
</blockquote>
</li>
<li>
<p>关于这几个文件的作用说明</p>
<blockquote>
<ul>
<li>应用 app.py</li>
<li>Dockerfile 将应用打包为镜像</li>
<li>Docker-compose.yml 定义整个服务需要的环境,web、redis</li>
</ul>
</blockquote>
</li>
<li>
<p>访问官方给的端口5000</p>
<p><img src="https://img-blog.csdnimg.cn/2d94ce645bc9410ebf91affd781519d2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<blockquote>
<p>可以看到,项目是可以计算访问次数的</p>
</blockquote>
<ul>
<li>
<p>关于这个可以看应用程序</p>
<p><img src="https://img-blog.csdnimg.cn/5814a8fc31af4cf3b4b80f283c7d9b7d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
</ul>
</li>
<li>
<p>我第二次运行了docker-compose,必须要在先前创建的目录下(带有这几个文件<code>尤其是yml文件</code>)才能启动项目</p>
<blockquote>
<p>docker-compose.yml是整个项目的核心配置文件</p>
</blockquote>
</li>
<li>
<p>运行后查看所有镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker images</span>
REPOSITORY            TAG          IMAGE ID       CREATED        SIZE
composetest_web       latest       c111b95705e3   <span class="m">7</span> hours ago    183MB
zhang/centos          1.0          cabc164891bd   <span class="m">11</span> hours ago   231MB
mytomcat              1.0          3a20fb127a30   <span class="m">2</span> days ago     684MB
tomcat                latest       904a98253fbf   <span class="m">10</span> days ago    680MB
nginx                 latest       ea335eea17ab   <span class="m">11</span> days ago    141MB
mysql                 latest       b05128b000dd   <span class="m">11</span> days ago    516MB
mongo                 latest       4253856b2570   <span class="m">11</span> days ago    701MB
redis                 alpine       5c08f13a2b92   <span class="m">2</span> weeks ago    32.4MB
python                3.7-alpine   f0c1a69798c7   <span class="m">2</span> weeks ago    41.9MB
centos                latest       5d0da3dc9764   <span class="m">2</span> months ago   231MB
portainer/portainer   latest       580c0e4e98b0   <span class="m">8</span> months ago   79.1MB
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>会发现多了一个composetest_web镜像</p>
</blockquote>
</li>
<li>
<p>查看docker的服务</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker service ls</span>
Error response from daemon: This node is not a swarm manager. Use <span class="s2">&#34;docker swarm init&#34;</span> or <span class="s2">&#34;docker swarm join&#34;</span> to connect this node to swarm and try again.
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>单节点不是集群</p>
</blockquote>
</li>
<li>
<p>查看docker-compose的网络信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker network ls</span>
NETWORK ID     NAME                  DRIVER    SCOPE
bffdaeb53bd1   bridge                bridge    <span class="nb">local</span>
8e0e034c8f15   composetest_default   bridge    <span class="nb">local</span>
a1ebd85ff5c2   host                  host      <span class="nb">local</span>
8982da3ca334   none                  null      <span class="nb">local</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>会发现多了个composetest_default的网络信息</p>
</blockquote>
</li>
<li>
<p>然后查看这个网络的具体信息</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@VM-16-16-centos ~<span class="o">]</span><span class="c1"># docker network inspect 8e0e034c8f15</span>
<span class="o">[</span>
    <span class="o">{</span>
        <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;composetest_default&#34;</span>,
        <span class="s2">&#34;Id&#34;</span>: <span class="s2">&#34;8e0e034c8f15477e4a050b4625c8c0c4198f4200419f8d8de6ee6d83ba6955bd&#34;</span>,
        <span class="s2">&#34;Created&#34;</span>: <span class="s2">&#34;2021-11-28T16:13:28.157946081+08:00&#34;</span>,
        <span class="s2">&#34;Scope&#34;</span>: <span class="s2">&#34;local&#34;</span>,
        <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;bridge&#34;</span>,
        <span class="s2">&#34;EnableIPv6&#34;</span>: false,
        <span class="s2">&#34;IPAM&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Driver&#34;</span>: <span class="s2">&#34;default&#34;</span>,
            <span class="s2">&#34;Options&#34;</span>: null,
            <span class="s2">&#34;Config&#34;</span>: <span class="o">[</span>
                <span class="o">{</span>
                    <span class="s2">&#34;Subnet&#34;</span>: <span class="s2">&#34;172.18.0.0/16&#34;</span>,
                    <span class="s2">&#34;Gateway&#34;</span>: <span class="s2">&#34;172.18.0.1&#34;</span>
                <span class="o">}</span>
            <span class="o">]</span>
        <span class="o">}</span>,
        <span class="s2">&#34;Internal&#34;</span>: false,
        <span class="s2">&#34;Attachable&#34;</span>: true,
        <span class="s2">&#34;Ingress&#34;</span>: false,
        <span class="s2">&#34;ConfigFrom&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;Network&#34;</span>: <span class="s2">&#34;&#34;</span>
        <span class="o">}</span>,
        <span class="s2">&#34;ConfigOnly&#34;</span>: false,
        <span class="s2">&#34;Containers&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;01800e08feafe4efb3ecacbc4c20428e2bed4338b43da18be8ea0f93f8b70527&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;composetest_redis_1&#34;</span>,
                <span class="s2">&#34;EndpointID&#34;</span>: <span class="s2">&#34;4fba3a9253c28ca83e18a0a218bc5876576dc5872e702dfcb871c8be533d531f&#34;</span>,
                <span class="s2">&#34;MacAddress&#34;</span>: <span class="s2">&#34;02:42:ac:12:00:02&#34;</span>,
                <span class="s2">&#34;IPv4Address&#34;</span>: <span class="s2">&#34;172.18.0.2/16&#34;</span>,
                <span class="s2">&#34;IPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>
            <span class="o">}</span>,
            <span class="s2">&#34;7780e8c83afb2b280c0ecf1efae94f89292b359cfab5886a874f1fb8c575e866&#34;</span>: <span class="o">{</span>
                <span class="s2">&#34;Name&#34;</span>: <span class="s2">&#34;composetest_web_1&#34;</span>,
                <span class="s2">&#34;EndpointID&#34;</span>: <span class="s2">&#34;75bb72b5b6f47b4df5ead8902b24e5f1209572cecc49153f6a10dfd8d8122a6f&#34;</span>,
                <span class="s2">&#34;MacAddress&#34;</span>: <span class="s2">&#34;02:42:ac:12:00:03&#34;</span>,
                <span class="s2">&#34;IPv4Address&#34;</span>: <span class="s2">&#34;172.18.0.3/16&#34;</span>,
                <span class="s2">&#34;IPv6Address&#34;</span>: <span class="s2">&#34;&#34;</span>
            <span class="o">}</span>
        <span class="o">}</span>,
        <span class="s2">&#34;Options&#34;</span>: <span class="o">{}</span>,
        <span class="s2">&#34;Labels&#34;</span>: <span class="o">{</span>
            <span class="s2">&#34;com.docker.compose.network&#34;</span>: <span class="s2">&#34;default&#34;</span>,
            <span class="s2">&#34;com.docker.compose.project&#34;</span>: <span class="s2">&#34;composetest&#34;</span>,
            <span class="s2">&#34;com.docker.compose.version&#34;</span>: <span class="s2">&#34;1.25.5&#34;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">]</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>可以看出,在同一个container中有一个redis和web</p>
</blockquote>
</li>
<li>
<p>停止docker-compose进程的两种方式</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">Ctrl + C
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker-compose down
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h2 id="docker-compose配置文件解读">docker-compose配置文件解读</h2>
<blockquote>
<p>docker-compose.yml是docker-compose的核心配置文件</p>
</blockquote>
<p><code>docker-compose.yml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yaml" data-lang="yaml"><span class="c"># 三层</span><span class="w">
</span><span class="w"></span>version<span class="p">:</span><span class="s1">&#39;3.3&#39;</span><span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c"># 服务层</span><span class="w">
</span><span class="w">	</span><span class="c"># 服务1</span><span class="w">
</span><span class="w">	</span>web<span class="p">:</span><span class="w">
</span><span class="w">		</span><span class="c"># 服务配置</span><span class="w">
</span><span class="w">		</span><span class="k">build</span><span class="p">:</span><span class="w"> </span>.<span class="w">
</span><span class="w">		</span>ports<span class="p">:</span><span class="w">
</span><span class="w">			</span>- <span class="s2">&#34;5000:5000&#34;</span><span class="w">
</span><span class="w">	
</span><span class="w">	</span><span class="c"># 服务2</span><span class="w">
</span><span class="w">	</span>redis<span class="p">:</span><span class="w">
</span><span class="w">		</span><span class="k">image</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;redis:alpine&#34;</span><span class="w">
</span><span class="w">		
</span><span class="w">	</span><span class="c"># 服务3</span><span class="w">
</span><span class="w">	</span>...<span class="w">
</span><span class="w">
</span><span class="w"></span><span class="c"># 其他配置 网络/卷、全局规则</span><span class="w">
</span><span class="w"></span>volumes<span class="p">:</span><span class="w">
</span><span class="w"></span>networks<span class="p">:</span><span class="w">
</span><span class="w"></span>configs<span class="p">:</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>然后具体的web下面有哪些配置可用,build、volumes下面该怎么写,读<a href="https://docs.docker.com/compose/compose-file/compose-file-v3/">官方文档</a>就可以了</p>
<p><img src="https://img-blog.csdnimg.cn/f7cb0f78482e4871a21249b450026cd2.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img">
<img src="https://img-blog.csdnimg.cn/6285963a538a4b4abf30f1d8f35cec9a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
</ul>
<h2 id="使用dockercompose一键发布wordpress博客">使用dockercompose一键发布wordpress博客</h2>
<ul>
<li>
<p>新建一个<code>my_wordpress</code>文件夹</p>
</li>
<li>
<p>在这个文件夹下面新建一个<code>docker-compose.yml</code>文件</p>
<p><code>docker-compose.yml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yml" data-lang="yml"><span class="k">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.3&#34;</span><span class="w">
</span><span class="w">      
</span><span class="w"></span>services<span class="p">:</span><span class="w">
</span><span class="w">  </span>db<span class="p">:</span><span class="w">
</span><span class="w">    </span><span class="k">image</span><span class="p">:</span><span class="w"> </span>mysql<span class="p">:</span><span class="m">5.7</span><span class="w">
</span><span class="w">    </span>volumes<span class="p">:</span><span class="w">
</span><span class="w">      </span>- db_data<span class="p">:</span>/var/lib/mysql<span class="w">
</span><span class="w">    </span><span class="k">restart</span><span class="p">:</span><span class="w"> </span>always<span class="w">
</span><span class="w">    </span>environment<span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="k">MYSQL_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span>somewordpress<span class="w">
</span><span class="w">      </span><span class="k">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span>wordpress<span class="w">
</span><span class="w">      </span><span class="k">MYSQL_USER</span><span class="p">:</span><span class="w"> </span>wordpress<span class="w">
</span><span class="w">      </span><span class="k">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span>wordpress<span class="w">
</span><span class="w">      
</span><span class="w">  </span>wordpress<span class="p">:</span><span class="w">
</span><span class="w">    </span>depends_on<span class="p">:</span><span class="w">
</span><span class="w">      </span>- db<span class="w">
</span><span class="w">    </span><span class="k">image</span><span class="p">:</span><span class="w"> </span>wordpress<span class="p">:</span>latest<span class="w">
</span><span class="w">    </span>volumes<span class="p">:</span><span class="w">
</span><span class="w">      </span>- wordpress_data<span class="p">:</span>/var/www/html<span class="w">
</span><span class="w">    </span>ports<span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;8000:80&#34;</span><span class="w">
</span><span class="w">    </span><span class="k">restart</span><span class="p">:</span><span class="w"> </span>always<span class="w">
</span><span class="w">    </span>environment<span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="k">WORDPRESS_DB_HOST</span><span class="p">:</span><span class="w"> </span>db<span class="p">:</span><span class="m">3306</span><span class="w">
</span><span class="w">      </span><span class="k">WORDPRESS_DB_USER</span><span class="p">:</span><span class="w"> </span>wordpress<span class="w">
</span><span class="w">      </span><span class="k">WORDPRESS_DB_PASSWORD</span><span class="p">:</span><span class="w"> </span>wordpress<span class="w">
</span><span class="w">      </span><span class="k">WORDPRESS_DB_NAME</span><span class="p">:</span><span class="w"> </span>wordpress<span class="w">
</span><span class="w"></span>volumes<span class="p">:</span><span class="w">
</span><span class="w">  </span><span class="k">db_data</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span><span class="w">  </span><span class="k">wordpress_data</span><span class="p">:</span><span class="w"> </span>{}<span class="w">
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>启动项目</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker-compose up -d
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>启动后它就会下载mysql5的镜像和wordpress的镜像</p>
</blockquote>
<blockquote>
<p>下载成功后它是通过8000端口映射本机80端口进行访问的,所以在腾讯云安全组中需要打开8000端口</p>
</blockquote>
</li>
<li>
<p>启动后访问<code>ip:8000</code>,就可以进入wordpress注册页面了</p>
</li>
<li>
<p>搞定注册后登录进入首页,里面直接是管理员页面</p>
</li>
<li>
<p>点击查看站点就可以查看你的博客网站了</p>
</li>
<li>
<p>当然wordpress是傻瓜式操作,不需要教程就可以随便玩的</p>
</li>
<li>
<p>搞一下,结果就变成了这个样子</p>
<p><img src="https://img-blog.csdnimg.cn/3c04edb49b28417e993df4e33fee115b.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/ae30ae966ecf4f20b1fc438ab22c446c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
<p><img src="https://img-blog.csdnimg.cn/ca2bfa198efa40b79b882fc61185d92a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
<li>
<p>在服务器中终止了docker-compose的运行它就无法访问了,这才叫所谓的服务器</p>
</li>
<li>
<p>如果想再次访问需要在项目文件夹中重新启动</p>
</li>
</ul>
<hr>
<h2 id="本地编写微服务项目通过dockercompose一键发布">本地编写微服务项目通过dockercompose一键发布</h2>
<blockquote>
<p>一个计数器项目</p>
</blockquote>
<ul>
<li>
<p>创建一个springboot项目</p>
<blockquote>
<p>导入redis和web依赖</p>
</blockquote>
</li>
<li>
<p>确保项目可以运行的情况</p>
</li>
<li>
<p>编写HelloController</p>
<p><code>HelloController.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.springbootdocker.controller</span><span class="o">;</span>
<span class="c1">// @CharacterEncoding   :   UTF-8
</span><span class="c1"></span><span class="cm">/*
</span><span class="cm"> * @File     :   HelloController
</span><span class="cm"> * @Time     :   2021/11/29
</span><span class="cm"> * @Author   :   张宇航
</span><span class="cm"> * @Contact  :   zhangzyh666@163.com
</span><span class="cm"> * @MyWeb    :   https://zhang666zyh.github.io
</span><span class="cm"> */</span>
  
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.core.StringRedisTemplate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="o">;</span>
  
<span class="nd">@RestController</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">HelloController</span> <span class="o">{</span>
  
    <span class="nd">@Autowired</span>
    <span class="n">StringRedisTemplate</span> <span class="n">stringRedisTemplate</span><span class="o">;</span>
  
    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;/hello&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="n">String</span> <span class="nf">hello</span><span class="o">(){</span>
        <span class="n">Long</span> <span class="n">viewNum</span> <span class="o">=</span> <span class="n">stringRedisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">increment</span><span class="o">(</span><span class="s">&#34;view&#34;</span><span class="o">);</span>
        <span class="k">return</span> <span class="s">&#34;Hello,Welcome to my Blog!!!&#34;</span> <span class="o">+</span> <span class="n">viewNum</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>然后编写Dockerfile</p>
<p><code>Dockerfile</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="k">FROM</span><span class="s"> java:8</span><span class="err">
</span><span class="err"></span>  <span class="err">
</span><span class="err"></span><span class="c"># 将整个项目下的所有jar包拷贝到/app.jar下</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> *.jar /app.jar<span class="err">
</span><span class="err"></span>  <span class="err">
</span><span class="err"></span><span class="k">CMD</span> <span class="p">[</span><span class="s2">&#34;---server:port=8080---&#34;</span><span class="p">]</span><span class="err">
</span><span class="err"></span>  <span class="err">
</span><span class="err"></span><span class="c"># 暴露端口</span><span class="err">
</span><span class="err"></span><span class="c"># 公开端口而不将它们发布到主机——它们只能被链接的服务访问。只能指定内部端口。</span><span class="err">
</span><span class="err"></span><span class="k">EXPOSE</span><span class="s"> 8080</span><span class="err">
</span><span class="err"></span>  <span class="err">
</span><span class="err"></span><span class="c"># 和CMD不同,ENTRYPOINT是项目启动时真正运行打印在控制台的语句,</span><span class="err">
</span><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;java&#34;</span> <span class="p">,</span><span class="s2">&#34;-jar&#34;</span> <span class="p">,</span><span class="s2">&#34;/app.jar&#34;</span><span class="p">]</span><span class="err">
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>编写docker-compose.yml</p>
<p><code>docker-compose.yml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-yml" data-lang="yml"><span class="k">version</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;3.3&#34;</span><span class="w">
</span><span class="w"></span>services<span class="p">:</span><span class="w">
</span><span class="w">  </span>zhangapp<span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="c"># 将项目中的Dockerfile文件导入(.是自动搜索目录下的Dockerfile)</span><span class="w">
</span><span class="w">    </span><span class="k">build</span><span class="p">:</span><span class="w"> </span>.<span class="w">
</span><span class="w">      
</span><span class="w">    </span><span class="c"># 打包后的镜像名</span><span class="w">
</span><span class="w">    </span><span class="k">image</span><span class="p">:</span><span class="w"> </span>zhangapp<span class="w">
</span><span class="w">      
</span><span class="w">    </span><span class="c"># service之间的依赖以及启动顺序	</span><span class="w">
</span><span class="w">    </span>depends_on<span class="p">:</span><span class="w">
</span><span class="w">      </span>- redis<span class="w">
</span><span class="w">        
</span><span class="w">    </span><span class="c"># 映射端口号</span><span class="w">
</span><span class="w">    </span>ports<span class="p">:</span><span class="w">
</span><span class="w">      </span>- <span class="s2">&#34;8080:8080&#34;</span><span class="w">
</span><span class="w">  
</span><span class="w">  </span><span class="c"># redis服务</span><span class="w">
</span><span class="w">  </span>redis<span class="p">:</span><span class="w">
</span><span class="w">      </span><span class="c"># 指定镜像</span><span class="w">
</span><span class="w">    </span><span class="k">image</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;library/redis:alpine&#34;</span><span class="w">
</span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>编写完配置文件后,进行打包</p>
<p><img src="https://img-blog.csdnimg.cn/ab227d60160347a1832d4270131a7185.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
<li>
<p>打包出来的jar包和<code>docker-compose.yml</code>以及<code>Dockerfile</code>,dockercompose三件套</p>
</li>
<li>
<p>在服务器中新建文件夹<code>/dockerFrame/springboot-redis</code></p>
</li>
<li>
<p>将三件套上传到文件夹下面</p>
<p><img src="https://img-blog.csdnimg.cn/bd2cc0294d0746afb8c75289f26fb947.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
<li>
<p>启动</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">docker-compose up --build
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>启动成功,进行访问</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell">curl localhost:8080/hell0
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>还是要记得将<code>8080</code>端口在安全组中打开</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/234d3e33c8f34a1abd9c724db77f276c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="img"></p>
</li>
</ul>
<h1 id="step18mac完全卸载docker">Step18.mac完全卸载docker</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-shell" data-lang="shell"><span class="c1">## 1）进入docker的安装目录</span>
<span class="nb">cd</span> /usr/local/bin/

<span class="c1">## 2）删除与docker相关的文件夹</span>
sudo rm -rf docker*
sudo rm -rf com.docker.*
sudo rm -rf hub-tool*
sudo rm -rf kube*
sudo rm -rf vpnkit*
</code></pre></td></tr></table>
</div>
</div><h2 id="heading"></h2>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Zhang's Blog</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2021-10-04
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/">中间件</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/spark/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">Spark</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/jetbrain%E5%BC%80%E5%8F%91%E5%B0%8F%E6%8A%80%E5%B7%A7/">
            <span class="next-text nav-default">JetBrain开发小技巧</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://twitter.com/" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://www.facebook.com/" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://www.linkedin.com/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://www.google.com/" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/" class="iconfont icon-douban" title="douban"></a>
      <a href="https://getpocket.com/" class="iconfont icon-pocket" title="pocket"></a>
      <a href="https://www.tumblr.com/" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="https://www.instagram.com/" class="iconfont icon-instagram" title="instagram"></a>
      <a href="https://about.gitlab.com/" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="https://www.bilibili.com/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="http://localhost:1313/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://golang.org/">GoLang</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Author - 
    <a class="theme-link" href="https://space.bilibili.com/628950169/">Mr'zhang</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span>Zhang's Blog</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>








</body>
</html>
