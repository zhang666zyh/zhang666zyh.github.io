<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Redis - Zhang&#39;s Blogçš„åšå®¢</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Zhang&#39;s Blog" /><meta name="description" content="Step1. å®‰è£… Step2. åŸºç¡€å‘½ä»¤ Step3. String Step4. List Step5. Set Step6.Hash Step7.zsetæœ‰åºé›†åˆ Step8.Geospatial Step9.HypperLogLog Step10.Redisçš„äº‹åŠ¡ æ‰§è¡Œäº‹åŠ¡ é”™è¯¯ä¸å¼‚å¸¸ Step11.ä½¿ç”¨Jedisæ“" /><meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.67.1 with theme even" />


<link rel="canonical" href="http://localhost:1313/post/redis/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="Redis" />
<meta property="og:description" content="Step1. å®‰è£… Step2. åŸºç¡€å‘½ä»¤ Step3. String Step4. List Step5. Set Step6.Hash Step7.zsetæœ‰åºé›†åˆ Step8.Geospatial Step9.HypperLogLog Step10.Redisçš„äº‹åŠ¡ æ‰§è¡Œäº‹åŠ¡ é”™è¯¯ä¸å¼‚å¸¸ Step11.ä½¿ç”¨Jedisæ“" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/post/redis/" />
<meta property="article:published_time" content="2021-09-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2021-09-24T00:00:00+00:00" />
<meta itemprop="name" content="Redis">
<meta itemprop="description" content="Step1. å®‰è£… Step2. åŸºç¡€å‘½ä»¤ Step3. String Step4. List Step5. Set Step6.Hash Step7.zsetæœ‰åºé›†åˆ Step8.Geospatial Step9.HypperLogLog Step10.Redisçš„äº‹åŠ¡ æ‰§è¡Œäº‹åŠ¡ é”™è¯¯ä¸å¼‚å¸¸ Step11.ä½¿ç”¨Jedisæ“">
<meta itemprop="datePublished" content="2021-09-24T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2021-09-24T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="15249">



<meta itemprop="keywords" content="DataBase," /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Redis"/>
<meta name="twitter:description" content="Step1. å®‰è£… Step2. åŸºç¡€å‘½ä»¤ Step3. String Step4. List Step5. Set Step6.Hash Step7.zsetæœ‰åºé›†åˆ Step8.Geospatial Step9.HypperLogLog Step10.Redisçš„äº‹åŠ¡ æ‰§è¡Œäº‹åŠ¡ é”™è¯¯ä¸å¼‚å¸¸ Step11.ä½¿ç”¨Jedisæ“"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Zhang&#39;s Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/home/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">MyBlog</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Zhang&#39;s Blog</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/home/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">MyBlog</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">About</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Redis</h1>

      <div class="post-meta">
        <span class="post-time"> 2021-09-24 </span>
        
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Contents</h2>
  <div class="post-toc-content always-active">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#step1-å®‰è£…">Step1. å®‰è£…</a>
      <ul>
        <li><a href="#ubuntu">Ubuntu</a></li>
        <li><a href="#centos">CentOS</a></li>
      </ul>
    </li>
    <li><a href="#step2-åŸºç¡€å‘½ä»¤">Step2. åŸºç¡€å‘½ä»¤</a></li>
    <li><a href="#step3-string">Step3. String</a></li>
    <li><a href="#step4-list">Step4. List</a></li>
    <li><a href="#step5-set">Step5. Set</a></li>
    <li><a href="#step6hash">Step6.Hash</a></li>
    <li><a href="#step7zsetæœ‰åºé›†åˆ">Step7.zset(æœ‰åºé›†åˆ)</a></li>
    <li><a href="#step8geospatial">Step8.Geospatial</a></li>
    <li><a href="#step9hypperloglog">Step9.HypperLogLog</a></li>
    <li><a href="#step10redisçš„äº‹åŠ¡">Step10.Redisçš„äº‹åŠ¡</a>
      <ul>
        <li><a href="#æ‰§è¡Œäº‹åŠ¡">æ‰§è¡Œäº‹åŠ¡</a></li>
        <li><a href="#é”™è¯¯ä¸å¼‚å¸¸">é”™è¯¯ä¸å¼‚å¸¸</a></li>
      </ul>
    </li>
    <li><a href="#step11ä½¿ç”¨jedisæ“ä½œredis">Step11.ä½¿ç”¨Jedisæ“ä½œRedis</a></li>
    <li><a href="#step12jedisæ“ä½œredisç†è§£redisä¸­çš„äº‹åŠ¡">Step12.Jedisæ“ä½œRedisç†è§£Redisä¸­çš„äº‹åŠ¡</a></li>
    <li><a href="#step13springbootæ•´åˆredis">Step13.SpringBootæ•´åˆRedis</a></li>
    <li><a href="#step14redisé…ç½®æ–‡ä»¶è¯¦è§£">Step14.Redisé…ç½®æ–‡ä»¶è¯¦è§£</a>
      <ul>
        <li><a href="#ubuntuä¸‹æ‰“å¼€é…ç½®æ–‡ä»¶">Ubuntuä¸‹æ‰“å¼€é…ç½®æ–‡ä»¶</a></li>
        <li><a href="#è¯»é…ç½®æ–‡ä»¶">è¯»é…ç½®æ–‡ä»¶</a></li>
      </ul>
    </li>
    <li><a href="#step15rdbæ“ä½œ">Step15.RDBæ“ä½œ</a>
      <ul>
        <li><a href="#rdbä»‹ç»">RDBä»‹ç»</a></li>
        <li><a href="#è·å–rdbæ–‡ä»¶è·¯å¾„çš„å‘½ä»¤">è·å–rdbæ–‡ä»¶è·¯å¾„çš„å‘½ä»¤</a></li>
        <li><a href="#è§¦å‘rdbæœºåˆ¶çš„æ–¹æ³•">è§¦å‘RDBæœºåˆ¶çš„æ–¹æ³•</a></li>
      </ul>
    </li>
    <li><a href="#step16aofæ“ä½œ">Step16.AOFæ“ä½œ</a></li>
    <li><a href="#step17redisè®¢é˜…å‘å¸ƒ">Step17.Redisè®¢é˜…å‘å¸ƒ</a></li>
    <li><a href="#step18redisä¸»ä»å¤åˆ¶">Step18.Redisä¸»ä»å¤åˆ¶</a>
      <ul>
        <li><a href="#å¦‚ä½•å¯åŠ¨å¤šä¸ªserverå’Œcli">å¦‚ä½•å¯åŠ¨å¤šä¸ªserverå’Œcli</a></li>
        <li><a href="#ä¸»ä»æœºé…ç½®">ä¸»ä»æœºé…ç½®</a>
          <ul>
            <li><a href="#ä¸€ä¸»äºŒä»">ä¸€ä¸»äºŒä»</a></li>
            <li><a href="#å±‚å±‚é“¾è·¯">```å±‚å±‚é“¾è·¯</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#step19å“¨å…µæ¨¡å¼">Step19.å“¨å…µæ¨¡å¼</a>
      <ul>
        <li><a href="#æ¦‚å¿µ">æ¦‚å¿µ</a></li>
        <li><a href="#æµ‹è¯•">æµ‹è¯•</a></li>
      </ul>
    </li>
    <li><a href="#step20redisç¼“å­˜ç©¿é€ç¼“å­˜å‡»ç©¿ä¸é›ªå´©">Step20.Redisç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ä¸é›ªå´©</a>
      <ul>
        <li><a href="#ç¼“å­˜ç©¿é€">ç¼“å­˜ç©¿é€</a></li>
        <li><a href="#ç¼“å­˜å‡»ç©¿">ç¼“å­˜å‡»ç©¿</a></li>
        <li><a href="#ç¼“å­˜é›ªå´©">ç¼“å­˜é›ªå´©</a></li>
      </ul>
    </li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <!-- TOC -->
<ul>
<li><a href="#step1-%E5%AE%89%E8%A3%85">Step1. å®‰è£…</a></li>
<li><a href="#step2-%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4">Step2. åŸºç¡€å‘½ä»¤</a></li>
<li><a href="#step3-string">Step3. String</a></li>
<li><a href="#step4-list">Step4. List</a></li>
<li><a href="#step5-set">Step5. Set</a></li>
<li><a href="#step6hash">Step6.Hash</a></li>
<li><a href="#step7zset%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88">Step7.zsetæœ‰åºé›†åˆ</a></li>
<li><a href="#step8geospatial">Step8.Geospatial</a></li>
<li><a href="#step9hypperloglog">Step9.HypperLogLog</a></li>
<li><a href="#step10redis%E7%9A%84%E4%BA%8B%E5%8A%A1">Step10.Redisçš„äº‹åŠ¡</a>
<ul>
<li><a href="#%E6%89%A7%E8%A1%8C%E4%BA%8B%E5%8A%A1">æ‰§è¡Œäº‹åŠ¡</a></li>
<li><a href="#%E9%94%99%E8%AF%AF%E4%B8%8E%E5%BC%82%E5%B8%B8">é”™è¯¯ä¸å¼‚å¸¸</a></li>
</ul>
</li>
<li><a href="#step11%E4%BD%BF%E7%94%A8jedis%E6%93%8D%E4%BD%9Credis">Step11.ä½¿ç”¨Jedisæ“ä½œRedis</a></li>
<li><a href="#step12jedis%E6%93%8D%E4%BD%9Credis%E7%90%86%E8%A7%A3redis%E4%B8%AD%E7%9A%84%E4%BA%8B%E5%8A%A1">Step12.Jedisæ“ä½œRedisç†è§£Redisä¸­çš„äº‹åŠ¡</a></li>
<li><a href="#step13springboot%E6%95%B4%E5%90%88redis">Step13.SpringBootæ•´åˆRedis</a></li>
<li><a href="#step14redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3">Step14.Redisé…ç½®æ–‡ä»¶è¯¦è§£</a>
<ul>
<li><a href="#ubuntu%E4%B8%8B%E6%89%93%E5%BC%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">Ubuntuä¸‹æ‰“å¼€é…ç½®æ–‡ä»¶</a></li>
<li><a href="#%E8%AF%BB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">è¯»é…ç½®æ–‡ä»¶</a></li>
</ul>
</li>
<li><a href="#step15rdb%E6%93%8D%E4%BD%9C">Step15.RDBæ“ä½œ</a>
<ul>
<li><a href="#rdb%E4%BB%8B%E7%BB%8D">RDBä»‹ç»</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96rdb%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%E7%9A%84%E5%91%BD%E4%BB%A4">è·å–rdbæ–‡ä»¶è·¯å¾„çš„å‘½ä»¤</a></li>
<li><a href="#%E8%A7%A6%E5%8F%91rdb%E6%9C%BA%E5%88%B6%E7%9A%84%E6%96%B9%E6%B3%95">è§¦å‘RDBæœºåˆ¶çš„æ–¹æ³•</a></li>
</ul>
</li>
<li><a href="#step16aof%E6%93%8D%E4%BD%9C">Step16.AOFæ“ä½œ</a></li>
</ul>
<!-- /TOC -->
<h1 id="step1-å®‰è£…">Step1. å®‰è£…</h1>
<h2 id="ubuntu">Ubuntu</h2>
<blockquote>
<p>sudo apt-get update</p>
</blockquote>
<blockquote>
<p>sudo apt-get install redis-server</p>
</blockquote>
<h2 id="centos">CentOS</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">wget http://download.redis.io/releases/redis-4.0.6.tar.gz
tar -zxvf redis-4.0.6.tar.gz

# è·³è½¬åˆ°redisè§£å‹ç›®å½•ä¸‹
cd redis-4.0.6

# ç¼–è¯‘å®‰è£…
make MALLOC=libc

#å°†/usr/local/redis-4.0.6/srcç›®å½•ä¸‹çš„æ–‡ä»¶åŠ åˆ°/usr/local/binç›®å½•
cd src &amp;&amp; make install

#å…ˆåˆ‡æ¢åˆ°redis srcç›®å½•ä¸‹(æˆ–è€…redis-serveræ–‡ä»¶æ‰€åœ¨ç›®å½•)
cd  /src
 
#ç›´æ¥å¯åŠ¨redis
./redis-server
</code></pre></td></tr></table>
</div>
</div><ul>
<li>ä½†æ˜¯ç›´æ¥å¯åŠ¨å´æ— æ³•ä½¿ç”¨</li>
<li>éœ€è¦åƒå¯åŠ¨redis-serveré‚£æ ·å¯åŠ¨redis-cli(Rediså®¢æˆ·ç«¯)</li>
</ul>
<h1 id="step2-åŸºç¡€å‘½ä»¤">Step2. åŸºç¡€å‘½ä»¤</h1>
<ul>
<li>
<p>å¯åŠ¨RedisæœåŠ¡</p>
<blockquote>
<p>redis-server</p>
</blockquote>
<blockquote>
<p>redis-cli</p>
</blockquote>
</li>
<li>
<p>åˆ¤æ–­redisæ˜¯å¦è¿æ¥</p>
<blockquote>
<p>PING</p>
</blockquote>
</li>
<li>
<p>è®¾ç½®å­—æ®µ</p>
<blockquote>
<p>set username zhangyuhang</p>
</blockquote>
<blockquote>
<p>set str 111</p>
</blockquote>
</li>
<li>
<p>è·å–å­—æ®µ</p>
<blockquote>
<p>get username</p>
</blockquote>
<p>å¦‚æœä½ è·å–ä¸€ä¸ªä¸å­˜åœ¨çš„å­—æ®µ,å®ƒä¼šè¿”å›ä¸€ä¸ªnui</p>
</li>
<li>
<p>Linuxä¸­æŸ¥çœ‹æ‰€æœ‰redisè¿›ç¨‹</p>
<blockquote>
<p>ps -ef|grep redis</p>
</blockquote>
<p>ps -efç”¨äºæŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹,grepç”¨äºè¿‡æ»¤å‡ºæŒ‡å®šè¿›ç¨‹</p>
</li>
<li>
<p>é€€å‡ºredisæœåŠ¡</p>
<blockquote>
<p>shutdown</p>
</blockquote>
<blockquote>
<p>exit</p>
</blockquote>
</li>
<li>
<p>åˆ‡æ¢æ•°æ®åº“å‘½ä»¤</p>
<blockquote>
<p>redisé»˜è®¤æœ‰16ä¸ªæ•°æ®åº“,é»˜è®¤æ˜¯0</p>
</blockquote>
<blockquote>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡select 7è¿™æ ·çš„å‘½ä»¤è¿›è¡Œåˆ‡æ¢</p>
</blockquote>
</li>
<li>
<p>æŸ¥çœ‹å½“å‰æ•°æ®åº“æ‰€æœ‰çš„key</p>
<blockquote>
<p>keys *</p>
</blockquote>
</li>
<li>
<p>æ¸…é™¤å½“å‰æ•°æ®åº“æ‰€æœ‰ä¿¡æ¯</p>
<blockquote>
<p>flushdb</p>
</blockquote>
</li>
<li>
<p>æ¸…é™¤å½“å‰æ‰€æœ‰æ•°æ®åº“æ‰€æœ‰ä¿¡æ¯</p>
<blockquote>
<p>flushall</p>
</blockquote>
</li>
<li>
<p>æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­æ•°æ®é‡</p>
<blockquote>
<p>dbsize</p>
</blockquote>
</li>
<li>
<p>åˆ¤æ–­keyæ˜¯å¦åœ¨å½“å‰æ•°æ®åº“ä¸­</p>
<blockquote>
<p>exists name</p>
</blockquote>
</li>
<li>
<p>ç§»é™¤æŒ‡å®škeyçš„å€¼</p>
<blockquote>
<p>move name 1</p>
</blockquote>
<p>1æŒ‡çš„æ˜¯ç§»é™¤æ•°æ®åº“1ä¸­é”®ä¸ºnameçš„å€¼</p>
</li>
</ul>
<h1 id="step3-string">Step3. String</h1>
<ul>
<li>
<p>è®¾ç½®keyçš„æœ‰æ•ˆæ—¶é—´(å•ä½:s)</p>
<blockquote>
<p>EXPIRE username 10</p>
</blockquote>
<p>æ„æ€å°±æ˜¯username10ç§’é’Ÿåè¢«é”€æ¯</p>
<ul>
<li>ä½ å¯ä»¥é€šè¿‡ttl usernameå‘½ä»¤æŸ¥çœ‹æŒ‡å®škeyçš„æœ‰æ•ˆæ—¶é—´</li>
</ul>
</li>
<li>
<p>åœ¨å­—ç¬¦ä¸²åé¢åŠ¨æ€è¿½åŠ å­—ç¬¦ä¸²</p>
<blockquote>
<p>append username &ldquo;s&rdquo;</p>
</blockquote>
<p>å¦‚æœå½“å‰keyä¸å­˜åœ¨,å°±ç›¸å½“äº<strong>set key</strong></p>
</li>
<li>
<p>è·å–å­—ç¬¦ä¸²çš„é•¿åº¦</p>
<blockquote>
<p>strlen username</p>
</blockquote>
</li>
<li>
<p>å¯¹æ•°å­—è¿›è¡ŒåŠ å‡æ“ä½œ</p>
<ul>
<li>
<p>é€ä¸€åŠ å‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">set val 0
incr val
incr val
decr val
decr val
decr val
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æŒ‰ç…§æŒ‡å®šæ­¥é•¿è¿›è¡ŒåŠ å‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">incrby val 10
decrby val 5
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>æŒ‰ç…§ç´¢å¼•æˆªå–å­—ç¬¦ä¸²</p>
<blockquote>
<p>getrange username 0 3</p>
</blockquote>
<p>æˆªå–keyä¸ºusernameå­—ç¬¦ä¸²ä¸­0-3çš„å­—ç¬¦</p>
</li>
<li>
<p>ä»ä¸€ä¸ªç´¢å¼•å¼€å§‹å‘åè®¾ç½®å­—ç¬¦ä¸²çš„æ¯ä¸ªå­—ç¬¦</p>
<blockquote>
<p>setrange username 1 88</p>
</blockquote>
<p>æ„æ€å°±æ˜¯usernameæ˜¯zhangyuhang,ç°åœ¨ä»ç´¢å¼•ä¸º1çš„ä½ç½®å¼€å§‹å‘åä½¿ç”¨88è¿™ä¸ªå­—ç¬¦ä¸²å‘åæ›¿æ¢,ç›´è‡³88çš„å†…å®¹å®Œå…¨è¢«æ’å…¥å­—ç¬¦ä¸²ä¸ºæ­¢</p>
</li>
<li>
<p>è®¾ç½®å­—ç¬¦ä¸²æœ‰æ•ˆæ—¶é—´(å•ä½:s)</p>
<blockquote>
<p>setex username 30 zhang</p>
</blockquote>
</li>
<li>
<p>åˆ›å»ºå­—ç¬¦ä¸²,å¦‚æœå­˜åœ¨åˆ™åˆ›å»º,å¦åˆ™åˆ™åˆ›å»ºå¤±è´¥(è¿”å›å€¼ä¸º0)</p>
<blockquote>
<p>setnx username zhang</p>
</blockquote>
</li>
<li>
<p>ä¸€æ¬¡æ€§è®¾ç½®å¤šä¸ªkey-value</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">mset k1 v1 k2 v2 k3 v3
keys *
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ä¸€æ¬¡æ€§è·å–å¤šä¸ªkeyçš„value</p>
<blockquote>
<p>mget k1 k2 k3</p>
</blockquote>
</li>
<li>
<p>åŒç†ä¹Ÿå¯ä»¥é€šè¿‡nxæ“ä½œ,åœ¨åˆ›å»ºçš„åŒæ—¶è¿›è¡Œæ˜¯å¦å­˜åœ¨çš„åˆ¤æ–­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">msetnx k1 v1 k4 v4
keys *
</code></pre></td></tr></table>
</div>
</div><p>nxæ˜¯ä¸€ç§åŸå­æ“ä½œ,è¦ä¹ˆä¸€èµ·æˆåŠŸ,è¦ä¹ˆä¸€èµ·å¤±è´¥</p>
</li>
<li>
<p>åˆ›å»ºå¯¹è±¡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">mset userğŸ§‘username zhangyuhang userğŸ§‘age 19
mget userğŸ§‘username userğŸ§‘age
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>getsetæ“ä½œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">getset yyds Me
get yyds
getset yyds wife
</code></pre></td></tr></table>
</div>
</div><p>getsetçš„æ“ä½œå°±æ˜¯:å¦‚æœè®¾ç½®çš„keyçš„å€¼å­˜åœ¨,å°±è·å–åˆ°åŸæ¥çš„å€¼,å¹¶å°†è¿™ä¸ªkeyè®¾ç½®ä¸ºæ–°å€¼;å¦‚æœä¸å­˜åœ¨,å°±è¿”å›nui,å¹¶ä¸ºkeyçš„valueèµ‹äºˆè¿™ä¸ªå€¼</p>
</li>
</ul>
<h1 id="step4-list">Step4. List</h1>
<ul>
<li>
<p>Listä¸­æ‰€æœ‰å‘½ä»¤éƒ½æ˜¯å¤§å†™çš„Lå¼€å¤´</p>
</li>
<li>
<p>Listå¯ä»¥ç©æˆæ ˆã€é˜Ÿåˆ—ã€é˜»å¡é˜Ÿåˆ—</p>
</li>
<li>
<p>å‘åˆ—è¡¨ä¸­æ’å…¥å…ƒç´ </p>
<blockquote>
<p>LPUSH list one</p>
</blockquote>
<blockquote>
<p>LPUSH list two</p>
</blockquote>
<blockquote>
<p>LPUSH list three</p>
</blockquote>
</li>
<li>
<p>è·å–åˆ—è¡¨ä¸­æ‰€æœ‰å…ƒç´ </p>
<blockquote>
<p>LRANGE list 0 -1</p>
</blockquote>
</li>
<li>
<p>è·å–åˆ—è¡¨ä¸­æŒ‡å®šç´¢å¼•èŒƒå›´çš„å…ƒç´ </p>
<blockquote>
<p>LRANGE list 0 1</p>
</blockquote>
</li>
<li>
<p>å°†ä¸€ä¸ªå€¼æ’å…¥åˆ°åˆ—è¡¨å°¾éƒ¨</p>
<blockquote>
<p>Rpush list righter</p>
</blockquote>
<p>RpushåŒºåˆ†å¤§å°å†™</p>
</li>
<li>
<p>ç§»é™¤åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ (å·¦å¼¹æ ˆ)</p>
<blockquote>
<p>Lpop list</p>
</blockquote>
</li>
<li>
<p>ç§»é™¤åˆ—è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ (å³å¼¹æ ˆ)</p>
<blockquote>
<p>Rpop list</p>
</blockquote>
</li>
<li>
<p>æ ¹æ®ç´¢å¼•æŸ¥æ‰¾å…ƒç´ çš„å€¼(ä¸å­˜åœ¨è¿”å›nui)</p>
<blockquote>
<p>Lindex list 0</p>
</blockquote>
</li>
<li>
<p>æŸ¥çœ‹åˆ—è¡¨é•¿åº¦</p>
<blockquote>
<p>Llen list</p>
</blockquote>
</li>
<li>
<p>ç§»é™¤æŒ‡å®šçš„å€¼</p>
<ul>
<li>
<p>ç§»é™¤ä¸€ä¸ªå€¼</p>
<blockquote>
<p>Lrem list 1 two</p>
</blockquote>
</li>
<li>
<p>ç§»é™¤å¤šä¸ªå€¼</p>
<blockquote>
<p>Lrem list 2 three</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>å°†listè£å‡ä¸ºæŒ‡å®šç´¢å¼•èŒƒå›´çš„å†…å®¹</p>
<blockquote>
<p>Ltrim list 1 3</p>
</blockquote>
</li>
<li>
<p>å°†ä¸€ä¸ªåˆ—è¡¨ä¸­çš„é¡¶å…ƒç´ ç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªåˆ—è¡¨ä¸­</p>
<blockquote>
<p>RpopLrange list list2</p>
</blockquote>
<p>å°†listä¸­å³å¼¹æ ˆçš„æ•°æ®pushåˆ°list2ä¸­</p>
</li>
<li>
<p>è®¾ç½®åˆ—è¡¨æŒ‡å®šç´¢å¼•ä½ç½®å…ƒç´ çš„å€¼</p>
<blockquote>
<p>Lset list 0 item</p>
</blockquote>
<p>å¦‚æœç´¢å¼•ä½ç½®å­˜åœ¨å€¼,åˆ™è¿›è¡Œæ›¿æ¢;å¦‚æœä¸å­˜åœ¨åˆ™æŠ¥é”™</p>
</li>
<li>
<p>å°†ä¸€ä¸ªå€¼æ’å…¥åˆ°å¦ä¸€ä¸ªå€¼çš„å‰é¢</p>
<blockquote>
<p>LINSERT list before &ldquo;two&rdquo; &ldquo;111&rdquo;</p>
</blockquote>
</li>
<li>
<p>å°†ä¸€ä¸ªå€¼æ’å…¥åˆ°å¦ä¸€ä¸ªå€¼çš„åé¢</p>
<blockquote>
<p>LINSERT list after &ldquo;two&rdquo; &ldquo;111&rdquo;</p>
</blockquote>
</li>
</ul>
<h1 id="step5-set">Step5. Set</h1>
<ul>
<li>
<p>Setä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½æ˜¯så¼€å¤´</p>
</li>
<li>
<p>Setä¸­æ²¡æœ‰é‡å¤å…ƒç´ </p>
</li>
<li>
<p>å‘setä¸­æ·»åŠ å…ƒç´ </p>
<blockquote>
<p>sadd myset &ldquo;hello&rdquo;</p>
</blockquote>
<blockquote>
<p>sadd myset &ldquo;world&rdquo;</p>
</blockquote>
<blockquote>
<p>sadd myset &ldquo;others&rdquo;</p>
</blockquote>
</li>
<li>
<p>éå†setå…ƒç´ </p>
<blockquote>
<p>SMEMBERS myset</p>
</blockquote>
</li>
<li>
<p>åˆ¤æ–­å…ƒç´ æ˜¯å¦å­˜åœ¨äºé›†åˆä¸­</p>
<blockquote>
<p>SISMEMBERS myset</p>
</blockquote>
</li>
<li>
<p>è·å–seté›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°</p>
<blockquote>
<p>SCARD myset</p>
</blockquote>
</li>
<li>
<p>ç§»é™¤setä¸­çš„æŒ‡å®šå…ƒç´ </p>
<blockquote>
<p>srem myset hello</p>
</blockquote>
</li>
<li>
<p>éšæœºè·å–setä¸­çš„æŸä¸ªå…ƒç´ </p>
<blockquote>
<p>SRANDMEMBER myset</p>
</blockquote>
</li>
<li>
<p>éšæœºåˆ é™¤æŸä¸ªå…ƒç´ </p>
<blockquote>
<p>SMEMBERS myset</p>
</blockquote>
</li>
<li>
<p>å°†ä¸€ä¸ªsetä¸­çš„æŒ‡å®šå…ƒç´ ç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªsetä¸­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">sadd set1 hello
sadd set1 world
sadd set1 other
sadd set2 people
SMOVE set1 set2 other
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ±‚ä¸€ä¸ªé›†åˆåœ¨å¦ä¸€ä¸ªé›†åˆä¸­ä¸å­˜åœ¨çš„å€¼</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">sadd set1 hello
sadd set1 world
sadd set2 hello
sadd set2 other
SDIFF set1 set2
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ±‚ä¸¤ä¸ªsetçš„äº¤é›†</p>
<blockquote>
<p>SINTER set1 set2</p>
</blockquote>
</li>
<li>
<p>æ±‚ä¸¤ä¸ªsetçš„å¹¶é›†</p>
<blockquote>
<p>SUNION set1 set2</p>
</blockquote>
</li>
</ul>
<h1 id="step6hash">Step6.Hash</h1>
<ul>
<li>
<p>Hashæ˜¯ä»¥key-mapçš„å½¢å¼å­˜å‚¨çš„</p>
</li>
<li>
<p>Hashæ‰€æœ‰å‘½ä»¤éƒ½æ˜¯ä»¥hå¼€å¤´</p>
</li>
<li>
<p>å‘hashä¸­æ·»åŠ ä¸€ä¸ªkey-mapé”®å€¼å¯¹</p>
<blockquote>
<p>hset myhash field1 id</p>
</blockquote>
</li>
<li>
<p>å‘hashä¸­æ·»åŠ å¤šä¸ªé”®å€¼å¯¹</p>
<blockquote>
<p>hmset myhash field2 name field3 age</p>
</blockquote>
</li>
<li>
<p>è·å–åˆ°hashä¸­æŒ‡å®škeyçš„å€¼</p>
<blockquote>
<p>hget myhash field1</p>
</blockquote>
</li>
<li>
<p>è·å–åˆ°hashä¸­å¤šä¸ªkeyçš„å€¼</p>
<blockquote>
<p>hmget myhash field1 field2</p>
</blockquote>
</li>
<li>
<p>è·å–åˆ°hashä¸­æ‰€æœ‰å€¼</p>
<blockquote>
<p>hgetall myhash</p>
</blockquote>
</li>
<li>
<p>åˆ é™¤æŒ‡å®šé”®çš„å€¼</p>
<blockquote>
<p>hdel myhash field1</p>
</blockquote>
</li>
<li>
<p>è·å–hashçš„é”®å€¼å¯¹ä¸ªæ•°</p>
<blockquote>
<p>hlen myhash</p>
</blockquote>
</li>
<li>
<p>åˆ¤æ–­åœ¨hashè¡¨ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šå­—æ®µçš„hashé”®å€¼å¯¹</p>
<blockquote>
<p>hexists myhash field1</p>
</blockquote>
</li>
<li>
<p>è·å–hashä¸­æ‰€æœ‰çš„key</p>
<blockquote>
<p>hkeys myhash</p>
</blockquote>
</li>
<li>
<p>è·å–hashä¸­æ‰€æœ‰çš„value</p>
<blockquote>
<p>hvals myhash</p>
</blockquote>
</li>
<li>
<p>å¯¹hashä¸­çš„æŸä¸ªé”®å€¼å¯¹ä¸­çš„å€¼(æ•°å­—)è¿›è¡ŒåŠ å‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">flushdb
hset myhash field 1
hincrby myhash field 5
hincrby myhash field -10
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>åœ¨hashä¸­è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹,å¦‚æœå­˜åœ¨,å°±åœ¨hashä¸­æ–°å»ºè¿™ä¸ªé”®å€¼å¯¹;å¦‚æœä¸å­˜åœ¨å°±è®¾ç½®å¤±è´¥</p>
<blockquote>
<p>flushdb</p>
<p>hset myhash field1 1</p>
<p>hset myhash field2 2</p>
<p>hset myhash field1 3</p>
</blockquote>
</li>
<li>
<p>hashä¸­è®¾ç½®å¯¹è±¡å¹¶è·å–å€¼</p>
<blockquote>
<p>hset user:root username zhangyuhang</p>
<p>hset user:root password 123456</p>
<p>hget user:root username</p>
</blockquote>
</li>
</ul>
<h1 id="step7zsetæœ‰åºé›†åˆ">Step7.zset(æœ‰åºé›†åˆ)</h1>
<ul>
<li>
<p>zsetå’Œsetçš„åŒºåˆ«æ˜¯,zsetä¸­çš„å…ƒç´ æ˜¯æœ‰åºçš„</p>
</li>
<li>
<p>å‘zsetä¸­æ·»åŠ å…ƒç´ </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">zadd myhash 1 one
</code></pre></td></tr></table>
</div>
</div><p>ä½ åœ¨æ·»åŠ å…ƒç´ çš„åŒæ—¶ä¹Ÿè¦æŒ‡å®šå…ƒç´ åœ¨zsetä¸­çš„ç¼–å·</p>
</li>
<li>
<p>å‘zsetä¸­æ·»åŠ å¤šä¸ªå…ƒç´ </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">zadd myhash 2 two 3 three
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>éå†zseté›†åˆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">zrange myhash 0 -1
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å¯¹zsetä¸­çš„å…ƒç´ è¿›è¡Œæ’åºæŸ¥è¯¢(ä»å°åˆ°å¤§)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">flushdb
zadd salary 1000000 zhang
zadd salary 100 wang
zadd salary 10 li
zadd salary 1 zhao
ZRANGEBYSCORE salary -inf +inf
</code></pre></td></tr></table>
</div>
</div><p>infæ˜¯æ— é™å¤§çš„æ„æ€</p>
</li>
<li>
<p>æŸ¥è¯¢æŒ‡å®šèŒƒå›´çš„æ•°æ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">zrangebyscore salary -inf 100
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>éå†zseté›†åˆ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">zrange salary 0 -1
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ç§»é™¤zsetä¸­çš„å…ƒç´ </p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">zrem salary li
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>è·å–zsetä¸­çš„å…ƒç´ ä¸ªæ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">zcard salary
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æŸ¥è¯¢zsetä¸­æ‰€æœ‰å…ƒç´ (ä»å¤§åˆ°å°æ’åº)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">zrevrange salary 0 -1
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>è·å–æŒ‡å®šåŒºé—´çš„æˆå‘˜æ•°é‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">flushdb
zadd myzhash 1 1
zadd myzhash 2 2
zadd myzhash 3 3
zadd myzhash 4 4
zcount myhash 1 3
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h1 id="step8geospatial">Step8.Geospatial</h1>
<ul>
<li>
<p>Geoåœ¨redisä¸­å°±æ˜¯åœ°ç†ä½ç½®çš„æ„æ€</p>
</li>
<li>
<p>å‘redisä¸­æ·»åŠ åœ°ç†ä½ç½®ä¿¡æ¯</p>
</li>
<li>
<p>åœ°ç†ä½ç½®ä¿¡æ¯é€šè¿‡ç»çº¬åº¦çš„æ–¹å¼æ·»åŠ ,ç»çº¬åº¦å¯ä»¥é€šè¿‡ç™¾åº¦ä¸­çš„ç½‘ç«™æŸ¥è¯¢åˆ°</p>
</li>
<li>
<p>å‘redisä¸­æ·»åŠ åœ°ç†ä½ç½®ä¿¡æ¯</p>
<blockquote>
<p>geoadd china:city 116.40 39.90 beijing</p>
</blockquote>
</li>
<li>
<p>è·å–æ·»åŠ åˆ°redisä¸­çš„åœ°ç†ä½ç½®</p>
<blockquote>
<p>geopos china:city haerbin</p>
</blockquote>
</li>
<li>
<p>è®¡ç®—ä¸¤ä¸ªåœ°ç†ä½ç½®ä¹‹é—´çš„è·ç¦»</p>
<blockquote>
<p>geopos china:city haerbin</p>
</blockquote>
<ul>
<li>
<p>åœ¨è¯­å¥ç»“å°¾å¯ä»¥æŒ‡å®šåº¦é‡å•ä½</p>
<blockquote>
<p>km,m,ft(è‹±å°º),mi(è‹±é‡Œ)</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>ä»¥ä¸€ä¸ªåŸå¸‚çš„ç»çº¬åº¦ä¸ºåœ†å¿ƒ,å¯»æ‰¾æŒ‡å®šåŠå¾„å†…çš„æ‰€æœ‰åŸå¸‚</p>
<blockquote>
<p>GEORADIUS china:city 116.40 39.90 1000 km</p>
</blockquote>
<ul>
<li>
<p>é™„å¸¦ä¸Šç›´çº¿è·ç¦»</p>
<blockquote>
<p>GEORADIUS  china:city 116.40 39.90 100000 km withdist</p>
</blockquote>
</li>
<li>
<p>ä¼´éšç€æ¯ä¸ªä½ç½®çš„ç»åº¦çº¬åº¦</p>
<blockquote>
<p>GEORADIUS  china:city 116.40 39.90 100000 km withdist</p>
</blockquote>
</li>
<li>
<p>æŒ‡å®šæŸ¥è¯¢å‡ºåŸå¸‚çš„æ•°é‡</p>
<blockquote>
<p>GEORADIUS  china:city 116.40 39.90 100000 km withdist withcoord count 2</p>
</blockquote>
<ul>
<li>å¦‚æœæ²¡æœ‰åˆ™å°†æ‰€æœ‰çš„åŸå¸‚éƒ½æŸ¥è¯¢å‡ºæ¥</li>
</ul>
</li>
</ul>
</li>
<li>
<p>æŸ¥è¯¢å’ŒæŒ‡å®šåŸå¸‚è·ç¦»ç­‰äºæŒ‡å®šè·ç¦»çš„æ‰€æœ‰åŸå¸‚</p>
<blockquote>
<p>georadiusbymember china:city shanghai 400 km</p>
</blockquote>
</li>
<li>
<p>æŸ¥è¯¢ä»£è¡¨æŒ‡å®šä½ç½®çš„å“ˆå¸Œå­—ç¬¦ä¸²</p>
<blockquote>
<p>geohash china:city shanghai</p>
</blockquote>
</li>
<li>
<p>éå†å½“å‰æ•°æ®åº“ä¸­æ‰€æœ‰çš„åœ°ç†ä½ç½®</p>
<blockquote>
<p>ZRANGE china:city 0 -1</p>
</blockquote>
</li>
<li>
<p>ç§»é™¤æŒ‡å®šåœ°ç†ä½ç½®</p>
<blockquote>
<p>zrem china:city shanghai</p>
</blockquote>
</li>
</ul>
<h1 id="step9hypperloglog">Step9.HypperLogLog</h1>
<ul>
<li>
<p>åŸºæ•°ç»Ÿè®¡</p>
</li>
<li>
<p>ä»€ä¹ˆæ˜¯åŸºæ•°</p>
<blockquote>
<p>A = {1,2,3,4,5}</p>
<p>B = {1,2,3,4,5,6,5}</p>
<p>Bçš„åŸºæ•°å°±æ˜¯6,æ’é™¤é‡å¤</p>
</blockquote>
</li>
<li>
<p>ä¼˜ç‚¹:å ç”¨å†…å­˜å›ºå®š,2^64ä¸­ä¸åŒå…ƒç´ çš„æŠ€æœ¯,åªéœ€è¦12kbå†…å­˜</p>
</li>
<li>
<p>ç½‘é¡µçš„UV(ä¸€ä¸ªäººè®¿é—®å¤šæ¬¡,ä½†è¿˜æ˜¯ç®—åšä¸€ä¸ªäºº)</p>
<blockquote>
<p>ä¼ ç»Ÿæ–¹å¼,ä½¿ç”¨setå‚¨å­˜ç”¨æˆ·id,å°±ä¼šæ¯”è¾ƒéº»çƒ¦!æˆ‘ä»¬çš„ç›®çš„æ˜¯ä¸ºäº†æ¯”è¾ƒ,è€Œä¸æ˜¯å‚¨å­˜id</p>
<p>0.81%é”™è¯¯ç‡</p>
</blockquote>
</li>
<li>
<p>åˆ›å»ºä¸€ä¸ªHypperLogLog,å¹¶å‘å…¶ä¸­æ·»åŠ æ•°æ®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">PFadd mykeys a b c d e f g
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å¦‚æœæœ‰é‡å¤,åˆ™è‡ªåŠ¨å»é‡</p>
<blockquote>
<p>PFadd mykeys a b c d e f a</p>
</blockquote>
</li>
<li>
<p>è·å–æŒ‡å®škeyä¸­åŸºæ•°å€¼</p>
<blockquote>
<p>PFCOUNT mykeys</p>
</blockquote>
</li>
<li>
<p>åˆå¹¶ä¸¤ä¸ªHypperLogLog</p>
<blockquote>
<p>PFMERGE mykeys1 mykeys2</p>
</blockquote>
<ul>
<li>åˆå¹¶è¿‡ç¨‹ä¸­ä¹Ÿä¼šå»é‡</li>
</ul>
</li>
</ul>
<p>Step10.BitMap</p>
<ul>
<li>
<p>é€šè¿‡å­˜å‚¨ä½è¿›è¡Œæ“ä½œ</p>
</li>
<li>
<p>æ¡ˆä¾‹:ç»Ÿè®¡ä¸€å‘¨æ‰“å¡æ¬¡æ•°</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">setbit daka 0 1
setbit daka 1 1
setbit daka 2 0
setbit daka 3 1
setbit daka 5 0
setbit daka 6 1
</code></pre></td></tr></table>
</div>
</div><ul>
<li>è·å–æŒ‡å®škeyæŒ‡å®šå€¼çš„bitå€¼</li>
</ul>
<blockquote>
<p>getbit daka 5</p>
</blockquote>
<ul>
<li>ç»Ÿè®¡æŒ‡å®škeyä¸­æ‰€æœ‰å€¼ä¸º1çš„å€¼çš„ä¸ªæ•°</li>
</ul>
</li>
</ul>
<h1 id="step10redisçš„äº‹åŠ¡">Step10.Redisçš„äº‹åŠ¡</h1>
<ul>
<li>
<p>Redisäº‹åŠ¡æœ¬è´¨:ä¸€ç¥–å‘½ä»¤çš„é›†åˆ!ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰€æœ‰å‘½ä»¤<code>éƒ½ä¼šè¢«åºåˆ—åŒ–,åœ¨äº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­,ä¼šæŒ‰é¡ºåºæ‰§è¡Œ!</code>ä¸€æ¬¡æ€§ã€é¡ºåºæ€§ã€æ’ä»–æ€§!æ‰§è¡Œä¸€ç³»åˆ—çš„å‘½ä»¤</p>
<blockquote>
<p>&mdash; é˜Ÿåˆ— set set set æ‰§è¡Œ &mdash;</p>
</blockquote>
</li>
<li>
<p>Redisäº‹åŠ¡ä¸­å•ä¸ªå‘½ä»¤å…·æœ‰åŸå­æ€§,ä½†æ˜¯äº‹ç‰©ä¸ä¿è¯åŸå­æ€§</p>
</li>
<li>
<p>Redisäº‹åŠ¡æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</p>
</li>
<li>
<p>æ‰€æœ‰çš„å‘½ä»¤åœ¨äº‹åŠ¡ä¸­,å¹¶æ²¡æœ‰é©¬ä¸Šæ‰§è¡Œ,åªæœ‰å‘èµ·æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œ!Exec</p>
</li>
<li>
<p>Redisçš„äº‹åŠ¡:</p>
<blockquote>
<p>å¼€å¯äº‹åŠ¡</p>
</blockquote>
<blockquote>
<p>å‘½ä»¤å…¥é˜Ÿ</p>
</blockquote>
<blockquote>
<p>æ‰§è¡Œäº‹åŠ¡</p>
</blockquote>
</li>
</ul>
<h2 id="æ‰§è¡Œäº‹åŠ¡">æ‰§è¡Œäº‹åŠ¡</h2>
<ul>
<li>
<p>å¼€å¯äº‹ç‰©</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">multi
</code></pre></td></tr></table>
</div>
</div><ul>
<li>è¿™ä¹‹åæ‰€æœ‰çš„å‘½ä»¤éƒ½ä¼šå­˜å‚¨åˆ°ä¸€ä¸ªäº‹ç‰©ä¸­,ç›´åˆ°execæ‰§è¡Œäº‹åŠ¡</li>
</ul>
</li>
<li>
<p>å‘½ä»¤å…¥é˜Ÿ</p>
<blockquote>
<p>set k1 v1</p>
<p>set k2 v2</p>
<p>set k3 v3</p>
</blockquote>
</li>
<li>
<p>æ‰§è¡Œäº‹åŠ¡</p>
<blockquote>
<p>exec</p>
</blockquote>
</li>
<li>
<p>åœ¨æ‰§è¡Œäº‹åŠ¡ä¹‹å‰ç»ˆæ­¢äº‹ç‰©</p>
<blockquote>
<p>discard</p>
</blockquote>
<ul>
<li>è¿™æ—¶å€™ç”±äºäº‹åŠ¡æ²¡æœ‰æ‰§è¡Œ,æ‰€ä»¥ä½¿ç”¨getç­‰æ–¹æ³•è·å–å‰é¢è®¾ç½®çš„å€¼æ˜¯ç©º</li>
</ul>
</li>
</ul>
<h2 id="é”™è¯¯ä¸å¼‚å¸¸">é”™è¯¯ä¸å¼‚å¸¸</h2>
<ul>
<li>
<p>åœ¨javaä¸­,åˆ†ä¸ºè¿è¡Œæ—¶é”™è¯¯å’Œç¼–è¯‘æ—¶é”™è¯¯</p>
<ul>
<li>
<p>ç¼–è¯‘æ—¶é”™è¯¯</p>
<blockquote>
<p>åœ¨è¿è¡Œä¹‹å‰,è¯­å¥ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯,å¯¼è‡´è¿ç¼–è¯‘éƒ½æ— æ³•é€šè¿‡,æ‰€æœ‰è¯­å¥éƒ½æ— æ³•æ‰§è¡Œ(å°±æ˜¯è¯´äº‹åŠ¡ä¸­åªè¦å­˜åœ¨è¯­æ³•é”™è¯¯æ•´ä¸ªäº‹åŠ¡å°±é”™è¯¯)</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">127.0.0.1:6379&gt; multi
OK
127.0.0.1:6379&gt; set k1 v1
QUEUED
127.0.0.1:6379&gt; set k2 v2
QUEUED
127.0.0.1:6379&gt; set k3 v3
QUEUED
127.0.0.1:6379&gt; getset k1
(error) ERR wrong number of arguments for &#39;getset&#39; command
127.0.0.1:6379&gt; exec
(error) EXECABORT Transaction discarded because of previous errors.
127.0.0.1:6379&gt; 
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>è¿è¡Œæ—¶é”™è¯¯</p>
<blockquote>
<p>è¯­å¥è¯­æ³•æ²¡æœ‰é”™è¯¯,ä½†æ˜¯å¯èƒ½å­˜åœ¨é€»è¾‘ä¸­çš„å¼‚å¸¸,è¿™ç§ä¸ä¼šå½±å“åˆ°å…¶ä»–å‘½ä»¤,å…¶ä»–æ­£ç¡®çš„å‘½ä»¤å¯æ­£å¸¸æ‰§è¡Œ(å› ä¸ºäº‹åŠ¡çš„åŸå­æ€§æ— æ³•ç¡®å®š)</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">127.0.0.1:6379&gt; multi
OK
127.0.0.1:6379&gt; set k1 &#34;v1&#34;
QUEUED
127.0.0.1:6379&gt; incr k1
QUEUED
127.0.0.1:6379&gt; set k2 v2
QUEUED
127.0.0.1:6379&gt; set k3 v3
QUEUED
127.0.0.1:6379&gt; exec
1) OK
2) (error) ERR value is not an integer or out of range
3) OK
4) OK
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
</ul>
<h1 id="step11ä½¿ç”¨jedisæ“ä½œredis">Step11.ä½¿ç”¨Jedisæ“ä½œRedis</h1>
<ul>
<li>
<p>Jedisæ˜¯redisçš„javaç‰ˆæœ¬çš„å®¢æˆ·ç«¯å®ç°</p>
</li>
<li>
<p>ä½¿ç”¨jedis</p>
</li>
<li>
<p>åˆ›å»ºä¸€ä¸ªæ™®é€šçš„mavené¡¹ç›®</p>
</li>
<li>
<p>å¯¼å…¥ä¾èµ–</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="nt">&lt;dependencies&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>redis.clients<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>jedis<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>3.2.0<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;dependency&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>com.alibaba<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>fastjson<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>1.2.62<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;/dependency&gt;</span>
<span class="nt">&lt;/dependencies&gt;</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>fastjsonæˆ‘ä¹Ÿä¸çŸ¥é“æ˜¯å¹²ä»€ä¹ˆçš„,è¯´æ˜¯å­˜æ•°æ®(jsonå¯¹è±¡)</p>
</blockquote>
</li>
<li>
<p>ç¼–å†™æµ‹è¯•ç±»</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>
  
  
<span class="kn">import</span> <span class="nn">redis.clients.jedis.Jedis</span><span class="o">;</span>
  
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JedisTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Jedis</span> <span class="n">jedis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Jedis</span><span class="o">(</span><span class="s">&#34;127.0.0.1&#34;</span><span class="o">,</span><span class="n">6379</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jedis</span><span class="o">.</span><span class="na">ping</span><span class="o">());</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<ul>
<li>
<p>å…¶ä»–æ–¹æ³•éƒ½ç›´æ¥è¯»APIå°±å¥½äº†</p>
<blockquote>
<p>å¾ˆå¤šæ–¹æ³•éƒ½å­¦è¿‡,å‘½åçš„å…³é”®å­—å’Œæ–¹æ³•åç»å¤§å¤šæ•°éƒ½æ˜¯ä¸€æ ·çš„</p>
</blockquote>
</li>
</ul>
<h1 id="step12jedisæ“ä½œredisç†è§£redisä¸­çš„äº‹åŠ¡">Step12.Jedisæ“ä½œRedisç†è§£Redisä¸­çš„äº‹åŠ¡</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">com.alibaba.fastjson.JSONObject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.Jedis</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.Transaction</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JedisTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Jedis</span> <span class="n">jedis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Jedis</span><span class="o">(</span><span class="s">&#34;127.0.0.1&#34;</span><span class="o">,</span><span class="n">6379</span><span class="o">);</span>
        
        <span class="c1">//ä¸ºäº†ä¸è®©ä¸Šæ¬¡setçš„ç»“æœå½±å“ä¸‹æ¬¡çš„æ“ä½œç»“æœ,æ‰€ä»¥æ¯æ¬¡å¯åŠ¨å‰å…ˆå°†å½“å‰æ•°æ®åº“flushDBä¸€ä¸‹
</span><span class="c1"></span>        <span class="n">jedis</span><span class="o">.</span><span class="na">flushDB</span><span class="o">();</span>
<span class="c1">//        System.ut.println(jedis.ping());
</span><span class="c1"></span>        
        <span class="c1">//å¼€å¯äº‹åŠ¡
</span><span class="c1"></span>        <span class="n">Transaction</span> <span class="n">multi</span> <span class="o">=</span> <span class="n">jedis</span><span class="o">.</span><span class="na">multi</span><span class="o">();</span>
        
        <span class="c1">//å°è£…ä¸€ä¸ªJSONå¯¹è±¡
</span><span class="c1"></span>        <span class="n">JSONObject</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">,</span><span class="s">&#34;zhangyuhang&#34;</span><span class="o">);</span>
        <span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">,</span><span class="s">&#34;123456&#34;</span><span class="o">);</span>
        <span class="c1">//å°†JSONå¯¹è±¡è½¬æˆJSONç±»å‹å­—ç¬¦ä¸²
</span><span class="c1"></span>        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">toJSONString</span><span class="o">();</span>

        <span class="k">try</span><span class="o">{</span>
            <span class="n">multi</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">,</span><span class="n">result</span><span class="o">);</span>
            <span class="n">multi</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">,</span><span class="n">result</span><span class="o">);</span>
            <span class="n">multi</span><span class="o">.</span><span class="na">exec</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">finally</span><span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jedis</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jedis</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">));</span>
            <span class="n">jedis</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>å½“äº‹åŠ¡ä¸­å‡ºç°å¼‚å¸¸æ—¶å€™,è¿™å’Œçº¯Redisä¸åŒ,Javaä¸­å­˜åœ¨å¼‚å¸¸æ˜¯ç›´æ¥ä¸å¾€ä¸‹è¿è¡Œ,ç›´æ¥é€€å‡ºçš„,ä¸ç®¡ä½ ä»€ä¹ˆäº‹åŠ¡ææ²¡æäº¤</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">com.alibaba.fastjson.JSONObject</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.Jedis</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">redis.clients.jedis.Transaction</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">JedisTest</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">Jedis</span> <span class="n">jedis</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Jedis</span><span class="o">(</span><span class="s">&#34;127.0.0.1&#34;</span><span class="o">,</span><span class="n">6379</span><span class="o">);</span>
        <span class="n">jedis</span><span class="o">.</span><span class="na">flushDB</span><span class="o">();</span>
<span class="c1">//        System.ut.println(jedis.ping());
</span><span class="c1"></span>        <span class="n">Transaction</span> <span class="n">multi</span> <span class="o">=</span> <span class="n">jedis</span><span class="o">.</span><span class="na">multi</span><span class="o">();</span>
        <span class="n">JSONObject</span> <span class="n">jsonObject</span> <span class="o">=</span> <span class="k">new</span> <span class="n">JSONObject</span><span class="o">();</span>
        <span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">,</span><span class="s">&#34;zhangyuhang&#34;</span><span class="o">);</span>
        <span class="n">jsonObject</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">,</span><span class="s">&#34;123456&#34;</span><span class="o">);</span>

        <span class="n">String</span> <span class="n">result</span> <span class="o">=</span> <span class="n">jsonObject</span><span class="o">.</span><span class="na">toJSONString</span><span class="o">();</span>

        <span class="k">try</span><span class="o">{</span>
            <span class="n">multi</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">,</span><span class="n">result</span><span class="o">);</span>
            <span class="n">multi</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">,</span><span class="n">result</span><span class="o">);</span>
            <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">1</span><span class="o">/</span><span class="n">0</span><span class="o">;</span>
            <span class="n">multi</span><span class="o">.</span><span class="na">exec</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">catch</span><span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">){</span>
            <span class="c1">//multi.discard();
</span><span class="c1"></span>            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span> <span class="k">finally</span><span class="o">{</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jedis</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">));</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">jedis</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;password&#34;</span><span class="o">));</span>
            <span class="n">jedis</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>è¿™é‡Œå¦‚æœæœ‰multi.discard();è¿è¡Œç»“æœå°±æ˜¯null</p>
<p>å¦‚æœæ²¡æœ‰,å°±ä»€ä¹ˆéƒ½æ²¡æœ‰</p>
<p>å› ä¸ºå‘ç”Ÿå¼‚å¸¸å¦‚æœä¸å–æ¶ˆäº‹åŠ¡,javaä¸­æ²¡æ‰§è¡Œjedis.exec();,ä½ å°±ç®—getäº†,è¿™ä¸ªjedisè¿˜æ˜¯åœ¨äº‹åŠ¡ä¸­çš„,è·å–ä¹Ÿä¸ä¼šç»™ä½ ç»“æœ</p>
<p>åœ¨äº‹åŠ¡ä¸­,getä¹Ÿç®—äº‹åŠ¡,åœ¨äº‹åŠ¡ä¸­getå®ƒä¸ä¼šç»™ä½ ç»“æœçš„,ç›´åˆ°ä½ æ‰§è¡Œäº‹åŠ¡,å®ƒæ‰ä¼šå°†æ‰€æœ‰ä½ getçš„ç»“æœä¸€èµ·ç»™ä½ </p>
<p>æ‰€ä»¥åœ¨è¿™ä¸ªä»£ç ä¸­,å‰ææ˜¯int i = 1 / 0;è¿™ç§å¼‚å¸¸ç›´æ¥ä»è¿™è¡Œä»£ç è·³å‡ºtry,æ°¸è¿œä¸ä¼šæ‰§è¡Œmulti.exec();</p>
<p>å¦‚æœæ²¡æœ‰discard,å°±æ˜¯è¿˜åœ¨äº‹åŠ¡ä¸­,ä½ åœ¨finallyä¸­(ä»»ä½•åœ°æ–¹)getæ˜¯æ²¡æœ‰ç»“æœçš„</p>
<p>å¦‚æœæœ‰discard,å®ƒæ²¡æœ‰æ‰§è¡Œäº‹åŠ¡,ä½†æ˜¯å®ƒé€€å‡ºäº‹åŠ¡äº†,æ‰€ä»¥å®ƒä¸æ˜¯åœ¨å½“å‰äº‹åŠ¡ä¸­æŸ¥æ‰¾,è€Œæ˜¯åœ¨å½“å‰æ•´ä¸ªæ•°æ®åº“ä¸­æŸ¥æ‰¾.ä¹‹å‰flushDBè¿‡,è€Œä¸”äº‹åŠ¡åˆæ²¡æœ‰æäº¤,å½“ç„¶æ˜¯nulläº†(ä¸å­˜åœ¨åƒäº‹åŠ¡ä¸­getæœ‰æ²¡æœ‰ç»“æœçš„æƒ…å†µ)</p>
</blockquote>
<hr>
<h1 id="step13springbootæ•´åˆredis">Step13.SpringBootæ•´åˆRedis</h1>
<ul>
<li>
<p>æ–°å»ºSpringBooté¡¹ç›®</p>
<p><img src="https://img-blog.csdnimg.cn/8a13149ae3c644319c09529e5d351ad7.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<blockquote>
<p>ä¾èµ–å‹¾é€‰ä¸ŠRedis(å³è¾¹ä»ä¸Šå¾€ä¸‹æ•°ç¬¬ä¸€ä¸ª)</p>
</blockquote>
</li>
</ul>
<p><code>application.properties</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"># é…ç½®ipå’Œç«¯å£å·
spring.redis.host=127.0.0.1
spring.redis.port=6379
</code></pre></td></tr></table>
</div>
</div><ul>
<li>JDBCä½¿ç”¨JDBCTemplate,Redisç›¸ä¼¼,Redisä½¿ç”¨RedisTemplate</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.code</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.core.RedisTemplate</span><span class="o">;</span>

<span class="nd">@SpringBootTest</span>
<span class="kd">class</span> <span class="nc">SpringBootRedisApplicationTests</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RedisTemplate</span> <span class="n">redisTemplate</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">contextLoads</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">,</span><span class="s">&#34;zhangyuhang&#34;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>ç»“æœæ˜¯æ­£ç¡®çš„,ä½†æ˜¯è¿™æ—¶å€™é—®é¢˜å°±æ¥äº†,åœ¨Ubuntuç»ˆç«¯ä¸­æŸ¥çœ‹keys *</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">127.0.0.1:6379&gt; keys *
1) &#34;\xac\xed\x00\x05t\x00\busername&#34;
127.0.0.1:6379&gt; 
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>æ˜¾ç„¶ç»“æœæ˜¯ä¹±ç çš„</p>
</li>
<li>
<p>SpringBooté›†æˆRedis,æ— è®ºæ˜¯åŸºæœ¬ç±»å‹è¿˜æ˜¯å¯¹è±¡æ•°æ®,éƒ½æ˜¯éœ€è¦å°†æ•°æ®åºåˆ—åŒ–çš„</p>
</li>
<li>
<p>ç°åœ¨setä¸€ä¸ªå¯¹è±¡</p>
</li>
</ul>
<p><code>User.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.pojo</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">lombok.AllArgsConstructor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.Data</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">lombok.NoArgsConstructor</span><span class="o">;</span>

<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Data</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">User</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">username</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">password</span><span class="o">;</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><p><code>SpringBootRedisApplicationTest.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.core.JsonProcessingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.core.RedisTemplate</span><span class="o">;</span>

<span class="nd">@SpringBootTest</span>
<span class="kd">class</span> <span class="nc">SpringBootRedisApplicationTests</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RedisTemplate</span> <span class="n">redisTemplate</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">contextLoads</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">JsonProcessingException</span> <span class="o">{</span>
        <span class="n">User</span> <span class="n">user</span> <span class="o">=</span> <span class="k">new</span> <span class="n">User</span><span class="o">(</span><span class="s">&#34;zhangyuhang&#34;</span><span class="o">,</span><span class="s">&#34;!23456&#34;</span><span class="o">);</span>
        <span class="n">String</span> <span class="n">jsonUser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">().</span><span class="na">writeValueAsString</span><span class="o">(</span><span class="n">user</span><span class="o">);</span>
        <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;user&#34;</span><span class="o">,</span><span class="n">jsonUser</span><span class="o">);</span>
    <span class="o">}</span>

<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>æˆ‘åœ¨è¿™é‡ŒObjectMapperç±»å‹æ ¹æœ¬æ— æ³•åŠ è½½,å¥½åƒæ˜¯æ²¡å¯¼å…¥ä»€ä¹ˆä¾èµ–</li>
<li>å¯¹æ¯”äº†ä¹‹å‰æˆåŠŸçš„é¡¹ç›®,ä¸¤ä¸ªpom.xmlå¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«</li>
<li>ä¸ç®¡é‚£ä¹ˆå¤š,ç›´æ¥æŠŠæˆåŠŸçš„ä¾èµ–å…¨æ‹¿è¿‡æ¥</li>
</ul>
<p><code>pom.xml</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
<span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
    <span class="nt">&lt;parent&gt;</span>
        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
        <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;version&gt;</span>2.5.6<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;relativePath/&gt;</span> <span class="c">&lt;!-- lookup parent from repository --&gt;</span>
    <span class="nt">&lt;/parent&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.zhang<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>redis-test<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>0.0.1-SNAPSHOT<span class="nt">&lt;/version&gt;</span>
    <span class="nt">&lt;name&gt;</span>redis-test<span class="nt">&lt;/name&gt;</span>
    <span class="nt">&lt;description&gt;</span>Demo project for Spring Boot<span class="nt">&lt;/description&gt;</span>
    <span class="nt">&lt;properties&gt;</span>
        <span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
        <span class="nt">&lt;repackage.classifier/&gt;</span>
        <span class="nt">&lt;spring-native.version&gt;</span>0.10.4<span class="nt">&lt;/spring-native.version&gt;</span>
    <span class="nt">&lt;/properties&gt;</span>
    <span class="nt">&lt;dependencies&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-data-redis<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.experimental<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-native<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;version&gt;</span>${spring-native.version}<span class="nt">&lt;/version&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>

        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-boot-devtools<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;scope&gt;</span>runtime<span class="nt">&lt;/scope&gt;</span>
            <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-boot-configuration-processor<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;optional&gt;</span>true<span class="nt">&lt;/optional&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
        <span class="nt">&lt;dependency&gt;</span>
            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
        <span class="nt">&lt;/dependency&gt;</span>
    <span class="nt">&lt;/dependencies&gt;</span>

    <span class="nt">&lt;build&gt;</span>
        <span class="nt">&lt;plugins&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;configuration&gt;</span>
                    <span class="nt">&lt;excludes&gt;</span>
                        <span class="nt">&lt;exclude&gt;</span>
                            <span class="nt">&lt;groupId&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
                            <span class="nt">&lt;artifactId&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
                        <span class="nt">&lt;/exclude&gt;</span>
                    <span class="nt">&lt;/excludes&gt;</span>
                    <span class="nt">&lt;classifier&gt;</span>${repackage.classifier}<span class="nt">&lt;/classifier&gt;</span>
                    <span class="nt">&lt;image&gt;</span>
                        <span class="nt">&lt;builder&gt;</span>paketobuildpacks/builder:tiny<span class="nt">&lt;/builder&gt;</span>
                        <span class="nt">&lt;env&gt;</span>
                            <span class="nt">&lt;BP_NATIVE_IMAGE&gt;</span>true<span class="nt">&lt;/BP_NATIVE_IMAGE&gt;</span>
                        <span class="nt">&lt;/env&gt;</span>
                    <span class="nt">&lt;/image&gt;</span>
                <span class="nt">&lt;/configuration&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
            <span class="nt">&lt;plugin&gt;</span>
                <span class="nt">&lt;groupId&gt;</span>org.springframework.experimental<span class="nt">&lt;/groupId&gt;</span>
                <span class="nt">&lt;artifactId&gt;</span>spring-aot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
                <span class="nt">&lt;version&gt;</span>${spring-native.version}<span class="nt">&lt;/version&gt;</span>
                <span class="nt">&lt;executions&gt;</span>
                    <span class="nt">&lt;execution&gt;</span>
                        <span class="nt">&lt;id&gt;</span>test-generate<span class="nt">&lt;/id&gt;</span>
                        <span class="nt">&lt;goals&gt;</span>
                            <span class="nt">&lt;goal&gt;</span>test-generate<span class="nt">&lt;/goal&gt;</span>
                        <span class="nt">&lt;/goals&gt;</span>
                    <span class="nt">&lt;/execution&gt;</span>
                    <span class="nt">&lt;execution&gt;</span>
                        <span class="nt">&lt;id&gt;</span>generate<span class="nt">&lt;/id&gt;</span>
                        <span class="nt">&lt;goals&gt;</span>
                            <span class="nt">&lt;goal&gt;</span>generate<span class="nt">&lt;/goal&gt;</span>
                        <span class="nt">&lt;/goals&gt;</span>
                    <span class="nt">&lt;/execution&gt;</span>
                <span class="nt">&lt;/executions&gt;</span>
            <span class="nt">&lt;/plugin&gt;</span>
        <span class="nt">&lt;/plugins&gt;</span>
    <span class="nt">&lt;/build&gt;</span>
    <span class="nt">&lt;repositories&gt;</span>
        <span class="nt">&lt;repository&gt;</span>
            <span class="nt">&lt;id&gt;</span>spring-releases<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;name&gt;</span>Spring Releases<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;url&gt;</span>https://repo.spring.io/release<span class="nt">&lt;/url&gt;</span>
            <span class="nt">&lt;snapshots&gt;</span>
                <span class="nt">&lt;enabled&gt;</span>false<span class="nt">&lt;/enabled&gt;</span>
            <span class="nt">&lt;/snapshots&gt;</span>
        <span class="nt">&lt;/repository&gt;</span>
    <span class="nt">&lt;/repositories&gt;</span>
    <span class="nt">&lt;pluginRepositories&gt;</span>
        <span class="nt">&lt;pluginRepository&gt;</span>
            <span class="nt">&lt;id&gt;</span>spring-releases<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;name&gt;</span>Spring Releases<span class="nt">&lt;/name&gt;</span>
            <span class="nt">&lt;url&gt;</span>https://repo.spring.io/release<span class="nt">&lt;/url&gt;</span>
            <span class="nt">&lt;snapshots&gt;</span>
                <span class="nt">&lt;enabled&gt;</span>false<span class="nt">&lt;/enabled&gt;</span>
            <span class="nt">&lt;/snapshots&gt;</span>
        <span class="nt">&lt;/pluginRepository&gt;</span>
    <span class="nt">&lt;/pluginRepositories&gt;</span>

    <span class="nt">&lt;profiles&gt;</span>
        <span class="nt">&lt;profile&gt;</span>
            <span class="nt">&lt;id&gt;</span>native<span class="nt">&lt;/id&gt;</span>
            <span class="nt">&lt;properties&gt;</span>
                <span class="nt">&lt;repackage.classifier&gt;</span>exec<span class="nt">&lt;/repackage.classifier&gt;</span>
                <span class="nt">&lt;native-buildtools.version&gt;</span>0.9.3<span class="nt">&lt;/native-buildtools.version&gt;</span>
            <span class="nt">&lt;/properties&gt;</span>
            <span class="nt">&lt;dependencies&gt;</span>
                <span class="nt">&lt;dependency&gt;</span>
                    <span class="nt">&lt;groupId&gt;</span>org.graalvm.buildtools<span class="nt">&lt;/groupId&gt;</span>
                    <span class="nt">&lt;artifactId&gt;</span>junit-platform-native<span class="nt">&lt;/artifactId&gt;</span>
                    <span class="nt">&lt;version&gt;</span>${native-buildtools.version}<span class="nt">&lt;/version&gt;</span>
                    <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
                <span class="nt">&lt;/dependency&gt;</span>
            <span class="nt">&lt;/dependencies&gt;</span>
            <span class="nt">&lt;build&gt;</span>
                <span class="nt">&lt;plugins&gt;</span>
                    <span class="nt">&lt;plugin&gt;</span>
                        <span class="nt">&lt;groupId&gt;</span>org.graalvm.buildtools<span class="nt">&lt;/groupId&gt;</span>
                        <span class="nt">&lt;artifactId&gt;</span>native-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
                        <span class="nt">&lt;version&gt;</span>${native-buildtools.version}<span class="nt">&lt;/version&gt;</span>
                        <span class="nt">&lt;executions&gt;</span>
                            <span class="nt">&lt;execution&gt;</span>
                                <span class="nt">&lt;id&gt;</span>test-native<span class="nt">&lt;/id&gt;</span>
                                <span class="nt">&lt;phase&gt;</span>test<span class="nt">&lt;/phase&gt;</span>
                                <span class="nt">&lt;goals&gt;</span>
                                    <span class="nt">&lt;goal&gt;</span>test<span class="nt">&lt;/goal&gt;</span>
                                <span class="nt">&lt;/goals&gt;</span>
                            <span class="nt">&lt;/execution&gt;</span>
                            <span class="nt">&lt;execution&gt;</span>
                                <span class="nt">&lt;id&gt;</span>build-native<span class="nt">&lt;/id&gt;</span>
                                <span class="nt">&lt;phase&gt;</span>package<span class="nt">&lt;/phase&gt;</span>
                                <span class="nt">&lt;goals&gt;</span>
                                    <span class="nt">&lt;goal&gt;</span>build<span class="nt">&lt;/goal&gt;</span>
                                <span class="nt">&lt;/goals&gt;</span>
                            <span class="nt">&lt;/execution&gt;</span>
                        <span class="nt">&lt;/executions&gt;</span>
                    <span class="nt">&lt;/plugin&gt;</span>
                <span class="nt">&lt;/plugins&gt;</span>
            <span class="nt">&lt;/build&gt;</span>
        <span class="nt">&lt;/profile&gt;</span>
    <span class="nt">&lt;/profiles&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>ä¸Šé¢è¯´setå¯¹è±¡éœ€è¦åºåˆ—åŒ–,ä½¿ç”¨RedisTemplate</li>
<li>ä½†æ˜¯æ®ç‹‚ç¥è¯´åœ¨å·¥ä½œå¼€å‘ä¸­ç»å¸¸è¦ä½¿ç”¨åˆ°è‡ªå·±å°è£…çš„RedisTemplate</li>
<li>åœ¨RedisConfig.javaä¸­å°†è‡ªå·±ç¼–å†™çš„redisTemplateæ–¹æ³•æ³¨å†Œåˆ°@Beanä¸­,è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªè‡ªå®šä¹‰çš„RedisTemplateå¯¹è±¡</li>
</ul>
<p><code>RedisConfig.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.config</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.annotation.JsonAutoDetect</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.annotation.PropertyAccessor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.connection.RedisConnectionFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.core.RedisTemplate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.serializer.StringRedisSerializer</span><span class="o">;</span>

<span class="nd">@Configuration</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisConfig</span> <span class="o">{</span>

    <span class="nd">@Bean</span>
    <span class="kd">public</span> <span class="n">RedisTemplate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">redisTemplate</span><span class="o">(</span><span class="n">RedisConnectionFactory</span> <span class="n">redisConnectionFactory</span><span class="o">){</span>
        <span class="c1">//newä¸€ä¸ªRedisTemplate,å¹¶è®¾ç½®è¿æ¥å·¥
</span><span class="c1"></span>        <span class="n">RedisTemplate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">template</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RedisTemplate</span><span class="o">&lt;&gt;();</span>
        <span class="n">template</span><span class="o">.</span><span class="na">setConnectionFactory</span><span class="o">(</span><span class="n">redisConnectionFactory</span><span class="o">);</span>

        <span class="c1">//RedisTemplateçš„keyä½¿ç”¨Stringåºåˆ—åŒ–æ–¹å¼,valueä½¿ç”¨jsonåºåˆ—åŒ–æ–¹å¼
</span><span class="c1"></span>
        <span class="c1">//åˆ›é€ ä¸¤è€…
</span><span class="c1"></span>
        <span class="c1">//è®¾ç½®jsonåºåˆ—åŒ–
</span><span class="c1"></span>        <span class="c1">//------------------------------------------------------------------------------------------------&gt;
</span><span class="c1"></span>        <span class="c1">//jsonå°±æ˜¯å°†å¯¹è±¡åºåˆ—åŒ–,æ‰€ä»¥éœ€è¦ä¸€ä¸ªObject.class
</span><span class="c1"></span>        <span class="n">Jackson2JsonRedisSerializer</span> <span class="n">jackson2JsonRedisSerializer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Jackson2JsonRedisSerializer</span><span class="o">(</span><span class="n">Object</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="c1">//å°†å¯¹è±¡åºåˆ—åŒ–å°±æ˜¯ä½¿ç”¨jsonçš„ObjectMapperå°†å¯¹è±¡å°è£…
</span><span class="c1"></span>        <span class="n">ObjectMapper</span> <span class="n">objectMapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ObjectMapper</span><span class="o">();</span>
        <span class="n">objectMapper</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">PropertyAccessor</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">JsonAutoDetect</span><span class="o">.</span><span class="na">Visibility</span><span class="o">.</span><span class="na">ANY</span><span class="o">);</span>
        <span class="n">objectMapper</span><span class="o">.</span><span class="na">enableDefaultTyping</span><span class="o">(</span><span class="n">ObjectMapper</span><span class="o">.</span><span class="na">DefaultTyping</span><span class="o">.</span><span class="na">NON_FINAL</span><span class="o">);</span>

        <span class="c1">//å°†è®¾ç½®å¥½çš„ObjectMapperæ”¾ç½®åˆ°Jackson2JsonRedisSerializerä¸­
</span><span class="c1"></span>        <span class="n">jackson2JsonRedisSerializer</span><span class="o">.</span><span class="na">setObjectMapper</span><span class="o">(</span><span class="n">objectMapper</span><span class="o">);</span>
        <span class="c1">//-------------------------------------------------------------------------------------------------&gt;
</span><span class="c1"></span>

        <span class="c1">//è®¾ç½®Stringåºåˆ—åŒ–
</span><span class="c1"></span>        <span class="c1">//-------------------------------------------------------------------------------------------------&gt;
</span><span class="c1"></span>        <span class="n">StringRedisSerializer</span> <span class="n">stringRedisSerializer</span> <span class="o">=</span> <span class="k">new</span> <span class="n">StringRedisSerializer</span><span class="o">();</span>
        <span class="c1">//-------------------------------------------------------------------------------------------------&gt;
</span><span class="c1"></span>

        <span class="c1">//è®¾ç½®Stringçš„keyçš„åºåˆ—åŒ–ä¸ºStringRedisSerializer
</span><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setKeySerializer</span><span class="o">(</span><span class="n">stringRedisSerializer</span><span class="o">);</span>

        <span class="c1">//è®¾ç½®Stringçš„valueçš„åºåˆ—åŒ–ä¸ºjson
</span><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setValueSerializer</span><span class="o">(</span><span class="n">jackson2JsonRedisSerializer</span><span class="o">);</span>

        <span class="c1">//è®¾ç½®Stringçš„valueçš„åºåˆ—åŒ–ä¸ºStringRedisSerializer
</span><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setHashKeySerializer</span><span class="o">(</span><span class="n">stringRedisSerializer</span><span class="o">);</span>

        <span class="c1">//è®¾ç½®hashçš„valueçš„åºåˆ—åŒ–ä¸ºjson
</span><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">setHashValueSerializer</span><span class="o">(</span><span class="n">jackson2JsonRedisSerializer</span><span class="o">);</span>

        <span class="c1">//å°†è®¾ç½®å¥½çš„templateæ‰€æœ‰å±æ€§è®¾ç½®è¿›å»
</span><span class="c1"></span>        <span class="n">template</span><span class="o">.</span><span class="na">afterPropertiesSet</span><span class="o">();</span>

        <span class="k">return</span> <span class="n">template</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>è¿™æ˜¯å·¥å…·ç±»,ç›´æ¥æ‹¿è¿‡æ¥ç”¨å°±å¥½</p>
</blockquote>
<ul>
<li>ä½†æ˜¯é€šå¸¸ä¸ä¼šè¿™æ ·ç›´æ¥æ,è€Œæ˜¯ä¼šè¿›ä¸€æ­¥å°è£…,å°è£…æˆUtilsç±»å·¥å…·ç±»,è‡ªå®šä¹‰RedisTemplateä¸­è‡ªå®šä¹‰çš„æ‰€æœ‰æ•°æ®åº“æ“ä½œæ–¹æ³•</li>
</ul>
<p><code>RedisUtil.java</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span><span class="lnt">188
</span><span class="lnt">189
</span><span class="lnt">190
</span><span class="lnt">191
</span><span class="lnt">192
</span><span class="lnt">193
</span><span class="lnt">194
</span><span class="lnt">195
</span><span class="lnt">196
</span><span class="lnt">197
</span><span class="lnt">198
</span><span class="lnt">199
</span><span class="lnt">200
</span><span class="lnt">201
</span><span class="lnt">202
</span><span class="lnt">203
</span><span class="lnt">204
</span><span class="lnt">205
</span><span class="lnt">206
</span><span class="lnt">207
</span><span class="lnt">208
</span><span class="lnt">209
</span><span class="lnt">210
</span><span class="lnt">211
</span><span class="lnt">212
</span><span class="lnt">213
</span><span class="lnt">214
</span><span class="lnt">215
</span><span class="lnt">216
</span><span class="lnt">217
</span><span class="lnt">218
</span><span class="lnt">219
</span><span class="lnt">220
</span><span class="lnt">221
</span><span class="lnt">222
</span><span class="lnt">223
</span><span class="lnt">224
</span><span class="lnt">225
</span><span class="lnt">226
</span><span class="lnt">227
</span><span class="lnt">228
</span><span class="lnt">229
</span><span class="lnt">230
</span><span class="lnt">231
</span><span class="lnt">232
</span><span class="lnt">233
</span><span class="lnt">234
</span><span class="lnt">235
</span><span class="lnt">236
</span><span class="lnt">237
</span><span class="lnt">238
</span><span class="lnt">239
</span><span class="lnt">240
</span><span class="lnt">241
</span><span class="lnt">242
</span><span class="lnt">243
</span><span class="lnt">244
</span><span class="lnt">245
</span><span class="lnt">246
</span><span class="lnt">247
</span><span class="lnt">248
</span><span class="lnt">249
</span><span class="lnt">250
</span><span class="lnt">251
</span><span class="lnt">252
</span><span class="lnt">253
</span><span class="lnt">254
</span><span class="lnt">255
</span><span class="lnt">256
</span><span class="lnt">257
</span><span class="lnt">258
</span><span class="lnt">259
</span><span class="lnt">260
</span><span class="lnt">261
</span><span class="lnt">262
</span><span class="lnt">263
</span><span class="lnt">264
</span><span class="lnt">265
</span><span class="lnt">266
</span><span class="lnt">267
</span><span class="lnt">268
</span><span class="lnt">269
</span><span class="lnt">270
</span><span class="lnt">271
</span><span class="lnt">272
</span><span class="lnt">273
</span><span class="lnt">274
</span><span class="lnt">275
</span><span class="lnt">276
</span><span class="lnt">277
</span><span class="lnt">278
</span><span class="lnt">279
</span><span class="lnt">280
</span><span class="lnt">281
</span><span class="lnt">282
</span><span class="lnt">283
</span><span class="lnt">284
</span><span class="lnt">285
</span><span class="lnt">286
</span><span class="lnt">287
</span><span class="lnt">288
</span><span class="lnt">289
</span><span class="lnt">290
</span><span class="lnt">291
</span><span class="lnt">292
</span><span class="lnt">293
</span><span class="lnt">294
</span><span class="lnt">295
</span><span class="lnt">296
</span><span class="lnt">297
</span><span class="lnt">298
</span><span class="lnt">299
</span><span class="lnt">300
</span><span class="lnt">301
</span><span class="lnt">302
</span><span class="lnt">303
</span><span class="lnt">304
</span><span class="lnt">305
</span><span class="lnt">306
</span><span class="lnt">307
</span><span class="lnt">308
</span><span class="lnt">309
</span><span class="lnt">310
</span><span class="lnt">311
</span><span class="lnt">312
</span><span class="lnt">313
</span><span class="lnt">314
</span><span class="lnt">315
</span><span class="lnt">316
</span><span class="lnt">317
</span><span class="lnt">318
</span><span class="lnt">319
</span><span class="lnt">320
</span><span class="lnt">321
</span><span class="lnt">322
</span><span class="lnt">323
</span><span class="lnt">324
</span><span class="lnt">325
</span><span class="lnt">326
</span><span class="lnt">327
</span><span class="lnt">328
</span><span class="lnt">329
</span><span class="lnt">330
</span><span class="lnt">331
</span><span class="lnt">332
</span><span class="lnt">333
</span><span class="lnt">334
</span><span class="lnt">335
</span><span class="lnt">336
</span><span class="lnt">337
</span><span class="lnt">338
</span><span class="lnt">339
</span><span class="lnt">340
</span><span class="lnt">341
</span><span class="lnt">342
</span><span class="lnt">343
</span><span class="lnt">344
</span><span class="lnt">345
</span><span class="lnt">346
</span><span class="lnt">347
</span><span class="lnt">348
</span><span class="lnt">349
</span><span class="lnt">350
</span><span class="lnt">351
</span><span class="lnt">352
</span><span class="lnt">353
</span><span class="lnt">354
</span><span class="lnt">355
</span><span class="lnt">356
</span><span class="lnt">357
</span><span class="lnt">358
</span><span class="lnt">359
</span><span class="lnt">360
</span><span class="lnt">361
</span><span class="lnt">362
</span><span class="lnt">363
</span><span class="lnt">364
</span><span class="lnt">365
</span><span class="lnt">366
</span><span class="lnt">367
</span><span class="lnt">368
</span><span class="lnt">369
</span><span class="lnt">370
</span><span class="lnt">371
</span><span class="lnt">372
</span><span class="lnt">373
</span><span class="lnt">374
</span><span class="lnt">375
</span><span class="lnt">376
</span><span class="lnt">377
</span><span class="lnt">378
</span><span class="lnt">379
</span><span class="lnt">380
</span><span class="lnt">381
</span><span class="lnt">382
</span><span class="lnt">383
</span><span class="lnt">384
</span><span class="lnt">385
</span><span class="lnt">386
</span><span class="lnt">387
</span><span class="lnt">388
</span><span class="lnt">389
</span><span class="lnt">390
</span><span class="lnt">391
</span><span class="lnt">392
</span><span class="lnt">393
</span><span class="lnt">394
</span><span class="lnt">395
</span><span class="lnt">396
</span><span class="lnt">397
</span><span class="lnt">398
</span><span class="lnt">399
</span><span class="lnt">400
</span><span class="lnt">401
</span><span class="lnt">402
</span><span class="lnt">403
</span><span class="lnt">404
</span><span class="lnt">405
</span><span class="lnt">406
</span><span class="lnt">407
</span><span class="lnt">408
</span><span class="lnt">409
</span><span class="lnt">410
</span><span class="lnt">411
</span><span class="lnt">412
</span><span class="lnt">413
</span><span class="lnt">414
</span><span class="lnt">415
</span><span class="lnt">416
</span><span class="lnt">417
</span><span class="lnt">418
</span><span class="lnt">419
</span><span class="lnt">420
</span><span class="lnt">421
</span><span class="lnt">422
</span><span class="lnt">423
</span><span class="lnt">424
</span><span class="lnt">425
</span><span class="lnt">426
</span><span class="lnt">427
</span><span class="lnt">428
</span><span class="lnt">429
</span><span class="lnt">430
</span><span class="lnt">431
</span><span class="lnt">432
</span><span class="lnt">433
</span><span class="lnt">434
</span><span class="lnt">435
</span><span class="lnt">436
</span><span class="lnt">437
</span><span class="lnt">438
</span><span class="lnt">439
</span><span class="lnt">440
</span><span class="lnt">441
</span><span class="lnt">442
</span><span class="lnt">443
</span><span class="lnt">444
</span><span class="lnt">445
</span><span class="lnt">446
</span><span class="lnt">447
</span><span class="lnt">448
</span><span class="lnt">449
</span><span class="lnt">450
</span><span class="lnt">451
</span><span class="lnt">452
</span><span class="lnt">453
</span><span class="lnt">454
</span><span class="lnt">455
</span><span class="lnt">456
</span><span class="lnt">457
</span><span class="lnt">458
</span><span class="lnt">459
</span><span class="lnt">460
</span><span class="lnt">461
</span><span class="lnt">462
</span><span class="lnt">463
</span><span class="lnt">464
</span><span class="lnt">465
</span><span class="lnt">466
</span><span class="lnt">467
</span><span class="lnt">468
</span><span class="lnt">469
</span><span class="lnt">470
</span><span class="lnt">471
</span><span class="lnt">472
</span><span class="lnt">473
</span><span class="lnt">474
</span><span class="lnt">475
</span><span class="lnt">476
</span><span class="lnt">477
</span><span class="lnt">478
</span><span class="lnt">479
</span><span class="lnt">480
</span><span class="lnt">481
</span><span class="lnt">482
</span><span class="lnt">483
</span><span class="lnt">484
</span><span class="lnt">485
</span><span class="lnt">486
</span><span class="lnt">487
</span><span class="lnt">488
</span><span class="lnt">489
</span><span class="lnt">490
</span><span class="lnt">491
</span><span class="lnt">492
</span><span class="lnt">493
</span><span class="lnt">494
</span><span class="lnt">495
</span><span class="lnt">496
</span><span class="lnt">497
</span><span class="lnt">498
</span><span class="lnt">499
</span><span class="lnt">500
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang.utils</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.core.RedisTemplate</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Component</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.util.CollectionUtils</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Collection</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Map</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Set</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.concurrent.TimeUnit</span><span class="o">;</span>

<span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">RedisUtil</span> <span class="o">{</span>
    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RedisTemplate</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">redisTemplate</span><span class="o">;</span>
    <span class="c1">// =============================common============================
</span><span class="c1"></span>    <span class="cm">/**
</span><span class="cm">     * æŒ‡å®šç¼“å­˜å¤±æ•ˆæ—¶é—´
</span><span class="cm">     * @param key é”®
</span><span class="cm">     * @param time æ—¶é—´(ç§’)
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">expire</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">long</span> <span class="n">time</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span><span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">redisTemplate</span><span class="o">.</span><span class="na">expire</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">time</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * æ ¹æ®key è·å–è¿‡æœŸæ—¶é—´
</span><span class="cm">     * @param key é”® ä¸èƒ½ä¸ºnull
</span><span class="cm">     * @return æ—¶é—´(ç§’) è¿”å›0ä»£è¡¨ä¸ºæ°¸ä¹…æœ‰æ•ˆ
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">getExpire</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">getExpire</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨
</span><span class="cm">     * @param key é”®
</span><span class="cm">     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hasKey</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">hasKey</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * åˆ é™¤ç¼“å­˜
</span><span class="cm">     * @param key å¯ä»¥ä¼ ä¸€ä¸ªå€¼ æˆ–å¤šä¸ª
</span><span class="cm">     */</span>
    <span class="nd">@SuppressWarnings</span><span class="o">(</span><span class="s">&#34;unchecked&#34;</span><span class="o">)</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">del</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">key</span> <span class="o">!=</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">key</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">key</span><span class="o">.</span><span class="na">length</span> <span class="o">==</span> <span class="n">1</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">redisTemplate</span><span class="o">.</span><span class="na">delete</span><span class="o">(</span><span class="n">key</span><span class="o">[</span><span class="n">0</span><span class="o">]);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">redisTemplate</span><span class="o">.</span><span class="na">delete</span><span class="o">((</span><span class="n">Collection</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;)</span> <span class="n">CollectionUtils</span><span class="o">.</span><span class="na">arrayToList</span><span class="o">(</span><span class="n">key</span><span class="o">));</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="c1">// ============================String=============================
</span><span class="c1"></span>    <span class="cm">/**
</span><span class="cm">     * æ™®é€šç¼“å­˜è·å–
</span><span class="cm">     * @param key é”®
</span><span class="cm">     * @return å€¼
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">get</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">key</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">?</span> <span class="kc">null</span> <span class="o">:</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * æ™®é€šç¼“å­˜æ”¾å…¥
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @return trueæˆåŠŸ falseå¤±è´¥
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">set</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * æ™®é€šç¼“å­˜æ”¾å…¥å¹¶è®¾ç½®æ—¶é—´
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @param time æ—¶é—´(ç§’) timeè¦å¤§äº0 å¦‚æœtimeå°äºç­‰äº0 å°†è®¾ç½®æ— é™æœŸ
</span><span class="cm">     * @return trueæˆåŠŸ false å¤±è´¥
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">set</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="kt">long</span> <span class="n">time</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">time</span><span class="o">,</span>
                        <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
                <span class="n">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * é€’å¢
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param delta è¦å¢åŠ å‡ (å¤§äº0)
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">incr</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">long</span> <span class="n">delta</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">delta</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;é€’å¢å› å­å¿…é¡»å¤§äº0&#34;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">increment</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">delta</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * é€’å‡
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param delta è¦å‡å°‘å‡ (å°äº0)
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">decr</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">long</span> <span class="n">delta</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">delta</span> <span class="o">&lt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="n">RuntimeException</span><span class="o">(</span><span class="s">&#34;é€’å‡å› å­å¿…é¡»å¤§äº0&#34;</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForValue</span><span class="o">().</span><span class="na">increment</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="o">-</span><span class="n">delta</span><span class="o">);</span>
    <span class="o">}</span>
<span class="c1">// ================================Map=================================
</span><span class="c1"></span>    <span class="cm">/**
</span><span class="cm">     * HashGet
</span><span class="cm">     * @param key é”® ä¸èƒ½ä¸ºnull
</span><span class="cm">     * @param item é¡¹ ä¸èƒ½ä¸ºnull
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">hget</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">get</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * è·å–hashKeyå¯¹åº”çš„æ‰€æœ‰é”®å€¼
</span><span class="cm">     * @param key é”®
</span><span class="cm">     * @return å¯¹åº”çš„å¤šä¸ªé”®å€¼
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="nf">hmget</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">entries</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * HashSet
</span><span class="cm">     * @param key é”®
</span><span class="cm">     * @param map å¯¹åº”å¤šä¸ªé”®å€¼
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hmset</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">putAll</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">map</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * HashSet å¹¶è®¾ç½®æ—¶é—´
</span><span class="cm">     * @param key é”®
</span><span class="cm">     * @param map å¯¹åº”å¤šä¸ªé”®å€¼
</span><span class="cm">     * @param time æ—¶é—´(ç§’)
</span><span class="cm">     * @return trueæˆåŠŸ falseå¤±è´¥
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hmset</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span><span class="o">,</span> <span class="kt">long</span> <span class="n">time</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">putAll</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">map</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">expire</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">time</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param item é¡¹
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @return true æˆåŠŸ falseå¤±è´¥
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hset</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">item</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">item</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param item é¡¹
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @param time æ—¶é—´(ç§’) æ³¨æ„:å¦‚æœå·²å­˜åœ¨çš„hashè¡¨æœ‰æ—¶é—´,è¿™é‡Œå°†ä¼šæ›¿æ¢åŸæœ‰çš„æ—¶é—´
</span><span class="cm">     * @return true æˆåŠŸ falseå¤±è´¥
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hset</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">item</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="kt">long</span> <span class="n">time</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">item</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">expire</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">time</span><span class="o">);</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * åˆ é™¤hashè¡¨ä¸­çš„å€¼
</span><span class="cm">     *
</span><span class="cm">     * @param key é”® ä¸èƒ½ä¸ºnull
</span><span class="cm">     * @param item é¡¹ å¯ä»¥ä½¿å¤šä¸ª ä¸èƒ½ä¸ºnull
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">hdel</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">delete</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * åˆ¤æ–­hashè¡¨ä¸­æ˜¯å¦æœ‰è¯¥é¡¹çš„å€¼
</span><span class="cm">     *
</span><span class="cm">     * @param key é”® ä¸èƒ½ä¸ºnull
</span><span class="cm">     * @param item é¡¹ ä¸èƒ½ä¸ºnull
</span><span class="cm">     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">hHasKey</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">hasKey</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * hashé€’å¢ å¦‚æœä¸å­˜åœ¨,å°±ä¼šåˆ›å»ºä¸€ä¸ª å¹¶æŠŠæ–°å¢åçš„å€¼è¿”å›
</span><span class="cm">     *
</span><span class="cm">     * @param key é”®
</span><span class="cm">     * @param item é¡¹
</span><span class="cm">     * @param by  è¦å¢åŠ å‡ (å¤§äº0)
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">hincr</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">item</span><span class="o">,</span> <span class="kt">double</span> <span class="n">by</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">increment</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">item</span><span class="o">,</span> <span class="n">by</span><span class="o">);</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * hashé€’å‡
</span><span class="cm">     *
</span><span class="cm">     * @param key é”®
</span><span class="cm">     * @param item é¡¹
</span><span class="cm">     * @param by  è¦å‡å°‘è®°(å°äº0)
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">double</span> <span class="nf">hdecr</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">String</span> <span class="n">item</span><span class="o">,</span> <span class="kt">double</span> <span class="n">by</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForHash</span><span class="o">().</span><span class="na">increment</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">item</span><span class="o">,</span> <span class="o">-</span><span class="n">by</span><span class="o">);</span>
    <span class="o">}</span>
<span class="c1">// ============================set=============================
</span><span class="c1"></span>    <span class="cm">/**
</span><span class="cm">     * æ ¹æ®keyè·å–Setä¸­çš„æ‰€æœ‰å€¼
</span><span class="cm">     * @param key é”®
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">Set</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">sGet</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForSet</span><span class="o">().</span><span class="na">members</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * æ ¹æ®valueä»ä¸€ä¸ªsetä¸­æŸ¥è¯¢,æ˜¯å¦å­˜åœ¨
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @return true å­˜åœ¨ falseä¸å­˜åœ¨
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">sHasKey</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForSet</span><span class="o">().</span><span class="na">isMember</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * å°†æ•°æ®æ”¾å…¥setç¼“å­˜
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
</span><span class="cm">     * @return æˆåŠŸä¸ªæ•°
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">sSet</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">values</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForSet</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">values</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">0</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * å°†setæ•°æ®æ”¾å…¥ç¼“å­˜
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param time  æ—¶é—´(ç§’)
</span><span class="cm">     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
</span><span class="cm">     * @return æˆåŠŸä¸ªæ•°
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">sSetAndTime</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">long</span> <span class="n">time</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">values</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForSet</span><span class="o">().</span><span class="na">add</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">values</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span>
                <span class="n">expire</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">time</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">0</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * è·å–setç¼“å­˜çš„é•¿åº¦
</span><span class="cm">     *
</span><span class="cm">     * @param key é”®
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">sGetSetSize</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForSet</span><span class="o">().</span><span class="na">size</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">0</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * ç§»é™¤å€¼ä¸ºvalueçš„
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param values å€¼ å¯ä»¥æ˜¯å¤šä¸ª
</span><span class="cm">     * @return ç§»é™¤çš„ä¸ªæ•°
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">setRemove</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">values</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Long</span> <span class="n">count</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForSet</span><span class="o">().</span><span class="na">remove</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">values</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">count</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">0</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="c1">// ===============================list=================================
</span><span class="c1"></span>    <span class="cm">/**
</span><span class="cm">     * è·å–listç¼“å­˜çš„å†…å®¹
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param start å¼€å§‹
</span><span class="cm">     * @param end  ç»“æŸ 0 åˆ° -1ä»£è¡¨æ‰€æœ‰å€¼
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="nf">lGet</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">long</span> <span class="n">start</span><span class="o">,</span> <span class="kt">long</span> <span class="n">end</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">range</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">start</span><span class="o">,</span> <span class="n">end</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * è·å–listç¼“å­˜çš„é•¿åº¦
</span><span class="cm">     *
</span><span class="cm">     * @param key é”®
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">lGetListSize</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">size</span><span class="o">(</span><span class="n">key</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">0</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * é€šè¿‡ç´¢å¼• è·å–listä¸­çš„å€¼
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param index ç´¢å¼• index&gt;=0æ—¶ï¼Œ 0 è¡¨å¤´ï¼Œ1 ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨ï¼›index&lt;0
</span><span class="cm">    æ—¶ï¼Œ-1ï¼Œè¡¨å°¾ï¼Œ-2å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="n">Object</span> <span class="nf">lGetIndex</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">long</span> <span class="n">index</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="k">return</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">index</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">index</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * å°†listæ”¾å…¥ç¼“å­˜
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">lSet</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">rightPush</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * å°†listæ”¾å…¥ç¼“å­˜
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @param time æ—¶é—´(ç§’)
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">lSet</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">,</span> <span class="kt">long</span> <span class="n">time</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">rightPush</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span>
                <span class="n">expire</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">time</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * å°†listæ”¾å…¥ç¼“å­˜
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @return
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">lSet</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">rightPushAll</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * å°†listæ”¾å…¥ç¼“å­˜
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @param time æ—¶é—´(ç§’)
</span><span class="cm">     * @return
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">lSet</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span> <span class="n">value</span><span class="o">,</span> <span class="kt">long</span> <span class="n">time</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">rightPushAll</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">0</span><span class="o">)</span>
                <span class="n">expire</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">time</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * æ ¹æ®ç´¢å¼•ä¿®æ”¹listä¸­çš„æŸæ¡æ•°æ®
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param index ç´¢å¼•
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @return
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">lUpdateIndex</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">long</span> <span class="n">index</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">set</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">index</span><span class="o">,</span> <span class="n">value</span><span class="o">);</span>
            <span class="k">return</span> <span class="kc">true</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
    <span class="cm">/**
</span><span class="cm">     * ç§»é™¤Nä¸ªå€¼ä¸ºvalue
</span><span class="cm">     *
</span><span class="cm">     * @param key  é”®
</span><span class="cm">     * @param count ç§»é™¤å¤šå°‘ä¸ª
</span><span class="cm">     * @param value å€¼
</span><span class="cm">     * @return ç§»é™¤çš„ä¸ªæ•°
</span><span class="cm">     */</span>
    <span class="kd">public</span> <span class="kt">long</span> <span class="nf">lRemove</span><span class="o">(</span><span class="n">String</span> <span class="n">key</span><span class="o">,</span> <span class="kt">long</span> <span class="n">count</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">Long</span> <span class="n">remove</span> <span class="o">=</span> <span class="n">redisTemplate</span><span class="o">.</span><span class="na">opsForList</span><span class="o">().</span><span class="na">remove</span><span class="o">(</span><span class="n">key</span><span class="o">,</span> <span class="n">count</span><span class="o">,</span>
                    <span class="n">value</span><span class="o">);</span>
            <span class="k">return</span> <span class="n">remove</span><span class="o">;</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="k">return</span> <span class="n">0</span><span class="o">;</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å°†åˆšæ‰è‡ªå®šä¹‰çš„RedisTemplateä¸­çš„æ‰€æœ‰æ–¹æ³•å°è£…ä¸€ä¸‹</p>
</blockquote>
<hr>
<p><code>æµ‹è¯•</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="nn">com.zhang</span><span class="o">;</span>


<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.core.JsonProcessingException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.fasterxml.jackson.databind.ObjectMapper</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.pojo.User</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.zhang.utils.RedisUtil</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.junit.jupiter.api.Test</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.beans.factory.annotation.Qualifier</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.springframework.data.redis.core.RedisTemplate</span><span class="o">;</span>

<span class="nd">@SpringBootTest</span>
<span class="kd">class</span> <span class="nc">SpringBootRedisApplicationTests</span> <span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="nd">@Qualifier</span><span class="o">(</span><span class="s">&#34;redisTemplate&#34;</span><span class="o">)</span>
    <span class="kd">private</span> <span class="n">RedisTemplate</span> <span class="n">redisTemplate</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">RedisUtil</span> <span class="n">redisUtil</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kt">void</span> <span class="nf">contextLoads</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">JsonProcessingException</span> <span class="o">{</span>
<span class="c1">//        User user = new User(&#34;zhangyuhang&#34;,&#34;!23456&#34;);
</span><span class="c1">//        String jsonUser = new ObjectMapper().writeValueAsString(user);
</span><span class="c1">//        redisTemplate.opsForValue().set(&#34;user&#34;,jsonUser);
</span><span class="c1"></span>        <span class="n">redisUtil</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">,</span><span class="s">&#34;zhangyuhang&#34;</span><span class="o">);</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">redisUtil</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;username&#34;</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h1 id="step14redisé…ç½®æ–‡ä»¶è¯¦è§£">Step14.Redisé…ç½®æ–‡ä»¶è¯¦è§£</h1>
<h2 id="ubuntuä¸‹æ‰“å¼€é…ç½®æ–‡ä»¶">Ubuntuä¸‹æ‰“å¼€é…ç½®æ–‡ä»¶</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&gt; cd /etc/redis
&gt; sudo su root 
&gt; vim redis.conf
</code></pre></td></tr></table>
</div>
</div><h2 id="è¯»é…ç½®æ–‡ä»¶">è¯»é…ç½®æ–‡ä»¶</h2>
<ul>
<li>unité»˜è®¤å•ä½</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback"># Redis configuration file example.
#
# Note that in order to read the configuration file, Redis must be
# started with the file path as first argument:
#
# ./redis-server /path/to/redis.conf

# Note on units: when memory size is needed, it is possible to specify
# it in the usual form of 1k 5GB 4M and so forth:
#
# 1k =&gt; 1000 bytes
# 1kb =&gt; 1024 bytes
# 1m =&gt; 1000000 bytes
# 1mb =&gt; 1024*1024 bytes
# 1g =&gt; 1000000000 bytes
# 1gb =&gt; 1024*1024*1024 bytes
#
# units are case insensitive so 1GB 1Gb 1gB are all the same.
</code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>å¯é…ç½®é…ç½®æ–‡ä»¶</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">################################## INCLUDES ###################################

# Include one or more other config files here.  This is useful if you
# have a standard template that goes to all Redis servers but also need
# to customize a few per-server settings.  Include files can include
# other files, so use this wisely.
#
# Notice option &#34;include&#34; won&#39;t be rewritten by command &#34;CONFIG REWRITE&#34;
# from admin or Redis Sentinel. Since Redis always uses the last processed
# line as value of a configuration directive, you&#39;d better put includes
# at the beginning of this file to avoid overwriting config change at runtime.
#
# If instead you are interested in using includes to override configuration
# options, it is better to use include as the last line.
#
# include /path/to/local.conf
# include /path/to/other.conf
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>è¿™ä¸ªå°±æ˜¯è¯´redisé»˜è®¤çš„é…ç½®æ–‡ä»¶æ˜¯/etc/redis/redis.conf,ä¹Ÿå¯ä»¥è‡ªå®šä¹‰é…ç½®æ–‡ä»¶,ä¾‹å¦‚local.confã€other.confç­‰</p>
</blockquote>
<hr>
<ul>
<li>ç½‘ç»œ</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">################################## NETWORK #####################################

# By default, if no &#34;bind&#34; configuration directive is specified, Redis listens
# for connections from all the network interfaces available on the server.
# It is possible to listen to just one or multiple selected interfaces using
# the &#34;bind&#34; configuration directive, followed by one or more IP addresses.
#
# Examples:
#
# bind 192.168.1.100 10.0.0.1
# bind 127.0.0.1 ::1
#
# ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the
# internet, binding to all the interfaces is dangerous and will expose the
# instance to everybody on the internet. So by default we uncomment the
# following bind directive, that will force Redis to listen only into
# the IPv4 loopback interface address (this means Redis will be able to
# accept connections only from clients running into the same computer it
# is running).
#
# IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES
# JUST COMMENT THE FOLLOWING LINE.
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
bind 127.0.0.1 ::1

# Protected mode is a layer of security protection, in order to avoid that
# Redis instances left open on the internet are accessed and exploited.
#
# When protected mode is on and if:
#
# 1) The server is not binding explicitly to a set of addresses using the
#    &#34;bind&#34; directive.
# 2) No password is configured.
#
# The server only accepts connections from clients connecting from the
# IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain
# sockets.
#
# By default protected mode is enabled. You should disable it only if
# you are sure you want clients from other hosts to connect to Redis
# even if no authentication is configured, nor a specific set of interfaces
# are explicitly listed using the &#34;bind&#34; directive.
protected-mode yes

# Accept connections on the specified port, default is 6379 (IANA #815344).
# If port 0 is specified Redis will not listen on a TCP socket.
port 6379

# TCP listen() backlog.
#
# In high requests-per-second environments you need an high backlog in order
# to avoid slow clients connections issues. Note that the Linux kernel
# will silently truncate it to the value of /proc/sys/net/core/somaxconn so
# make sure to raise both the value of somaxconn and tcp_max_syn_backlog
# in order to get the desired effect.
tcp-backlog 511

# Unix socket.
#
# Specify the path for the Unix socket that will be used to listen for
# incoming connections. There is no default, so Redis will not listen
# on a unix socket when not specified.
#
# unixsocket /var/run/redis/redis-server.sock
# unixsocketperm 700

# Close the connection after a client is idle for N seconds (0 to disable)
timeout 0

# TCP keepalive.
#
# If non-zero, use SO_KEEPALIVE to send TCP ACKs to clients in absence
# of communication. This is useful for two reasons:
#
# 1) Detect dead peers.
# 2) Take the connection alive from the point of view of network
#    equipment in the middle.
#
# On Linux, the specified value (in seconds) is the period used to send ACKs.
# Note that to close the connection the double of the time is needed.
# On other kernels the period depends on the kernel configuration.
#
# A reasonable value for this option is 300 seconds, which is the new
# Redis default starting with Redis 3.2.1.
tcp-keepalive 300

</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>bind 127.0.0.1 ::1 (ç»‘å®šä¸€ä¸ªipä¸ºæœ¬æœºip)</p>
</blockquote>
<blockquote>
<p>protected-mode yes (ä¿æŠ¤æ¨¡å¼)</p>
</blockquote>
<blockquote>
<p>port 6379 (æŒ‡å®šç«¯å£å·)</p>
</blockquote>
<blockquote>
<p>ä¸‹é¢è¿˜æœ‰ä¸€äº›TCPçš„è¿æ¥ã€ä»¥åŠè¶…æ—¶å¤„ç†ç­‰</p>
</blockquote>
<hr>
<h1 id="step15rdbæ“ä½œ">Step15.RDBæ“ä½œ</h1>
<h2 id="rdbä»‹ç»">RDBä»‹ç»</h2>
<blockquote>
<p>Redisæ˜¯å†…å­˜æ•°æ®åº“,å¦‚æœä¸å°†æ•°æ®ä¿å­˜åœ¨å¤–å­˜ä¸­,ä¸€æ—¦æ–­ç”µ,æ•°æ®å°±ä¼šå…¨éƒ¨æ¶ˆå¤±</p>
</blockquote>
<blockquote>
<p>æœåŠ¡å™¨ä¸­çš„æ•°æ®ä¹Ÿä¼šæ¶ˆå¤±</p>
</blockquote>
<blockquote>
<p>æ‰€ä»¥æˆ‘ä»¬ç»™Redisæä¾›äº†æŒä¹…åŒ–åŠŸèƒ½</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/ded61f556349489b831af3fba2327be1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/2f8a59e76d4b494abd39cde46b452310.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<blockquote>
<p>åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…æŒ‡çš„æ˜¯saveæ“ä½œ</p>
</blockquote>
<blockquote>
<p>save æŒ‡å®šæ—¶é—´é—´éš” è§¦å‘setæ“ä½œå‡ æ¬¡</p>
</blockquote>
<h2 id="è·å–rdbæ–‡ä»¶è·¯å¾„çš„å‘½ä»¤">è·å–rdbæ–‡ä»¶è·¯å¾„çš„å‘½ä»¤</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">CONFIG GET dir
</code></pre></td></tr></table>
</div>
</div><h2 id="è§¦å‘rdbæœºåˆ¶çš„æ–¹æ³•">è§¦å‘RDBæœºåˆ¶çš„æ–¹æ³•</h2>
<ul>
<li>
<p>1.æ›´æ”¹saveçš„è®¾ç½®</p>
<p><img src="https://img-blog.csdnimg.cn/6acfb386727449d4a39305486248141d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<blockquote>
<p>è®¾ç½®ä¸ºåœ¨60ç§’å†…æ›´æ”¹key6æ¬¡æ•°æˆ–è€…è®¾ç½®key6æ¬¡,å°±ä¼šè§¦å‘RDBæœºåˆ¶</p>
</blockquote>
</li>
<li>
<p>æ‰§è¡Œflushallæ“ä½œ</p>
<blockquote>
<p>å¼€ä¸¤ä¸ªç»ˆç«¯,ä¸€ä¸ªæ‰§è¡Œredis,ä¸€ä¸ªæŸ¥çœ‹dump.rdbæ˜¯å¦å­˜åœ¨</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/bfeb7d9a4ab544cdb40c20949ce896ac.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">å·¦è¾¹å…ˆflushall,å³è¾¹rm -rf dump.rdb
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">å°†æ‰€æœ‰çš„éƒ½æ¸…ç©º
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">ç„¶åå·¦è¾¹
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">127.0.0.1:6379&gt; set k1 v1
OK
127.0.0.1:6379&gt; set k2 v2
OK
127.0.0.1:6379&gt; set k3 v3
OK
127.0.0.1:6379&gt; set k4 v4
OK
127.0.0.1:6379&gt; set k5 v5
OK
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">å³è¾¹å†æ¬¡æŸ¥çœ‹dump.rdb,å°±ä¼šå‘ç°æœ‰ç»“æœ
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>é’ˆå¯¹CentOS</p>
<blockquote>
<p>dump.rdbæ–‡ä»¶å’Œredis-serveræ”¾åœ¨ä¸€èµ·</p>
<p>å¼€ä¸¤ä¸ªçª—å£,ä¸€ä¸ªè¿è¡Œredis-server,ä¸€ä¸ªè¿›å…¥/usr/local/binæŸ¥çœ‹dump.rdbæ–‡ä»¶çš„å­˜åœ¨æƒ…å†µ</p>
</blockquote>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="step16aofæ“ä½œ">Step16.AOFæ“ä½œ</h1>
<ul>
<li>
<p>AOFæ“ä½œå’ŒRDBç±»ä¼¼,RDBæ˜¯å­˜å‚¨key-valueæ–‡ä»¶,AOFæ˜¯å­˜å‚¨setã€getè¿™ç§æŒ‡ä»¤çš„æ–‡ä»¶,å†æ¬¡å¯åŠ¨æ—¶è¯»å–æ–‡ä»¶,å°†æ–‡ä»¶ä¸­çš„å‘½ä»¤å†æ‰§è¡Œä¸€æ¬¡</p>
<p><img src="https://img-blog.csdnimg.cn/1fd29f6e19734599ab1bf5fcb13af087.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>AOFé»˜è®¤æ˜¯å…³é—­çš„</p>
</li>
<li>
<p>éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰‹åŠ¨å¼€å¯</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">############################## APPEND ONLY MODE ###############################
  
# By default Redis asynchronously dumps the dataset on disk. This mode is
# good enough in many applications, but an issue with the Redis process or
# a power outage may result into a few minutes of writes lost (depending on
# the configured save points).
#
# The Append Only File is an alternative persistence mode that provides
# much better durability. For instance using the default data fsync policy
# (see later in the config file) Redis can lose just one second of writes in a
# dramatic event like a server power outage, or a single write if something
# wrong with the Redis process itself happens, but the operating system is
# still running correctly.
#
# AOF and RDB persistence can be enabled at the same time without problems.
# If the AOF is enabled on startup Redis will load the AOF, that is the file
# with the better durability guarantees.
#
# Please check http://redis.io/topics/persistence for more information.
  
appendonly yes
  
# The name of the append only file (default: &#34;appendonly.aof&#34;)
  
appendfilename &#34;appendonly.aof&#34;
  
# The fsync() call tells the Operating System to actually write data on disk
# instead of waiting for more data in the output buffer. Some OS will really flush
# data on disk, some other OS will just try to do it ASAP.
#
# Redis supports three different modes:
#
# no: don&#39;t fsync, just let the OS flush the data when it wants. Faster.
# always: fsync after every write to the append only log. Slow, Safest.
# everysec: fsync only one time every second. Compromise.
#
# The default is &#34;everysec&#34;, as that&#39;s usually the right compromise between
# speed and data safety. It&#39;s up to you to understand if you can relax this to
# &#34;no&#34; that will let the operating system flush the output buffer when
# it wants, for better performances (but if you can live with the idea of
# some data loss consider the default persistence mode that&#39;s snapshotting),
# or on the contrary, use &#34;always&#34; that&#39;s very slow but a bit safer than
# everysec.
#
# More details please check the following article:
# http://antirez.com/post/redis-persistence-demystified.html
#
# If unsure, use &#34;everysec&#34;.
  
# appendfsync always
appendfsync everysec
# appendfsync no
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>è®¾ç½®appendonly noæ”¹ä¸ºyes</p>
</blockquote>
</li>
<li>
<p>ç„¶åæµ‹è¯•</p>
</li>
<li>
<p>ä½†æ˜¯é€šè¿‡vimè®¾ç½®appendonly noå¥½åƒå¹¶ä¸å¥æ•ˆ</p>
</li>
<li>
<p>CentOSè¿›å…¥/usr/local/bin</p>
<blockquote>
<p>redis-cli config set appendonly yes</p>
</blockquote>
</li>
<li>
<p>ç„¶ååœ¨å¯¹åº”ä¿®æ”¹çš„é…ç½®æ–‡ä»¶çš„serverä¸‹æ‰§è¡ŒRedisè¯­å¥,åœ¨/usr/local/binä¸‹å°±ä¼šè‡ªåŠ¨ç”Ÿæˆappendonly.aofæ–‡ä»¶</p>
<p><img src="https://img-blog.csdnimg.cn/f828d30bb109486a80d607634203e0b9.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/ab1cf034c6974b46b5e58adc676fddd0.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>é…ç½®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">appendonly no <span class="c1"># Redisé»˜è®¤æ˜¯ä¸å¼€å¯appendonlyçš„,éœ€è¦æ‰‹åŠ¨å¼€å¯,æˆ‘æ•´ç†äº†ä¸¤ç§å¼€å¯æ–¹å¼,åœ¨æˆ‘çš„Ubuntuä¸­ç¬¬äºŒç§æ–¹å¼æ›´å¥æ•ˆ</span>
appendfilename <span class="s2">&#34;appendonly.aof&#34;</span> <span class="c1"># æŒä¹…åŒ–çš„åå­—</span>
  
<span class="c1"># appendfsync always # æ¯æ¬¡ä¿®æ”¹éƒ½ä¼šsync,æ¶ˆè€—æ€§èƒ½</span>
appendfsync everysec <span class="c1"># æ¯ç§’æ‰§è¡Œä¸€æ¬¡sync,å¯èƒ½ä¸¢å¤±è¿™ä¸€ç§’çš„æ•°æ®</span>
<span class="c1"># appendfsync no # ä¸æ‰§è¡Œsync,æ“ä½œç³»ç»Ÿè‡ªå·±åŒæ­¥æ•°æ®,é€Ÿåº¦æœ€å¿«</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="https://img-blog.csdnimg.cn/7d0531f923854f34954df38fe661bc86.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
</ul>
<h1 id="step17redisè®¢é˜…å‘å¸ƒ">Step17.Redisè®¢é˜…å‘å¸ƒ</h1>
<ul>
<li>
<p>Redisè®¢é˜…å‘å¸ƒ(PUBLISH/SUBSCRIBE)æ˜¯ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼:å‘é€è€…å‘é€æ¶ˆæ¯,è®¢é˜…è€…æ¥å—æ¶ˆæ¯.å¾®åšã€å¾®ä¿¡ã€å…³æ³¨ç³»ç»Ÿ</p>
</li>
<li>
<p>Rediså®¢æˆ·ç«¯å¯ä»¥è®¢é˜…ä»»æ„æ•°é‡çš„é¢‘é“</p>
<p><img src="https://img-blog.csdnimg.cn/9ee9925706f3442b9d1653d9e597b89d.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/b8c2beb489664db3be645baadf27fe4a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>æ“ä½œ</p>
<p><img src="https://img-blog.csdnimg.cn/cef96ba040ea45d58c4e8ba8ebf7b9e1.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<ul>
<li>
<p>å¼€ä¸¤ä¸ªtermial,éƒ½å¼€å¯Redis-Server,ä¸€ä¸ªä½œä¸ºSUB,ä¸€ä¸ªä½œä¸ºPUB</p>
</li>
<li>
<p>SUB</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">SUBSCRIBE zhangyuhang
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ„æ€å°±æ˜¯è®¢é˜…äº†åå«zhangyuhangçš„é¢‘é“</p>
</blockquote>
</li>
<li>
<p>PUB</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">PUBLISH zhangyuhang &#34;HelloRedis&#34;
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ„æ€å°±æ˜¯å‘æ‰€æœ‰è®¢é˜…zhangyuhangé¢‘é“çš„clientå‘é€&quot;HelloRedis&quot;æ¶ˆæ¯</p>
</blockquote>
</li>
</ul>
</li>
<li>
<p>å½“PUBLISHå‘é€æˆåŠŸ,SUBç«¯ä¼šè‡ªåŠ¨æ¥æ”¶åˆ°æ¶ˆæ¯</p>
</li>
</ul>
<hr>
<h1 id="step18redisä¸»ä»å¤åˆ¶">Step18.Redisä¸»ä»å¤åˆ¶</h1>
<p><img src="https://img-blog.csdnimg.cn/522c4c76991f4863a9726c322bf2984a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<ul>
<li>æä¸€ä¸ªä¸»æœº,å¤šä¸ªä»æœº,ç”±äºæˆ‘ä»¬é¢å‘æœåŠ¡å™¨80%çš„æ“ä½œéƒ½æ˜¯è¯»æ“ä½œ,åªæœ‰ä¸åˆ°20%çš„æ“ä½œæ—¶å†™æ“ä½œ</li>
<li>ä¸»æœºè´Ÿè´£å†™,å¤šä¸ªä»æœºè´Ÿè´£è¯»,æå¤§çš„å‡ç¼“äº†ä¸»æœºçš„è´Ÿè½½</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/0eb5efeafef144d4afb811da395fd992.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<ul>
<li>
<p>æœ€ä½é…æ˜¯ä¸€ä¸ªä¸»æœºä¸¤ä¸ªä»æœº,å› ä¸ºå¦‚æœæœ‰ä¸€ä¸ªä¸»æœºä¸€ä¸ªä»æœº,ä¸»æœºkilläº†ä»æœºè¿˜å¯ä»¥é¡¶ä¸€ä¸‹.ä½†è¿™æ ·æ˜æ˜¾ä¸å¤Ÿ</p>
</li>
<li>
<p>ä»æœºå®ƒæœ‰ä¸ªå“¨å…µæ¨¡å¼,å½“ä¸»æœºæ­»äº†,ä»æœºä¸­å¯ä»¥é€‰ä¸¾</p>
</li>
<li>
<p>redis.confå‚¨å­˜åœ¨CentOSä¸‹çš„/etcç›®å½•ä¸­</p>
</li>
<li>
<p>redis-serverå’Œredis-cliéƒ½æ”¾åœ¨/usr/local/binç›®å½•ä¸‹</p>
</li>
<li>
<p>å°†redis.confæ›´æ”¹é…ç½®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">daemonize yes
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>è¿™æ˜¯éå¸¸å…³é”®çš„é…ç½®,å¦‚æœä¸å¼€å¯å®ƒ,å³ä½¿é…ç½®å¥½äº†ä¹Ÿæ²¡ç”¨</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-txt" data-lang="txt">Redis daemonizeä»‹ç»
  1ã€daemonizeä»‹ç»
      Aã€redis.confé…ç½®æ–‡ä»¶ä¸­daemonizeå®ˆæŠ¤çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯NOã€‚
      Bã€daemonizeæ˜¯ç”¨æ¥æŒ‡å®šredisæ˜¯å¦è¦ç”¨å®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼å¯åŠ¨ã€‚
  2ã€daemonize è®¾ç½®yesæˆ–è€…noåŒºåˆ«
      daemonize:yes:
          redisé‡‡ç”¨çš„æ˜¯å•è¿›ç¨‹å¤šçº¿ç¨‹çš„æ¨¡å¼ã€‚å½“redis.confä¸­é€‰é¡¹daemonizeè®¾		                   ç½®æˆyesæ—¶ï¼Œä»£è¡¨å¼€å¯å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œredisä¼šåœ¨åå°è¿è¡Œï¼Œå¹¶å°†è¿›                   ç¨‹pidå·å†™å…¥è‡³redis.confé€‰é¡¹pidfileè®¾ç½®çš„æ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶rediså°†ä¸€ç›´è¿                     è¡Œï¼Œé™¤éæ‰‹åŠ¨killè¯¥è¿›ç¨‹ã€‚
      daemonize:no:
          å½“daemonizeé€‰é¡¹è®¾ç½®æˆnoæ—¶ï¼Œå½“å‰ç•Œé¢å°†è¿›å…¥redisçš„å‘½ä»¤è¡Œç•Œé¢ï¼Œexitå¼ºåˆ¶é€€å‡ºæˆ–				è€…å…³é—­è¿æ¥å·¥å…·(putty,xshellç­‰)éƒ½ä¼šå¯¼è‡´redisè¿›ç¨‹é€€å‡ºã€‚
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å•æœºé›†ç¾¤å¤šé…ç½®æ–‡ä»¶,ä¸€ä¸ªserveråŠ è½½ä¸€ä¸ªé…ç½®æ–‡ä»¶,è¿™é‡Œç”¨äºæµ‹è¯•å¤åˆ¶ä¸‰ä¸ª</p>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cd /etc
cp redis.conf redis80.conf
cp redis.conf redis81.conf
cp redis.conf redis82.conf
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>æ›´æ”¹å¤åˆ¶å‡ºæ¥çš„è¿™å‡ ä¸ªconfigçš„ä»¥ä¸‹é…ç½®</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">port 6382
pidfile /var/run/redis_6382.pid
logfile /var/log/redis/redis82.log
dbfilename dump82.rdb
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ç«¯å£æ”¹æˆè‡ªå·±æƒ³è¦çš„,ç„¶åä¸‹é¢çš„é‚£äº›é…ç½®æ–‡ä»¶åé¢éƒ½åŠ ä¸Šç«¯å£å·æˆ–è€…ç«¯å£å·åä¸¤ä½</p>
</blockquote>
</li>
<li>
<p>æ›´æ”¹å®Œæˆå</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">cd /usr/local/bin
./redis-server /etc/redis80.conf
./redis-server /etc/redis81.conf
./redis-server /etc/redis82.conf
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å°±å¯ä»¥åŒæ—¶å¯åŠ¨ä¸‰ä¸ªserveräº†</p>
</li>
</ul>
<h2 id="å¦‚ä½•å¯åŠ¨å¤šä¸ªserverå’Œcli">å¦‚ä½•å¯åŠ¨å¤šä¸ªserverå’Œcli</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /usr/local/bin
./redis-server /etc/redis80.conf
./redis-client -p <span class="m">6381</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="ä¸»ä»æœºé…ç½®">ä¸»ä»æœºé…ç½®</h2>
<ul>
<li>å‰é¢åªæ˜¯è¿›è¡Œä¸»ä»å¤åˆ¶çš„å‡†å¤‡å·¥ä½œ</li>
<li>ä¸‹é¢æ‰æ˜¯çœŸæ­£çš„ä¸»ä»å¤åˆ¶æ“ä½œ</li>
<li>å›é¡¾ä¸€ä¸‹,ä¸»ä»å¤åˆ¶å°±æ˜¯ä¸€ä¸ªä¸»æœºå¤šä¸ªä»æœº,ä¸»æœºå¯è¯»å¯å†™,ä»æœºåªèƒ½è¯»ä¸èƒ½å†™</li>
<li>è¿™æ ·åšçš„ç›®çš„æ˜¯,å› ä¸ºæˆ‘ä»¬å¹³æ—¶80%çš„æ“ä½œéƒ½æ˜¯è¯»å–,åªæœ‰ä¸åˆ°20%çš„æ“ä½œæ˜¯å†™</li>
<li>ä¸ºäº†é™ä½ä¸»æœºçš„è´Ÿè·,å°†æ‰€æœ‰è¯»å–æ“ä½œæ”¾ç½®åœ¨å¤šä¸ªä»æœºä¸Š,å¹¶ç”±å¯è¯»å¯å†™çš„ä¸»æœºæ“ä½œå¤šä¸ªä»æœº</li>
</ul>
<p><code>ä¸»ä»é…ç½®æ“ä½œ</code></p>
<h3 id="ä¸€ä¸»äºŒä»">ä¸€ä¸»äºŒä»</h3>
<ul>
<li>ç»ˆç«¯1(ä¸»æœº)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /usr/local/bin
./redis-server /etc/redis.conf
./redis-cli
</code></pre></td></tr></table>
</div>
</div><ul>
<li>ç»ˆç«¯2(ä»æœº1)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /usr/local/bin
./redis-server /etc/redis80.conf
./redis-cli -p <span class="m">6380</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>ç»ˆç«¯3(ä»æœº2)</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">cd</span> /usr/local/bin
./redis-server /etc/redis81.conf
./redis-cli -p <span class="m">6381</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<ul>
<li>å°†6380å’Œ6381è®¾ç½®æˆ6379serverçš„ä»æœº</li>
</ul>
<p><code>ä»æœº1ä¸­</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">SLAVEOF 127.0.0.1 <span class="m">6379</span> <span class="c1"># å°†å½“å‰serverè®¾ç½®æˆæŒ‡å®šip serverçš„ä»æœº</span>
</code></pre></td></tr></table>
</div>
</div><p><code>ä»æœº2ä¸­</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">SLAVEOF 127.0.0.1 <span class="m">6379</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>æŸ¥çœ‹å½“å‰ä¸»ä»çŠ¶æ€çš„å‘½ä»¤</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">info replication
</code></pre></td></tr></table>
</div>
</div><p><code>ä¸»æœºä¸­</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6379&gt; info replication
<span class="c1"># Replication</span>
role:master <span class="c1"># è§’è‰²:ç®¡ç†è€…</span>
connected_slaves:2 <span class="c1"># ä»æœºæ•°é‡:2</span>
slave0:ip<span class="o">=</span>127.0.0.1,port<span class="o">=</span>6380,state<span class="o">=</span>online,offset<span class="o">=</span>364,lag<span class="o">=</span><span class="m">0</span> <span class="c1"># ä»æœºçš„ä¿¡æ¯</span>
slave1:ip<span class="o">=</span>127.0.0.1,port<span class="o">=</span>6381,state<span class="o">=</span>online,offset<span class="o">=</span>364,lag<span class="o">=</span><span class="m">1</span>
master_replid:488d71c6bb84408bb2a6f625e52d478c9d67318e
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:364
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:364
</code></pre></td></tr></table>
</div>
</div><p><code>ä»æœº1ä¸­</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6380&gt; info replication
<span class="c1"># Replication</span>
role:slave <span class="c1"># è§’è‰²æ˜¯ä»æœº</span>
master_host:127.0.0.1 <span class="c1"># ä»å±ä¸»æœºipåœ°å€</span>
master_port:6379 <span class="c1"># ä»å±ä¸»æœºç«¯å£å·</span>
master_link_status:up
master_last_io_seconds_ago:8
master_sync_in_progress:0
slave_repl_offset:14
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:488d71c6bb84408bb2a6f625e52d478c9d67318e
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:14
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:14
</code></pre></td></tr></table>
</div>
</div><p><code>ä»æœº2ä¸­</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6381&gt; info replication
<span class="c1"># Replication</span>
role:slave
master_host:127.0.0.1
master_port:6379
master_link_status:up
master_last_io_seconds_ago:6
master_sync_in_progress:0
slave_repl_offset:154
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:776a04f12fb1f5cd718d8ad2f4820981051bea79
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:154
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:29
repl_backlog_histlen:126
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å¯ä»¥çœ‹åˆ°,ä¸»æœº6379ä¸­çš„role(è§’è‰²)æ˜¯master,è€Œå…¶ä»–ä¸¤ä¸ªä»æœºçš„roleæ˜¯slave(å¥´éš¶)</p>
</blockquote>
<hr>
<p><code>åœ¨ä¸»æœºä¸­setä¸€ä¸ªå€¼</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6379&gt; <span class="nb">set</span> k1 v1
OK
127.0.0.1:6379&gt; 
</code></pre></td></tr></table>
</div>
</div><p><code>ä»æœºä¸­å¯ä»¥è¯»å–ä¸»æœºä¿¡æ¯(æ ¸å¿ƒæœ¬æ¥å°±æ˜¯ä¸»æœº,ä»æœºè¯»ä¸»æœºçš„æ•°æ®,è€Œä¸»æœºå¯¹è‡ªå·±çš„æ•°æ®è¿›è¡Œå†™æ“ä½œ)</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6380&gt; get k1
<span class="s2">&#34;v1&#34;</span>
</code></pre></td></tr></table>
</div>
</div><p><code>ä½†æ˜¯ä»æœºä¸­åªèƒ½è¯»ä¸èƒ½å†™,æ‰€ä»¥åœ¨ä»æœºä¸­è¿›è¡Œå†™æ“ä½œä¼šæŠ¥é”™</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6380&gt; <span class="nb">set</span> k1
<span class="o">(</span>error<span class="o">)</span> ERR wrong number of arguments <span class="k">for</span> <span class="s1">&#39;set&#39;</span> <span class="nb">command</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<p><code>å½“ä¸»æœºæ–­å¼€,ä»æœºä¾ç„¶å¯ä»¥è·å–åˆ°ä¸»æœºçš„æ•°æ®</code></p>
<ul>
<li>
<p>ä¸»æœº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6379&gt; shutdown
not connected&gt; <span class="nb">exit</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>ä»æœº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6380&gt; get k1
<span class="s2">&#34;v1&#34;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p><code>å½“ä»æœºæ–­å¼€,ç„¶åé‡æ–°è¿æ¥,å°±åˆå¯ä»¥é‡æ–°è·å–åˆ°ä¸»æœºçš„æ•°æ®</code></p>
<ul>
<li>
<p>ä»æœº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6380&gt; shutdown
not connected&gt; <span class="nb">exit</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-server /etc/redis80.conf</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-cli -p 6380</span>
127.0.0.1:6380&gt; get k1
<span class="s2">&#34;v1&#34;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/c1ae7059310c449096e20a0380ccc6d6.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<hr>
<h3 id="å±‚å±‚é“¾è·¯">```å±‚å±‚é“¾è·¯</h3>
<blockquote>
<p>å‘½ä»¤å’Œä¸€ä¸»äºŒä»ä¸€æ ·</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/c3052aaf37714b7d8952514a221f85ef.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<ul>
<li>
<p>6380</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@iz2ze6kbye84nif83w2g4az ~<span class="o">]</span><span class="c1"># cd /usr/local/bin</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-server /etc/redis80.conf</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-cli</span>
127.0.0.1:6379&gt; shutdown 
not connected&gt; <span class="nb">exit</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-cli -p 6380</span>
127.0.0.1:6380&gt; SLAVEOF 127.0.0.1 <span class="m">6379</span>
OK
127.0.0.1:6380&gt; info replication
<span class="c1"># Replication</span>
role:slave
master_host:127.0.0.1
master_port:6379
master_link_status:up
master_last_io_seconds_ago:3
master_sync_in_progress:0
slave_repl_offset:42
slave_priority:100
slave_read_only:1
connected_slaves:1
slave0:ip<span class="o">=</span>127.0.0.1,port<span class="o">=</span>6381,state<span class="o">=</span>online,offset<span class="o">=</span>42,lag<span class="o">=</span><span class="m">0</span>
master_replid:d247663bb55d515898816cd8317aa3f164e6616d
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:42
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:42
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>6381</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@iz2ze6kbye84nif83w2g4az ~<span class="o">]</span><span class="c1"># cd /usr/local/bin</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-server /etc/redis81.conf</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-cli -p 6381</span>
127.0.0.1:6381&gt; SLAVEOF 127.0.0.1 <span class="m">6380</span>
OK
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>6379</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6379&gt; info replication
<span class="c1"># Replication</span>
role:master
connected_slaves:1
slave0:ip<span class="o">=</span>127.0.0.1,port<span class="o">=</span>6380,state<span class="o">=</span>online,offset<span class="o">=</span>28,lag<span class="o">=</span><span class="m">0</span>
master_replid:d247663bb55d515898816cd8317aa3f164e6616d
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:28
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:28
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<blockquote>
<p>å¯ä»¥çœ‹åˆ°,6381æ˜¯6380çš„ä¸»æœº,è€Œ6379æ˜¯6380çš„ä¸»æœº</p>
<p>è™½ç„¶6380æ˜¯6381çš„ä¸»æœº,ä½†å®ƒè¿˜æ˜¯ä¸ªslave</p>
</blockquote>
<ul>
<li>
<p>ç„¶ååœ¨6379ä¸­</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">set</span> k1 v1
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>åœ¨6380å’Œ6381ä¸­éƒ½å¯ä»¥è·å–åˆ°k1çš„å€¼</p>
</li>
<li>
<p>è¿™æ˜¯å› ä¸ºå®ƒæœ¬æ¥å°±æ˜¯ä¸»ä»å¤åˆ¶æœºåˆ¶,ä¸»æœºä¼šå®æ—¶çš„å°†è‡ªå·±çš„æ•°æ®å¤åˆ¶ç»™ä»æœº,è¿™æ ·6380ä¸­å°±æœ‰6379çš„æ•°æ®äº†,ç„¶å6380æ˜¯6381çš„ä¸»æœº</p>
</li>
<li>
<p>ä½†ç°åœ¨å¦‚æœè®©6379ä¸»æœºå®•æœº,é‚£6380å’Œ6381è¿˜èƒ½å¦è·å–åˆ°k1çš„å€¼å‘¢?</p>
<ul>
<li>
<p>6379</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6379&gt; flushall
OK
127.0.0.1:6379&gt; <span class="nb">set</span> k1 v1
OK
127.0.0.1:6379&gt; shutdown
not connected&gt; <span class="nb">exit</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>6380</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6380&gt; get k1
<span class="s2">&#34;v1&#34;</span>
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>6381</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6381&gt; get k1
<span class="s2">&#34;v1&#34;</span>
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
</li>
<li>
<p>æ˜æ˜¾,æ˜¯å¯ä»¥è·å–åˆ°çš„</p>
</li>
<li>
<p>ç°åœ¨6379å®•æœºäº†,ç°åœ¨6381æ˜¯6380çš„ä»æœº,åˆšæ‰çœ‹6381è™½ç„¶æ˜¯6380çš„ä¸»æœº,ä½†æ˜¯6380è¿˜æ˜¯ä¸€ä¸ªslave</p>
</li>
<li>
<p>å°±æ˜¯è¯´ä¸»æœºæŒ‚äº†,ç°åœ¨å°±æ²¡æœ‰ä¸»æœºäº†</p>
</li>
<li>
<p>è€Œä¸”ç°åœ¨ä¹Ÿæ²¡é…ç½®å“¨å…µæ¨¡å¼,æ²¡æ³•è‡ªåŠ¨é€‰ä¸¾</p>
</li>
<li>
<p>æ²¡æœ‰çœŸæ­£æ„ä¹‰ä¸Šçš„ä¸»æœº,å°±æ— æ³•è¿›è¡Œå†™æ“ä½œ</p>
</li>
<li>
<p>æ‰‹åŠ¨å°†6380è®¾ç½®ä¸ºä¸»æœº</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">SLAVEOF no one
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>å°†å½“å‰serverè®¾ç½®æˆä¸»æœº,å®ƒçš„slaveä¹Ÿä¿æŒä¸å˜</p>
</blockquote>
</li>
</ul>
<hr>
<ul>
<li>
<p>é‚£ç°åœ¨å°†å®•æœºçš„6379é‡æ–°å¯åŠ¨,6380ä¼šä¸ä¼šè‡ªåŠ¨å˜æˆ6379çš„slaveå‘¢?</p>
<blockquote>
<p>è‚¯å®šæ˜¯ä¸ä¼š</p>
</blockquote>
</li>
<li>
<p>å¼€å¯6379å,éœ€è¦åœ¨6380ä¸­é‡æ–°æ‰‹åŠ¨å°†6380è®¾ç½®æˆ6379çš„ä¸»æœº</p>
<p><code>6379</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-server /etc/redis.conf</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-cli -p 6379</span>
</code></pre></td></tr></table>
</div>
</div><p><code>6380</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6380&gt; SLAVEOF 127.0.0.1 <span class="m">6379</span>
OK
127.0.0.1:6380&gt; info replication
<span class="c1"># Replication</span>
role:slave
master_host:127.0.0.1
master_port:6379
master_link_status:up
master_last_io_seconds_ago:9
master_sync_in_progress:0
slave_repl_offset:42
slave_priority:100
slave_read_only:1
connected_slaves:1
slave0:ip<span class="o">=</span>127.0.0.1,port<span class="o">=</span>6381,state<span class="o">=</span>online,offset<span class="o">=</span>42,lag<span class="o">=</span><span class="m">1</span>
master_replid:4772364c1009b8e6ae1a1c3af4972d33ab071a65
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:42
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:1
repl_backlog_histlen:42
</code></pre></td></tr></table>
</div>
</div></li>
</ul>
<hr>
<h1 id="step19å“¨å…µæ¨¡å¼">Step19.å“¨å…µæ¨¡å¼</h1>
<h2 id="æ¦‚å¿µ">æ¦‚å¿µ</h2>
<p><img src="https://img-blog.csdnimg.cn/121f66d4061a4803b5991ac7246427bf.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/4dac85a97d804d3f87964a9184ccfc9f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/5ab3d916a86649448175375663765638.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/84ed122e69e4413d914861c6aff25e0a.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<h2 id="æµ‹è¯•">æµ‹è¯•</h2>
<ul>
<li>
<p>å¼€å¯å››ä¸ªç»ˆç«¯,åˆ†åˆ«ç”¨äº6379ã€6380ã€6381å’Œå“¨å…µ</p>
</li>
<li>
<p>6380å’Œ6381éƒ½æ˜¯6379çš„ä»æœº</p>
<p><code>6379</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@iz2ze6kbye84nif83w2g4az ~<span class="o">]</span><span class="c1"># cd /usr/local/bin</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ll</span>
total <span class="m">20136</span>
-rw-r--r-- <span class="m">1</span> root root     <span class="m">237</span> Nov  <span class="m">3</span> 23:28 appendonly.aof
-rwxr-xr-x <span class="m">1</span> root root <span class="m">8855632</span> May  <span class="m">7</span>  <span class="m">2018</span> docker-compose
-rw-r--r-- <span class="m">1</span> root root     <span class="m">188</span> Nov  <span class="m">4</span> 21:38 dump.rdb
-rwxr-xr-x <span class="m">1</span> root root  <span class="m">353424</span> Nov  <span class="m">3</span> 09:52 redis-benchmark
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-check-aof
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-check-rdb
-rwxr-xr-x <span class="m">1</span> root root  <span class="m">518736</span> Nov  <span class="m">3</span> 09:52 redis-cli
lrwxrwxrwx <span class="m">1</span> root root      <span class="m">12</span> Nov  <span class="m">3</span> 09:52 redis-sentinel -&gt; redis-server
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-server
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-server /etc/redis.conf</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-cli</span>
</code></pre></td></tr></table>
</div>
</div><p><code>6380</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@iz2ze6kbye84nif83w2g4az ~<span class="o">]</span><span class="c1"># cd /usr/local/bin</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ll</span>
total <span class="m">20136</span>
-rw-r--r-- <span class="m">1</span> root root     <span class="m">237</span> Nov  <span class="m">3</span> 23:28 appendonly.aof
-rwxr-xr-x <span class="m">1</span> root root <span class="m">8855632</span> May  <span class="m">7</span>  <span class="m">2018</span> docker-compose
-rw-r--r-- <span class="m">1</span> root root     <span class="m">188</span> Nov  <span class="m">4</span> 21:38 dump.rdb
-rwxr-xr-x <span class="m">1</span> root root  <span class="m">353424</span> Nov  <span class="m">3</span> 09:52 redis-benchmark
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-check-aof
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-check-rdb
-rwxr-xr-x <span class="m">1</span> root root  <span class="m">518736</span> Nov  <span class="m">3</span> 09:52 redis-cli
lrwxrwxrwx <span class="m">1</span> root root      <span class="m">12</span> Nov  <span class="m">3</span> 09:52 redis-sentinel -&gt; redis-server
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-server
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-server /etc/redis80.conf</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-cli -p 6380</span>
127.0.0.1:6380&gt; clear
127.0.0.1:6380&gt; SLAVEOF 127.0.0.1 <span class="m">6379</span>
OK
</code></pre></td></tr></table>
</div>
</div><p><code>6381</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@iz2ze6kbye84nif83w2g4az ~<span class="o">]</span><span class="c1"># cd /usr/local/bin</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ll</span>
total <span class="m">20136</span>
-rw-r--r-- <span class="m">1</span> root root     <span class="m">237</span> Nov  <span class="m">3</span> 23:28 appendonly.aof
-rwxr-xr-x <span class="m">1</span> root root <span class="m">8855632</span> May  <span class="m">7</span>  <span class="m">2018</span> docker-compose
-rw-r--r-- <span class="m">1</span> root root     <span class="m">188</span> Nov  <span class="m">4</span> 21:38 dump.rdb
-rwxr-xr-x <span class="m">1</span> root root  <span class="m">353424</span> Nov  <span class="m">3</span> 09:52 redis-benchmark
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-check-aof
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-check-rdb
-rwxr-xr-x <span class="m">1</span> root root  <span class="m">518736</span> Nov  <span class="m">3</span> 09:52 redis-cli
lrwxrwxrwx <span class="m">1</span> root root      <span class="m">12</span> Nov  <span class="m">3</span> 09:52 redis-sentinel -&gt; redis-server
-rwxr-xr-x <span class="m">1</span> root root <span class="m">3623072</span> Nov  <span class="m">3</span> 09:52 redis-server
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-server /etc/redis81.conf</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-cli -p 6381</span>
127.0.0.1:6381&gt; clear
127.0.0.1:6381&gt; SLAVEOF 127.0.0.1 <span class="m">6379</span>
OK
</code></pre></td></tr></table>
</div>
</div><p><code>sentinel</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@iz2ze6kbye84nif83w2g4az /<span class="o">]</span><span class="c1"># cd etc</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az etc<span class="o">]</span><span class="c1"># vim sentinel.conf</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az /<span class="o">]</span><span class="c1"># cd /usr/local/bin</span>
<span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-sentinel /etc/sentinel.conf</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>å“¨å…µé…ç½®æ–‡ä»¶<code>sentinel.conf</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-v" data-lang="v"><span class="n">sentinel</span> <span class="n">monitor</span> <span class="n">firstSentinel</span> <span class="mf">127.0.0.1</span> <span class="mh">6379</span> <span class="mh">1</span>
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>sentinelæ˜¯å“¨å…µçš„æ„æ€,monitoræ˜¯ç›‘æ§å™¨çš„æ„æ€,firstSentinelæ˜¯å½“å‰å“¨å…µçš„åç§°,æœ€åé¢å°±æ˜¯ä½ è¿™ä¸ªå“¨å…µè¦ç›‘è§†çš„ä¸»æœºå’Œç«¯å£å·</p>
</blockquote>
</li>
<li>
<p>å¯åŠ¨å“¨å…µçš„å‘½ä»¤å’Œå¯åŠ¨serverçš„æ–¹å¼æ˜¯ä¸€æ ·çš„,éƒ½æ˜¯åœ¨/usr/local/binä¸‹é¢é€šè¿‡åŠ è½½/etcä¸‹çš„é…ç½®æ–‡ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">./redis-sentinel /etc/sentinel.conf
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å¯åŠ¨å,è¿™é‡Œè¯•éªŒè¿‡ä¸€æ¬¡,ç„¶åç¬¬äºŒæ¬¡ä¸ºäº†è®°ç¬”è®°å°±å°†ä¸‰ä¸ªserverå’Œsentineléƒ½å…³é—­äº†,ç„¶ååˆé‡å¯äº†ä¸€ä¸‹,è¿™æ—¶å€™å‘ç°ä¸‰ä¸ªéƒ½TMæ˜¯slave</p>
</li>
<li>
<p>æˆ‘æ˜¯è¿™æ ·è§£å†³çš„</p>
<p><code>6381</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">SLAVEOF 127.0.0.1 <span class="m">6379</span>
</code></pre></td></tr></table>
</div>
</div><p><code>6380</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">SLAVEOF 127.0.0.1 <span class="m">6379</span>
</code></pre></td></tr></table>
</div>
</div><p><code>6379</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">SLAVEOF NO ONE
</code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>è¿™æ ·6379å°±é‡æ–°å˜å›6380å’Œ6381çš„ä¸»æœºäº†</p>
</li>
<li>
<p>ä½†æ˜¯æˆ‘å‘ç°,6379å´ä¸æ˜¯ä¸»æœº,è€Œæ˜¯6379å’Œ6380éƒ½å˜æˆäº†6379çš„ä¸»æœº</p>
</li>
<li>
<p>ä¹Ÿè¡Œå§,é‚£å°±è®©6381å®•æœº</p>
<p><code>6381</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6381&gt; shutdown
not connected&gt; <span class="nb">exit</span>
</code></pre></td></tr></table>
</div>
</div><p><code>6379</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6379&gt; info replication
<span class="c1"># Replication</span>
role:slave
master_host:127.0.0.1
master_port:6380
master_link_status:up
master_last_io_seconds_ago:1
master_sync_in_progress:0
slave_repl_offset:35112
slave_priority:100
slave_read_only:1
connected_slaves:0
master_replid:60ed7908ca63d41aa1d3bfe924cd3c5cecdfd8b6
master_replid2:3c6e43cb2e69ddf24ae629cebfa714f4cc144941
master_repl_offset:35112
second_repl_offset:29030
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:9971
repl_backlog_histlen:25142
</code></pre></td></tr></table>
</div>
</div><p><code>6380</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">127.0.0.1:6380&gt; info replication
<span class="c1"># Replication</span>
role:master
connected_slaves:1
slave0:ip<span class="o">=</span>127.0.0.1,port<span class="o">=</span>6379,state<span class="o">=</span>online,offset<span class="o">=</span>29480,lag<span class="o">=</span><span class="m">0</span>
master_replid:60ed7908ca63d41aa1d3bfe924cd3c5cecdfd8b6
master_replid2:3c6e43cb2e69ddf24ae629cebfa714f4cc144941
master_repl_offset:29480
second_repl_offset:29030
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:9971
repl_backlog_histlen:19510
</code></pre></td></tr></table>
</div>
</div><p><code>sentinel</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="o">[</span>root@iz2ze6kbye84nif83w2g4az bin<span class="o">]</span><span class="c1"># ./redis-sentinel /etc/sentinel.conf</span>
16967:X <span class="m">06</span> Nov 12:45:34.191 <span class="c1"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
16967:X <span class="m">06</span> Nov 12:45:34.192 <span class="c1"># Redis version=4.0.6, bits=64, commit=00000000, modified=0, pid=16967, just started</span>
16967:X <span class="m">06</span> Nov 12:45:34.192 <span class="c1"># Configuration loaded</span>
                _._                                                  
           _.-<span class="sb">``</span>__ <span class="s1">&#39;&#39;</span>-._                                             
      _.-<span class="sb">``</span>    <span class="sb">`</span>.  <span class="sb">`</span>_.  <span class="s1">&#39;&#39;</span>-._           Redis 4.0.6 <span class="o">(</span>00000000/0<span class="o">)</span> <span class="m">64</span> bit
  .-<span class="sb">``</span> .-<span class="sb">```</span>.  <span class="sb">```</span><span class="se">\/</span>    _.,_ <span class="s1">&#39;&#39;</span>-._                                   
 <span class="o">(</span>    <span class="s1">&#39;      ,       .-`  | `,    )     Running in sentinel mode
</span><span class="s1"> |`-._`-...-` __...-.``-._|&#39;</span><span class="sb">`</span> _.-<span class="s1">&#39;|     Port: 26379
</span><span class="s1"> |    `-._   `._    /     _.-&#39;</span>    <span class="p">|</span>     PID: <span class="m">16967</span>
  <span class="sb">`</span>-._    <span class="sb">`</span>-._  <span class="sb">`</span>-./  _.-<span class="s1">&#39;    _.-&#39;</span>                                   
 <span class="p">|</span><span class="sb">`</span>-._<span class="sb">`</span>-._    <span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>_.-<span class="s1">&#39;|                                  
</span><span class="s1"> |    `-._`-._        _.-&#39;</span>_.-<span class="s1">&#39;    |           http://redis.io        
</span><span class="s1">  `-._    `-._`-.__.-&#39;</span>_.-<span class="s1">&#39;    _.-&#39;</span>                                   
 <span class="p">|</span><span class="sb">`</span>-._<span class="sb">`</span>-._    <span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>_.-<span class="s1">&#39;|                                  
</span><span class="s1"> |    `-._`-._        _.-&#39;</span>_.-<span class="s1">&#39;    |                                  
</span><span class="s1">  `-._    `-._`-.__.-&#39;</span>_.-<span class="s1">&#39;    _.-&#39;</span>                                   
      <span class="sb">`</span>-._    <span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>                                       
          <span class="sb">`</span>-._        _.-<span class="s1">&#39;                                           
</span><span class="s1">              `-.__.-&#39;</span>                                               
    
16967:X <span class="m">06</span> Nov 12:45:34.194 <span class="c1"># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span>
16967:X <span class="m">06</span> Nov 12:45:34.194 <span class="c1"># Sentinel ID is 1a3ef702ea2efa419a5a0d97a488043c0946b750</span>
16967:X <span class="m">06</span> Nov 12:45:34.194 <span class="c1"># +monitor master firstSentinel 127.0.0.1 6381 quorum 1</span>
16967:X <span class="m">06</span> Nov 12:47:39.398 <span class="c1"># +sdown master firstSentinel 127.0.0.1 6381</span>
16967:X <span class="m">06</span> Nov 12:47:39.398 <span class="c1"># +odown master firstSentinel 127.0.0.1 6381 #quorum 1/1</span>
16967:X <span class="m">06</span> Nov 12:47:39.398 <span class="c1"># +new-epoch 4</span>
16967:X <span class="m">06</span> Nov 12:47:39.398 <span class="c1"># +try-failover master firstSentinel 127.0.0.1 6381</span>
16967:X <span class="m">06</span> Nov 12:47:39.400 <span class="c1"># +vote-for-leader 1a3ef702ea2efa419a5a0d97a488043c0946b750 4</span>
16967:X <span class="m">06</span> Nov 12:47:39.400 <span class="c1"># +elected-leader master firstSentinel 127.0.0.1 6381</span>
16967:X <span class="m">06</span> Nov 12:47:39.400 <span class="c1"># +failover-state-select-slave master firstSentinel 127.0.0.1 6381</span>
16967:X <span class="m">06</span> Nov 12:47:39.467 <span class="c1"># +selected-slave slave 127.0.0.1:6380 127.0.0.1 6380 @ firstSentinel 127.0.0.1 6381</span>
16967:X <span class="m">06</span> Nov 12:47:39.467 * +failover-state-send-slaveof-noone slave 127.0.0.1:6380 127.0.0.1 <span class="m">6380</span> @ firstSentinel 127.0.0.1 <span class="m">6381</span>
16967:X <span class="m">06</span> Nov 12:47:39.533 * +failover-state-wait-promotion slave 127.0.0.1:6380 127.0.0.1 <span class="m">6380</span> @ firstSentinel 127.0.0.1 <span class="m">6381</span>
16967:X <span class="m">06</span> Nov 12:47:40.477 <span class="c1"># +promoted-slave slave 127.0.0.1:6380 127.0.0.1 6380 @ firstSentinel 127.0.0.1 6381</span>
16967:X <span class="m">06</span> Nov 12:47:40.477 <span class="c1"># +failover-state-reconf-slaves master firstSentinel 127.0.0.1 6381</span>
16967:X <span class="m">06</span> Nov 12:47:40.540 * +slave-reconf-sent slave 127.0.0.1:6379 127.0.0.1 <span class="m">6379</span> @ firstSentinel 127.0.0.1 <span class="m">6381</span>
16967:X <span class="m">06</span> Nov 12:47:41.552 * +slave-reconf-inprog slave 127.0.0.1:6379 127.0.0.1 <span class="m">6379</span> @ firstSentinel 127.0.0.1 <span class="m">6381</span>
16967:X <span class="m">06</span> Nov 12:47:41.552 * +slave-reconf-done slave 127.0.0.1:6379 127.0.0.1 <span class="m">6379</span> @ firstSentinel 127.0.0.1 <span class="m">6381</span>
16967:X <span class="m">06</span> Nov 12:47:41.604 <span class="c1"># +failover-end master firstSentinel 127.0.0.1 6381</span>
16967:X <span class="m">06</span> Nov 12:47:41.604 <span class="c1"># +switch-master firstSentinel 127.0.0.1 6381 127.0.0.1 6380</span>
16967:X <span class="m">06</span> Nov 12:47:41.604 * +slave slave 127.0.0.1:6379 127.0.0.1 <span class="m">6379</span> @ firstSentinel 127.0.0.1 <span class="m">6380</span>
16967:X <span class="m">06</span> Nov 12:47:41.604 * +slave slave 127.0.0.1:6381 127.0.0.1 <span class="m">6381</span> @ firstSentinel 127.0.0.1 <span class="m">6380</span>
<span class="m">1696</span>
</code></pre></td></tr></table>
</div>
</div><ul>
<li>
<p>è¯»sentinelçš„å‘½ä»¤</p>
<p><img src="https://img-blog.csdnimg.cn/cc0f6392f3f8439aa68a84278aaf56df.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
</li>
<li>
<p>å°±æ˜¯åŸæ¥å¼€å¯äº†ä¸‰ä¸ªserverå’Œä¸€ä¸ªå“¨å…µ,6379å’Œ6380éƒ½æ˜¯6381çš„slave,ç„¶åè®©master6381å´©äº†,å“¨å…µå°±è‡ªåŠ¨é€‰ä¸¾å‡º6380ä¸ºmaster,åŒæ—¶å°†å·²ç»å´©äº†çš„ç«¯å£ä¹Ÿè®¾ç½®æˆé€‰ä¸¾å‡ºæ¥çš„è¿™ä¸ªmasterçš„slave,å†æ¬¡å¯åŠ¨ç”Ÿæ•ˆ,ä¸ä¼šè¯´å†æ¬¡å¯åŠ¨åŸæ¥å´©äº†çš„masterå®ƒè¿˜ä¼šå˜ä¸ºmaster,å®ƒåªèƒ½æ˜¯ç°åœ¨masterçš„slave</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h1 id="step20redisç¼“å­˜ç©¿é€ç¼“å­˜å‡»ç©¿ä¸é›ªå´©">Step20.Redisç¼“å­˜ç©¿é€ã€ç¼“å­˜å‡»ç©¿ä¸é›ªå´©</h1>
<h2 id="ç¼“å­˜ç©¿é€">ç¼“å­˜ç©¿é€</h2>
<p><img src="https://img-blog.csdnimg.cn/efa3101d759e4d98ab930b231c16fb33.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/4c2513c6901c4c84b23304a860882e1f.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/092ebce226cb4bfb96f0e4810b44a323.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/470781a0cbd842e09208944bb36d896c.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/899ff88d36274489841a2ee732074782.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<hr>
<h2 id="ç¼“å­˜å‡»ç©¿">ç¼“å­˜å‡»ç©¿</h2>
<p><img src="https://img-blog.csdnimg.cn/2835647ddbd441779ed0bf4f410f3de5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/45f2619fa0ec49da824517d717ab32e7.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<hr>
<h2 id="ç¼“å­˜é›ªå´©">ç¼“å­˜é›ªå´©</h2>
<p><img src="https://img-blog.csdnimg.cn/27a7d6214e0044ffadb92bd3ee67ec9e.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<p><img src="https://img-blog.csdnimg.cn/bb23de6d634e407a962141851b0c60d5.png?x-oss-process=image/watermark,type_ZHJvaWRzYW5zZmFsbGJhY2s,shadow_50,text_Q1NETiBA5a2k5ZCNQA==,size_20,color_FFFFFF,t_70,g_se,x_16" alt="Photo"></p>
<hr>
<p>ç‹‚ç¥Redisç½‘è¯¾å®Œç»“&hellip;</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">Zhang's Blog</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
        2021-09-24
        
    </span>
  </p>
  
  
</div>
<footer class="post-footer">
      <div class="post-tags">
          <a href="/tags/database/">DataBase</a>
          </div>
      <nav class="post-nav">
        <a class="prev" href="/post/react/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">React</span>
            <span class="prev-text nav-mobile">Prev</span>
          </a>
        <a class="next" href="/post/leetcode/">
            <span class="next-text nav-default">LeetCode</span>
            <span class="next-text nav-mobile">Next</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
      <a href="https://stackoverflow.com/" class="iconfont icon-stack-overflow" title="stack-overflow"></a>
      <a href="https://twitter.com/" class="iconfont icon-twitter" title="twitter"></a>
      <a href="https://www.facebook.com/" class="iconfont icon-facebook" title="facebook"></a>
      <a href="https://www.linkedin.com/" class="iconfont icon-linkedin" title="linkedin"></a>
      <a href="https://www.google.com/" class="iconfont icon-google" title="google"></a>
      <a href="https://github.com/" class="iconfont icon-github" title="github"></a>
      <a href="https://weibo.com/" class="iconfont icon-weibo" title="weibo"></a>
      <a href="https://www.zhihu.com/" class="iconfont icon-zhihu" title="zhihu"></a>
      <a href="https://www.douban.com/" class="iconfont icon-douban" title="douban"></a>
      <a href="https://getpocket.com/" class="iconfont icon-pocket" title="pocket"></a>
      <a href="https://www.tumblr.com/" class="iconfont icon-tumblr" title="tumblr"></a>
      <a href="https://www.instagram.com/" class="iconfont icon-instagram" title="instagram"></a>
      <a href="https://about.gitlab.com/" class="iconfont icon-gitlab" title="gitlab"></a>
      <a href="https://www.bilibili.com/" class="iconfont icon-bilibili" title="bilibili"></a>
  <a href="http://localhost:1313/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://golang.org/">GoLang</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Author - 
    <a class="theme-link" href="https://space.bilibili.com/628950169/">Mr'zhang</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2017 - 
    2022<span class="heart"><i class="iconfont icon-heart"></i></span><span>Zhang's Blog</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c12618f9a600c40bd024996677e951e64d3487006775aeb22e200c990006c5c7.js"></script>








</body>
</html>
